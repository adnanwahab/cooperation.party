import{Runtime as Wy,Inspector as bC}from"https://cdn.jsdelivr.net/npm/@observablehq/runtime@5/dist/runtime.js";import oD from"https://api.observablehq.com/@marialuisacp/pie-chart.js?v=3";import EC from"https://api.observablehq.com/d/84ce55045edfd14f.js?v=3";import"https://api.observablehq.com/@d3/bar-chart-race-explained.js?v=3";import"https://cdn.skypack.dev/d3-scale-chromatic@3";function aD(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const A=Object.getOwnPropertyDescriptor(i,r);A&&Object.defineProperty(t,r,A.get?A:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const A of r)if(A.type==="childList")for(const d of A.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function n(r){const A={};return r.integrity&&(A.integrity=r.integrity),r.referrerPolicy&&(A.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?A.credentials="include":r.crossOrigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function i(r){if(r.ep)return;r.ep=!0;const A=n(r);fetch(r.href,A)}})();var AD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $m(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var TC={exports:{}},Zm={},SC={exports:{}},Kn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rd=Symbol.for("react.element"),lD=Symbol.for("react.portal"),uD=Symbol.for("react.fragment"),cD=Symbol.for("react.strict_mode"),hD=Symbol.for("react.profiler"),fD=Symbol.for("react.provider"),dD=Symbol.for("react.context"),pD=Symbol.for("react.forward_ref"),gD=Symbol.for("react.suspense"),mD=Symbol.for("react.memo"),_D=Symbol.for("react.lazy"),DE=Symbol.iterator;function yD(t){return t===null||typeof t!="object"?null:(t=DE&&t[DE]||t["@@iterator"],typeof t=="function"?t:null)}var CC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},PC=Object.assign,MC={};function D0(t,e,n){this.props=t,this.context=e,this.refs=MC,this.updater=n||CC}D0.prototype.isReactComponent={};D0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};D0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function IC(){}IC.prototype=D0.prototype;function Nv(t,e,n){this.props=t,this.context=e,this.refs=MC,this.updater=n||CC}var Uv=Nv.prototype=new IC;Uv.constructor=Nv;PC(Uv,D0.prototype);Uv.isPureReactComponent=!0;var BE=Array.isArray,kC=Object.prototype.hasOwnProperty,Vv={current:null},LC={key:!0,ref:!0,__self:!0,__source:!0};function DC(t,e,n){var i,r={},A=null,d=null;if(e!=null)for(i in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(A=""+e.key),e)kC.call(e,i)&&!LC.hasOwnProperty(i)&&(r[i]=e[i]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var S=Array(l),k=0;k<l;k++)S[k]=arguments[k+2];r.children=S}if(t&&t.defaultProps)for(i in l=t.defaultProps,l)r[i]===void 0&&(r[i]=l[i]);return{$$typeof:Rd,type:t,key:A,ref:d,props:r,_owner:Vv.current}}function vD(t,e){return{$$typeof:Rd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function jv(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rd}function xD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var RE=/\/+/g;function x1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?xD(""+t.key):e.toString(36)}function pg(t,e,n,i,r){var A=typeof t;(A==="undefined"||A==="boolean")&&(t=null);var d=!1;if(t===null)d=!0;else switch(A){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case Rd:case lD:d=!0}}if(d)return d=t,r=r(d),t=i===""?"."+x1(d,0):i,BE(r)?(n="",t!=null&&(n=t.replace(RE,"$&/")+"/"),pg(r,e,n,"",function(k){return k})):r!=null&&(jv(r)&&(r=vD(r,n+(!r.key||d&&d.key===r.key?"":(""+r.key).replace(RE,"$&/")+"/")+t)),e.push(r)),1;if(d=0,i=i===""?".":i+":",BE(t))for(var l=0;l<t.length;l++){A=t[l];var S=i+x1(A,l);d+=pg(A,e,n,S,r)}else if(S=yD(t),typeof S=="function")for(t=S.call(t),l=0;!(A=t.next()).done;)A=A.value,S=i+x1(A,l++),d+=pg(A,e,n,S,r);else if(A==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function Pp(t,e,n){if(t==null)return t;var i=[],r=0;return pg(t,i,"","",function(A){return e.call(n,A,r++)}),i}function wD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var wo={current:null},gg={transition:null},bD={ReactCurrentDispatcher:wo,ReactCurrentBatchConfig:gg,ReactCurrentOwner:Vv};Kn.Children={map:Pp,forEach:function(t,e,n){Pp(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Pp(t,function(){e++}),e},toArray:function(t){return Pp(t,function(e){return e})||[]},only:function(t){if(!jv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Kn.Component=D0;Kn.Fragment=uD;Kn.Profiler=hD;Kn.PureComponent=Nv;Kn.StrictMode=cD;Kn.Suspense=gD;Kn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bD;Kn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=PC({},t.props),r=t.key,A=t.ref,d=t._owner;if(e!=null){if(e.ref!==void 0&&(A=e.ref,d=Vv.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(S in e)kC.call(e,S)&&!LC.hasOwnProperty(S)&&(i[S]=e[S]===void 0&&l!==void 0?l[S]:e[S])}var S=arguments.length-2;if(S===1)i.children=n;else if(1<S){l=Array(S);for(var k=0;k<S;k++)l[k]=arguments[k+2];i.children=l}return{$$typeof:Rd,type:t.type,key:r,ref:A,props:i,_owner:d}};Kn.createContext=function(t){return t={$$typeof:dD,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:fD,_context:t},t.Consumer=t};Kn.createElement=DC;Kn.createFactory=function(t){var e=DC.bind(null,t);return e.type=t,e};Kn.createRef=function(){return{current:null}};Kn.forwardRef=function(t){return{$$typeof:pD,render:t}};Kn.isValidElement=jv;Kn.lazy=function(t){return{$$typeof:_D,_payload:{_status:-1,_result:t},_init:wD}};Kn.memo=function(t,e){return{$$typeof:mD,type:t,compare:e===void 0?null:e}};Kn.startTransition=function(t){var e=gg.transition;gg.transition={};try{t()}finally{gg.transition=e}};Kn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Kn.useCallback=function(t,e){return wo.current.useCallback(t,e)};Kn.useContext=function(t){return wo.current.useContext(t)};Kn.useDebugValue=function(){};Kn.useDeferredValue=function(t){return wo.current.useDeferredValue(t)};Kn.useEffect=function(t,e){return wo.current.useEffect(t,e)};Kn.useId=function(){return wo.current.useId()};Kn.useImperativeHandle=function(t,e,n){return wo.current.useImperativeHandle(t,e,n)};Kn.useInsertionEffect=function(t,e){return wo.current.useInsertionEffect(t,e)};Kn.useLayoutEffect=function(t,e){return wo.current.useLayoutEffect(t,e)};Kn.useMemo=function(t,e){return wo.current.useMemo(t,e)};Kn.useReducer=function(t,e,n){return wo.current.useReducer(t,e,n)};Kn.useRef=function(t){return wo.current.useRef(t)};Kn.useState=function(t){return wo.current.useState(t)};Kn.useSyncExternalStore=function(t,e,n){return wo.current.useSyncExternalStore(t,e,n)};Kn.useTransition=function(){return wo.current.useTransition()};Kn.version="18.2.0";SC.exports=Kn;var Tt=SC.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ED=Tt,TD=Symbol.for("react.element"),SD=Symbol.for("react.fragment"),CD=Object.prototype.hasOwnProperty,PD=ED.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,MD={key:!0,ref:!0,__self:!0,__source:!0};function BC(t,e,n){var i,r={},A=null,d=null;n!==void 0&&(A=""+n),e.key!==void 0&&(A=""+e.key),e.ref!==void 0&&(d=e.ref);for(i in e)CD.call(e,i)&&!MD.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:TD,type:t,key:A,ref:d,props:r,_owner:PD.current}}Zm.Fragment=SD;Zm.jsx=BC;Zm.jsxs=BC;TC.exports=Zm;var $t=TC.exports,$y={},RC={exports:{}},Ba={},OC={exports:{}},zC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Nt,dn){var vn=Nt.length;Nt.push(dn);e:for(;0<vn;){var Bn=vn-1>>>1,Tn=Nt[Bn];if(0<r(Tn,dn))Nt[Bn]=dn,Nt[vn]=Tn,vn=Bn;else break e}}function n(Nt){return Nt.length===0?null:Nt[0]}function i(Nt){if(Nt.length===0)return null;var dn=Nt[0],vn=Nt.pop();if(vn!==dn){Nt[0]=vn;e:for(var Bn=0,Tn=Nt.length,wi=Tn>>>1;Bn<wi;){var Un=2*(Bn+1)-1,Hr=Nt[Un],qi=Un+1,ti=Nt[qi];if(0>r(Hr,vn))qi<Tn&&0>r(ti,Hr)?(Nt[Bn]=ti,Nt[qi]=vn,Bn=qi):(Nt[Bn]=Hr,Nt[Un]=vn,Bn=Un);else if(qi<Tn&&0>r(ti,vn))Nt[Bn]=ti,Nt[qi]=vn,Bn=qi;else break e}}return dn}function r(Nt,dn){var vn=Nt.sortIndex-dn.sortIndex;return vn!==0?vn:Nt.id-dn.id}if(typeof performance=="object"&&typeof performance.now=="function"){var A=performance;t.unstable_now=function(){return A.now()}}else{var d=Date,l=d.now();t.unstable_now=function(){return d.now()-l}}var S=[],k=[],U=1,V=null,$=3,X=!1,ee=!1,ue=!1,we=typeof setTimeout=="function"?setTimeout:null,ie=typeof clearTimeout=="function"?clearTimeout:null,Ae=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ce(Nt){for(var dn=n(k);dn!==null;){if(dn.callback===null)i(k);else if(dn.startTime<=Nt)i(k),dn.sortIndex=dn.expirationTime,e(S,dn);else break;dn=n(k)}}function Ce(Nt){if(ue=!1,ce(Nt),!ee)if(n(S)!==null)ee=!0,ei(Ne);else{var dn=n(k);dn!==null&&li(Ce,dn.startTime-Nt)}}function Ne(Nt,dn){ee=!1,ue&&(ue=!1,ie(lt),lt=-1),X=!0;var vn=$;try{for(ce(dn),V=n(S);V!==null&&(!(V.expirationTime>dn)||Nt&&!Et());){var Bn=V.callback;if(typeof Bn=="function"){V.callback=null,$=V.priorityLevel;var Tn=Bn(V.expirationTime<=dn);dn=t.unstable_now(),typeof Tn=="function"?V.callback=Tn:V===n(S)&&i(S),ce(dn)}else i(S);V=n(S)}if(V!==null)var wi=!0;else{var Un=n(k);Un!==null&&li(Ce,Un.startTime-dn),wi=!1}return wi}finally{V=null,$=vn,X=!1}}var qe=!1,tt=null,lt=-1,at=5,ht=-1;function Et(){return!(t.unstable_now()-ht<at)}function St(){if(tt!==null){var Nt=t.unstable_now();ht=Nt;var dn=!0;try{dn=tt(!0,Nt)}finally{dn?Mt():(qe=!1,tt=null)}}else qe=!1}var Mt;if(typeof Ae=="function")Mt=function(){Ae(St)};else if(typeof MessageChannel<"u"){var Kt=new MessageChannel,pn=Kt.port2;Kt.port1.onmessage=St,Mt=function(){pn.postMessage(null)}}else Mt=function(){we(St,0)};function ei(Nt){tt=Nt,qe||(qe=!0,Mt())}function li(Nt,dn){lt=we(function(){Nt(t.unstable_now())},dn)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Nt){Nt.callback=null},t.unstable_continueExecution=function(){ee||X||(ee=!0,ei(Ne))},t.unstable_forceFrameRate=function(Nt){0>Nt||125<Nt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):at=0<Nt?Math.floor(1e3/Nt):5},t.unstable_getCurrentPriorityLevel=function(){return $},t.unstable_getFirstCallbackNode=function(){return n(S)},t.unstable_next=function(Nt){switch($){case 1:case 2:case 3:var dn=3;break;default:dn=$}var vn=$;$=dn;try{return Nt()}finally{$=vn}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Nt,dn){switch(Nt){case 1:case 2:case 3:case 4:case 5:break;default:Nt=3}var vn=$;$=Nt;try{return dn()}finally{$=vn}},t.unstable_scheduleCallback=function(Nt,dn,vn){var Bn=t.unstable_now();switch(typeof vn=="object"&&vn!==null?(vn=vn.delay,vn=typeof vn=="number"&&0<vn?Bn+vn:Bn):vn=Bn,Nt){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=vn+Tn,Nt={id:U++,callback:dn,priorityLevel:Nt,startTime:vn,expirationTime:Tn,sortIndex:-1},vn>Bn?(Nt.sortIndex=vn,e(k,Nt),n(S)===null&&Nt===n(k)&&(ue?(ie(lt),lt=-1):ue=!0,li(Ce,vn-Bn))):(Nt.sortIndex=Tn,e(S,Nt),ee||X||(ee=!0,ei(Ne))),Nt},t.unstable_shouldYield=Et,t.unstable_wrapCallback=function(Nt){var dn=$;return function(){var vn=$;$=dn;try{return Nt.apply(this,arguments)}finally{$=vn}}}})(zC);OC.exports=zC;var ID=OC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FC=Tt,Da=ID;function Rt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NC=new Set,Xf={};function th(t,e){f0(t,e),f0(t+"Capture",e)}function f0(t,e){for(Xf[t]=e,t=0;t<e.length;t++)NC.add(e[t])}var uu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zy=Object.prototype.hasOwnProperty,kD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,OE={},zE={};function LD(t){return Zy.call(zE,t)?!0:Zy.call(OE,t)?!1:kD.test(t)?zE[t]=!0:(OE[t]=!0,!1)}function DD(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function BD(t,e,n,i){if(e===null||typeof e>"u"||DD(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bo(t,e,n,i,r,A,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=A,this.removeEmptyString=d}var Os={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Os[t]=new bo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Os[e]=new bo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Os[t]=new bo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Os[t]=new bo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Os[t]=new bo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Os[t]=new bo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Os[t]=new bo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Os[t]=new bo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Os[t]=new bo(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gv=/[\-:]([a-z])/g;function Qv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gv,Qv);Os[e]=new bo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gv,Qv);Os[e]=new bo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gv,Qv);Os[e]=new bo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Os[t]=new bo(t,1,!1,t.toLowerCase(),null,!1,!1)});Os.xlinkHref=new bo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Os[t]=new bo(t,1,!1,t.toLowerCase(),null,!0,!0)});function Hv(t,e,n,i){var r=Os.hasOwnProperty(e)?Os[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(BD(e,n,r,i)&&(n=null),i||r===null?LD(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var xu=FC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Mp=Symbol.for("react.element"),Fh=Symbol.for("react.portal"),Nh=Symbol.for("react.fragment"),Wv=Symbol.for("react.strict_mode"),qy=Symbol.for("react.profiler"),UC=Symbol.for("react.provider"),VC=Symbol.for("react.context"),$v=Symbol.for("react.forward_ref"),Yy=Symbol.for("react.suspense"),Xy=Symbol.for("react.suspense_list"),Zv=Symbol.for("react.memo"),Wu=Symbol.for("react.lazy"),jC=Symbol.for("react.offscreen"),FE=Symbol.iterator;function af(t){return t===null||typeof t!="object"?null:(t=FE&&t[FE]||t["@@iterator"],typeof t=="function"?t:null)}var Ar=Object.assign,w1;function Pf(t){if(w1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);w1=e&&e[1]||""}return`
`+w1+t}var b1=!1;function E1(t,e){if(!t||b1)return"";b1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(k){var i=k}Reflect.construct(t,[],e)}else{try{e.call()}catch(k){i=k}t.call(e.prototype)}else{try{throw Error()}catch(k){i=k}t()}}catch(k){if(k&&i&&typeof k.stack=="string"){for(var r=k.stack.split(`
`),A=i.stack.split(`
`),d=r.length-1,l=A.length-1;1<=d&&0<=l&&r[d]!==A[l];)l--;for(;1<=d&&0<=l;d--,l--)if(r[d]!==A[l]){if(d!==1||l!==1)do if(d--,l--,0>l||r[d]!==A[l]){var S=`
`+r[d].replace(" at new "," at ");return t.displayName&&S.includes("<anonymous>")&&(S=S.replace("<anonymous>",t.displayName)),S}while(1<=d&&0<=l);break}}}finally{b1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Pf(t):""}function RD(t){switch(t.tag){case 5:return Pf(t.type);case 16:return Pf("Lazy");case 13:return Pf("Suspense");case 19:return Pf("SuspenseList");case 0:case 2:case 15:return t=E1(t.type,!1),t;case 11:return t=E1(t.type.render,!1),t;case 1:return t=E1(t.type,!0),t;default:return""}}function Ky(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Nh:return"Fragment";case Fh:return"Portal";case qy:return"Profiler";case Wv:return"StrictMode";case Yy:return"Suspense";case Xy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case VC:return(t.displayName||"Context")+".Consumer";case UC:return(t._context.displayName||"Context")+".Provider";case $v:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zv:return e=t.displayName||null,e!==null?e:Ky(t.type)||"Memo";case Wu:e=t._payload,t=t._init;try{return Ky(t(e))}catch{}}return null}function OD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ky(e);case 8:return e===Wv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function GC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zD(t){var e=GC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,A=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(d){i=""+d,A.call(this,d)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(d){i=""+d},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ip(t){t._valueTracker||(t._valueTracker=zD(t))}function QC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=GC(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Vg(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Jy(t,e){var n=e.checked;return Ar({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function NE(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=hc(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function HC(t,e){e=e.checked,e!=null&&Hv(t,"checked",e,!1)}function e2(t,e){HC(t,e);var n=hc(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?t2(t,e.type,n):e.hasOwnProperty("defaultValue")&&t2(t,e.type,hc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function UE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function t2(t,e,n){(e!=="number"||Vg(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Mf=Array.isArray;function i0(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+hc(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function n2(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Rt(91));return Ar({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function VE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Rt(92));if(Mf(n)){if(1<n.length)throw Error(Rt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:hc(n)}}function WC(t,e){var n=hc(e.value),i=hc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function jE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $C(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function i2(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$C(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kp,ZC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kp=kp||document.createElement("div"),kp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Kf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Of={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FD=["Webkit","ms","Moz","O"];Object.keys(Of).forEach(function(t){FD.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Of[e]=Of[t]})});function qC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Of.hasOwnProperty(t)&&Of[t]?(""+e).trim():e+"px"}function YC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=qC(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var ND=Ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function r2(t,e){if(e){if(ND[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Rt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Rt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Rt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Rt(62))}}function s2(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var o2=null;function qv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var a2=null,r0=null,s0=null;function GE(t){if(t=Fd(t)){if(typeof a2!="function")throw Error(Rt(280));var e=t.stateNode;e&&(e=Jm(e),a2(t.stateNode,t.type,e))}}function XC(t){r0?s0?s0.push(t):s0=[t]:r0=t}function KC(){if(r0){var t=r0,e=s0;if(s0=r0=null,GE(t),e)for(t=0;t<e.length;t++)GE(e[t])}}function JC(t,e){return t(e)}function eP(){}var T1=!1;function tP(t,e,n){if(T1)return t(e,n);T1=!0;try{return JC(t,e,n)}finally{T1=!1,(r0!==null||s0!==null)&&(eP(),KC())}}function Jf(t,e){var n=t.stateNode;if(n===null)return null;var i=Jm(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Rt(231,e,typeof n));return n}var A2=!1;if(uu)try{var Af={};Object.defineProperty(Af,"passive",{get:function(){A2=!0}}),window.addEventListener("test",Af,Af),window.removeEventListener("test",Af,Af)}catch{A2=!1}function UD(t,e,n,i,r,A,d,l,S){var k=Array.prototype.slice.call(arguments,3);try{e.apply(n,k)}catch(U){this.onError(U)}}var zf=!1,jg=null,Gg=!1,l2=null,VD={onError:function(t){zf=!0,jg=t}};function jD(t,e,n,i,r,A,d,l,S){zf=!1,jg=null,UD.apply(VD,arguments)}function GD(t,e,n,i,r,A,d,l,S){if(jD.apply(this,arguments),zf){if(zf){var k=jg;zf=!1,jg=null}else throw Error(Rt(198));Gg||(Gg=!0,l2=k)}}function nh(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function nP(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function QE(t){if(nh(t)!==t)throw Error(Rt(188))}function QD(t){var e=t.alternate;if(!e){if(e=nh(t),e===null)throw Error(Rt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var A=r.alternate;if(A===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===A.child){for(A=r.child;A;){if(A===n)return QE(r),t;if(A===i)return QE(r),e;A=A.sibling}throw Error(Rt(188))}if(n.return!==i.return)n=r,i=A;else{for(var d=!1,l=r.child;l;){if(l===n){d=!0,n=r,i=A;break}if(l===i){d=!0,i=r,n=A;break}l=l.sibling}if(!d){for(l=A.child;l;){if(l===n){d=!0,n=A,i=r;break}if(l===i){d=!0,i=A,n=r;break}l=l.sibling}if(!d)throw Error(Rt(189))}}if(n.alternate!==i)throw Error(Rt(190))}if(n.tag!==3)throw Error(Rt(188));return n.stateNode.current===n?t:e}function iP(t){return t=QD(t),t!==null?rP(t):null}function rP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rP(t);if(e!==null)return e;t=t.sibling}return null}var sP=Da.unstable_scheduleCallback,HE=Da.unstable_cancelCallback,HD=Da.unstable_shouldYield,WD=Da.unstable_requestPaint,Ir=Da.unstable_now,$D=Da.unstable_getCurrentPriorityLevel,Yv=Da.unstable_ImmediatePriority,oP=Da.unstable_UserBlockingPriority,Qg=Da.unstable_NormalPriority,ZD=Da.unstable_LowPriority,aP=Da.unstable_IdlePriority,qm=null,wl=null;function qD(t){if(wl&&typeof wl.onCommitFiberRoot=="function")try{wl.onCommitFiberRoot(qm,t,void 0,(t.current.flags&128)===128)}catch{}}var HA=Math.clz32?Math.clz32:KD,YD=Math.log,XD=Math.LN2;function KD(t){return t>>>=0,t===0?32:31-(YD(t)/XD|0)|0}var Lp=64,Dp=4194304;function If(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hg(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,A=t.pingedLanes,d=n&268435455;if(d!==0){var l=d&~r;l!==0?i=If(l):(A&=d,A!==0&&(i=If(A)))}else d=n&~r,d!==0?i=If(d):A!==0&&(i=If(A));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,A=e&-e,r>=A||r===16&&(A&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-HA(e),r=1<<n,i|=t[n],e&=~r;return i}function JD(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eB(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,A=t.pendingLanes;0<A;){var d=31-HA(A),l=1<<d,S=r[d];S===-1?(!(l&n)||l&i)&&(r[d]=JD(l,e)):S<=e&&(t.expiredLanes|=l),A&=~l}}function u2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function AP(){var t=Lp;return Lp<<=1,!(Lp&4194240)&&(Lp=64),t}function S1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Od(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-HA(e),t[e]=n}function tB(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-HA(n),A=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~A}}function Xv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-HA(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var mi=0;function lP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var uP,Kv,cP,hP,fP,c2=!1,Bp=[],tc=null,nc=null,ic=null,ed=new Map,td=new Map,Zu=[],nB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function WE(t,e){switch(t){case"focusin":case"focusout":tc=null;break;case"dragenter":case"dragleave":nc=null;break;case"mouseover":case"mouseout":ic=null;break;case"pointerover":case"pointerout":ed.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":td.delete(e.pointerId)}}function lf(t,e,n,i,r,A){return t===null||t.nativeEvent!==A?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:A,targetContainers:[r]},e!==null&&(e=Fd(e),e!==null&&Kv(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function iB(t,e,n,i,r){switch(e){case"focusin":return tc=lf(tc,t,e,n,i,r),!0;case"dragenter":return nc=lf(nc,t,e,n,i,r),!0;case"mouseover":return ic=lf(ic,t,e,n,i,r),!0;case"pointerover":var A=r.pointerId;return ed.set(A,lf(ed.get(A)||null,t,e,n,i,r)),!0;case"gotpointercapture":return A=r.pointerId,td.set(A,lf(td.get(A)||null,t,e,n,i,r)),!0}return!1}function dP(t){var e=Bc(t.target);if(e!==null){var n=nh(e);if(n!==null){if(e=n.tag,e===13){if(e=nP(n),e!==null){t.blockedOn=e,fP(t.priority,function(){cP(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=h2(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);o2=i,n.target.dispatchEvent(i),o2=null}else return e=Fd(n),e!==null&&Kv(e),t.blockedOn=n,!1;e.shift()}return!0}function $E(t,e,n){mg(t)&&n.delete(e)}function rB(){c2=!1,tc!==null&&mg(tc)&&(tc=null),nc!==null&&mg(nc)&&(nc=null),ic!==null&&mg(ic)&&(ic=null),ed.forEach($E),td.forEach($E)}function uf(t,e){t.blockedOn===e&&(t.blockedOn=null,c2||(c2=!0,Da.unstable_scheduleCallback(Da.unstable_NormalPriority,rB)))}function nd(t){function e(r){return uf(r,t)}if(0<Bp.length){uf(Bp[0],t);for(var n=1;n<Bp.length;n++){var i=Bp[n];i.blockedOn===t&&(i.blockedOn=null)}}for(tc!==null&&uf(tc,t),nc!==null&&uf(nc,t),ic!==null&&uf(ic,t),ed.forEach(e),td.forEach(e),n=0;n<Zu.length;n++)i=Zu[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Zu.length&&(n=Zu[0],n.blockedOn===null);)dP(n),n.blockedOn===null&&Zu.shift()}var o0=xu.ReactCurrentBatchConfig,Wg=!0;function sB(t,e,n,i){var r=mi,A=o0.transition;o0.transition=null;try{mi=1,Jv(t,e,n,i)}finally{mi=r,o0.transition=A}}function oB(t,e,n,i){var r=mi,A=o0.transition;o0.transition=null;try{mi=4,Jv(t,e,n,i)}finally{mi=r,o0.transition=A}}function Jv(t,e,n,i){if(Wg){var r=h2(t,e,n,i);if(r===null)O1(t,e,i,$g,n),WE(t,i);else if(iB(r,t,e,n,i))i.stopPropagation();else if(WE(t,i),e&4&&-1<nB.indexOf(t)){for(;r!==null;){var A=Fd(r);if(A!==null&&uP(A),A=h2(t,e,n,i),A===null&&O1(t,e,i,$g,n),A===r)break;r=A}r!==null&&i.stopPropagation()}else O1(t,e,i,null,n)}}var $g=null;function h2(t,e,n,i){if($g=null,t=qv(i),t=Bc(t),t!==null)if(e=nh(t),e===null)t=null;else if(n=e.tag,n===13){if(t=nP(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $g=t,null}function pP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($D()){case Yv:return 1;case oP:return 4;case Qg:case ZD:return 16;case aP:return 536870912;default:return 16}default:return 16}}var Xu=null,ex=null,_g=null;function gP(){if(_g)return _g;var t,e=ex,n=e.length,i,r="value"in Xu?Xu.value:Xu.textContent,A=r.length;for(t=0;t<n&&e[t]===r[t];t++);var d=n-t;for(i=1;i<=d&&e[n-i]===r[A-i];i++);return _g=r.slice(t,1<i?1-i:void 0)}function yg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Rp(){return!0}function ZE(){return!1}function Ra(t){function e(n,i,r,A,d){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=A,this.target=d,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(A):A[l]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Rp:ZE,this.isPropagationStopped=ZE,this}return Ar(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Rp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Rp)},persist:function(){},isPersistent:Rp}),e}var B0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tx=Ra(B0),zd=Ar({},B0,{view:0,detail:0}),aB=Ra(zd),C1,P1,cf,Ym=Ar({},zd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cf&&(cf&&t.type==="mousemove"?(C1=t.screenX-cf.screenX,P1=t.screenY-cf.screenY):P1=C1=0,cf=t),C1)},movementY:function(t){return"movementY"in t?t.movementY:P1}}),qE=Ra(Ym),AB=Ar({},Ym,{dataTransfer:0}),lB=Ra(AB),uB=Ar({},zd,{relatedTarget:0}),M1=Ra(uB),cB=Ar({},B0,{animationName:0,elapsedTime:0,pseudoElement:0}),hB=Ra(cB),fB=Ar({},B0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dB=Ra(fB),pB=Ar({},B0,{data:0}),YE=Ra(pB),gB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_B={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yB(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=_B[t])?!!e[t]:!1}function nx(){return yB}var vB=Ar({},zd,{key:function(t){if(t.key){var e=gB[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?mB[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nx,charCode:function(t){return t.type==="keypress"?yg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xB=Ra(vB),wB=Ar({},Ym,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),XE=Ra(wB),bB=Ar({},zd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nx}),EB=Ra(bB),TB=Ar({},B0,{propertyName:0,elapsedTime:0,pseudoElement:0}),SB=Ra(TB),CB=Ar({},Ym,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),PB=Ra(CB),MB=[9,13,27,32],ix=uu&&"CompositionEvent"in window,Ff=null;uu&&"documentMode"in document&&(Ff=document.documentMode);var IB=uu&&"TextEvent"in window&&!Ff,mP=uu&&(!ix||Ff&&8<Ff&&11>=Ff),KE=String.fromCharCode(32),JE=!1;function _P(t,e){switch(t){case"keyup":return MB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Uh=!1;function kB(t,e){switch(t){case"compositionend":return yP(e);case"keypress":return e.which!==32?null:(JE=!0,KE);case"textInput":return t=e.data,t===KE&&JE?null:t;default:return null}}function LB(t,e){if(Uh)return t==="compositionend"||!ix&&_P(t,e)?(t=gP(),_g=ex=Xu=null,Uh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mP&&e.locale!=="ko"?null:e.data;default:return null}}var DB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function e3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!DB[t.type]:e==="textarea"}function vP(t,e,n,i){XC(i),e=Zg(e,"onChange"),0<e.length&&(n=new tx("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Nf=null,id=null;function BB(t){kP(t,0)}function Xm(t){var e=Gh(t);if(QC(e))return t}function RB(t,e){if(t==="change")return e}var xP=!1;if(uu){var I1;if(uu){var k1="oninput"in document;if(!k1){var t3=document.createElement("div");t3.setAttribute("oninput","return;"),k1=typeof t3.oninput=="function"}I1=k1}else I1=!1;xP=I1&&(!document.documentMode||9<document.documentMode)}function n3(){Nf&&(Nf.detachEvent("onpropertychange",wP),id=Nf=null)}function wP(t){if(t.propertyName==="value"&&Xm(id)){var e=[];vP(e,id,t,qv(t)),tP(BB,e)}}function OB(t,e,n){t==="focusin"?(n3(),Nf=e,id=n,Nf.attachEvent("onpropertychange",wP)):t==="focusout"&&n3()}function zB(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Xm(id)}function FB(t,e){if(t==="click")return Xm(e)}function NB(t,e){if(t==="input"||t==="change")return Xm(e)}function UB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ZA=typeof Object.is=="function"?Object.is:UB;function rd(t,e){if(ZA(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Zy.call(e,r)||!ZA(t[r],e[r]))return!1}return!0}function i3(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function r3(t,e){var n=i3(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=i3(n)}}function bP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?bP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function EP(){for(var t=window,e=Vg();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vg(t.document)}return e}function rx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function VB(t){var e=EP(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&bP(n.ownerDocument.documentElement,n)){if(i!==null&&rx(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,A=Math.min(i.start,r);i=i.end===void 0?A:Math.min(i.end,r),!t.extend&&A>i&&(r=i,i=A,A=r),r=r3(n,A);var d=r3(n,i);r&&d&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==d.node||t.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),A>i?(t.addRange(e),t.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var jB=uu&&"documentMode"in document&&11>=document.documentMode,Vh=null,f2=null,Uf=null,d2=!1;function s3(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;d2||Vh==null||Vh!==Vg(i)||(i=Vh,"selectionStart"in i&&rx(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Uf&&rd(Uf,i)||(Uf=i,i=Zg(f2,"onSelect"),0<i.length&&(e=new tx("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Vh)))}function Op(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var jh={animationend:Op("Animation","AnimationEnd"),animationiteration:Op("Animation","AnimationIteration"),animationstart:Op("Animation","AnimationStart"),transitionend:Op("Transition","TransitionEnd")},L1={},TP={};uu&&(TP=document.createElement("div").style,"AnimationEvent"in window||(delete jh.animationend.animation,delete jh.animationiteration.animation,delete jh.animationstart.animation),"TransitionEvent"in window||delete jh.transitionend.transition);function Km(t){if(L1[t])return L1[t];if(!jh[t])return t;var e=jh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in TP)return L1[t]=e[n];return t}var SP=Km("animationend"),CP=Km("animationiteration"),PP=Km("animationstart"),MP=Km("transitionend"),IP=new Map,o3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dc(t,e){IP.set(t,e),th(e,[t])}for(var D1=0;D1<o3.length;D1++){var B1=o3[D1],GB=B1.toLowerCase(),QB=B1[0].toUpperCase()+B1.slice(1);dc(GB,"on"+QB)}dc(SP,"onAnimationEnd");dc(CP,"onAnimationIteration");dc(PP,"onAnimationStart");dc("dblclick","onDoubleClick");dc("focusin","onFocus");dc("focusout","onBlur");dc(MP,"onTransitionEnd");f0("onMouseEnter",["mouseout","mouseover"]);f0("onMouseLeave",["mouseout","mouseover"]);f0("onPointerEnter",["pointerout","pointerover"]);f0("onPointerLeave",["pointerout","pointerover"]);th("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));th("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));th("onBeforeInput",["compositionend","keypress","textInput","paste"]);th("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));th("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));th("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HB=new Set("cancel close invalid load scroll toggle".split(" ").concat(kf));function a3(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,GD(i,e,void 0,t),t.currentTarget=null}function kP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var A=void 0;if(e)for(var d=i.length-1;0<=d;d--){var l=i[d],S=l.instance,k=l.currentTarget;if(l=l.listener,S!==A&&r.isPropagationStopped())break e;a3(r,l,k),A=S}else for(d=0;d<i.length;d++){if(l=i[d],S=l.instance,k=l.currentTarget,l=l.listener,S!==A&&r.isPropagationStopped())break e;a3(r,l,k),A=S}}}if(Gg)throw t=l2,Gg=!1,l2=null,t}function Ui(t,e){var n=e[y2];n===void 0&&(n=e[y2]=new Set);var i=t+"__bubble";n.has(i)||(LP(e,t,2,!1),n.add(i))}function R1(t,e,n){var i=0;e&&(i|=4),LP(n,t,i,e)}var zp="_reactListening"+Math.random().toString(36).slice(2);function sd(t){if(!t[zp]){t[zp]=!0,NC.forEach(function(n){n!=="selectionchange"&&(HB.has(n)||R1(n,!1,t),R1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[zp]||(e[zp]=!0,R1("selectionchange",!1,e))}}function LP(t,e,n,i){switch(pP(e)){case 1:var r=sB;break;case 4:r=oB;break;default:r=Jv}n=r.bind(null,e,n,t),r=void 0,!A2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function O1(t,e,n,i,r){var A=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var d=i.tag;if(d===3||d===4){var l=i.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(d===4)for(d=i.return;d!==null;){var S=d.tag;if((S===3||S===4)&&(S=d.stateNode.containerInfo,S===r||S.nodeType===8&&S.parentNode===r))return;d=d.return}for(;l!==null;){if(d=Bc(l),d===null)return;if(S=d.tag,S===5||S===6){i=A=d;continue e}l=l.parentNode}}i=i.return}tP(function(){var k=A,U=qv(n),V=[];e:{var $=IP.get(t);if($!==void 0){var X=tx,ee=t;switch(t){case"keypress":if(yg(n)===0)break e;case"keydown":case"keyup":X=xB;break;case"focusin":ee="focus",X=M1;break;case"focusout":ee="blur",X=M1;break;case"beforeblur":case"afterblur":X=M1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=qE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=lB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=EB;break;case SP:case CP:case PP:X=hB;break;case MP:X=SB;break;case"scroll":X=aB;break;case"wheel":X=PB;break;case"copy":case"cut":case"paste":X=dB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=XE}var ue=(e&4)!==0,we=!ue&&t==="scroll",ie=ue?$!==null?$+"Capture":null:$;ue=[];for(var Ae=k,ce;Ae!==null;){ce=Ae;var Ce=ce.stateNode;if(ce.tag===5&&Ce!==null&&(ce=Ce,ie!==null&&(Ce=Jf(Ae,ie),Ce!=null&&ue.push(od(Ae,Ce,ce)))),we)break;Ae=Ae.return}0<ue.length&&($=new X($,ee,null,n,U),V.push({event:$,listeners:ue}))}}if(!(e&7)){e:{if($=t==="mouseover"||t==="pointerover",X=t==="mouseout"||t==="pointerout",$&&n!==o2&&(ee=n.relatedTarget||n.fromElement)&&(Bc(ee)||ee[cu]))break e;if((X||$)&&($=U.window===U?U:($=U.ownerDocument)?$.defaultView||$.parentWindow:window,X?(ee=n.relatedTarget||n.toElement,X=k,ee=ee?Bc(ee):null,ee!==null&&(we=nh(ee),ee!==we||ee.tag!==5&&ee.tag!==6)&&(ee=null)):(X=null,ee=k),X!==ee)){if(ue=qE,Ce="onMouseLeave",ie="onMouseEnter",Ae="mouse",(t==="pointerout"||t==="pointerover")&&(ue=XE,Ce="onPointerLeave",ie="onPointerEnter",Ae="pointer"),we=X==null?$:Gh(X),ce=ee==null?$:Gh(ee),$=new ue(Ce,Ae+"leave",X,n,U),$.target=we,$.relatedTarget=ce,Ce=null,Bc(U)===k&&(ue=new ue(ie,Ae+"enter",ee,n,U),ue.target=ce,ue.relatedTarget=we,Ce=ue),we=Ce,X&&ee)t:{for(ue=X,ie=ee,Ae=0,ce=ue;ce;ce=Th(ce))Ae++;for(ce=0,Ce=ie;Ce;Ce=Th(Ce))ce++;for(;0<Ae-ce;)ue=Th(ue),Ae--;for(;0<ce-Ae;)ie=Th(ie),ce--;for(;Ae--;){if(ue===ie||ie!==null&&ue===ie.alternate)break t;ue=Th(ue),ie=Th(ie)}ue=null}else ue=null;X!==null&&A3(V,$,X,ue,!1),ee!==null&&we!==null&&A3(V,we,ee,ue,!0)}}e:{if($=k?Gh(k):window,X=$.nodeName&&$.nodeName.toLowerCase(),X==="select"||X==="input"&&$.type==="file")var Ne=RB;else if(e3($))if(xP)Ne=NB;else{Ne=zB;var qe=OB}else(X=$.nodeName)&&X.toLowerCase()==="input"&&($.type==="checkbox"||$.type==="radio")&&(Ne=FB);if(Ne&&(Ne=Ne(t,k))){vP(V,Ne,n,U);break e}qe&&qe(t,$,k),t==="focusout"&&(qe=$._wrapperState)&&qe.controlled&&$.type==="number"&&t2($,"number",$.value)}switch(qe=k?Gh(k):window,t){case"focusin":(e3(qe)||qe.contentEditable==="true")&&(Vh=qe,f2=k,Uf=null);break;case"focusout":Uf=f2=Vh=null;break;case"mousedown":d2=!0;break;case"contextmenu":case"mouseup":case"dragend":d2=!1,s3(V,n,U);break;case"selectionchange":if(jB)break;case"keydown":case"keyup":s3(V,n,U)}var tt;if(ix)e:{switch(t){case"compositionstart":var lt="onCompositionStart";break e;case"compositionend":lt="onCompositionEnd";break e;case"compositionupdate":lt="onCompositionUpdate";break e}lt=void 0}else Uh?_P(t,n)&&(lt="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(lt="onCompositionStart");lt&&(mP&&n.locale!=="ko"&&(Uh||lt!=="onCompositionStart"?lt==="onCompositionEnd"&&Uh&&(tt=gP()):(Xu=U,ex="value"in Xu?Xu.value:Xu.textContent,Uh=!0)),qe=Zg(k,lt),0<qe.length&&(lt=new YE(lt,t,null,n,U),V.push({event:lt,listeners:qe}),tt?lt.data=tt:(tt=yP(n),tt!==null&&(lt.data=tt)))),(tt=IB?kB(t,n):LB(t,n))&&(k=Zg(k,"onBeforeInput"),0<k.length&&(U=new YE("onBeforeInput","beforeinput",null,n,U),V.push({event:U,listeners:k}),U.data=tt))}kP(V,e)})}function od(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zg(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,A=r.stateNode;r.tag===5&&A!==null&&(r=A,A=Jf(t,n),A!=null&&i.unshift(od(t,A,r)),A=Jf(t,e),A!=null&&i.push(od(t,A,r))),t=t.return}return i}function Th(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function A3(t,e,n,i,r){for(var A=e._reactName,d=[];n!==null&&n!==i;){var l=n,S=l.alternate,k=l.stateNode;if(S!==null&&S===i)break;l.tag===5&&k!==null&&(l=k,r?(S=Jf(n,A),S!=null&&d.unshift(od(n,S,l))):r||(S=Jf(n,A),S!=null&&d.push(od(n,S,l)))),n=n.return}d.length!==0&&t.push({event:e,listeners:d})}var WB=/\r\n?/g,$B=/\u0000|\uFFFD/g;function l3(t){return(typeof t=="string"?t:""+t).replace(WB,`
`).replace($B,"")}function Fp(t,e,n){if(e=l3(e),l3(t)!==e&&n)throw Error(Rt(425))}function qg(){}var p2=null,g2=null;function m2(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _2=typeof setTimeout=="function"?setTimeout:void 0,ZB=typeof clearTimeout=="function"?clearTimeout:void 0,u3=typeof Promise=="function"?Promise:void 0,qB=typeof queueMicrotask=="function"?queueMicrotask:typeof u3<"u"?function(t){return u3.resolve(null).then(t).catch(YB)}:_2;function YB(t){setTimeout(function(){throw t})}function z1(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),nd(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);nd(e)}function rc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function c3(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var R0=Math.random().toString(36).slice(2),ml="__reactFiber$"+R0,ad="__reactProps$"+R0,cu="__reactContainer$"+R0,y2="__reactEvents$"+R0,XB="__reactListeners$"+R0,KB="__reactHandles$"+R0;function Bc(t){var e=t[ml];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cu]||n[ml]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=c3(t);t!==null;){if(n=t[ml])return n;t=c3(t)}return e}t=n,n=t.parentNode}return null}function Fd(t){return t=t[ml]||t[cu],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Gh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Rt(33))}function Jm(t){return t[ad]||null}var v2=[],Qh=-1;function pc(t){return{current:t}}function Vi(t){0>Qh||(t.current=v2[Qh],v2[Qh]=null,Qh--)}function zi(t,e){Qh++,v2[Qh]=t.current,t.current=e}var fc={},no=pc(fc),jo=pc(!1),Gc=fc;function d0(t,e){var n=t.type.contextTypes;if(!n)return fc;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},A;for(A in n)r[A]=e[A];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Go(t){return t=t.childContextTypes,t!=null}function Yg(){Vi(jo),Vi(no)}function h3(t,e,n){if(no.current!==fc)throw Error(Rt(168));zi(no,e),zi(jo,n)}function DP(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Rt(108,OD(t)||"Unknown",r));return Ar({},n,i)}function Xg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fc,Gc=no.current,zi(no,t),zi(jo,jo.current),!0}function f3(t,e,n){var i=t.stateNode;if(!i)throw Error(Rt(169));n?(t=DP(t,e,Gc),i.__reactInternalMemoizedMergedChildContext=t,Vi(jo),Vi(no),zi(no,t)):Vi(jo),zi(jo,n)}var eu=null,e_=!1,F1=!1;function BP(t){eu===null?eu=[t]:eu.push(t)}function JB(t){e_=!0,BP(t)}function gc(){if(!F1&&eu!==null){F1=!0;var t=0,e=mi;try{var n=eu;for(mi=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}eu=null,e_=!1}catch(r){throw eu!==null&&(eu=eu.slice(t+1)),sP(Yv,gc),r}finally{mi=e,F1=!1}}return null}var Hh=[],Wh=0,Kg=null,Jg=0,Ja=[],eA=0,Qc=null,iu=1,ru="";function kc(t,e){Hh[Wh++]=Jg,Hh[Wh++]=Kg,Kg=t,Jg=e}function RP(t,e,n){Ja[eA++]=iu,Ja[eA++]=ru,Ja[eA++]=Qc,Qc=t;var i=iu;t=ru;var r=32-HA(i)-1;i&=~(1<<r),n+=1;var A=32-HA(e)+r;if(30<A){var d=r-r%5;A=(i&(1<<d)-1).toString(32),i>>=d,r-=d,iu=1<<32-HA(e)+r|n<<r|i,ru=A+t}else iu=1<<A|n<<r|i,ru=t}function sx(t){t.return!==null&&(kc(t,1),RP(t,1,0))}function ox(t){for(;t===Kg;)Kg=Hh[--Wh],Hh[Wh]=null,Jg=Hh[--Wh],Hh[Wh]=null;for(;t===Qc;)Qc=Ja[--eA],Ja[eA]=null,ru=Ja[--eA],Ja[eA]=null,iu=Ja[--eA],Ja[eA]=null}var ka=null,Ma=null,Zi=!1,UA=null;function OP(t,e){var n=tA(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function d3(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ka=t,Ma=rc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ka=t,Ma=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Qc!==null?{id:iu,overflow:ru}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=tA(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ka=t,Ma=null,!0):!1;default:return!1}}function x2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function w2(t){if(Zi){var e=Ma;if(e){var n=e;if(!d3(t,e)){if(x2(t))throw Error(Rt(418));e=rc(n.nextSibling);var i=ka;e&&d3(t,e)?OP(i,n):(t.flags=t.flags&-4097|2,Zi=!1,ka=t)}}else{if(x2(t))throw Error(Rt(418));t.flags=t.flags&-4097|2,Zi=!1,ka=t}}}function p3(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ka=t}function Np(t){if(t!==ka)return!1;if(!Zi)return p3(t),Zi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!m2(t.type,t.memoizedProps)),e&&(e=Ma)){if(x2(t))throw zP(),Error(Rt(418));for(;e;)OP(t,e),e=rc(e.nextSibling)}if(p3(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Rt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ma=rc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ma=null}}else Ma=ka?rc(t.stateNode.nextSibling):null;return!0}function zP(){for(var t=Ma;t;)t=rc(t.nextSibling)}function p0(){Ma=ka=null,Zi=!1}function ax(t){UA===null?UA=[t]:UA.push(t)}var eR=xu.ReactCurrentBatchConfig;function FA(t,e){if(t&&t.defaultProps){e=Ar({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var em=pc(null),tm=null,$h=null,Ax=null;function lx(){Ax=$h=tm=null}function ux(t){var e=em.current;Vi(em),t._currentValue=e}function b2(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function a0(t,e){tm=t,Ax=$h=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Uo=!0),t.firstContext=null)}function sA(t){var e=t._currentValue;if(Ax!==t)if(t={context:t,memoizedValue:e,next:null},$h===null){if(tm===null)throw Error(Rt(308));$h=t,tm.dependencies={lanes:0,firstContext:t}}else $h=$h.next=t;return e}var Rc=null;function cx(t){Rc===null?Rc=[t]:Rc.push(t)}function FP(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,cx(e)):(n.next=r.next,r.next=n),e.interleaved=n,hu(t,i)}function hu(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $u=!1;function hx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function NP(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function su(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function sc(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Ai&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,hu(t,n)}return r=i.interleaved,r===null?(e.next=e,cx(i)):(e.next=r.next,r.next=e),i.interleaved=e,hu(t,n)}function vg(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Xv(t,n)}}function g3(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,A=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};A===null?r=A=d:A=A.next=d,n=n.next}while(n!==null);A===null?r=A=e:A=A.next=e}else r=A=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:A,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function nm(t,e,n,i){var r=t.updateQueue;$u=!1;var A=r.firstBaseUpdate,d=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var S=l,k=S.next;S.next=null,d===null?A=k:d.next=k,d=S;var U=t.alternate;U!==null&&(U=U.updateQueue,l=U.lastBaseUpdate,l!==d&&(l===null?U.firstBaseUpdate=k:l.next=k,U.lastBaseUpdate=S))}if(A!==null){var V=r.baseState;d=0,U=k=S=null,l=A;do{var $=l.lane,X=l.eventTime;if((i&$)===$){U!==null&&(U=U.next={eventTime:X,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var ee=t,ue=l;switch($=e,X=n,ue.tag){case 1:if(ee=ue.payload,typeof ee=="function"){V=ee.call(X,V,$);break e}V=ee;break e;case 3:ee.flags=ee.flags&-65537|128;case 0:if(ee=ue.payload,$=typeof ee=="function"?ee.call(X,V,$):ee,$==null)break e;V=Ar({},V,$);break e;case 2:$u=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,$=r.effects,$===null?r.effects=[l]:$.push(l))}else X={eventTime:X,lane:$,tag:l.tag,payload:l.payload,callback:l.callback,next:null},U===null?(k=U=X,S=V):U=U.next=X,d|=$;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;$=l,l=$.next,$.next=null,r.lastBaseUpdate=$,r.shared.pending=null}}while(1);if(U===null&&(S=V),r.baseState=S,r.firstBaseUpdate=k,r.lastBaseUpdate=U,e=r.shared.interleaved,e!==null){r=e;do d|=r.lane,r=r.next;while(r!==e)}else A===null&&(r.shared.lanes=0);Wc|=d,t.lanes=d,t.memoizedState=V}}function m3(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(Rt(191,r));r.call(i)}}}var UP=new FC.Component().refs;function E2(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Ar({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var t_={isMounted:function(t){return(t=t._reactInternals)?nh(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=vo(),r=ac(t),A=su(i,r);A.payload=e,n!=null&&(A.callback=n),e=sc(t,A,r),e!==null&&(WA(e,t,r,i),vg(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=vo(),r=ac(t),A=su(i,r);A.tag=1,A.payload=e,n!=null&&(A.callback=n),e=sc(t,A,r),e!==null&&(WA(e,t,r,i),vg(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vo(),i=ac(t),r=su(n,i);r.tag=2,e!=null&&(r.callback=e),e=sc(t,r,i),e!==null&&(WA(e,t,i,n),vg(e,t,i))}};function _3(t,e,n,i,r,A,d){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,A,d):e.prototype&&e.prototype.isPureReactComponent?!rd(n,i)||!rd(r,A):!0}function VP(t,e,n){var i=!1,r=fc,A=e.contextType;return typeof A=="object"&&A!==null?A=sA(A):(r=Go(e)?Gc:no.current,i=e.contextTypes,A=(i=i!=null)?d0(t,r):fc),e=new e(n,A),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=t_,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=A),e}function y3(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&t_.enqueueReplaceState(e,e.state,null)}function T2(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=UP,hx(t);var A=e.contextType;typeof A=="object"&&A!==null?r.context=sA(A):(A=Go(e)?Gc:no.current,r.context=d0(t,A)),r.state=t.memoizedState,A=e.getDerivedStateFromProps,typeof A=="function"&&(E2(t,e,A,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&t_.enqueueReplaceState(r,r.state,null),nm(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function hf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Rt(309));var i=n.stateNode}if(!i)throw Error(Rt(147,t));var r=i,A=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===A?e.ref:(e=function(d){var l=r.refs;l===UP&&(l=r.refs={}),d===null?delete l[A]:l[A]=d},e._stringRef=A,e)}if(typeof t!="string")throw Error(Rt(284));if(!n._owner)throw Error(Rt(290,t))}return t}function Up(t,e){throw t=Object.prototype.toString.call(e),Error(Rt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function v3(t){var e=t._init;return e(t._payload)}function jP(t){function e(ie,Ae){if(t){var ce=ie.deletions;ce===null?(ie.deletions=[Ae],ie.flags|=16):ce.push(Ae)}}function n(ie,Ae){if(!t)return null;for(;Ae!==null;)e(ie,Ae),Ae=Ae.sibling;return null}function i(ie,Ae){for(ie=new Map;Ae!==null;)Ae.key!==null?ie.set(Ae.key,Ae):ie.set(Ae.index,Ae),Ae=Ae.sibling;return ie}function r(ie,Ae){return ie=Ac(ie,Ae),ie.index=0,ie.sibling=null,ie}function A(ie,Ae,ce){return ie.index=ce,t?(ce=ie.alternate,ce!==null?(ce=ce.index,ce<Ae?(ie.flags|=2,Ae):ce):(ie.flags|=2,Ae)):(ie.flags|=1048576,Ae)}function d(ie){return t&&ie.alternate===null&&(ie.flags|=2),ie}function l(ie,Ae,ce,Ce){return Ae===null||Ae.tag!==6?(Ae=H1(ce,ie.mode,Ce),Ae.return=ie,Ae):(Ae=r(Ae,ce),Ae.return=ie,Ae)}function S(ie,Ae,ce,Ce){var Ne=ce.type;return Ne===Nh?U(ie,Ae,ce.props.children,Ce,ce.key):Ae!==null&&(Ae.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Wu&&v3(Ne)===Ae.type)?(Ce=r(Ae,ce.props),Ce.ref=hf(ie,Ae,ce),Ce.return=ie,Ce):(Ce=Sg(ce.type,ce.key,ce.props,null,ie.mode,Ce),Ce.ref=hf(ie,Ae,ce),Ce.return=ie,Ce)}function k(ie,Ae,ce,Ce){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==ce.containerInfo||Ae.stateNode.implementation!==ce.implementation?(Ae=W1(ce,ie.mode,Ce),Ae.return=ie,Ae):(Ae=r(Ae,ce.children||[]),Ae.return=ie,Ae)}function U(ie,Ae,ce,Ce,Ne){return Ae===null||Ae.tag!==7?(Ae=Uc(ce,ie.mode,Ce,Ne),Ae.return=ie,Ae):(Ae=r(Ae,ce),Ae.return=ie,Ae)}function V(ie,Ae,ce){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return Ae=H1(""+Ae,ie.mode,ce),Ae.return=ie,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case Mp:return ce=Sg(Ae.type,Ae.key,Ae.props,null,ie.mode,ce),ce.ref=hf(ie,null,Ae),ce.return=ie,ce;case Fh:return Ae=W1(Ae,ie.mode,ce),Ae.return=ie,Ae;case Wu:var Ce=Ae._init;return V(ie,Ce(Ae._payload),ce)}if(Mf(Ae)||af(Ae))return Ae=Uc(Ae,ie.mode,ce,null),Ae.return=ie,Ae;Up(ie,Ae)}return null}function $(ie,Ae,ce,Ce){var Ne=Ae!==null?Ae.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number")return Ne!==null?null:l(ie,Ae,""+ce,Ce);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Mp:return ce.key===Ne?S(ie,Ae,ce,Ce):null;case Fh:return ce.key===Ne?k(ie,Ae,ce,Ce):null;case Wu:return Ne=ce._init,$(ie,Ae,Ne(ce._payload),Ce)}if(Mf(ce)||af(ce))return Ne!==null?null:U(ie,Ae,ce,Ce,null);Up(ie,ce)}return null}function X(ie,Ae,ce,Ce,Ne){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return ie=ie.get(ce)||null,l(Ae,ie,""+Ce,Ne);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case Mp:return ie=ie.get(Ce.key===null?ce:Ce.key)||null,S(Ae,ie,Ce,Ne);case Fh:return ie=ie.get(Ce.key===null?ce:Ce.key)||null,k(Ae,ie,Ce,Ne);case Wu:var qe=Ce._init;return X(ie,Ae,ce,qe(Ce._payload),Ne)}if(Mf(Ce)||af(Ce))return ie=ie.get(ce)||null,U(Ae,ie,Ce,Ne,null);Up(Ae,Ce)}return null}function ee(ie,Ae,ce,Ce){for(var Ne=null,qe=null,tt=Ae,lt=Ae=0,at=null;tt!==null&&lt<ce.length;lt++){tt.index>lt?(at=tt,tt=null):at=tt.sibling;var ht=$(ie,tt,ce[lt],Ce);if(ht===null){tt===null&&(tt=at);break}t&&tt&&ht.alternate===null&&e(ie,tt),Ae=A(ht,Ae,lt),qe===null?Ne=ht:qe.sibling=ht,qe=ht,tt=at}if(lt===ce.length)return n(ie,tt),Zi&&kc(ie,lt),Ne;if(tt===null){for(;lt<ce.length;lt++)tt=V(ie,ce[lt],Ce),tt!==null&&(Ae=A(tt,Ae,lt),qe===null?Ne=tt:qe.sibling=tt,qe=tt);return Zi&&kc(ie,lt),Ne}for(tt=i(ie,tt);lt<ce.length;lt++)at=X(tt,ie,lt,ce[lt],Ce),at!==null&&(t&&at.alternate!==null&&tt.delete(at.key===null?lt:at.key),Ae=A(at,Ae,lt),qe===null?Ne=at:qe.sibling=at,qe=at);return t&&tt.forEach(function(Et){return e(ie,Et)}),Zi&&kc(ie,lt),Ne}function ue(ie,Ae,ce,Ce){var Ne=af(ce);if(typeof Ne!="function")throw Error(Rt(150));if(ce=Ne.call(ce),ce==null)throw Error(Rt(151));for(var qe=Ne=null,tt=Ae,lt=Ae=0,at=null,ht=ce.next();tt!==null&&!ht.done;lt++,ht=ce.next()){tt.index>lt?(at=tt,tt=null):at=tt.sibling;var Et=$(ie,tt,ht.value,Ce);if(Et===null){tt===null&&(tt=at);break}t&&tt&&Et.alternate===null&&e(ie,tt),Ae=A(Et,Ae,lt),qe===null?Ne=Et:qe.sibling=Et,qe=Et,tt=at}if(ht.done)return n(ie,tt),Zi&&kc(ie,lt),Ne;if(tt===null){for(;!ht.done;lt++,ht=ce.next())ht=V(ie,ht.value,Ce),ht!==null&&(Ae=A(ht,Ae,lt),qe===null?Ne=ht:qe.sibling=ht,qe=ht);return Zi&&kc(ie,lt),Ne}for(tt=i(ie,tt);!ht.done;lt++,ht=ce.next())ht=X(tt,ie,lt,ht.value,Ce),ht!==null&&(t&&ht.alternate!==null&&tt.delete(ht.key===null?lt:ht.key),Ae=A(ht,Ae,lt),qe===null?Ne=ht:qe.sibling=ht,qe=ht);return t&&tt.forEach(function(St){return e(ie,St)}),Zi&&kc(ie,lt),Ne}function we(ie,Ae,ce,Ce){if(typeof ce=="object"&&ce!==null&&ce.type===Nh&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Mp:e:{for(var Ne=ce.key,qe=Ae;qe!==null;){if(qe.key===Ne){if(Ne=ce.type,Ne===Nh){if(qe.tag===7){n(ie,qe.sibling),Ae=r(qe,ce.props.children),Ae.return=ie,ie=Ae;break e}}else if(qe.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Wu&&v3(Ne)===qe.type){n(ie,qe.sibling),Ae=r(qe,ce.props),Ae.ref=hf(ie,qe,ce),Ae.return=ie,ie=Ae;break e}n(ie,qe);break}else e(ie,qe);qe=qe.sibling}ce.type===Nh?(Ae=Uc(ce.props.children,ie.mode,Ce,ce.key),Ae.return=ie,ie=Ae):(Ce=Sg(ce.type,ce.key,ce.props,null,ie.mode,Ce),Ce.ref=hf(ie,Ae,ce),Ce.return=ie,ie=Ce)}return d(ie);case Fh:e:{for(qe=ce.key;Ae!==null;){if(Ae.key===qe)if(Ae.tag===4&&Ae.stateNode.containerInfo===ce.containerInfo&&Ae.stateNode.implementation===ce.implementation){n(ie,Ae.sibling),Ae=r(Ae,ce.children||[]),Ae.return=ie,ie=Ae;break e}else{n(ie,Ae);break}else e(ie,Ae);Ae=Ae.sibling}Ae=W1(ce,ie.mode,Ce),Ae.return=ie,ie=Ae}return d(ie);case Wu:return qe=ce._init,we(ie,Ae,qe(ce._payload),Ce)}if(Mf(ce))return ee(ie,Ae,ce,Ce);if(af(ce))return ue(ie,Ae,ce,Ce);Up(ie,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"?(ce=""+ce,Ae!==null&&Ae.tag===6?(n(ie,Ae.sibling),Ae=r(Ae,ce),Ae.return=ie,ie=Ae):(n(ie,Ae),Ae=H1(ce,ie.mode,Ce),Ae.return=ie,ie=Ae),d(ie)):n(ie,Ae)}return we}var g0=jP(!0),GP=jP(!1),Nd={},bl=pc(Nd),Ad=pc(Nd),ld=pc(Nd);function Oc(t){if(t===Nd)throw Error(Rt(174));return t}function fx(t,e){switch(zi(ld,e),zi(Ad,t),zi(bl,Nd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:i2(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=i2(e,t)}Vi(bl),zi(bl,e)}function m0(){Vi(bl),Vi(Ad),Vi(ld)}function QP(t){Oc(ld.current);var e=Oc(bl.current),n=i2(e,t.type);e!==n&&(zi(Ad,t),zi(bl,n))}function dx(t){Ad.current===t&&(Vi(bl),Vi(Ad))}var sr=pc(0);function im(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var N1=[];function px(){for(var t=0;t<N1.length;t++)N1[t]._workInProgressVersionPrimary=null;N1.length=0}var xg=xu.ReactCurrentDispatcher,U1=xu.ReactCurrentBatchConfig,Hc=0,ar=null,ts=null,bs=null,rm=!1,Vf=!1,ud=0,tR=0;function qs(){throw Error(Rt(321))}function gx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ZA(t[n],e[n]))return!1;return!0}function mx(t,e,n,i,r,A){if(Hc=A,ar=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xg.current=t===null||t.memoizedState===null?sR:oR,t=n(i,r),Vf){A=0;do{if(Vf=!1,ud=0,25<=A)throw Error(Rt(301));A+=1,bs=ts=null,e.updateQueue=null,xg.current=aR,t=n(i,r)}while(Vf)}if(xg.current=sm,e=ts!==null&&ts.next!==null,Hc=0,bs=ts=ar=null,rm=!1,e)throw Error(Rt(300));return t}function _x(){var t=ud!==0;return ud=0,t}function gl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bs===null?ar.memoizedState=bs=t:bs=bs.next=t,bs}function oA(){if(ts===null){var t=ar.alternate;t=t!==null?t.memoizedState:null}else t=ts.next;var e=bs===null?ar.memoizedState:bs.next;if(e!==null)bs=e,ts=t;else{if(t===null)throw Error(Rt(310));ts=t,t={memoizedState:ts.memoizedState,baseState:ts.baseState,baseQueue:ts.baseQueue,queue:ts.queue,next:null},bs===null?ar.memoizedState=bs=t:bs=bs.next=t}return bs}function cd(t,e){return typeof e=="function"?e(t):e}function V1(t){var e=oA(),n=e.queue;if(n===null)throw Error(Rt(311));n.lastRenderedReducer=t;var i=ts,r=i.baseQueue,A=n.pending;if(A!==null){if(r!==null){var d=r.next;r.next=A.next,A.next=d}i.baseQueue=r=A,n.pending=null}if(r!==null){A=r.next,i=i.baseState;var l=d=null,S=null,k=A;do{var U=k.lane;if((Hc&U)===U)S!==null&&(S=S.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),i=k.hasEagerState?k.eagerState:t(i,k.action);else{var V={lane:U,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};S===null?(l=S=V,d=i):S=S.next=V,ar.lanes|=U,Wc|=U}k=k.next}while(k!==null&&k!==A);S===null?d=i:S.next=l,ZA(i,e.memoizedState)||(Uo=!0),e.memoizedState=i,e.baseState=d,e.baseQueue=S,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do A=r.lane,ar.lanes|=A,Wc|=A,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function j1(t){var e=oA(),n=e.queue;if(n===null)throw Error(Rt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,A=e.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do A=t(A,d.action),d=d.next;while(d!==r);ZA(A,e.memoizedState)||(Uo=!0),e.memoizedState=A,e.baseQueue===null&&(e.baseState=A),n.lastRenderedState=A}return[A,i]}function HP(){}function WP(t,e){var n=ar,i=oA(),r=e(),A=!ZA(i.memoizedState,r);if(A&&(i.memoizedState=r,Uo=!0),i=i.queue,yx(qP.bind(null,n,i,t),[t]),i.getSnapshot!==e||A||bs!==null&&bs.memoizedState.tag&1){if(n.flags|=2048,hd(9,ZP.bind(null,n,i,r,e),void 0,null),Ts===null)throw Error(Rt(349));Hc&30||$P(n,e,r)}return r}function $P(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ar.updateQueue,e===null?(e={lastEffect:null,stores:null},ar.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ZP(t,e,n,i){e.value=n,e.getSnapshot=i,YP(e)&&XP(t)}function qP(t,e,n){return n(function(){YP(e)&&XP(t)})}function YP(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ZA(t,n)}catch{return!0}}function XP(t){var e=hu(t,1);e!==null&&WA(e,t,1,-1)}function x3(t){var e=gl();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cd,lastRenderedState:t},e.queue=t,t=t.dispatch=rR.bind(null,ar,t),[e.memoizedState,t]}function hd(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=ar.updateQueue,e===null?(e={lastEffect:null,stores:null},ar.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function KP(){return oA().memoizedState}function wg(t,e,n,i){var r=gl();ar.flags|=t,r.memoizedState=hd(1|e,n,void 0,i===void 0?null:i)}function n_(t,e,n,i){var r=oA();i=i===void 0?null:i;var A=void 0;if(ts!==null){var d=ts.memoizedState;if(A=d.destroy,i!==null&&gx(i,d.deps)){r.memoizedState=hd(e,n,A,i);return}}ar.flags|=t,r.memoizedState=hd(1|e,n,A,i)}function w3(t,e){return wg(8390656,8,t,e)}function yx(t,e){return n_(2048,8,t,e)}function JP(t,e){return n_(4,2,t,e)}function eM(t,e){return n_(4,4,t,e)}function tM(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function nM(t,e,n){return n=n!=null?n.concat([t]):null,n_(4,4,tM.bind(null,e,t),n)}function vx(){}function iM(t,e){var n=oA();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&gx(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function rM(t,e){var n=oA();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&gx(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function sM(t,e,n){return Hc&21?(ZA(n,e)||(n=AP(),ar.lanes|=n,Wc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Uo=!0),t.memoizedState=n)}function nR(t,e){var n=mi;mi=n!==0&&4>n?n:4,t(!0);var i=U1.transition;U1.transition={};try{t(!1),e()}finally{mi=n,U1.transition=i}}function oM(){return oA().memoizedState}function iR(t,e,n){var i=ac(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},aM(t))AM(e,n);else if(n=FP(t,e,n,i),n!==null){var r=vo();WA(n,t,i,r),lM(n,e,i)}}function rR(t,e,n){var i=ac(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(aM(t))AM(e,r);else{var A=t.alternate;if(t.lanes===0&&(A===null||A.lanes===0)&&(A=e.lastRenderedReducer,A!==null))try{var d=e.lastRenderedState,l=A(d,n);if(r.hasEagerState=!0,r.eagerState=l,ZA(l,d)){var S=e.interleaved;S===null?(r.next=r,cx(e)):(r.next=S.next,S.next=r),e.interleaved=r;return}}catch{}finally{}n=FP(t,e,r,i),n!==null&&(r=vo(),WA(n,t,i,r),lM(n,e,i))}}function aM(t){var e=t.alternate;return t===ar||e!==null&&e===ar}function AM(t,e){Vf=rm=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function lM(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Xv(t,n)}}var sm={readContext:sA,useCallback:qs,useContext:qs,useEffect:qs,useImperativeHandle:qs,useInsertionEffect:qs,useLayoutEffect:qs,useMemo:qs,useReducer:qs,useRef:qs,useState:qs,useDebugValue:qs,useDeferredValue:qs,useTransition:qs,useMutableSource:qs,useSyncExternalStore:qs,useId:qs,unstable_isNewReconciler:!1},sR={readContext:sA,useCallback:function(t,e){return gl().memoizedState=[t,e===void 0?null:e],t},useContext:sA,useEffect:w3,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wg(4194308,4,tM.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wg(4194308,4,t,e)},useInsertionEffect:function(t,e){return wg(4,2,t,e)},useMemo:function(t,e){var n=gl();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=gl();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=iR.bind(null,ar,t),[i.memoizedState,t]},useRef:function(t){var e=gl();return t={current:t},e.memoizedState=t},useState:x3,useDebugValue:vx,useDeferredValue:function(t){return gl().memoizedState=t},useTransition:function(){var t=x3(!1),e=t[0];return t=nR.bind(null,t[1]),gl().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=ar,r=gl();if(Zi){if(n===void 0)throw Error(Rt(407));n=n()}else{if(n=e(),Ts===null)throw Error(Rt(349));Hc&30||$P(i,e,n)}r.memoizedState=n;var A={value:n,getSnapshot:e};return r.queue=A,w3(qP.bind(null,i,A,t),[t]),i.flags|=2048,hd(9,ZP.bind(null,i,A,n,e),void 0,null),n},useId:function(){var t=gl(),e=Ts.identifierPrefix;if(Zi){var n=ru,i=iu;n=(i&~(1<<32-HA(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=ud++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},oR={readContext:sA,useCallback:iM,useContext:sA,useEffect:yx,useImperativeHandle:nM,useInsertionEffect:JP,useLayoutEffect:eM,useMemo:rM,useReducer:V1,useRef:KP,useState:function(){return V1(cd)},useDebugValue:vx,useDeferredValue:function(t){var e=oA();return sM(e,ts.memoizedState,t)},useTransition:function(){var t=V1(cd)[0],e=oA().memoizedState;return[t,e]},useMutableSource:HP,useSyncExternalStore:WP,useId:oM,unstable_isNewReconciler:!1},aR={readContext:sA,useCallback:iM,useContext:sA,useEffect:yx,useImperativeHandle:nM,useInsertionEffect:JP,useLayoutEffect:eM,useMemo:rM,useReducer:j1,useRef:KP,useState:function(){return j1(cd)},useDebugValue:vx,useDeferredValue:function(t){var e=oA();return ts===null?e.memoizedState=t:sM(e,ts.memoizedState,t)},useTransition:function(){var t=j1(cd)[0],e=oA().memoizedState;return[t,e]},useMutableSource:HP,useSyncExternalStore:WP,useId:oM,unstable_isNewReconciler:!1};function _0(t,e){try{var n="",i=e;do n+=RD(i),i=i.return;while(i);var r=n}catch(A){r=`
Error generating stack: `+A.message+`
`+A.stack}return{value:t,source:e,stack:r,digest:null}}function G1(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function S2(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var AR=typeof WeakMap=="function"?WeakMap:Map;function uM(t,e,n){n=su(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){am||(am=!0,O2=i),S2(t,e)},n}function cM(t,e,n){n=su(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){S2(t,e)}}var A=t.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(n.callback=function(){S2(t,e),typeof i!="function"&&(oc===null?oc=new Set([this]):oc.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),n}function b3(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new AR;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=wR.bind(null,t,e,n),e.then(t,t))}function E3(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function T3(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=su(-1,1),e.tag=2,sc(n,e,1))),n.lanes|=1),t)}var lR=xu.ReactCurrentOwner,Uo=!1;function _o(t,e,n,i){e.child=t===null?GP(e,null,n,i):g0(e,t.child,n,i)}function S3(t,e,n,i,r){n=n.render;var A=e.ref;return a0(e,r),i=mx(t,e,n,i,A,r),n=_x(),t!==null&&!Uo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,fu(t,e,r)):(Zi&&n&&sx(e),e.flags|=1,_o(t,e,i,r),e.child)}function C3(t,e,n,i,r){if(t===null){var A=n.type;return typeof A=="function"&&!Px(A)&&A.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=A,hM(t,e,A,i,r)):(t=Sg(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(A=t.child,!(t.lanes&r)){var d=A.memoizedProps;if(n=n.compare,n=n!==null?n:rd,n(d,i)&&t.ref===e.ref)return fu(t,e,r)}return e.flags|=1,t=Ac(A,i),t.ref=e.ref,t.return=e,e.child=t}function hM(t,e,n,i,r){if(t!==null){var A=t.memoizedProps;if(rd(A,i)&&t.ref===e.ref)if(Uo=!1,e.pendingProps=i=A,(t.lanes&r)!==0)t.flags&131072&&(Uo=!0);else return e.lanes=t.lanes,fu(t,e,r)}return C2(t,e,n,i,r)}function fM(t,e,n){var i=e.pendingProps,r=i.children,A=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},zi(qh,Ta),Ta|=n;else{if(!(n&1073741824))return t=A!==null?A.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,zi(qh,Ta),Ta|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=A!==null?A.baseLanes:n,zi(qh,Ta),Ta|=i}else A!==null?(i=A.baseLanes|n,e.memoizedState=null):i=n,zi(qh,Ta),Ta|=i;return _o(t,e,r,n),e.child}function dM(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function C2(t,e,n,i,r){var A=Go(n)?Gc:no.current;return A=d0(e,A),a0(e,r),n=mx(t,e,n,i,A,r),i=_x(),t!==null&&!Uo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,fu(t,e,r)):(Zi&&i&&sx(e),e.flags|=1,_o(t,e,n,r),e.child)}function P3(t,e,n,i,r){if(Go(n)){var A=!0;Xg(e)}else A=!1;if(a0(e,r),e.stateNode===null)bg(t,e),VP(e,n,i),T2(e,n,i,r),i=!0;else if(t===null){var d=e.stateNode,l=e.memoizedProps;d.props=l;var S=d.context,k=n.contextType;typeof k=="object"&&k!==null?k=sA(k):(k=Go(n)?Gc:no.current,k=d0(e,k));var U=n.getDerivedStateFromProps,V=typeof U=="function"||typeof d.getSnapshotBeforeUpdate=="function";V||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(l!==i||S!==k)&&y3(e,d,i,k),$u=!1;var $=e.memoizedState;d.state=$,nm(e,i,d,r),S=e.memoizedState,l!==i||$!==S||jo.current||$u?(typeof U=="function"&&(E2(e,n,U,i),S=e.memoizedState),(l=$u||_3(e,n,l,i,$,S,k))?(V||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=S),d.props=i,d.state=S,d.context=k,i=l):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{d=e.stateNode,NP(t,e),l=e.memoizedProps,k=e.type===e.elementType?l:FA(e.type,l),d.props=k,V=e.pendingProps,$=d.context,S=n.contextType,typeof S=="object"&&S!==null?S=sA(S):(S=Go(n)?Gc:no.current,S=d0(e,S));var X=n.getDerivedStateFromProps;(U=typeof X=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(l!==V||$!==S)&&y3(e,d,i,S),$u=!1,$=e.memoizedState,d.state=$,nm(e,i,d,r);var ee=e.memoizedState;l!==V||$!==ee||jo.current||$u?(typeof X=="function"&&(E2(e,n,X,i),ee=e.memoizedState),(k=$u||_3(e,n,k,i,$,ee,S)||!1)?(U||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(i,ee,S),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(i,ee,S)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||l===t.memoizedProps&&$===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&$===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=ee),d.props=i,d.state=ee,d.context=S,i=k):(typeof d.componentDidUpdate!="function"||l===t.memoizedProps&&$===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&$===t.memoizedState||(e.flags|=1024),i=!1)}return P2(t,e,n,i,A,r)}function P2(t,e,n,i,r,A){dM(t,e);var d=(e.flags&128)!==0;if(!i&&!d)return r&&f3(e,n,!1),fu(t,e,A);i=e.stateNode,lR.current=e;var l=d&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&d?(e.child=g0(e,t.child,null,A),e.child=g0(e,null,l,A)):_o(t,e,l,A),e.memoizedState=i.state,r&&f3(e,n,!0),e.child}function pM(t){var e=t.stateNode;e.pendingContext?h3(t,e.pendingContext,e.pendingContext!==e.context):e.context&&h3(t,e.context,!1),fx(t,e.containerInfo)}function M3(t,e,n,i,r){return p0(),ax(r),e.flags|=256,_o(t,e,n,i),e.child}var M2={dehydrated:null,treeContext:null,retryLane:0};function I2(t){return{baseLanes:t,cachePool:null,transitions:null}}function gM(t,e,n){var i=e.pendingProps,r=sr.current,A=!1,d=(e.flags&128)!==0,l;if((l=d)||(l=t!==null&&t.memoizedState===null?!1:(r&2)!==0),l?(A=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),zi(sr,r&1),t===null)return w2(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=i.children,t=i.fallback,A?(i=e.mode,A=e.child,d={mode:"hidden",children:d},!(i&1)&&A!==null?(A.childLanes=0,A.pendingProps=d):A=s_(d,i,0,null),t=Uc(t,i,n,null),A.return=e,t.return=e,A.sibling=t,e.child=A,e.child.memoizedState=I2(n),e.memoizedState=M2,t):xx(e,d));if(r=t.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return uR(t,e,d,i,l,r,n);if(A){A=i.fallback,d=e.mode,r=t.child,l=r.sibling;var S={mode:"hidden",children:i.children};return!(d&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=S,e.deletions=null):(i=Ac(r,S),i.subtreeFlags=r.subtreeFlags&14680064),l!==null?A=Ac(l,A):(A=Uc(A,d,n,null),A.flags|=2),A.return=e,i.return=e,i.sibling=A,e.child=i,i=A,A=e.child,d=t.child.memoizedState,d=d===null?I2(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},A.memoizedState=d,A.childLanes=t.childLanes&~n,e.memoizedState=M2,i}return A=t.child,t=A.sibling,i=Ac(A,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function xx(t,e){return e=s_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Vp(t,e,n,i){return i!==null&&ax(i),g0(e,t.child,null,n),t=xx(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function uR(t,e,n,i,r,A,d){if(n)return e.flags&256?(e.flags&=-257,i=G1(Error(Rt(422))),Vp(t,e,d,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(A=i.fallback,r=e.mode,i=s_({mode:"visible",children:i.children},r,0,null),A=Uc(A,r,d,null),A.flags|=2,i.return=e,A.return=e,i.sibling=A,e.child=i,e.mode&1&&g0(e,t.child,null,d),e.child.memoizedState=I2(d),e.memoizedState=M2,A);if(!(e.mode&1))return Vp(t,e,d,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var l=i.dgst;return i=l,A=Error(Rt(419)),i=G1(A,i,void 0),Vp(t,e,d,i)}if(l=(d&t.childLanes)!==0,Uo||l){if(i=Ts,i!==null){switch(d&-d){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|d)?0:r,r!==0&&r!==A.retryLane&&(A.retryLane=r,hu(t,r),WA(i,t,r,-1))}return Cx(),i=G1(Error(Rt(421))),Vp(t,e,d,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=bR.bind(null,t),r._reactRetry=e,null):(t=A.treeContext,Ma=rc(r.nextSibling),ka=e,Zi=!0,UA=null,t!==null&&(Ja[eA++]=iu,Ja[eA++]=ru,Ja[eA++]=Qc,iu=t.id,ru=t.overflow,Qc=e),e=xx(e,i.children),e.flags|=4096,e)}function I3(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),b2(t.return,e,n)}function Q1(t,e,n,i,r){var A=t.memoizedState;A===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(A.isBackwards=e,A.rendering=null,A.renderingStartTime=0,A.last=i,A.tail=n,A.tailMode=r)}function mM(t,e,n){var i=e.pendingProps,r=i.revealOrder,A=i.tail;if(_o(t,e,i.children,n),i=sr.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&I3(t,n,e);else if(t.tag===19)I3(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(zi(sr,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&im(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Q1(e,!1,r,n,A);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&im(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Q1(e,!0,n,null,A);break;case"together":Q1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fu(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Wc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Rt(153));if(e.child!==null){for(t=e.child,n=Ac(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ac(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function cR(t,e,n){switch(e.tag){case 3:pM(e),p0();break;case 5:QP(e);break;case 1:Go(e.type)&&Xg(e);break;case 4:fx(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;zi(em,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(zi(sr,sr.current&1),e.flags|=128,null):n&e.child.childLanes?gM(t,e,n):(zi(sr,sr.current&1),t=fu(t,e,n),t!==null?t.sibling:null);zi(sr,sr.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return mM(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),zi(sr,sr.current),i)break;return null;case 22:case 23:return e.lanes=0,fM(t,e,n)}return fu(t,e,n)}var _M,k2,yM,vM;_M=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};k2=function(){};yM=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Oc(bl.current);var A=null;switch(n){case"input":r=Jy(t,r),i=Jy(t,i),A=[];break;case"select":r=Ar({},r,{value:void 0}),i=Ar({},i,{value:void 0}),A=[];break;case"textarea":r=n2(t,r),i=n2(t,i),A=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=qg)}r2(n,i);var d;n=null;for(k in r)if(!i.hasOwnProperty(k)&&r.hasOwnProperty(k)&&r[k]!=null)if(k==="style"){var l=r[k];for(d in l)l.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(Xf.hasOwnProperty(k)?A||(A=[]):(A=A||[]).push(k,null));for(k in i){var S=i[k];if(l=r!=null?r[k]:void 0,i.hasOwnProperty(k)&&S!==l&&(S!=null||l!=null))if(k==="style")if(l){for(d in l)!l.hasOwnProperty(d)||S&&S.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in S)S.hasOwnProperty(d)&&l[d]!==S[d]&&(n||(n={}),n[d]=S[d])}else n||(A||(A=[]),A.push(k,n)),n=S;else k==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,l=l?l.__html:void 0,S!=null&&l!==S&&(A=A||[]).push(k,S)):k==="children"?typeof S!="string"&&typeof S!="number"||(A=A||[]).push(k,""+S):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(Xf.hasOwnProperty(k)?(S!=null&&k==="onScroll"&&Ui("scroll",t),A||l===S||(A=[])):(A=A||[]).push(k,S))}n&&(A=A||[]).push("style",n);var k=A;(e.updateQueue=k)&&(e.flags|=4)}};vM=function(t,e,n,i){n!==i&&(e.flags|=4)};function ff(t,e){if(!Zi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ys(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function hR(t,e,n){var i=e.pendingProps;switch(ox(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ys(e),null;case 1:return Go(e.type)&&Yg(),Ys(e),null;case 3:return i=e.stateNode,m0(),Vi(jo),Vi(no),px(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Np(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,UA!==null&&(N2(UA),UA=null))),k2(t,e),Ys(e),null;case 5:dx(e);var r=Oc(ld.current);if(n=e.type,t!==null&&e.stateNode!=null)yM(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Rt(166));return Ys(e),null}if(t=Oc(bl.current),Np(e)){i=e.stateNode,n=e.type;var A=e.memoizedProps;switch(i[ml]=e,i[ad]=A,t=(e.mode&1)!==0,n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(r=0;r<kf.length;r++)Ui(kf[r],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":NE(i,A),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!A.multiple},Ui("invalid",i);break;case"textarea":VE(i,A),Ui("invalid",i)}r2(n,A),r=null;for(var d in A)if(A.hasOwnProperty(d)){var l=A[d];d==="children"?typeof l=="string"?i.textContent!==l&&(A.suppressHydrationWarning!==!0&&Fp(i.textContent,l,t),r=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(A.suppressHydrationWarning!==!0&&Fp(i.textContent,l,t),r=["children",""+l]):Xf.hasOwnProperty(d)&&l!=null&&d==="onScroll"&&Ui("scroll",i)}switch(n){case"input":Ip(i),UE(i,A,!0);break;case"textarea":Ip(i),jE(i);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(i.onclick=qg)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{d=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$C(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=d.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=d.createElement(n,{is:i.is}):(t=d.createElement(n),n==="select"&&(d=t,i.multiple?d.multiple=!0:i.size&&(d.size=i.size))):t=d.createElementNS(t,n),t[ml]=e,t[ad]=i,_M(t,e,!1,!1),e.stateNode=t;e:{switch(d=s2(n,i),n){case"dialog":Ui("cancel",t),Ui("close",t),r=i;break;case"iframe":case"object":case"embed":Ui("load",t),r=i;break;case"video":case"audio":for(r=0;r<kf.length;r++)Ui(kf[r],t);r=i;break;case"source":Ui("error",t),r=i;break;case"img":case"image":case"link":Ui("error",t),Ui("load",t),r=i;break;case"details":Ui("toggle",t),r=i;break;case"input":NE(t,i),r=Jy(t,i),Ui("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=Ar({},i,{value:void 0}),Ui("invalid",t);break;case"textarea":VE(t,i),r=n2(t,i),Ui("invalid",t);break;default:r=i}r2(n,r),l=r;for(A in l)if(l.hasOwnProperty(A)){var S=l[A];A==="style"?YC(t,S):A==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,S!=null&&ZC(t,S)):A==="children"?typeof S=="string"?(n!=="textarea"||S!=="")&&Kf(t,S):typeof S=="number"&&Kf(t,""+S):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(Xf.hasOwnProperty(A)?S!=null&&A==="onScroll"&&Ui("scroll",t):S!=null&&Hv(t,A,S,d))}switch(n){case"input":Ip(t),UE(t,i,!1);break;case"textarea":Ip(t),jE(t);break;case"option":i.value!=null&&t.setAttribute("value",""+hc(i.value));break;case"select":t.multiple=!!i.multiple,A=i.value,A!=null?i0(t,!!i.multiple,A,!1):i.defaultValue!=null&&i0(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=qg)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ys(e),null;case 6:if(t&&e.stateNode!=null)vM(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Rt(166));if(n=Oc(ld.current),Oc(bl.current),Np(e)){if(i=e.stateNode,n=e.memoizedProps,i[ml]=e,(A=i.nodeValue!==n)&&(t=ka,t!==null))switch(t.tag){case 3:Fp(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Fp(i.nodeValue,n,(t.mode&1)!==0)}A&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[ml]=e,e.stateNode=i}return Ys(e),null;case 13:if(Vi(sr),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Zi&&Ma!==null&&e.mode&1&&!(e.flags&128))zP(),p0(),e.flags|=98560,A=!1;else if(A=Np(e),i!==null&&i.dehydrated!==null){if(t===null){if(!A)throw Error(Rt(318));if(A=e.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(Rt(317));A[ml]=e}else p0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ys(e),A=!1}else UA!==null&&(N2(UA),UA=null),A=!0;if(!A)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||sr.current&1?ns===0&&(ns=3):Cx())),e.updateQueue!==null&&(e.flags|=4),Ys(e),null);case 4:return m0(),k2(t,e),t===null&&sd(e.stateNode.containerInfo),Ys(e),null;case 10:return ux(e.type._context),Ys(e),null;case 17:return Go(e.type)&&Yg(),Ys(e),null;case 19:if(Vi(sr),A=e.memoizedState,A===null)return Ys(e),null;if(i=(e.flags&128)!==0,d=A.rendering,d===null)if(i)ff(A,!1);else{if(ns!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(d=im(t),d!==null){for(e.flags|=128,ff(A,!1),i=d.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)A=n,t=i,A.flags&=14680066,d=A.alternate,d===null?(A.childLanes=0,A.lanes=t,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=d.childLanes,A.lanes=d.lanes,A.child=d.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=d.memoizedProps,A.memoizedState=d.memoizedState,A.updateQueue=d.updateQueue,A.type=d.type,t=d.dependencies,A.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return zi(sr,sr.current&1|2),e.child}t=t.sibling}A.tail!==null&&Ir()>y0&&(e.flags|=128,i=!0,ff(A,!1),e.lanes=4194304)}else{if(!i)if(t=im(d),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ff(A,!0),A.tail===null&&A.tailMode==="hidden"&&!d.alternate&&!Zi)return Ys(e),null}else 2*Ir()-A.renderingStartTime>y0&&n!==1073741824&&(e.flags|=128,i=!0,ff(A,!1),e.lanes=4194304);A.isBackwards?(d.sibling=e.child,e.child=d):(n=A.last,n!==null?n.sibling=d:e.child=d,A.last=d)}return A.tail!==null?(e=A.tail,A.rendering=e,A.tail=e.sibling,A.renderingStartTime=Ir(),e.sibling=null,n=sr.current,zi(sr,i?n&1|2:n&1),e):(Ys(e),null);case 22:case 23:return Sx(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Ta&1073741824&&(Ys(e),e.subtreeFlags&6&&(e.flags|=8192)):Ys(e),null;case 24:return null;case 25:return null}throw Error(Rt(156,e.tag))}function fR(t,e){switch(ox(e),e.tag){case 1:return Go(e.type)&&Yg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return m0(),Vi(jo),Vi(no),px(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return dx(e),null;case 13:if(Vi(sr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Rt(340));p0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Vi(sr),null;case 4:return m0(),null;case 10:return ux(e.type._context),null;case 22:case 23:return Sx(),null;case 24:return null;default:return null}}var jp=!1,eo=!1,dR=typeof WeakSet=="function"?WeakSet:Set,on=null;function Zh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){yr(t,e,i)}else n.current=null}function L2(t,e,n){try{n()}catch(i){yr(t,e,i)}}var k3=!1;function pR(t,e){if(p2=Wg,t=EP(),rx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,A=i.focusNode;i=i.focusOffset;try{n.nodeType,A.nodeType}catch{n=null;break e}var d=0,l=-1,S=-1,k=0,U=0,V=t,$=null;t:for(;;){for(var X;V!==n||r!==0&&V.nodeType!==3||(l=d+r),V!==A||i!==0&&V.nodeType!==3||(S=d+i),V.nodeType===3&&(d+=V.nodeValue.length),(X=V.firstChild)!==null;)$=V,V=X;for(;;){if(V===t)break t;if($===n&&++k===r&&(l=d),$===A&&++U===i&&(S=d),(X=V.nextSibling)!==null)break;V=$,$=V.parentNode}V=X}n=l===-1||S===-1?null:{start:l,end:S}}else n=null}n=n||{start:0,end:0}}else n=null;for(g2={focusedElem:t,selectionRange:n},Wg=!1,on=e;on!==null;)if(e=on,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,on=t;else for(;on!==null;){e=on;try{var ee=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(ee!==null){var ue=ee.memoizedProps,we=ee.memoizedState,ie=e.stateNode,Ae=ie.getSnapshotBeforeUpdate(e.elementType===e.type?ue:FA(e.type,ue),we);ie.__reactInternalSnapshotBeforeUpdate=Ae}break;case 3:var ce=e.stateNode.containerInfo;ce.nodeType===1?ce.textContent="":ce.nodeType===9&&ce.documentElement&&ce.removeChild(ce.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Rt(163))}}catch(Ce){yr(e,e.return,Ce)}if(t=e.sibling,t!==null){t.return=e.return,on=t;break}on=e.return}return ee=k3,k3=!1,ee}function jf(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var A=r.destroy;r.destroy=void 0,A!==void 0&&L2(e,n,A)}r=r.next}while(r!==i)}}function i_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function D2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function xM(t){var e=t.alternate;e!==null&&(t.alternate=null,xM(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ml],delete e[ad],delete e[y2],delete e[XB],delete e[KB])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function wM(t){return t.tag===5||t.tag===3||t.tag===4}function L3(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||wM(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function B2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qg));else if(i!==4&&(t=t.child,t!==null))for(B2(t,e,n),t=t.sibling;t!==null;)B2(t,e,n),t=t.sibling}function R2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(R2(t,e,n),t=t.sibling;t!==null;)R2(t,e,n),t=t.sibling}var Bs=null,NA=!1;function Nu(t,e,n){for(n=n.child;n!==null;)bM(t,e,n),n=n.sibling}function bM(t,e,n){if(wl&&typeof wl.onCommitFiberUnmount=="function")try{wl.onCommitFiberUnmount(qm,n)}catch{}switch(n.tag){case 5:eo||Zh(n,e);case 6:var i=Bs,r=NA;Bs=null,Nu(t,e,n),Bs=i,NA=r,Bs!==null&&(NA?(t=Bs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bs.removeChild(n.stateNode));break;case 18:Bs!==null&&(NA?(t=Bs,n=n.stateNode,t.nodeType===8?z1(t.parentNode,n):t.nodeType===1&&z1(t,n),nd(t)):z1(Bs,n.stateNode));break;case 4:i=Bs,r=NA,Bs=n.stateNode.containerInfo,NA=!0,Nu(t,e,n),Bs=i,NA=r;break;case 0:case 11:case 14:case 15:if(!eo&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var A=r,d=A.destroy;A=A.tag,d!==void 0&&(A&2||A&4)&&L2(n,e,d),r=r.next}while(r!==i)}Nu(t,e,n);break;case 1:if(!eo&&(Zh(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(l){yr(n,e,l)}Nu(t,e,n);break;case 21:Nu(t,e,n);break;case 22:n.mode&1?(eo=(i=eo)||n.memoizedState!==null,Nu(t,e,n),eo=i):Nu(t,e,n);break;default:Nu(t,e,n)}}function D3(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new dR),e.forEach(function(i){var r=ER.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function zA(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var A=t,d=e,l=d;e:for(;l!==null;){switch(l.tag){case 5:Bs=l.stateNode,NA=!1;break e;case 3:Bs=l.stateNode.containerInfo,NA=!0;break e;case 4:Bs=l.stateNode.containerInfo,NA=!0;break e}l=l.return}if(Bs===null)throw Error(Rt(160));bM(A,d,r),Bs=null,NA=!1;var S=r.alternate;S!==null&&(S.return=null),r.return=null}catch(k){yr(r,e,k)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)EM(e,t),e=e.sibling}function EM(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zA(e,t),hl(t),i&4){try{jf(3,t,t.return),i_(3,t)}catch(ue){yr(t,t.return,ue)}try{jf(5,t,t.return)}catch(ue){yr(t,t.return,ue)}}break;case 1:zA(e,t),hl(t),i&512&&n!==null&&Zh(n,n.return);break;case 5:if(zA(e,t),hl(t),i&512&&n!==null&&Zh(n,n.return),t.flags&32){var r=t.stateNode;try{Kf(r,"")}catch(ue){yr(t,t.return,ue)}}if(i&4&&(r=t.stateNode,r!=null)){var A=t.memoizedProps,d=n!==null?n.memoizedProps:A,l=t.type,S=t.updateQueue;if(t.updateQueue=null,S!==null)try{l==="input"&&A.type==="radio"&&A.name!=null&&HC(r,A),s2(l,d);var k=s2(l,A);for(d=0;d<S.length;d+=2){var U=S[d],V=S[d+1];U==="style"?YC(r,V):U==="dangerouslySetInnerHTML"?ZC(r,V):U==="children"?Kf(r,V):Hv(r,U,V,k)}switch(l){case"input":e2(r,A);break;case"textarea":WC(r,A);break;case"select":var $=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!A.multiple;var X=A.value;X!=null?i0(r,!!A.multiple,X,!1):$!==!!A.multiple&&(A.defaultValue!=null?i0(r,!!A.multiple,A.defaultValue,!0):i0(r,!!A.multiple,A.multiple?[]:"",!1))}r[ad]=A}catch(ue){yr(t,t.return,ue)}}break;case 6:if(zA(e,t),hl(t),i&4){if(t.stateNode===null)throw Error(Rt(162));r=t.stateNode,A=t.memoizedProps;try{r.nodeValue=A}catch(ue){yr(t,t.return,ue)}}break;case 3:if(zA(e,t),hl(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{nd(e.containerInfo)}catch(ue){yr(t,t.return,ue)}break;case 4:zA(e,t),hl(t);break;case 13:zA(e,t),hl(t),r=t.child,r.flags&8192&&(A=r.memoizedState!==null,r.stateNode.isHidden=A,!A||r.alternate!==null&&r.alternate.memoizedState!==null||(Ex=Ir())),i&4&&D3(t);break;case 22:if(U=n!==null&&n.memoizedState!==null,t.mode&1?(eo=(k=eo)||U,zA(e,t),eo=k):zA(e,t),hl(t),i&8192){if(k=t.memoizedState!==null,(t.stateNode.isHidden=k)&&!U&&t.mode&1)for(on=t,U=t.child;U!==null;){for(V=on=U;on!==null;){switch($=on,X=$.child,$.tag){case 0:case 11:case 14:case 15:jf(4,$,$.return);break;case 1:Zh($,$.return);var ee=$.stateNode;if(typeof ee.componentWillUnmount=="function"){i=$,n=$.return;try{e=i,ee.props=e.memoizedProps,ee.state=e.memoizedState,ee.componentWillUnmount()}catch(ue){yr(i,n,ue)}}break;case 5:Zh($,$.return);break;case 22:if($.memoizedState!==null){R3(V);continue}}X!==null?(X.return=$,on=X):R3(V)}U=U.sibling}e:for(U=null,V=t;;){if(V.tag===5){if(U===null){U=V;try{r=V.stateNode,k?(A=r.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(l=V.stateNode,S=V.memoizedProps.style,d=S!=null&&S.hasOwnProperty("display")?S.display:null,l.style.display=qC("display",d))}catch(ue){yr(t,t.return,ue)}}}else if(V.tag===6){if(U===null)try{V.stateNode.nodeValue=k?"":V.memoizedProps}catch(ue){yr(t,t.return,ue)}}else if((V.tag!==22&&V.tag!==23||V.memoizedState===null||V===t)&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===t)break e;for(;V.sibling===null;){if(V.return===null||V.return===t)break e;U===V&&(U=null),V=V.return}U===V&&(U=null),V.sibling.return=V.return,V=V.sibling}}break;case 19:zA(e,t),hl(t),i&4&&D3(t);break;case 21:break;default:zA(e,t),hl(t)}}function hl(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(wM(n)){var i=n;break e}n=n.return}throw Error(Rt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Kf(r,""),i.flags&=-33);var A=L3(t);R2(t,A,r);break;case 3:case 4:var d=i.stateNode.containerInfo,l=L3(t);B2(t,l,d);break;default:throw Error(Rt(161))}}catch(S){yr(t,t.return,S)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gR(t,e,n){on=t,TM(t)}function TM(t,e,n){for(var i=(t.mode&1)!==0;on!==null;){var r=on,A=r.child;if(r.tag===22&&i){var d=r.memoizedState!==null||jp;if(!d){var l=r.alternate,S=l!==null&&l.memoizedState!==null||eo;l=jp;var k=eo;if(jp=d,(eo=S)&&!k)for(on=r;on!==null;)d=on,S=d.child,d.tag===22&&d.memoizedState!==null?O3(r):S!==null?(S.return=d,on=S):O3(r);for(;A!==null;)on=A,TM(A),A=A.sibling;on=r,jp=l,eo=k}B3(t)}else r.subtreeFlags&8772&&A!==null?(A.return=r,on=A):B3(t)}}function B3(t){for(;on!==null;){var e=on;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:eo||i_(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!eo)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:FA(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var A=e.updateQueue;A!==null&&m3(e,A,i);break;case 3:var d=e.updateQueue;if(d!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}m3(e,d,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var S=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":S.autoFocus&&n.focus();break;case"img":S.src&&(n.src=S.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var k=e.alternate;if(k!==null){var U=k.memoizedState;if(U!==null){var V=U.dehydrated;V!==null&&nd(V)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Rt(163))}eo||e.flags&512&&D2(e)}catch($){yr(e,e.return,$)}}if(e===t){on=null;break}if(n=e.sibling,n!==null){n.return=e.return,on=n;break}on=e.return}}function R3(t){for(;on!==null;){var e=on;if(e===t){on=null;break}var n=e.sibling;if(n!==null){n.return=e.return,on=n;break}on=e.return}}function O3(t){for(;on!==null;){var e=on;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{i_(4,e)}catch(S){yr(e,n,S)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(S){yr(e,r,S)}}var A=e.return;try{D2(e)}catch(S){yr(e,A,S)}break;case 5:var d=e.return;try{D2(e)}catch(S){yr(e,d,S)}}}catch(S){yr(e,e.return,S)}if(e===t){on=null;break}var l=e.sibling;if(l!==null){l.return=e.return,on=l;break}on=e.return}}var mR=Math.ceil,om=xu.ReactCurrentDispatcher,wx=xu.ReactCurrentOwner,nA=xu.ReactCurrentBatchConfig,Ai=0,Ts=null,Qr=null,Rs=0,Ta=0,qh=pc(0),ns=0,fd=null,Wc=0,r_=0,bx=0,Gf=null,Fo=null,Ex=0,y0=1/0,Jl=null,am=!1,O2=null,oc=null,Gp=!1,Ku=null,Am=0,Qf=0,z2=null,Eg=-1,Tg=0;function vo(){return Ai&6?Ir():Eg!==-1?Eg:Eg=Ir()}function ac(t){return t.mode&1?Ai&2&&Rs!==0?Rs&-Rs:eR.transition!==null?(Tg===0&&(Tg=AP()),Tg):(t=mi,t!==0||(t=window.event,t=t===void 0?16:pP(t.type)),t):1}function WA(t,e,n,i){if(50<Qf)throw Qf=0,z2=null,Error(Rt(185));Od(t,n,i),(!(Ai&2)||t!==Ts)&&(t===Ts&&(!(Ai&2)&&(r_|=n),ns===4&&qu(t,Rs)),Qo(t,i),n===1&&Ai===0&&!(e.mode&1)&&(y0=Ir()+500,e_&&gc()))}function Qo(t,e){var n=t.callbackNode;eB(t,e);var i=Hg(t,t===Ts?Rs:0);if(i===0)n!==null&&HE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&HE(n),e===1)t.tag===0?JB(z3.bind(null,t)):BP(z3.bind(null,t)),qB(function(){!(Ai&6)&&gc()}),n=null;else{switch(lP(i)){case 1:n=Yv;break;case 4:n=oP;break;case 16:n=Qg;break;case 536870912:n=aP;break;default:n=Qg}n=DM(n,SM.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function SM(t,e){if(Eg=-1,Tg=0,Ai&6)throw Error(Rt(327));var n=t.callbackNode;if(A0()&&t.callbackNode!==n)return null;var i=Hg(t,t===Ts?Rs:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=lm(t,i);else{e=i;var r=Ai;Ai|=2;var A=PM();(Ts!==t||Rs!==e)&&(Jl=null,y0=Ir()+500,Nc(t,e));do try{vR();break}catch(l){CM(t,l)}while(1);lx(),om.current=A,Ai=r,Qr!==null?e=0:(Ts=null,Rs=0,e=ns)}if(e!==0){if(e===2&&(r=u2(t),r!==0&&(i=r,e=F2(t,r))),e===1)throw n=fd,Nc(t,0),qu(t,i),Qo(t,Ir()),n;if(e===6)qu(t,i);else{if(r=t.current.alternate,!(i&30)&&!_R(r)&&(e=lm(t,i),e===2&&(A=u2(t),A!==0&&(i=A,e=F2(t,A))),e===1))throw n=fd,Nc(t,0),qu(t,i),Qo(t,Ir()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(Rt(345));case 2:Lc(t,Fo,Jl);break;case 3:if(qu(t,i),(i&130023424)===i&&(e=Ex+500-Ir(),10<e)){if(Hg(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){vo(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=_2(Lc.bind(null,t,Fo,Jl),e);break}Lc(t,Fo,Jl);break;case 4:if(qu(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var d=31-HA(i);A=1<<d,d=e[d],d>r&&(r=d),i&=~A}if(i=r,i=Ir()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*mR(i/1960))-i,10<i){t.timeoutHandle=_2(Lc.bind(null,t,Fo,Jl),i);break}Lc(t,Fo,Jl);break;case 5:Lc(t,Fo,Jl);break;default:throw Error(Rt(329))}}}return Qo(t,Ir()),t.callbackNode===n?SM.bind(null,t):null}function F2(t,e){var n=Gf;return t.current.memoizedState.isDehydrated&&(Nc(t,e).flags|=256),t=lm(t,e),t!==2&&(e=Fo,Fo=n,e!==null&&N2(e)),t}function N2(t){Fo===null?Fo=t:Fo.push.apply(Fo,t)}function _R(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],A=r.getSnapshot;r=r.value;try{if(!ZA(A(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qu(t,e){for(e&=~bx,e&=~r_,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-HA(e),i=1<<n;t[n]=-1,e&=~i}}function z3(t){if(Ai&6)throw Error(Rt(327));A0();var e=Hg(t,0);if(!(e&1))return Qo(t,Ir()),null;var n=lm(t,e);if(t.tag!==0&&n===2){var i=u2(t);i!==0&&(e=i,n=F2(t,i))}if(n===1)throw n=fd,Nc(t,0),qu(t,e),Qo(t,Ir()),n;if(n===6)throw Error(Rt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Lc(t,Fo,Jl),Qo(t,Ir()),null}function Tx(t,e){var n=Ai;Ai|=1;try{return t(e)}finally{Ai=n,Ai===0&&(y0=Ir()+500,e_&&gc())}}function $c(t){Ku!==null&&Ku.tag===0&&!(Ai&6)&&A0();var e=Ai;Ai|=1;var n=nA.transition,i=mi;try{if(nA.transition=null,mi=1,t)return t()}finally{mi=i,nA.transition=n,Ai=e,!(Ai&6)&&gc()}}function Sx(){Ta=qh.current,Vi(qh)}function Nc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ZB(n)),Qr!==null)for(n=Qr.return;n!==null;){var i=n;switch(ox(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Yg();break;case 3:m0(),Vi(jo),Vi(no),px();break;case 5:dx(i);break;case 4:m0();break;case 13:Vi(sr);break;case 19:Vi(sr);break;case 10:ux(i.type._context);break;case 22:case 23:Sx()}n=n.return}if(Ts=t,Qr=t=Ac(t.current,null),Rs=Ta=e,ns=0,fd=null,bx=r_=Wc=0,Fo=Gf=null,Rc!==null){for(e=0;e<Rc.length;e++)if(n=Rc[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,A=n.pending;if(A!==null){var d=A.next;A.next=r,i.next=d}n.pending=i}Rc=null}return t}function CM(t,e){do{var n=Qr;try{if(lx(),xg.current=sm,rm){for(var i=ar.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}rm=!1}if(Hc=0,bs=ts=ar=null,Vf=!1,ud=0,wx.current=null,n===null||n.return===null){ns=1,fd=e,Qr=null;break}e:{var A=t,d=n.return,l=n,S=e;if(e=Rs,l.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){var k=S,U=l,V=U.tag;if(!(U.mode&1)&&(V===0||V===11||V===15)){var $=U.alternate;$?(U.updateQueue=$.updateQueue,U.memoizedState=$.memoizedState,U.lanes=$.lanes):(U.updateQueue=null,U.memoizedState=null)}var X=E3(d);if(X!==null){X.flags&=-257,T3(X,d,l,A,e),X.mode&1&&b3(A,k,e),e=X,S=k;var ee=e.updateQueue;if(ee===null){var ue=new Set;ue.add(S),e.updateQueue=ue}else ee.add(S);break e}else{if(!(e&1)){b3(A,k,e),Cx();break e}S=Error(Rt(426))}}else if(Zi&&l.mode&1){var we=E3(d);if(we!==null){!(we.flags&65536)&&(we.flags|=256),T3(we,d,l,A,e),ax(_0(S,l));break e}}A=S=_0(S,l),ns!==4&&(ns=2),Gf===null?Gf=[A]:Gf.push(A),A=d;do{switch(A.tag){case 3:A.flags|=65536,e&=-e,A.lanes|=e;var ie=uM(A,S,e);g3(A,ie);break e;case 1:l=S;var Ae=A.type,ce=A.stateNode;if(!(A.flags&128)&&(typeof Ae.getDerivedStateFromError=="function"||ce!==null&&typeof ce.componentDidCatch=="function"&&(oc===null||!oc.has(ce)))){A.flags|=65536,e&=-e,A.lanes|=e;var Ce=cM(A,l,e);g3(A,Ce);break e}}A=A.return}while(A!==null)}IM(n)}catch(Ne){e=Ne,Qr===n&&n!==null&&(Qr=n=n.return);continue}break}while(1)}function PM(){var t=om.current;return om.current=sm,t===null?sm:t}function Cx(){(ns===0||ns===3||ns===2)&&(ns=4),Ts===null||!(Wc&268435455)&&!(r_&268435455)||qu(Ts,Rs)}function lm(t,e){var n=Ai;Ai|=2;var i=PM();(Ts!==t||Rs!==e)&&(Jl=null,Nc(t,e));do try{yR();break}catch(r){CM(t,r)}while(1);if(lx(),Ai=n,om.current=i,Qr!==null)throw Error(Rt(261));return Ts=null,Rs=0,ns}function yR(){for(;Qr!==null;)MM(Qr)}function vR(){for(;Qr!==null&&!HD();)MM(Qr)}function MM(t){var e=LM(t.alternate,t,Ta);t.memoizedProps=t.pendingProps,e===null?IM(t):Qr=e,wx.current=null}function IM(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=fR(n,e),n!==null){n.flags&=32767,Qr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ns=6,Qr=null;return}}else if(n=hR(n,e,Ta),n!==null){Qr=n;return}if(e=e.sibling,e!==null){Qr=e;return}Qr=e=t}while(e!==null);ns===0&&(ns=5)}function Lc(t,e,n){var i=mi,r=nA.transition;try{nA.transition=null,mi=1,xR(t,e,n,i)}finally{nA.transition=r,mi=i}return null}function xR(t,e,n,i){do A0();while(Ku!==null);if(Ai&6)throw Error(Rt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Rt(177));t.callbackNode=null,t.callbackPriority=0;var A=n.lanes|n.childLanes;if(tB(t,A),t===Ts&&(Qr=Ts=null,Rs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gp||(Gp=!0,DM(Qg,function(){return A0(),null})),A=(n.flags&15990)!==0,n.subtreeFlags&15990||A){A=nA.transition,nA.transition=null;var d=mi;mi=1;var l=Ai;Ai|=4,wx.current=null,pR(t,n),EM(n,t),VB(g2),Wg=!!p2,g2=p2=null,t.current=n,gR(n),WD(),Ai=l,mi=d,nA.transition=A}else t.current=n;if(Gp&&(Gp=!1,Ku=t,Am=r),A=t.pendingLanes,A===0&&(oc=null),qD(n.stateNode),Qo(t,Ir()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(am)throw am=!1,t=O2,O2=null,t;return Am&1&&t.tag!==0&&A0(),A=t.pendingLanes,A&1?t===z2?Qf++:(Qf=0,z2=t):Qf=0,gc(),null}function A0(){if(Ku!==null){var t=lP(Am),e=nA.transition,n=mi;try{if(nA.transition=null,mi=16>t?16:t,Ku===null)var i=!1;else{if(t=Ku,Ku=null,Am=0,Ai&6)throw Error(Rt(331));var r=Ai;for(Ai|=4,on=t.current;on!==null;){var A=on,d=A.child;if(on.flags&16){var l=A.deletions;if(l!==null){for(var S=0;S<l.length;S++){var k=l[S];for(on=k;on!==null;){var U=on;switch(U.tag){case 0:case 11:case 15:jf(8,U,A)}var V=U.child;if(V!==null)V.return=U,on=V;else for(;on!==null;){U=on;var $=U.sibling,X=U.return;if(xM(U),U===k){on=null;break}if($!==null){$.return=X,on=$;break}on=X}}}var ee=A.alternate;if(ee!==null){var ue=ee.child;if(ue!==null){ee.child=null;do{var we=ue.sibling;ue.sibling=null,ue=we}while(ue!==null)}}on=A}}if(A.subtreeFlags&2064&&d!==null)d.return=A,on=d;else e:for(;on!==null;){if(A=on,A.flags&2048)switch(A.tag){case 0:case 11:case 15:jf(9,A,A.return)}var ie=A.sibling;if(ie!==null){ie.return=A.return,on=ie;break e}on=A.return}}var Ae=t.current;for(on=Ae;on!==null;){d=on;var ce=d.child;if(d.subtreeFlags&2064&&ce!==null)ce.return=d,on=ce;else e:for(d=Ae;on!==null;){if(l=on,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:i_(9,l)}}catch(Ne){yr(l,l.return,Ne)}if(l===d){on=null;break e}var Ce=l.sibling;if(Ce!==null){Ce.return=l.return,on=Ce;break e}on=l.return}}if(Ai=r,gc(),wl&&typeof wl.onPostCommitFiberRoot=="function")try{wl.onPostCommitFiberRoot(qm,t)}catch{}i=!0}return i}finally{mi=n,nA.transition=e}}return!1}function F3(t,e,n){e=_0(n,e),e=uM(t,e,1),t=sc(t,e,1),e=vo(),t!==null&&(Od(t,1,e),Qo(t,e))}function yr(t,e,n){if(t.tag===3)F3(t,t,n);else for(;e!==null;){if(e.tag===3){F3(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(oc===null||!oc.has(i))){t=_0(n,t),t=cM(e,t,1),e=sc(e,t,1),t=vo(),e!==null&&(Od(e,1,t),Qo(e,t));break}}e=e.return}}function wR(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=vo(),t.pingedLanes|=t.suspendedLanes&n,Ts===t&&(Rs&n)===n&&(ns===4||ns===3&&(Rs&130023424)===Rs&&500>Ir()-Ex?Nc(t,0):bx|=n),Qo(t,e)}function kM(t,e){e===0&&(t.mode&1?(e=Dp,Dp<<=1,!(Dp&130023424)&&(Dp=4194304)):e=1);var n=vo();t=hu(t,e),t!==null&&(Od(t,e,n),Qo(t,n))}function bR(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),kM(t,n)}function ER(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(Rt(314))}i!==null&&i.delete(e),kM(t,n)}var LM;LM=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||jo.current)Uo=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Uo=!1,cR(t,e,n);Uo=!!(t.flags&131072)}else Uo=!1,Zi&&e.flags&1048576&&RP(e,Jg,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;bg(t,e),t=e.pendingProps;var r=d0(e,no.current);a0(e,n),r=mx(null,e,i,t,r,n);var A=_x();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Go(i)?(A=!0,Xg(e)):A=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,hx(e),r.updater=t_,e.stateNode=r,r._reactInternals=e,T2(e,i,t,n),e=P2(null,e,i,!0,A,n)):(e.tag=0,Zi&&A&&sx(e),_o(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(bg(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=SR(i),t=FA(i,t),r){case 0:e=C2(null,e,i,t,n);break e;case 1:e=P3(null,e,i,t,n);break e;case 11:e=S3(null,e,i,t,n);break e;case 14:e=C3(null,e,i,FA(i.type,t),n);break e}throw Error(Rt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:FA(i,r),C2(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:FA(i,r),P3(t,e,i,r,n);case 3:e:{if(pM(e),t===null)throw Error(Rt(387));i=e.pendingProps,A=e.memoizedState,r=A.element,NP(t,e),nm(e,i,null,n);var d=e.memoizedState;if(i=d.element,A.isDehydrated)if(A={element:i,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=A,e.memoizedState=A,e.flags&256){r=_0(Error(Rt(423)),e),e=M3(t,e,i,n,r);break e}else if(i!==r){r=_0(Error(Rt(424)),e),e=M3(t,e,i,n,r);break e}else for(Ma=rc(e.stateNode.containerInfo.firstChild),ka=e,Zi=!0,UA=null,n=GP(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(p0(),i===r){e=fu(t,e,n);break e}_o(t,e,i,n)}e=e.child}return e;case 5:return QP(e),t===null&&w2(e),i=e.type,r=e.pendingProps,A=t!==null?t.memoizedProps:null,d=r.children,m2(i,r)?d=null:A!==null&&m2(i,A)&&(e.flags|=32),dM(t,e),_o(t,e,d,n),e.child;case 6:return t===null&&w2(e),null;case 13:return gM(t,e,n);case 4:return fx(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=g0(e,null,i,n):_o(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:FA(i,r),S3(t,e,i,r,n);case 7:return _o(t,e,e.pendingProps,n),e.child;case 8:return _o(t,e,e.pendingProps.children,n),e.child;case 12:return _o(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,A=e.memoizedProps,d=r.value,zi(em,i._currentValue),i._currentValue=d,A!==null)if(ZA(A.value,d)){if(A.children===r.children&&!jo.current){e=fu(t,e,n);break e}}else for(A=e.child,A!==null&&(A.return=e);A!==null;){var l=A.dependencies;if(l!==null){d=A.child;for(var S=l.firstContext;S!==null;){if(S.context===i){if(A.tag===1){S=su(-1,n&-n),S.tag=2;var k=A.updateQueue;if(k!==null){k=k.shared;var U=k.pending;U===null?S.next=S:(S.next=U.next,U.next=S),k.pending=S}}A.lanes|=n,S=A.alternate,S!==null&&(S.lanes|=n),b2(A.return,n,e),l.lanes|=n;break}S=S.next}}else if(A.tag===10)d=A.type===e.type?null:A.child;else if(A.tag===18){if(d=A.return,d===null)throw Error(Rt(341));d.lanes|=n,l=d.alternate,l!==null&&(l.lanes|=n),b2(d,n,e),d=A.sibling}else d=A.child;if(d!==null)d.return=A;else for(d=A;d!==null;){if(d===e){d=null;break}if(A=d.sibling,A!==null){A.return=d.return,d=A;break}d=d.return}A=d}_o(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,a0(e,n),r=sA(r),i=i(r),e.flags|=1,_o(t,e,i,n),e.child;case 14:return i=e.type,r=FA(i,e.pendingProps),r=FA(i.type,r),C3(t,e,i,r,n);case 15:return hM(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:FA(i,r),bg(t,e),e.tag=1,Go(i)?(t=!0,Xg(e)):t=!1,a0(e,n),VP(e,i,r),T2(e,i,r,n),P2(null,e,i,!0,t,n);case 19:return mM(t,e,n);case 22:return fM(t,e,n)}throw Error(Rt(156,e.tag))};function DM(t,e){return sP(t,e)}function TR(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tA(t,e,n,i){return new TR(t,e,n,i)}function Px(t){return t=t.prototype,!(!t||!t.isReactComponent)}function SR(t){if(typeof t=="function")return Px(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$v)return 11;if(t===Zv)return 14}return 2}function Ac(t,e){var n=t.alternate;return n===null?(n=tA(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sg(t,e,n,i,r,A){var d=2;if(i=t,typeof t=="function")Px(t)&&(d=1);else if(typeof t=="string")d=5;else e:switch(t){case Nh:return Uc(n.children,r,A,e);case Wv:d=8,r|=8;break;case qy:return t=tA(12,n,e,r|2),t.elementType=qy,t.lanes=A,t;case Yy:return t=tA(13,n,e,r),t.elementType=Yy,t.lanes=A,t;case Xy:return t=tA(19,n,e,r),t.elementType=Xy,t.lanes=A,t;case jC:return s_(n,r,A,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case UC:d=10;break e;case VC:d=9;break e;case $v:d=11;break e;case Zv:d=14;break e;case Wu:d=16,i=null;break e}throw Error(Rt(130,t==null?t:typeof t,""))}return e=tA(d,n,e,r),e.elementType=t,e.type=i,e.lanes=A,e}function Uc(t,e,n,i){return t=tA(7,t,i,e),t.lanes=n,t}function s_(t,e,n,i){return t=tA(22,t,i,e),t.elementType=jC,t.lanes=n,t.stateNode={isHidden:!1},t}function H1(t,e,n){return t=tA(6,t,null,e),t.lanes=n,t}function W1(t,e,n){return e=tA(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function CR(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S1(0),this.expirationTimes=S1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S1(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Mx(t,e,n,i,r,A,d,l,S){return t=new CR(t,e,n,l,S),e===1?(e=1,A===!0&&(e|=8)):e=0,A=tA(3,null,null,e),t.current=A,A.stateNode=t,A.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hx(A),t}function PR(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fh,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function BM(t){if(!t)return fc;t=t._reactInternals;e:{if(nh(t)!==t||t.tag!==1)throw Error(Rt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Go(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Rt(171))}if(t.tag===1){var n=t.type;if(Go(n))return DP(t,n,e)}return e}function RM(t,e,n,i,r,A,d,l,S){return t=Mx(n,i,!0,t,r,A,d,l,S),t.context=BM(null),n=t.current,i=vo(),r=ac(n),A=su(i,r),A.callback=e??null,sc(n,A,r),t.current.lanes=r,Od(t,r,i),Qo(t,i),t}function o_(t,e,n,i){var r=e.current,A=vo(),d=ac(r);return n=BM(n),e.context===null?e.context=n:e.pendingContext=n,e=su(A,d),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=sc(r,e,d),t!==null&&(WA(t,r,d,A),vg(t,r,d)),d}function um(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function N3(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ix(t,e){N3(t,e),(t=t.alternate)&&N3(t,e)}function MR(){return null}var OM=typeof reportError=="function"?reportError:function(t){console.error(t)};function kx(t){this._internalRoot=t}a_.prototype.render=kx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Rt(409));o_(t,e,null,null)};a_.prototype.unmount=kx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$c(function(){o_(null,t,null,null)}),e[cu]=null}};function a_(t){this._internalRoot=t}a_.prototype.unstable_scheduleHydration=function(t){if(t){var e=hP();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Zu.length&&e!==0&&e<Zu[n].priority;n++);Zu.splice(n,0,t),n===0&&dP(t)}};function Lx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function A_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function U3(){}function IR(t,e,n,i,r){if(r){if(typeof i=="function"){var A=i;i=function(){var k=um(d);A.call(k)}}var d=RM(e,i,t,0,null,!1,!1,"",U3);return t._reactRootContainer=d,t[cu]=d.current,sd(t.nodeType===8?t.parentNode:t),$c(),d}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var l=i;i=function(){var k=um(S);l.call(k)}}var S=Mx(t,0,!1,null,null,!1,!1,"",U3);return t._reactRootContainer=S,t[cu]=S.current,sd(t.nodeType===8?t.parentNode:t),$c(function(){o_(e,S,n,i)}),S}function l_(t,e,n,i,r){var A=n._reactRootContainer;if(A){var d=A;if(typeof r=="function"){var l=r;r=function(){var S=um(d);l.call(S)}}o_(e,d,t,r)}else d=IR(n,e,t,r,i);return um(d)}uP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=If(e.pendingLanes);n!==0&&(Xv(e,n|1),Qo(e,Ir()),!(Ai&6)&&(y0=Ir()+500,gc()))}break;case 13:$c(function(){var i=hu(t,1);if(i!==null){var r=vo();WA(i,t,1,r)}}),Ix(t,1)}};Kv=function(t){if(t.tag===13){var e=hu(t,134217728);if(e!==null){var n=vo();WA(e,t,134217728,n)}Ix(t,134217728)}};cP=function(t){if(t.tag===13){var e=ac(t),n=hu(t,e);if(n!==null){var i=vo();WA(n,t,e,i)}Ix(t,e)}};hP=function(){return mi};fP=function(t,e){var n=mi;try{return mi=t,e()}finally{mi=n}};a2=function(t,e,n){switch(e){case"input":if(e2(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=Jm(i);if(!r)throw Error(Rt(90));QC(i),e2(i,r)}}}break;case"textarea":WC(t,n);break;case"select":e=n.value,e!=null&&i0(t,!!n.multiple,e,!1)}};JC=Tx;eP=$c;var kR={usingClientEntryPoint:!1,Events:[Fd,Gh,Jm,XC,KC,Tx]},df={findFiberByHostInstance:Bc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},LR={bundleType:df.bundleType,version:df.version,rendererPackageName:df.rendererPackageName,rendererConfig:df.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xu.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=iP(t),t===null?null:t.stateNode},findFiberByHostInstance:df.findFiberByHostInstance||MR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qp.isDisabled&&Qp.supportsFiber)try{qm=Qp.inject(LR),wl=Qp}catch{}}Ba.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kR;Ba.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lx(e))throw Error(Rt(200));return PR(t,e,null,n)};Ba.createRoot=function(t,e){if(!Lx(t))throw Error(Rt(299));var n=!1,i="",r=OM;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Mx(t,1,!1,null,null,n,!1,i,r),t[cu]=e.current,sd(t.nodeType===8?t.parentNode:t),new kx(e)};Ba.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Rt(188)):(t=Object.keys(t).join(","),Error(Rt(268,t)));return t=iP(e),t=t===null?null:t.stateNode,t};Ba.flushSync=function(t){return $c(t)};Ba.hydrate=function(t,e,n){if(!A_(e))throw Error(Rt(200));return l_(null,t,e,!0,n)};Ba.hydrateRoot=function(t,e,n){if(!Lx(t))throw Error(Rt(405));var i=n!=null&&n.hydratedSources||null,r=!1,A="",d=OM;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(A=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),e=RM(e,null,t,1,n??null,r,!1,A,d),t[cu]=e.current,sd(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new a_(e)};Ba.render=function(t,e,n){if(!A_(e))throw Error(Rt(200));return l_(null,t,e,!1,n)};Ba.unmountComponentAtNode=function(t){if(!A_(t))throw Error(Rt(40));return t._reactRootContainer?($c(function(){l_(null,null,t,!1,function(){t._reactRootContainer=null,t[cu]=null})}),!0):!1};Ba.unstable_batchedUpdates=Tx;Ba.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!A_(n))throw Error(Rt(200));if(t==null||t._reactInternals===void 0)throw Error(Rt(38));return l_(t,e,n,!1,i)};Ba.version="18.2.0-next-9e3b772b8-20220608";function zM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zM)}catch(t){console.error(t)}}zM(),RC.exports=Ba;var Dx=RC.exports,V3=Dx;$y.createRoot=V3.createRoot,$y.hydrateRoot=V3.hydrateRoot;var FM={exports:{}},NM={exports:{}},DR="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",BR=DR,RR=BR;function UM(){}function VM(){}VM.resetWarningCache=UM;var OR=function(){function t(i,r,A,d,l,S){if(S!==RR){var k=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw k.name="Invariant Violation",k}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:VM,resetWarningCache:UM};return n.PropTypes=n,n};NM.exports=OR();var zR=NM.exports;(function(t){var e=Object.create,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,A=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty,l=(Ne,qe)=>{for(var tt in qe)n(Ne,tt,{get:qe[tt],enumerable:!0})},S=(Ne,qe,tt,lt)=>{if(qe&&typeof qe=="object"||typeof qe=="function")for(let at of r(qe))!d.call(Ne,at)&&at!==tt&&n(Ne,at,{get:()=>qe[at],enumerable:!(lt=i(qe,at))||lt.enumerable});return Ne},k=(Ne,qe,tt)=>(tt=Ne!=null?e(A(Ne)):{},S(qe||!Ne||!Ne.__esModule?n(tt,"default",{value:Ne,enumerable:!0}):tt,Ne)),U=Ne=>S(n({},"__esModule",{value:!0}),Ne),V={};l(V,{default:()=>Ce}),t.exports=U(V);var $=Tt,X=k(zR),ee=16,ue=[],we=(Ne,{fillColor:qe,text:tt,textColor:lt,canvasSize:at})=>{const ht=at/5;Ne.font=`bold ${at-ht*2}px arial`;const Et=Math.min(Ne.measureText(tt).width,at-ht)+ht,St=at-Et,Mt=at/2-ht,Kt=ht+at/2,pn=Math.min(Et/2,Kt/2);Ne.beginPath(),Ne.moveTo(St+pn,Mt),Ne.arcTo(St+Et,Mt,St+Et,Mt+Kt,pn),Ne.arcTo(St+Et,Mt+Kt,St,Mt+Kt,pn),Ne.arcTo(St,Mt+Kt,St,Mt,pn),Ne.arcTo(St,Mt,St+Et,Mt,pn),Ne.closePath(),Ne.fillStyle=qe,Ne.fill(),Ne.fillStyle=lt,Ne.textBaseline="bottom",Ne.textAlign="right",Ne.fillText(tt,at-ht/2,at,at-ht)},ie=({alertCount:Ne,alertFillColor:qe,alertTextColor:tt,callback:lt,renderOverlay:at,url:ht,canvasSize:Et})=>{const St=document.createElement("img");St.crossOrigin="Anonymous",St.onload=function(){const Mt=document.createElement("canvas");Mt.width=Et,Mt.height=Et;const Kt=Mt.getContext("2d");Kt.clearRect(0,0,St.width,St.height),Kt.drawImage(St,0,0,Mt.width,Mt.height),Ne&&we(Kt,{fillColor:qe,textColor:tt,text:Ne,canvasSize:Et}),at&&at(Mt,Kt),lt(Kt.canvas.toDataURL())},St.src=ht},Ae=Ne=>{if(!(typeof document>"u")&&ue.length===0){var qe=document.getElementsByTagName("head")[0];const at=document.createElement("link");at.type="image/x-icon",at.rel="icon";const ht=document.createElement("link");ht.rel="apple-touch-icon",ue.push(at,ht);for(var tt=qe.getElementsByTagName("link"),lt=tt.length;--lt>=0;)/\bicon\b/i.test(tt[lt].getAttribute("rel"))&&!Ne(tt[lt])&&qe.removeChild(tt[lt]);ue.forEach(Et=>qe.appendChild(Et))}},ce=({iconSize:Ne,alertCount:qe,alertFillColor:tt,alertTextColor:lt,animated:at,animationDelay:ht,keepIconLink:Et,renderOverlay:St,url:Mt})=>{const Kt=(0,$.useRef)(0),pn=(0,$.useRef)(null),[,ei]=(0,$.useState)(),li=(0,$.useCallback)(()=>ei({}),[]),Nt=(0,$.useCallback)(()=>{Ae(Et),Kt.current=(Kt.current+1)%Mt.length,li()},[li,Et,Mt]);(0,$.useEffect)(()=>{Nt()},[Nt]);const dn=Mt instanceof Array&&at;(0,$.useEffect)(()=>{if(dn){if(!pn.current){const Bn=setInterval(Nt,ht);pn.current=Bn}}else pn.current&&(clearInterval(pn.current),pn.current=null,Ae(Et))},[ht,dn,Et,Nt,Mt]);const vn=dn?Mt[Kt.current]:Mt instanceof Array?Mt[0]:Mt;return qe||St?ie({alertCount:qe,alertFillColor:tt,alertTextColor:lt,callback:Bn=>{ue.forEach(Tn=>Tn.href=Bn)},renderOverlay:St,url:vn,canvasSize:Ne}):ue.forEach(Bn=>Bn.href=vn),null};ce.defaultProps={iconSize:ee,alertCount:null,alertFillColor:"red",alertTextColor:"white",animated:!0,animationDelay:500,keepIconLink:()=>!1,renderOverlay:null,url:null},ce.propTypes={iconSize:X.default.number,alertCount:X.default.oneOfType([X.default.number,X.default.string]),alertFillColor:X.default.string,alertTextColor:X.default.string,animated:X.default.bool,animationDelay:X.default.number,keepIconLink:X.default.func,renderOverlay:X.default.func,url:X.default.oneOfType([X.default.arrayOf(X.default.string),X.default.string]).isRequired};var Ce=ce;t.exports=t.exports.default})(FM);var FR=FM.exports;const NR=$m(FR);function cm(t,e,n){n=n||{};var i=t.ownerDocument,r=i.defaultView.CustomEvent;typeof r=="function"?r=new r(e,{detail:n}):(r=i.createEvent("Event"),r.initEvent(e,!1,!1),r.detail=n),t.dispatchEvent(r)}function jM(t){return Array.isArray(t)||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function GM(t){return t===(t|0)+""}function yl(t){const e=document.createElement("span");return e.className="observablehq--cellname",e.textContent=`${t} = `,e}const UR=Symbol.prototype.toString;function O0(t){return UR.call(t)}const{getOwnPropertySymbols:VR,prototype:{hasOwnProperty:jR}}=Object,{toStringTag:GR}=Symbol,QM={},Ud=VR;function u_(t,e){return jR.call(t,e)}function U2(t){return t[GR]||t.constructor&&t.constructor.name||"Object"}function iA(t,e){try{const n=t[e];return n&&n.constructor,n}catch{return QM}}const QR=[{symbol:"@@__IMMUTABLE_INDEXED__@@",name:"Indexed",modifier:!0},{symbol:"@@__IMMUTABLE_KEYED__@@",name:"Keyed",modifier:!0},{symbol:"@@__IMMUTABLE_LIST__@@",name:"List",arrayish:!0},{symbol:"@@__IMMUTABLE_MAP__@@",name:"Map"},{symbol:"@@__IMMUTABLE_ORDERED__@@",name:"Ordered",modifier:!0,prefix:!0},{symbol:"@@__IMMUTABLE_RECORD__@@",name:"Record"},{symbol:"@@__IMMUTABLE_SET__@@",name:"Set",arrayish:!0,setish:!0},{symbol:"@@__IMMUTABLE_STACK__@@",name:"Stack",arrayish:!0}];function HM(t){try{let e=QR.filter(({symbol:d})=>t[d]===!0);if(!e.length)return;const n=e.find(d=>!d.modifier),i=n.name==="Map"&&e.find(d=>d.modifier&&d.prefix),r=e.some(d=>d.arrayish),A=e.some(d=>d.setish);return{name:`${i?i.name:""}${n.name}`,symbols:e,arrayish:r&&!A,setish:A}}catch{return null}}const{getPrototypeOf:Bx,getOwnPropertyDescriptors:HR}=Object,WM=Bx({});function $M(t,e,n,i){let r=jM(t),A,d,l,S;t instanceof Map?t instanceof t.constructor?(A=`Map(${t.size})`,d=WR):(A="Map()",d=Hf):t instanceof Set?t instanceof t.constructor?(A=`Set(${t.size})`,d=$R):(A="Set()",d=Hf):r?(A=`${t.constructor.name}(${t.length})`,d=qR):(S=HM(t))?(A=`Immutable.${S.name}${S.name==="Record"?"":`(${t.size})`}`,r=S.arrayish,d=S.arrayish?YR:S.setish?ZR:KR):i?(A=U2(t),d=XR):(A=U2(t),d=Hf);const k=document.createElement("span");k.className="observablehq--expanded",n&&k.appendChild(yl(n));const U=k.appendChild(document.createElement("a"));U.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M4 7L0 1h8z' fill='currentColor' />
  </svg>`,U.appendChild(document.createTextNode(`${A}${r?" [":" {"}`)),U.addEventListener("mouseup",function(V){V.stopPropagation(),fm(k,Rx(t,null,n,i))}),d=d(t);for(let V=0;!(l=d.next()).done&&V<20;++V)k.appendChild(l.value);if(!l.done){const V=k.appendChild(document.createElement("a"));V.className="observablehq--field",V.style.display="block",V.appendChild(document.createTextNode("  … more")),V.addEventListener("mouseup",function($){$.stopPropagation(),k.insertBefore(l.value,k.lastChild.previousSibling);for(let X=0;!(l=d.next()).done&&X<19;++X)k.insertBefore(l.value,k.lastChild.previousSibling);l.done&&k.removeChild(k.lastChild.previousSibling),cm(k,"load")})}return k.appendChild(document.createTextNode(r?"]":"}")),k}function*WR(t){for(const[e,n]of t)yield JR(e,n);yield*Hf(t)}function*$R(t){for(const e of t)yield qM(e);yield*Hf(t)}function*ZR(t){for(const e of t)yield qM(e)}function*qR(t){for(let e=0,n=t.length;e<n;++e)e in t&&(yield ou(e,iA(t,e),"observablehq--index"));for(const e in t)!GM(e)&&u_(t,e)&&(yield ou(e,iA(t,e),"observablehq--key"));for(const e of Ud(t))yield ou(O0(e),iA(t,e),"observablehq--symbol")}function*YR(t){let e=0;for(const n=t.size;e<n;++e)yield ou(e,t.get(e),!0)}function*XR(t){for(const n in HR(t))yield ou(n,iA(t,n),"observablehq--key");for(const n of Ud(t))yield ou(O0(n),iA(t,n),"observablehq--symbol");const e=Bx(t);e&&e!==WM&&(yield ZM(e))}function*Hf(t){for(const n in t)u_(t,n)&&(yield ou(n,iA(t,n),"observablehq--key"));for(const n of Ud(t))yield ou(O0(n),iA(t,n),"observablehq--symbol");const e=Bx(t);e&&e!==WM&&(yield ZM(e))}function*KR(t){for(const[e,n]of t)yield ou(e,n,"observablehq--key")}function ZM(t){const e=document.createElement("div"),n=e.appendChild(document.createElement("span"));return e.className="observablehq--field",n.className="observablehq--prototype-key",n.textContent="  <prototype>",e.appendChild(document.createTextNode(": ")),e.appendChild(Wo(t,void 0,void 0,void 0,!0)),e}function ou(t,e,n){const i=document.createElement("div"),r=i.appendChild(document.createElement("span"));return i.className="observablehq--field",r.className=n,r.textContent=`  ${t}`,i.appendChild(document.createTextNode(": ")),i.appendChild(Wo(e)),i}function JR(t,e){const n=document.createElement("div");return n.className="observablehq--field",n.appendChild(document.createTextNode("  ")),n.appendChild(Wo(t)),n.appendChild(document.createTextNode(" => ")),n.appendChild(Wo(e)),n}function qM(t){const e=document.createElement("div");return e.className="observablehq--field",e.appendChild(document.createTextNode("  ")),e.appendChild(Wo(t)),e}function j3(t){const e=window.getSelection();return e.type==="Range"&&(e.containsNode(t,!0)||e.anchorNode.isSelfOrDescendant(t)||e.focusNode.isSelfOrDescendant(t))}function Rx(t,e,n,i){let r=jM(t),A,d,l,S;if(t instanceof Map?t instanceof t.constructor?(A=`Map(${t.size})`,d=eO):(A="Map()",d=Wf):t instanceof Set?t instanceof t.constructor?(A=`Set(${t.size})`,d=tO):(A="Set()",d=Wf):r?(A=`${t.constructor.name}(${t.length})`,d=rO):(S=HM(t))?(A=`Immutable.${S.name}${S.name==="Record"?"":`(${t.size})`}`,r=S.arrayish,d=S.arrayish?iO:S.setish?nO:sO):(A=U2(t),d=Wf),e){const V=document.createElement("span");return V.className="observablehq--shallow",n&&V.appendChild(yl(n)),V.appendChild(document.createTextNode(A)),V.addEventListener("mouseup",function($){j3(V)||($.stopPropagation(),fm(V,Rx(t)))}),V}const k=document.createElement("span");k.className="observablehq--collapsed",n&&k.appendChild(yl(n));const U=k.appendChild(document.createElement("a"));U.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M7 4L1 8V0z' fill='currentColor' />
  </svg>`,U.appendChild(document.createTextNode(`${A}${r?" [":" {"}`)),k.addEventListener("mouseup",function(V){j3(k)||(V.stopPropagation(),fm(k,$M(t,null,n,i)))},!0),d=d(t);for(let V=0;!(l=d.next()).done&&V<20;++V)V>0&&k.appendChild(document.createTextNode(", ")),k.appendChild(l.value);return l.done||k.appendChild(document.createTextNode(", …")),k.appendChild(document.createTextNode(r?"]":"}")),k}function*eO(t){for(const[e,n]of t)yield oO(e,n);yield*Wf(t)}function*tO(t){for(const e of t)yield Wo(e,!0);yield*Wf(t)}function*nO(t){for(const e of t)yield Wo(e,!0)}function*iO(t){let e=-1,n=0;for(const i=t.size;n<i;++n)n>e+1&&(yield hm(n-e-1)),yield Wo(t.get(n),!0),e=n;n>e+1&&(yield hm(n-e-1))}function*rO(t){let e=-1,n=0;for(const i=t.length;n<i;++n)n in t&&(n>e+1&&(yield hm(n-e-1)),yield Wo(iA(t,n),!0),e=n);n>e+1&&(yield hm(n-e-1));for(const i in t)!GM(i)&&u_(t,i)&&(yield dd(i,iA(t,i),"observablehq--key"));for(const i of Ud(t))yield dd(O0(i),iA(t,i),"observablehq--symbol")}function*Wf(t){for(const e in t)u_(t,e)&&(yield dd(e,iA(t,e),"observablehq--key"));for(const e of Ud(t))yield dd(O0(e),iA(t,e),"observablehq--symbol")}function*sO(t){for(const[e,n]of t)yield dd(e,n,"observablehq--key")}function hm(t){const e=document.createElement("span");return e.className="observablehq--empty",e.textContent=t===1?"empty":`empty × ${t}`,e}function dd(t,e,n){const i=document.createDocumentFragment(),r=i.appendChild(document.createElement("span"));return r.className=n,r.textContent=t,i.appendChild(document.createTextNode(": ")),i.appendChild(Wo(e,!0)),i}function oO(t,e){const n=document.createDocumentFragment();return n.appendChild(Wo(t,!0)),n.appendChild(document.createTextNode(" => ")),n.appendChild(Wo(e,!0)),n}function aO(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return typeof e=="function"?e(t):e;const n=t.getUTCHours(),i=t.getUTCMinutes(),r=t.getUTCSeconds(),A=t.getUTCMilliseconds();return`${AO(t.getUTCFullYear())}-${tu(t.getUTCMonth()+1,2)}-${tu(t.getUTCDate(),2)}${n||i||r||A?`T${tu(n,2)}:${tu(i,2)}${r||A?`:${tu(r,2)}${A?`.${tu(A,3)}`:""}`:""}Z`:""}`}function AO(t){return t<0?`-${tu(-t,6)}`:t>9999?`+${tu(t,6)}`:tu(t,4)}function tu(t,e){return`${t}`.padStart(e,"0")}function lO(t){return aO(t,"Invalid Date")}var uO=Error.prototype.toString;function cO(t){return t.stack||uO.call(t)}var hO=RegExp.prototype.toString;function fO(t){return hO.call(t)}const $1=20;function dO(t,e,n,i){if(e===!1){if(Q3(t,/["\n]/g)<=Q3(t,/`|\${/g)){const k=document.createElement("span");i&&k.appendChild(yl(i));const U=k.appendChild(document.createElement("span"));return U.className="observablehq--string",U.textContent=JSON.stringify(t),k}const d=t.split(`
`);if(d.length>$1&&!n){const k=document.createElement("div");i&&k.appendChild(yl(i));const U=k.appendChild(document.createElement("span"));U.className="observablehq--string",U.textContent="`"+G3(d.slice(0,$1).join(`
`));const V=k.appendChild(document.createElement("span")),$=d.length-$1;return V.textContent=`Show ${$} truncated line${$>1?"s":""}`,V.className="observablehq--string-expand",V.addEventListener("mouseup",function(X){X.stopPropagation(),fm(k,Wo(t,e,!0,i))}),k}const l=document.createElement("span");i&&l.appendChild(yl(i));const S=l.appendChild(document.createElement("span"));return S.className=`observablehq--string${n?" observablehq--expanded":""}`,S.textContent="`"+G3(t)+"`",l}const r=document.createElement("span");i&&r.appendChild(yl(i));const A=r.appendChild(document.createElement("span"));return A.className="observablehq--string",A.textContent=JSON.stringify(t.length>100?`${t.slice(0,50)}…${t.slice(-49)}`:t),r}function G3(t){return t.replace(/[\\`\x00-\x09\x0b-\x19]|\${/g,pO)}function pO(t){var e=t.charCodeAt(0);switch(e){case 8:return"\\b";case 9:return"\\t";case 11:return"\\v";case 12:return"\\f";case 13:return"\\r"}return e<16?"\\x0"+e.toString(16):e<32?"\\x"+e.toString(16):"\\"+t}function Q3(t,e){for(var n=0;e.exec(t);)++n;return n}var gO=Function.prototype.toString,mO={prefix:"async ƒ"},_O={prefix:"async ƒ*"},H3={prefix:"class"},yO={prefix:"ƒ"},vO={prefix:"ƒ*"};function xO(t,e){var n,i,r=gO.call(t);switch(t.constructor&&t.constructor.name){case"AsyncFunction":n=mO;break;case"AsyncGeneratorFunction":n=_O;break;case"GeneratorFunction":n=vO;break;default:n=/^class\b/.test(r)?H3:yO;break}return n===H3?pf(n,"",e):(i=/^(?:async\s*)?(\w+)\s*=>/.exec(r))?pf(n,"("+i[1]+")",e):(i=/^(?:async\s*)?\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(r))?pf(n,i[1]?"("+i[1].replace(/\s*,\s*/g,", ")+")":"()",e):(i=/^(?:async\s*)?function(?:\s*\*)?(?:\s*\w+)?\s*\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(r))?pf(n,i[1]?"("+i[1].replace(/\s*,\s*/g,", ")+")":"()",e):pf(n,"(…)",e)}function pf(t,e,n){var i=document.createElement("span");i.className="observablehq--function",n&&i.appendChild(yl(n));var r=i.appendChild(document.createElement("span"));return r.className="observablehq--keyword",r.textContent=t.prefix,i.appendChild(document.createTextNode(e)),i}const{prototype:{toString:wO}}=Object;function Wo(t,e,n,i,r){let A=typeof t;switch(A){case"boolean":case"undefined":{t+="";break}case"number":{t=t===0&&1/t<0?"-0":t+"";break}case"bigint":{t=t+"n";break}case"symbol":{t=O0(t);break}case"function":return xO(t,i);case"string":return dO(t,e,n,i);default:{if(t===null){A=null,t="null";break}if(t instanceof Date){A="date",t=lO(t);break}if(t===QM){A="forbidden",t="[forbidden]";break}switch(wO.call(t)){case"[object RegExp]":{A="regexp",t=fO(t);break}case"[object Error]":case"[object DOMException]":{A="error",t=cO(t);break}default:return(n?$M:Rx)(t,e,i,r)}break}}const d=document.createElement("span");i&&d.appendChild(yl(i));const l=d.appendChild(document.createElement("span"));return l.className=`observablehq--${A}`,l.textContent=t,d}function fm(t,e){t.classList.contains("observablehq--inspect")&&e.classList.add("observablehq--inspect"),t.parentNode.replaceChild(e,t),cm(e,"load")}const bO=/\s+\(\d+:\d+\)$/m;class V2{constructor(e){if(!e)throw new Error("invalid node");this._node=e,e.classList.add("observablehq")}pending(){const{_node:e}=this;e.classList.remove("observablehq--error"),e.classList.add("observablehq--running")}fulfilled(e,n){const{_node:i}=this;if((!EO(e)||e.parentNode&&e.parentNode!==i)&&(e=Wo(e,!1,i.firstChild&&i.firstChild.classList&&i.firstChild.classList.contains("observablehq--expanded"),n),e.classList.add("observablehq--inspect")),i.classList.remove("observablehq--running","observablehq--error"),i.firstChild!==e)if(i.firstChild){for(;i.lastChild!==i.firstChild;)i.removeChild(i.lastChild);i.replaceChild(e,i.firstChild)}else i.appendChild(e);cm(i,"update")}rejected(e,n){const{_node:i}=this;for(i.classList.remove("observablehq--running"),i.classList.add("observablehq--error");i.lastChild;)i.removeChild(i.lastChild);var r=document.createElement("div");r.className="observablehq--inspect",n&&r.appendChild(yl(n)),r.appendChild(document.createTextNode((e+"").replace(bO,""))),i.appendChild(r),cm(i,"error",{error:e})}}V2.into=function(t){if(typeof t=="string"&&(t=document.querySelector(t),t==null))throw new Error("container not found");return function(){return new V2(t.appendChild(document.createElement("div")))}};function EO(t){return(t instanceof Element||t instanceof Text)&&t instanceof t.constructor}const TO="modulepreload",SO=function(t){return"/"+t},W3={},pd=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(A=>{if(A=SO(A),A in W3)return;W3[A]=!0;const d=A.endsWith(".css"),l=d?'[rel="stylesheet"]':"";if(!!i)for(let U=r.length-1;U>=0;U--){const V=r[U];if(V.href===A&&(!d||V.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${A}"]${l}`))return;const k=document.createElement("link");if(k.rel=d?"stylesheet":TO,d||(k.as="script",k.crossOrigin=""),k.href=A,document.head.appendChild(k),d)return new Promise((U,V)=>{k.addEventListener("load",U),k.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${A}`)))})})).then(()=>e()).catch(A=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=A,window.dispatchEvent(d),!d.defaultPrevented)throw A})};var $3={},Z1={},q1=34,gf=10,Y1=13;function YM(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function CO(t,e){var n=YM(t);return function(i,r){return e(n(i),r,t)}}function Z3(t){var e=Object.create(null),n=[];return t.forEach(function(i){for(var r in i)r in e||n.push(e[r]=r)}),n}function zo(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function PO(t){return t<0?"-"+zo(-t,6):t>9999?"+"+zo(t,6):zo(t,4)}function MO(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),i=t.getUTCSeconds(),r=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":PO(t.getUTCFullYear())+"-"+zo(t.getUTCMonth()+1,2)+"-"+zo(t.getUTCDate(),2)+(r?"T"+zo(e,2)+":"+zo(n,2)+":"+zo(i,2)+"."+zo(r,3)+"Z":i?"T"+zo(e,2)+":"+zo(n,2)+":"+zo(i,2)+"Z":n||e?"T"+zo(e,2)+":"+zo(n,2)+"Z":"")}function XM(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function i(V,$){var X,ee,ue=r(V,function(we,ie){if(X)return X(we,ie-1);ee=we,X=$?CO(we,$):YM(we)});return ue.columns=ee||[],ue}function r(V,$){var X=[],ee=V.length,ue=0,we=0,ie,Ae=ee<=0,ce=!1;V.charCodeAt(ee-1)===gf&&--ee,V.charCodeAt(ee-1)===Y1&&--ee;function Ce(){if(Ae)return Z1;if(ce)return ce=!1,$3;var qe,tt=ue,lt;if(V.charCodeAt(tt)===q1){for(;ue++<ee&&V.charCodeAt(ue)!==q1||V.charCodeAt(++ue)===q1;);return(qe=ue)>=ee?Ae=!0:(lt=V.charCodeAt(ue++))===gf?ce=!0:lt===Y1&&(ce=!0,V.charCodeAt(ue)===gf&&++ue),V.slice(tt+1,qe-1).replace(/""/g,'"')}for(;ue<ee;){if((lt=V.charCodeAt(qe=ue++))===gf)ce=!0;else if(lt===Y1)ce=!0,V.charCodeAt(ue)===gf&&++ue;else if(lt!==n)continue;return V.slice(tt,qe)}return Ae=!0,V.slice(tt,ee)}for(;(ie=Ce())!==Z1;){for(var Ne=[];ie!==$3&&ie!==Z1;)Ne.push(ie),ie=Ce();$&&(Ne=$(Ne,we++))==null||X.push(Ne)}return X}function A(V,$){return V.map(function(X){return $.map(function(ee){return U(X[ee])}).join(t)})}function d(V,$){return $==null&&($=Z3(V)),[$.map(U).join(t)].concat(A(V,$)).join(`
`)}function l(V,$){return $==null&&($=Z3(V)),A(V,$).join(`
`)}function S(V){return V.map(k).join(`
`)}function k(V){return V.map(U).join(t)}function U(V){return V==null?"":V instanceof Date?MO(V):e.test(V+="")?'"'+V.replace(/"/g,'""')+'"':V}return{parse:i,parseRows:r,format:d,formatBody:l,formatRows:S,formatRow:k,formatValue:U}}var KM=XM(","),IO=KM.parse,kO=KM.parseRows,JM=XM("	"),LO=JM.parse,DO=JM.parseRows;function BO(t){for(var e in t){var n=t[e].trim(),i,r;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(i=+n))n=i;else if(r=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))RO&&r[4]&&!r[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;t[e]=n}return t}const RO=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function lr(t,e,n){return{resolve(i=n){return`${t}@${e}/${i}`}}}const OO=lr("d3","7.8.5","dist/d3.min.js"),zO=lr("@observablehq/inputs","0.10.6","dist/inputs.min.js"),FO=lr("@observablehq/plot","0.6.10","dist/plot.umd.min.js"),NO=lr("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),X1=lr("@observablehq/highlight.js","2.0.0","highlight.min.js"),q3=lr("@observablehq/katex","0.11.1","dist/katex.min.js"),UO=lr("lodash","4.17.21","lodash.min.js"),VO=lr("htl","0.3.1","dist/htl.min.js"),jO=lr("jszip","3.10.1","dist/jszip.min.js"),GO=lr("marked","0.3.12","marked.min.js"),Y3=lr("sql.js","1.8.0","dist/sql-wasm.js"),QO=lr("vega","5.22.1","build/vega.min.js"),HO=lr("vega-lite","5.6.0","build/vega-lite.min.js"),WO=lr("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),j2=lr("apache-arrow","4.0.1","Arrow.es2015.min.js"),$O=lr("apache-arrow","9.0.0","+esm"),eI=lr("apache-arrow","11.0.0","+esm"),ZO=lr("arquero","4.8.8","dist/arquero.min.js"),qO=lr("topojson-client","3.1.0","dist/topojson-client.min.js"),YO=lr("exceljs","4.3.0","dist/exceljs.min.js"),XO=lr("mermaid","9.2.2","dist/mermaid.min.js"),X3=lr("leaflet","1.9.3","dist/leaflet.js"),mf=lr("@duckdb/duckdb-wasm","1.24.0","+esm"),Hp=new Map,Vd=[],G2=Vd.map,KO=Vd.some,JO=Vd.hasOwnProperty,ez=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,tz=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,K3=/(?:\.[^/]*|\/)$/;class v0 extends Error{constructor(e){super(e)}}v0.prototype.name=v0.name;function J3(t){const e=ez.exec(t);return e&&{name:e[1],version:e[2],path:e[3]}}function tI(t="https://cdn.jsdelivr.net/npm/",e=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(t))throw new Error("origin lacks trailing slash");function n(r){for(const A of e){let d=r[A];if(typeof d=="string")return d.startsWith("./")&&(d=d.slice(2)),K3.test(d)?d:`${d}.js`}}function i(r){const A=`${t}${r.name}${r.version?`@${r.version}`:""}/package.json`;let d=Hp.get(A);return d||Hp.set(A,d=fetch(A).then(l=>{if(!l.ok)throw new v0("unable to load package.json");return l.redirected&&!Hp.has(l.url)&&Hp.set(l.url,d),l.json()})),d}return async function(A,d){if(A.startsWith(t)&&(A=A.substring(t.length)),/^(\w+:)|\/\//i.test(A))return A;if(/^[.]{0,2}\//i.test(A))return new URL(A,d??location).href;if(!A.length||/^[\s._]/.test(A)||/\s$/.test(A))throw new v0("illegal name");const l=J3(A);if(!l)return`${t}${A}`;if(!l.version&&d!=null&&d.startsWith(t)){const k=await i(J3(d.substring(t.length)));l.version=k.dependencies&&k.dependencies[l.name]||k.peerDependencies&&k.peerDependencies[l.name]}if(l.path&&!K3.test(l.path)&&(l.path+=".js"),l.path&&l.version&&tz.test(l.version))return`${t}${l.name}@${l.version}/${l.path}`;const S=await i(l);return`${t}${S.name}@${S.version}/${l.path||n(S)||"index.js"}`}}var nz=c_(tI());function c_(t){const e=new Map,n=r(null);function i(l){if(typeof l!="string")return l;let S=e.get(l);return S||e.set(l,S=new Promise((k,U)=>{const V=document.createElement("script");V.onload=()=>{try{k(Vd.pop()(r(l)))}catch{U(new v0("invalid module"))}V.remove()},V.onerror=()=>{U(new v0("unable to load module")),V.remove()},V.async=!0,V.src=l,window.define=nI,document.head.appendChild(V)})),S}function r(l){return S=>Promise.resolve(t(S,l)).then(i)}function A(l){return c_((S,k)=>S in l&&(S=l[S],k=null,typeof S!="string")?S:t(S,k))}function d(l){return arguments.length>1?Promise.all(G2.call(arguments,n)).then(iz):n(l)}return d.alias=A,d.resolve=t,d}function iz(t){const e={};for(const n of t)for(const i in n)JO.call(n,i)&&(n[i]==null?Object.defineProperty(e,i,{get:rz(n,i)}):e[i]=n[i]);return e}function rz(t,e){return()=>t[e]}function sz(t){return t=t+"",t==="exports"||t==="module"}function nI(t,e,n){const i=arguments.length;i<2?(n=t,e=[]):i<3&&(n=e,e=typeof t=="string"?[]:t),Vd.push(KO.call(e,sz)?r=>{const A={},d={exports:A};return Promise.all(G2.call(e,l=>(l=l+"",l==="exports"?A:l==="module"?d:r(l)))).then(l=>(n.apply(null,l),d.exports))}:r=>Promise.all(G2.call(e,r)).then(A=>typeof n=="function"?n.apply(null,A):n))}nI.amd={};const Yu="https://cdn.observableusercontent.com/npm/";let lc=nz;function oz(t){lc=t}function az(t){return t==null?lc:c_(t)}async function iI(t){const[e,n]=await Promise.all([t(Y3.resolve()),t.resolve(Y3.resolve("dist/"))]);return e({locateFile:i=>`${n}${i}`})}class jd{constructor(e){Object.defineProperties(this,{_db:{value:e}})}static async open(e){const[n,i]=await Promise.all([iI(lc),Promise.resolve(e).then(Q2)]);return new jd(new n.Database(i))}async query(e,n){return await lz(this._db,e,n)}async queryRow(e,n){return(await this.query(e,n))[0]||null}async explain(e,n){const i=await this.query(`EXPLAIN QUERY PLAN ${e}`,n);return Uu("pre",{className:"observablehq--inspect"},[K1(i.map(r=>r.detail).join(`
`))])}async describeTables({schema:e}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${e==null?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%' ORDER BY schema, name`,e==null?[]:[e])}async describeColumns({schema:e,table:n}={}){if(n==null)throw new Error("missing table");const i=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${e==null?"":", ?"}) ORDER BY cid`,e==null?[n]:[n,e]);if(!i.length)throw new Error(`table not found: ${n}`);return i.map(({name:r,type:A,notnull:d})=>({name:r,type:Az(A),databaseType:A,nullable:!d}))}async describe(e){const n=await(e===void 0?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[e]));if(!n.length)throw new Error("Not found");const{columns:i}=n;return Uu("table",{value:n},[Uu("thead",[Uu("tr",i.map(r=>Uu("th",[K1(r)])))]),Uu("tbody",n.map(r=>Uu("tr",i.map(A=>Uu("td",[K1(r[A])])))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(e,...n){return[e.join("?"),n]}}Object.defineProperty(jd.prototype,"dialect",{value:"sqlite"});function Az(t){switch(t){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";case"DATE":case"DATETIME":return"string";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(t)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(t)?"number":"other"}}function Q2(t){return typeof t=="string"?fetch(t).then(Q2):t instanceof Response||t instanceof Blob?t.arrayBuffer().then(Q2):t instanceof ArrayBuffer?new Uint8Array(t):t}async function lz(t,e,n){const[i]=await t.exec(e,n);if(!i)return[];const{columns:r,values:A}=i,d=A.map(l=>Object.fromEntries(l.map((S,k)=>[r[k],S])));return d.columns=r,d}function Uu(t,e,n){arguments.length===2&&(n=e,e=void 0);const i=document.createElement(t);if(e!==void 0)for(const r in e)i[r]=e[r];if(n!==void 0)for(const r of n)i.appendChild(r);return i}function K1(t){return document.createTextNode(t)}function J1(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function uz(t,e=J1){let n,i=!1;if(e.length===1){let r;for(const A of t){const d=e(A);(i?J1(d,r)>0:J1(d,d)===0)&&(n=A,r=d,i=!0)}}else for(const r of t)(i?e(r,n)>0:e(r,r)===0)&&(n=r,i=!0);return n}function cz(t){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(t).reverse()}function Ox(t){return t&&typeof t.toArrowBuffer=="function"}function dm(t){return t&&typeof t.getChild=="function"&&typeof t.toArray=="function"&&t.schema&&Array.isArray(t.schema.fields)}function hz(t){return t.schema.fields.map(fz)}function fz(t){return{name:t.name,type:dz(t.type),nullable:t.nullable,databaseType:String(t.type)}}function dz(t){switch(t.typeId){case 2:return"integer";case 3:case 7:return"number";case 4:case 15:return"buffer";case 5:return"string";case 6:return"boolean";case 8:case 9:case 10:return"date";case 12:case 16:return"array";case 13:case 14:return"object";case 11:case 17:default:return"other"}}async function zx(){return await pd(()=>import(`${Yu}${eI.resolve()}`),[])}let ey;class Gd{constructor(e){Object.defineProperties(this,{_db:{value:e}})}async queryStream(e,n){const i=await this._db.connect();let r,A;try{if((n==null?void 0:n.length)>0?r=await(await i.prepare(e)).send(...n):r=await i.send(e),A=await r.next(),A.done)throw new Error("missing first batch")}catch(d){throw await i.close(),d}return{schema:hz(A.value),async*readRows(){try{for(;!A.done;)yield A.value.toArray(),A=await r.next()}finally{await i.close()}}}}async query(e,n){const i=await this.queryStream(e,n),r=[];for await(const A of i.readRows())for(const d of A)r.push(d);return r.schema=i.schema,r}async queryRow(e,n){const r=(await this.queryStream(e,n)).readRows();try{const{done:A,value:d}=await r.next();return A||!d.length?null:d[0]}finally{await r.return()}}async sql(e,...n){return await this.query(e.join("?"),n)}queryTag(e,...n){return[e.join("?"),n]}escape(e){return`"${e}"`}async describeTables(){return(await this.query("SHOW TABLES")).map(({name:n})=>({name:n}))}async describeColumns({table:e}={}){return(await this.query(`DESCRIBE ${this.escape(e)}`)).map(({column_name:i,column_type:r,null:A})=>({name:i,type:yz(r),nullable:A!=="NO",databaseType:r}))}static async of(e={},n={}){var r,A;const i=await _z();return((r=n.query)==null?void 0:r.castTimestampToDate)===void 0&&(n={...n,query:{...n.query,castTimestampToDate:!0}}),((A=n.query)==null?void 0:A.castBigIntToDouble)===void 0&&(n={...n,query:{...n.query,castBigIntToDouble:!0}}),await i.open(n),await Promise.all(Object.entries(e).map(async([d,l])=>{if(l instanceof es)await eT(i,d,l);else if(dm(l))await pm(i,d,l);else if(Array.isArray(l))await tT(i,d,l);else if(Ox(l))await gz(i,d,l);else if("data"in l){const{data:S,...k}=l;dm(S)?await pm(i,d,S,k):await tT(i,d,S,k)}else if("file"in l){const{file:S,...k}=l;await eT(i,d,S,k)}else throw new Error(`invalid source: ${l}`)})),new Gd(i)}}Object.defineProperty(Gd.prototype,"dialect",{value:"duckdb"});async function eT(t,e,n,i){const r=await n.url();if(r.startsWith("blob:")){const d=await n.arrayBuffer();await t.registerFileBuffer(n.name,new Uint8Array(d))}else await t.registerFileURL(n.name,r,4);const A=await t.connect();try{switch(n.mimeType){case"text/csv":case"text/tab-separated-values":return await A.insertCSVFromPath(n.name,{name:e,schema:"main",...i}).catch(async d=>{if(d.toString().includes("Could not convert"))return await pz(A,n,e);throw d});case"application/json":return await A.insertJSONFromPath(n.name,{name:e,schema:"main",...i});default:if(/\.arrow$/i.test(n.name)){const d=new Uint8Array(await n.arrayBuffer());return await A.insertArrowFromIPCStream(d,{name:e,schema:"main",...i})}if(/\.parquet$/i.test(n.name))return await A.query(`CREATE VIEW '${e}' AS SELECT * FROM parquet_scan('${n.name}')`);throw new Error(`unknown file type: ${n.mimeType}`)}}finally{await A.close()}}async function pz(t,e,n){return await(await t.prepare(`CREATE TABLE '${n}' AS SELECT * FROM read_csv_auto(?, ALL_VARCHAR=TRUE)`)).send(e.name)}async function pm(t,e,n,i){const r=await t.connect();try{await r.insertArrowTable(n,{name:e,schema:"main",...i})}finally{await r.close()}}async function gz(t,e,n){const r=(await zx()).tableFromIPC(n.toArrowBuffer());return await pm(t,e,r)}async function tT(t,e,n,i){const A=(await zx()).tableFromJSON(n);return await pm(t,e,A,i)}async function mz(){const t=await pd(()=>import(`${Yu}${mf.resolve()}`),[]),e=await t.selectBundle({mvp:{mainModule:`${Yu}${mf.resolve("dist/duckdb-mvp.wasm")}`,mainWorker:`${Yu}${mf.resolve("dist/duckdb-browser-mvp.worker.js")}`},eh:{mainModule:`${Yu}${mf.resolve("dist/duckdb-eh.wasm")}`,mainWorker:`${Yu}${mf.resolve("dist/duckdb-browser-eh.worker.js")}`}}),n=new t.ConsoleLogger;return{module:t,bundle:e,logger:n}}async function _z(){ey===void 0&&(ey=mz());const{module:t,bundle:e,logger:n}=await ey,i=await t.createWorker(e.mainWorker),r=new t.AsyncDuckDB(n,i);return await r.instantiate(e.mainModule),r}function yz(t){switch(t){case"BIGINT":case"HUGEINT":case"UBIGINT":return"bigint";case"DOUBLE":case"REAL":case"FLOAT":return"number";case"INTEGER":case"SMALLINT":case"TINYINT":case"USMALLINT":case"UINTEGER":case"UTINYINT":return"integer";case"BOOLEAN":return"boolean";case"DATE":case"TIMESTAMP":case"TIMESTAMP WITH TIME ZONE":return"date";case"VARCHAR":case"UUID":return"string";default:return/^DECIMAL\(/.test(t)?"integer":"other"}}const Fx=20;function vz(t,e){return t&&(typeof t.sql=="function"||typeof t.queryTag=="function"&&(typeof t.query=="function"||typeof t.queryStream=="function"))&&(e!=="table"||typeof t.describeColumns=="function")&&t!==uI}function h_(t){return Array.isArray(t)&&(rI(t.schema)||sI(t.columns)||xz(t)||aI(t)||AI(t))||lI(t)}function xz(t){const e=Math.min(Fx,t.length);for(let n=0;n<e;++n){const i=t[n];if(i===null||typeof i!="object")return!1}return e>0&&wz(t[0])}function wz(t){for(const e in t)return!0;return!1}function rI(t){return Array.isArray(t)&&t.every(bz)}function sI(t){return Array.isArray(t)&&t.every(e=>typeof e=="string")}function bz(t){return t&&typeof t.name=="string"&&typeof t.type=="string"}function oI(t){return lI(t)||aI(t)||AI(t)}function aI(t){const e=Math.min(Fx,t.length);if(!(e>0))return!1;let n,i=!1;for(let r=0;r<e;++r){const A=t[r];if(A==null)continue;const d=typeof A;if(n===void 0)switch(d){case"number":case"boolean":case"string":case"bigint":n=d;break;default:return!1}else if(d!==n)return!1;i=!0}return i}function AI(t){const e=Math.min(Fx,t.length);if(!(e>0))return!1;let n=!1;for(let i=0;i<e;++i){const r=t[i];if(r!=null){if(!(r instanceof Date))return!1;n=!0}}return n}function lI(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}const uI=Object.assign(async(t,e,n,i)=>{if(t=await Ez(await t,i),vz(t))return nT(t,Mz(e,t),n);if(h_(t))return Zz(t,e);throw t?new Error("invalid data source"):new Error("missing data source")},{sql(t,e,n){return async function(){return nT(await Tz(await t,n),arguments,e)}}});function cI(t){const e=new WeakMap;return(n,i)=>{if(!n||typeof n!="object")throw new Error("invalid data source");let r=e.get(n);return(!r||h_(n)&&n.length!==r._numRows)&&(r=t(n,i),r._numRows=n.length,e.set(n,r)),r}}const Ez=cI(async(t,e)=>{if(t instanceof es){switch(t.mimeType){case"text/csv":return t.csv();case"text/tab-separated-values":return t.tsv();case"application/json":return t.json();case"application/x-sqlite3":return t.sqlite()}if(/\.(arrow|parquet)$/i.test(t.name))return Yh(t,e);throw new Error(`unsupported file type: ${t.mimeType}`)}return dm(t)||Ox(t)?Yh(t,e):h_(t)&&oI(t)?Array.from(t,n=>({value:n})):t}),Tz=cI(async(t,e)=>{if(t instanceof es){switch(t.mimeType){case"text/csv":case"text/tab-separated-values":case"application/json":return Yh(t,e);case"application/x-sqlite3":return t.sqlite()}if(/\.(arrow|parquet)$/i.test(t.name))return Yh(t,e);throw new Error(`unsupported file type: ${t.mimeType}`)}return h_(t)?Yh(await Sz(t,e),e):dm(t)||Ox(t)?Yh(t,e):t});async function Sz(t,e){const n=await zx();return oI(t)?n.tableFromArrays({[e]:t}):n.tableFromJSON(t)}function Yh(t,e=t instanceof es?Cz(t):"__table"){return Gd.of({[e]:t})}function Cz(t){return t.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"")}async function nT(t,e,n){if(!t)throw new Error("missing data source");if(typeof t.queryTag=="function"){const i=new AbortController,r={signal:i.signal};if(n.then(()=>i.abort("invalidated")),typeof t.queryStream=="function")return Pz(t.queryStream(...t.queryTag.apply(t,e),r));if(typeof t.query=="function")return t.query(...t.queryTag.apply(t,e),r)}if(typeof t.sql=="function")return t.sql.apply(t,e);throw new Error("source does not implement query, queryStream, or sql")}async function*Pz(t){let e=performance.now();const n=await t,i=[];i.done=!1,i.error=null,i.schema=n.schema;try{for await(const r of n.readRows()){performance.now()-e>150&&i.length>0&&(yield i,e=performance.now());for(const A of r)i.push(A)}i.done=!0,yield i}catch(r){i.error=r,yield i}}function Mz(t,e){var V;const n=typeof e.escape=="function"?e.escape:$=>$,{select:i,from:r,filter:A,sort:d,slice:l}=t;if(!r.table)throw new Error("missing from table");if(i.columns&&i.columns.length===0)throw new Error("at least one column must be selected");const S=new Map((V=t.names)==null?void 0:V.map(({column:$,name:X})=>[$,X])),U=[[`SELECT ${i.columns?i.columns.map($=>{const X=S.get($);return X?`${n($)} AS ${n(X)}`:n($)}).join(", "):"*"} FROM ${Iz(r.table,n)}`]];for(let $=0;$<A.length;++$)rr($?`
AND `:`
WHERE `,U),kz(A[$],U,n);for(let $=0;$<d.length;++$)rr($?", ":`
ORDER BY `,U),iT(d[$],U,n);if(e.dialect==="mssql"||e.dialect==="oracle"){if(l.to!==null||l.from!==null){if(!d.length){if(!i.columns)throw new Error("at least one column must be explicitly specified. Received '*'.");rr(`
ORDER BY `,U),iT({column:i.columns[0],direction:"ASC"},U,n)}rr(`
OFFSET ${l.from||0} ROWS`,U),rr(`
FETCH NEXT ${l.to!==null?l.to-(l.from||0):1e9} ROWS ONLY`,U)}}else(l.to!==null||l.from!==null)&&rr(`
LIMIT ${l.to!==null?l.to-(l.from||0):1e9}`,U),l.from!==null&&rr(` OFFSET ${l.from}`,U);return U}function Iz(t,e){if(typeof t=="object"){let n="";return t.database!=null&&(n+=e(t.database)+"."),t.schema!=null&&(n+=e(t.schema)+"."),n+=e(t.table),n}else return e(t)}function rr(t,e){const n=e[0];n[n.length-1]+=t}function iT({column:t,direction:e},n,i){rr(`${i(t)} ${e.toUpperCase()}`,n)}function kz({type:t,operands:e},n,i){if(e.length<1)throw new Error("Invalid operand length");if(e.length===1||t==="v"||t==="nv")switch(Sh(e[0],n,i),t){case"n":case"nv":rr(" IS NULL",n);return;case"nn":case"v":rr(" IS NOT NULL",n);return;default:throw new Error("Invalid filter operation")}if(e.length===2&&!["in","nin"].includes(t))if(["c","nc"].includes(t)){switch(Sh(e[0],n,i),t){case"c":rr(" LIKE ",n);break;case"nc":rr(" NOT LIKE ",n);break}Sh(Dz(e[1]),n,i);return}else{switch(Sh(e[0],n,i),t){case"eq":rr(" = ",n);break;case"ne":rr(" <> ",n);break;case"gt":rr(" > ",n);break;case"lt":rr(" < ",n);break;case"gte":rr(" >= ",n);break;case"lte":rr(" <= ",n);break;default:throw new Error("Invalid filter operation")}Sh(e[1],n,i);return}switch(Sh(e[0],n,i),t){case"in":rr(" IN (",n);break;case"nin":rr(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}Lz(e.slice(1),n),rr(")",n)}function Sh(t,e,n){t.type==="column"?rr(n(t.value),e):(e.push(t.value),e[0].push(""))}function Lz(t,e){let n=!0;for(const i of t)n?n=!1:rr(",",e),e.push(i.value),e[0].push("")}function Dz(t){return{...t,value:`%${t.value}%`}}function hI(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))}function Bz(t,e){return hI(t,e)||(t<e?-1:t>e?1:0)}function Rz(t,e){return hI(t,e)||(t>e?-1:t<e?1:0)}const Oz=t=>typeof t=="number"&&!Number.isNaN(t),zz=t=>Number.isInteger(t)&&!Number.isNaN(t),Fz=t=>typeof t=="string",Nz=t=>typeof t=="boolean",Uz=t=>typeof t=="bigint",Vz=t=>t instanceof Date&&!isNaN(t),jz=t=>t instanceof ArrayBuffer,Gz=t=>Array.isArray(t),Qz=t=>typeof t=="object"&&t!==null,Hz=t=>t!=null;function rT(t){switch(t){case"string":return Fz;case"bigint":return Uz;case"boolean":return Nz;case"number":return Oz;case"integer":return zz;case"date":return Vz;case"buffer":return jz;case"array":return Gz;case"object":return Qz;case"other":default:return Hz}}const fI=/^(([-+]\d{2})?\d{4}(-\d{2}(-\d{2}))|(\d{1,2})\/(\d{1,2})\/(\d{2,4}))([T ]\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function Wz(t,e){switch(e){case"string":return typeof t=="string"||t==null?t:String(t);case"boolean":if(typeof t=="string"){const n=t.trim().toLowerCase();return n==="true"?!0:n==="false"?!1:null}return typeof t=="boolean"||t==null?t:!!t;case"bigint":return typeof t=="bigint"||t==null?t:Number.isInteger(typeof t=="string"&&!t.trim()?NaN:+t)?BigInt(t):void 0;case"integer":case"number":return typeof t=="number"?t:t==null||typeof t=="string"&&!t.trim()?NaN:Number(t);case"date":{if(t instanceof Date||t==null)return t;if(typeof t=="number")return new Date(t);const n=String(t).trim();return typeof t=="string"&&!n?null:new Date(fI.test(n)?n:NaN)}case"array":case"object":case"buffer":case"other":return t;default:throw new Error(`Unable to coerce to type: ${e}`)}}function $z(t){const{columns:e}=t;let{schema:n}=t;return rI(n)?{schema:n,inferred:!1}:(n=dI(t,sI(e)?e:void 0),{schema:n,inferred:!0})}function sT(t,e){const n=t;let{schema:i,inferred:r}=$z(t);const A=new Map(i.map(({name:d,type:l})=>[d,l]));if(e.types){for(const{name:d,type:l}of e.types){A.set(d,l),i===n.schema&&(i=i.slice());const S=i.findIndex(k=>k.name===d);S>-1&&(i[S]={...i[S],type:l})}t=t.map(d=>H2(d,A,i))}else r&&(t=t.map(d=>H2(d,A,i)));return{source:t,schema:i}}function oT(t,e){if(!e.names)return t;const n=new Map(e.names.map(i=>[i.column,i]));return t.map(i=>Object.fromEntries(Object.keys(i).map(r=>{const A=n.get(r);return[(A==null?void 0:A.name)??r,i[r]]})))}function Zz(t,e){const n=new Map,i=t,r=sT(t,e);t=r.source;let A=r.schema;if(e.derive){const k=[];e.derive.map(({name:V,value:$})=>{let X=[];oT(t,e).map((ee,ue)=>{let we;try{we=$(ee)}catch(ie){X.push({index:ue,error:ie}),we=void 0}k[ue]?k[ue]={...k[ue],[V]:we}:k.push({[V]:we})}),X.length&&n.set(V,X)});const U=sT(k,e);t=t.map((V,$)=>({...V,...U.source[$]})),A=[...A,...U.schema]}for(const{type:k,operands:U}of e.filter){const[{value:V}]=U,$=U.slice(1).map(({value:X})=>X);switch(k){case"v":{const[X]=$,ee=rT(X);t=t.filter(ue=>ee(ue[V]));break}case"nv":{const[X]=$,ee=rT(X);t=t.filter(ue=>!ee(ue[V]));break}case"eq":{const[X]=$;if(X instanceof Date){const ee=+X;t=t.filter(ue=>+ue[V]===ee)}else t=t.filter(ee=>ee[V]===X);break}case"ne":{const[X]=$;t=t.filter(ee=>ee[V]!==X);break}case"c":{const[X]=$;t=t.filter(ee=>typeof ee[V]=="string"&&ee[V].includes(X));break}case"nc":{const[X]=$;t=t.filter(ee=>typeof ee[V]=="string"&&!ee[V].includes(X));break}case"in":{const X=new Set($);t=t.filter(ee=>X.has(ee[V]));break}case"nin":{const X=new Set($);t=t.filter(ee=>!X.has(ee[V]));break}case"n":{t=t.filter(X=>X[V]==null);break}case"nn":{t=t.filter(X=>X[V]!=null);break}case"lt":{const[X]=$;t=t.filter(ee=>ee[V]<X);break}case"lte":{const[X]=$;t=t.filter(ee=>ee[V]<=X);break}case"gt":{const[X]=$;t=t.filter(ee=>ee[V]>X);break}case"gte":{const[X]=$;t=t.filter(ee=>ee[V]>=X);break}default:throw new Error(`unknown filter type: ${k}`)}}for(const{column:k,direction:U}of cz(e.sort)){const V=U==="desc"?Rz:Bz;t===i&&(t=t.slice()),t.sort(($,X)=>V($[k],X[k]))}let{from:d,to:l}=e.slice;d=d==null?0:Math.max(0,d),l=l==null?1/0:Math.max(0,l),(d>0||l<1/0)&&(t=t.slice(Math.max(0,d),Math.max(0,l)));let S=A.slice();if(e.select.columns){if(A){const k=new Map(A.map(U=>[U.name,U]));A=e.select.columns.map(U=>k.get(U))}t=t.map(k=>Object.fromEntries(e.select.columns.map(U=>[U,k[U]])))}if(e.names){const k=new Map(e.names.map(U=>[U.column,U]));A&&(A=A.map(U=>{const V=k.get(U.name);return{...U,...V?{name:V.name}:null}})),S&&(S=S.map(U=>{const V=k.get(U.name);return{...U,...V?{name:V.name}:null}})),t=oT(t,e)}return t!==i&&A&&(t.schema=A),t.fullSchema=S,t.errors=n,t}function H2(t,e,n){const i={};for(const r of n){const A=e.get(r.name),d=t[r.name];i[r.name]=A==="raw"?d:Wz(d,A)}return i}function qz(){return{boolean:0,integer:0,number:0,date:0,string:0,array:0,object:0,bigint:0,buffer:0,defined:0}}const Yz=["boolean","integer","number","date","bigint","array","object","buffer"];function Xz(t){const e=new Set;for(const n of t)if(n)for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.add(i);return Array.from(e)}function dI(t,e=Xz(t)){const n=[],r=t.slice(0,100);for(const A of e){const d=qz();for(const k of r){let U=k[A];if(U==null)continue;const V=typeof U;if(V!=="string")++d.defined,Array.isArray(U)?++d.array:U instanceof Date?++d.date:U instanceof ArrayBuffer?++d.buffer:V==="number"?(++d.number,Number.isInteger(U)&&++d.integer):V in d&&++d[V];else{if(U=U.trim(),!U)continue;++d.defined,++d.string,/^(true|false)$/i.test(U)?++d.boolean:U&&!isNaN(U)?(++d.number,Number.isInteger(+U)&&++d.integer):fI.test(U)&&++d.date}}const l=Math.max(1,d.defined*.9),S=uz(Yz,k=>d[k]>=l?d[k]:NaN)??(d.string>=l?"string":"other");n.push({name:A,type:S,inferred:S})}return n}class Kz{constructor(e){Object.defineProperties(this,{_:{value:e},sheetNames:{value:e.worksheets.map(n=>n.name),enumerable:!0}})}sheet(e,n){const i=typeof e=="number"?this.sheetNames[e]:this.sheetNames.includes(e+="")?e:null;if(i==null)throw new Error(`Sheet not found: ${e}`);const r=this._.getWorksheet(i);return Jz(r,n)}}function Jz(t,{range:e,headers:n}={}){let[[i,r],[A,d]]=eF(e,t);const l=n?t._rows[r++]:null;let S=new Set(["#"]);for(let U=i;U<=A;U++){const V=l?aT(l.findCell(U+1)):null;let $=V&&V+""||tF(U);for(;S.has($);)$+="_";S.add($)}S=new Array(i).concat(Array.from(S));const k=new Array(d-r+1);for(let U=r;U<=d;U++){const V=k[U-r]=Object.create(null,{"#":{value:U+1}}),$=t.getRow(U+1);if($.hasValues)for(let X=i;X<=A;X++){const ee=aT($.findCell(X+1));ee!=null&&(V[S[X+1]]=ee)}}return k.columns=S.filter(()=>!0),k}function aT(t){if(!t)return;const{value:e}=t;if(e&&typeof e=="object"&&!(e instanceof Date)){if(e.formula||e.sharedFormula)return e.result&&e.result.error?NaN:e.result;if(e.richText)return AT(e);if(e.text){let{text:n}=e;return n.richText&&(n=AT(n)),e.hyperlink&&e.hyperlink!==n?`${e.hyperlink} ${n}`:n}return e}return e}function AT(t){return t.richText.map(e=>e.text).join("")}function eF(t=":",{columnCount:e,rowCount:n}){if(t+="",!t.match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[i=0,r=0],[A=e-1,d=n-1]]=t.split(":").map(nF);return[[i,r],[A,d]]}function tF(t){let e="";t++;do e=String.fromCharCode(64+(t%26||26))+e;while(t=Math.floor((t-1)/26));return e}function nF(t){const[,e,n]=t.match(/^([A-Z]*)(\d*)$/);let i=0;if(e)for(let r=0;r<e.length;r++)i+=Math.pow(26,e.length-r-1)*(e.charCodeAt(r)-64);return[i?i-1:void 0,n?+n-1:void 0]}async function Xl(t){const e=await fetch(await t.url());if(!e.ok)throw new Error(`Unable to load file: ${t.name}`);return e}function iF(t,e){const n=new Map(e.map(({name:i,type:r})=>[i,r]));return Object.assign(t.map(i=>H2(i,n,e)),{schema:e})}async function lT(t,e,{array:n=!1,typed:i=!1}={}){const r=await t.text(),A=e==="	"?n?DO:LO:n?kO:IO;if(i==="auto"&&!n){const d=A(r);return iF(d,dI(d,d.columns))}return A(r,i&&BO)}class Nx{constructor(e,n){Object.defineProperty(this,"name",{value:e,enumerable:!0}),n!==void 0&&Object.defineProperty(this,"mimeType",{value:n+"",enumerable:!0})}async blob(){return(await Xl(this)).blob()}async arrayBuffer(){return(await Xl(this)).arrayBuffer()}async text(){return(await Xl(this)).text()}async json(){return(await Xl(this)).json()}async stream(){return(await Xl(this)).body}async csv(e){return lT(this,",",e)}async tsv(e){return lT(this,"	",e)}async image(e){const n=await this.url();return new Promise((i,r)=>{const A=new Image;new URL(n,document.baseURI).origin!==new URL(location).origin&&(A.crossOrigin="anonymous"),Object.assign(A,e),A.onload=()=>i(A),A.onerror=()=>r(new Error(`Unable to load file: ${this.name}`)),A.src=n})}async arrow({version:e=4}={}){switch(e){case 4:{const[n,i]=await Promise.all([lc(j2.resolve()),Xl(this)]);return n.Table.from(i)}case 9:{const[n,i]=await Promise.all([pd(()=>import(`${Yu}${$O.resolve()}`),[]),Xl(this)]);return n.tableFromIPC(i)}case 11:{const[n,i]=await Promise.all([pd(()=>import(`${Yu}${eI.resolve()}`),[]),Xl(this)]);return n.tableFromIPC(i)}default:throw new Error(`unsupported arrow version: ${e}`)}}async sqlite(){return jd.open(Xl(this))}async zip(){const[e,n]=await Promise.all([lc(jO.resolve()),this.arrayBuffer()]);return new oF(await e.loadAsync(n))}async xml(e="application/xml"){return new DOMParser().parseFromString(await this.text(),e)}async html(){return this.xml("text/html")}async xlsx(){const[e,n]=await Promise.all([lc(YO.resolve()),this.arrayBuffer()]);return new Kz(await new e.Workbook().xlsx.load(n))}}class es extends Nx{constructor(e,n,i){super(n,i),Object.defineProperty(this,"_url",{value:e})}async url(){return await this._url+""}}function rF(t){throw new Error(`File not found: ${t}`)}function sF(t){return Object.assign(e=>{const n=t(e+="");if(n==null)throw new Error(`File not found: ${e}`);if(typeof n=="object"&&"url"in n){const{url:i,mimeType:r}=n;return new es(i,e,r)}return new es(n,e)},{prototype:es.prototype})}class oF{constructor(e){Object.defineProperty(this,"_",{value:e}),this.filenames=Object.keys(e.files).filter(n=>!e.files[n].dir)}file(e){const n=this._.file(e+="");if(!n||n.dir)throw new Error(`file not found: ${e}`);return new aF(n)}}class aF extends Nx{constructor(e){super(e.name),Object.defineProperty(this,"_",{value:e}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}function AF(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}function lF(t,e,n){n==null&&(n=devicePixelRatio);var i=document.createElement("canvas");i.width=t*n,i.height=e*n,i.style.width=t+"px";var r=i.getContext("2d");return r.scale(n,n),r}function uF(t,e="untitled",n="Save"){const i=document.createElement("a"),r=i.appendChild(document.createElement("button"));r.textContent=n,i.download=e;async function A(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(i.href),i.removeAttribute("href"),r.textContent=n,r.disabled=!1}return i.onclick=async d=>{if(r.disabled=!0,i.href)return A();r.textContent="Saving…";try{const l=await(typeof t=="function"?t():t);r.textContent="Download",i.href=URL.createObjectURL(l)}catch{r.textContent=n}if(d.eventPhase)return A();r.disabled=!1},i}var Wp={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function cF(t,e){var n=t+="",i=n.indexOf(":"),r;i>=0&&(n=t.slice(0,i))!=="xmlns"&&(t=t.slice(i+1));var A=Wp.hasOwnProperty(n)?document.createElementNS(Wp[n],t):document.createElement(t);if(e)for(var d in e)n=d,i=n.indexOf(":"),r=e[d],i>=0&&(n=d.slice(0,i))!=="xmlns"&&(d=d.slice(i+1)),Wp.hasOwnProperty(n)?A.setAttributeNS(Wp[n],d,r):A.setAttribute(d,r);return A}function hF(t){var e=document.createElement("input");return t!=null&&(e.type=t),e}function fF(t,e,n){arguments.length===1&&(e=t,t=null);var i=document.createElement("input");return i.min=t=t==null?0:+t,i.max=e=e==null?1:+e,i.step=n==null?"any":n=+n,i.type="range",i}function dF(t){var e=document.createElement("select");return Array.prototype.forEach.call(t,function(n){var i=document.createElement("option");i.value=i.textContent=n,e.appendChild(i)}),e}function pF(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,t,e]),n.setAttribute("width",t),n.setAttribute("height",e),n}function gF(t){return document.createTextNode(t)}var mF=0;function pI(t){return new gI("O-"+(t==null?"":t+"-")+ ++mF)}function gI(t){this.id=t,this.href=new URL(`#${t}`,location)+""}gI.prototype.toString=function(){return"url("+this.href+")"};const _F=Object.freeze(Object.defineProperty({__proto__:null,canvas:AF,context2d:lF,download:uF,element:cF,input:hF,range:fF,select:dF,svg:pF,text:gF,uid:pI},Symbol.toStringTag,{value:"Module"}));function yF(t){return new Promise(function(e,n){var i=new FileReader;i.onload=function(){e(i.result)},i.onerror=n,i.readAsArrayBuffer(t)})}function vF(t){return new Promise(function(e,n){var i=new FileReader;i.onload=function(){e(i.result)},i.onerror=n,i.readAsText(t)})}function xF(t){return new Promise(function(e,n){var i=new FileReader;i.onload=function(){e(i.result)},i.onerror=n,i.readAsDataURL(t)})}const wF=Object.freeze(Object.defineProperty({__proto__:null,buffer:yF,text:vF,url:xF},Symbol.toStringTag,{value:"Module"}));function Ux(){return this}function mI(t,e){let n=!1;if(typeof e!="function")throw new Error("dispose is not a function");return{[Symbol.iterator]:Ux,next:()=>n?{done:!0}:(n=!0,{done:!1,value:t}),return:()=>(n=!0,e(t),{done:!0}),throw:()=>({done:n=!0})}}function*bF(t,e){for(var n,i=-1;!(n=t.next()).done;)e(n.value,++i)&&(yield n.value)}function f_(t){let e=!1,n,i;const r=t(A);if(r!=null&&typeof r!="function")throw new Error(typeof r.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function A(l){return i?(i(l),i=null):e=!0,n=l}function d(){return{done:!1,value:e?(e=!1,Promise.resolve(n)):new Promise(l=>i=l)}}return{[Symbol.iterator]:Ux,throw:()=>({done:!0}),return:()=>(r!=null&&r(),{done:!0}),next:d}}function EF(t){return f_(function(e){var n=TF(t),i=uT(t);function r(){e(uT(t))}return t.addEventListener(n,r),i!==void 0&&e(i),function(){t.removeEventListener(n,r)}})}function uT(t){switch(t.type){case"range":case"number":return t.valueAsNumber;case"date":return t.valueAsDate;case"checkbox":return t.checked;case"file":return t.multiple?t.files:t.files[0];case"select-multiple":return Array.from(t.selectedOptions,e=>e.value);default:return t.value}}function TF(t){switch(t.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}function*SF(t,e){for(var n,i=-1;!(n=t.next()).done;)yield e(n.value,++i)}function CF(t){let e;const n=[],i=t(r);if(i!=null&&typeof i!="function")throw new Error(typeof i.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function r(d){return n.push(d),e&&(e(n.shift()),e=null),d}function A(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise(d=>e=d)}}return{[Symbol.iterator]:Ux,throw:()=>({done:!0}),return:()=>(i!=null&&i(),{done:!0}),next:A}}function*PF(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0;++i<r;)yield t+i*n}function MF(t,e){if(!(!isFinite(e=+e)||e<0||e!==e|0)){for(var n,i=-1;!(n=t.next()).done;)if(++i===e)return n.value}}function IF(t){const e=URL.createObjectURL(new Blob([t],{type:"text/javascript"})),n=new Worker(e);return mI(n,()=>{n.terminate(),URL.revokeObjectURL(e)})}const kF=Object.freeze(Object.defineProperty({__proto__:null,disposable:mI,filter:bF,input:EF,map:SF,observe:f_,queue:CF,range:PF,valueAt:MF,worker:IF},Symbol.toStringTag,{value:"Module"}));function Vx(t,e){return function(n){var i=n[0],r=[],A,d=null,l,S,k,U,V,$,X,ee=-1;for(U=1,V=arguments.length;U<V;++U){if(A=arguments[U],A instanceof Node)r[++ee]=A,i+="<!--o:"+ee+"-->";else if(Array.isArray(A)){for($=0,X=A.length;$<X;++$)l=A[$],l instanceof Node?(d===null&&(r[++ee]=d=document.createDocumentFragment(),i+="<!--o:"+ee+"-->"),d.appendChild(l)):(d=null,i+=l);d=null}else i+=A;i+=n[U]}if(d=t(i),++ee>0){for(S=new Array(ee),k=document.createTreeWalker(d,NodeFilter.SHOW_COMMENT,null,!1);k.nextNode();)l=k.currentNode,/^o:/.test(l.nodeValue)&&(S[+l.nodeValue.slice(2)]=l);for(U=0;U<ee;++U)(l=S[U])&&l.parentNode.replaceChild(r[U],l)}return d.childNodes.length===1?d.removeChild(d.firstChild):d.nodeType===11?((l=e()).appendChild(d),l):d}}const LF=Vx(function(t){var e=document.createElement("template");return e.innerHTML=t.trim(),document.importNode(e.content,!0)},function(){return document.createElement("span")});async function DF(t){const e=await t(X3.resolve());if(!e._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await t.resolve(X3.resolve("dist/leaflet.css")),e._style=document.head.appendChild(n)}return e}function BF(t){return t(GO.resolve()).then(function(e){return Vx(function(n){var i=document.createElement("div");i.innerHTML=e(n,{langPrefix:""}).trim();var r=i.querySelectorAll("pre code[class]");return r.length>0&&t(X1.resolve()).then(function(A){r.forEach(function(d){function l(){A.highlightBlock(d),d.parentNode.classList.add("observablehq--md-pre")}A.getLanguage(d.className)?l():t(X1.resolve("async-languages/index.js")).then(S=>{if(S.has(d.className))return t(X1.resolve("async-languages/"+S.get(d.className))).then(k=>{A.registerLanguage(d.className,k)})}).then(l,l)})}),i},function(){return document.createElement("div")})})}async function RF(t){const e=await t(XO.resolve());return e.initialize({securityLevel:"loose",theme:"neutral"}),function(){const i=document.createElement("div");return i.innerHTML=e.render(pI().id,String.raw.apply(String,arguments)),i.removeChild(i.firstChild)}}function OF(t){let e;Object.defineProperties(this,{generator:{value:f_(n=>void(e=n))},value:{get:()=>t,set:n=>e(t=n)}}),t!==void 0&&e(t)}function*zF(){for(;;)yield Date.now()}function FF(t,e){return new Promise(function(n){setTimeout(function(){n(e)},t)})}var W2=new Map;function NF(t,e){var n=new Promise(function(i){W2.delete(e);var r=e-t;if(!(r>0))throw new Error("invalid time");if(r>2147483647)throw new Error("too long to wait");setTimeout(i,r)});return W2.set(e,n),n}function _I(t,e){var n;return(n=W2.get(t=+t))?n.then(()=>e):(n=Date.now())>=t?Promise.resolve(e):NF(n,t).then(()=>e)}function UF(t,e){return _I(Math.ceil((Date.now()+1)/t)*t,e)}const VF=Object.freeze(Object.defineProperty({__proto__:null,delay:FF,tick:UF,when:_I},Symbol.toStringTag,{value:"Module"}));function jF(t,e){if(/^(\w+:)|\/\//i.test(t))return t;if(/^[.]{0,2}\//i.test(t))return new URL(t,e??location).href;if(!t.length||/^[\s._]/.test(t)||/\s$/.test(t))throw new Error("illegal name");return"https://unpkg.com/"+t}const GF=Vx(function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g");return e.innerHTML=t.trim(),e},function(){return document.createElementNS("http://www.w3.org/2000/svg","g")});var QF=String.raw;function HF(t){return new Promise(function(e,n){var i=document.createElement("link");i.rel="stylesheet",i.href=t,i.onerror=n,i.onload=e,document.head.appendChild(i)})}function WF(t){return Promise.all([t(q3.resolve()),t.resolve(q3.resolve("dist/katex.min.css")).then(HF)]).then(function(e){var n=e[0],i=r();function r(A){return function(){var d=document.createElement("div");return n.render(QF.apply(String,arguments),d,A),d.removeChild(d.firstChild)}}return i.options=r,i.block=r({displayMode:!0}),i})}async function $F(t){const[e,n,i]=await Promise.all([QO,HO,WO].map(r=>t(r.resolve())));return i.register(e,n)}function ZF(){return f_(function(t){var e=t(document.body.clientWidth);function n(){var i=document.body.clientWidth;i!==e&&t(e=i)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}})}const qF=Object.assign(Object.defineProperties(function(e){const n=az(e);Object.defineProperties(this,YF({FileAttachment:()=>rF,Mutable:()=>OF,now:zF,width:ZF,dot:()=>n(NO.resolve()),htl:()=>n(VO.resolve()),html:()=>LF,md:()=>BF(n),svg:()=>GF,tex:()=>WF(n),_:()=>n(UO.resolve()),aq:()=>n.alias({"apache-arrow":j2.resolve()})(ZO.resolve()),Arrow:()=>n(j2.resolve()),d3:()=>n(OO.resolve()),DuckDBClient:()=>Gd,Inputs:()=>n(zO.resolve()).then(i=>({...i,file:i.fileOf(Nx)})),L:()=>DF(n),mermaid:()=>RF(n),Plot:()=>n(FO.resolve()),__query:()=>uI,require:()=>n,resolve:()=>jF,SQLite:()=>iI(n),SQLiteDatabaseClient:()=>jd,topojson:()=>n(qO.resolve()),vl:()=>$F(n),aapl:()=>new es("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new es("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new es("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new es("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new es("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new es("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new es("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new es("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new es("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new es("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),pizza:()=>new es("https://static.observableusercontent.com/files/c653108ab176088cacbb338eaf2344c4f5781681702bd6afb55697a3f91b511c6686ff469f3e3a27c75400001a2334dbd39a4499fe46b50a8b3c278b7d2f7fb5").csv({typed:!0}),weather:()=>new es("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:_F,Files:wF,Generators:kF,Promises:VF}))},{resolve:{get:()=>lc.resolve,enumerable:!0,configurable:!0},require:{get:()=>lc,set:oz,enumerable:!0,configurable:!0}}),{resolveFrom:tI,requireFrom:c_});function YF(t){return Object.fromEntries(Object.entries(t).map(XF))}function XF([t,e]){return[t,{value:e,writable:!0,enumerable:!0}]}class au extends Error{constructor(e,n){super(e),this.input=n}}au.prototype.name="RuntimeError";function KF(t){return t&&typeof t.next=="function"&&typeof t.return=="function"}function $2(t){return()=>t}function gm(t){return t}function JF(t){return()=>{throw t}}const eN=Array.prototype,tN=eN.map;function du(){}const jx=1,Qd=2,Cg=3,gd=Symbol("no-observer");function mc(t,e,n,i){n||(n=gd),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:Gx,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:du,writable:!0},_module:{value:e},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==gd,writable:!0},_rejector:{value:sN(this)},_shadow:{value:nN(e,i)},_type:{value:t},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}Object.defineProperties(mc.prototype,{_pending:{value:uN,writable:!0,configurable:!0},_fulfilled:{value:cN,writable:!0,configurable:!0},_rejected:{value:hN,writable:!0,configurable:!0},_resolve:{value:aN,writable:!0,configurable:!0},define:{value:oN,writable:!0,configurable:!0},delete:{value:lN,writable:!0,configurable:!0},import:{value:AN,writable:!0,configurable:!0}});function nN(t,e){return e!=null&&e.shadow?new Map(Object.entries(e.shadow).map(([n,i])=>[n,new mc(Qd,t).define([],i)])):null}function iN(t){t._module._runtime._dirty.add(t),t._outputs.add(this)}function rN(t){t._module._runtime._dirty.add(t),t._outputs.delete(this)}function Gx(){throw Gx}function Au(){throw Au}function sN(t){return e=>{throw e===Au?e:e===Gx?new au(`${t._name} is not defined`,t._name):e instanceof Error&&e.message?new au(e.message,t._name):new au(`${t._name} could not be resolved`,t._name)}}function cT(t){return()=>{throw new au(`${t} is defined more than once`)}}function oN(t,e,n){switch(arguments.length){case 1:{n=t,t=e=null;break}case 2:{n=e,typeof t=="string"?e=null:(e=t,t=null);break}}return Qx.call(this,t==null?null:String(t),e==null?[]:tN.call(e,this._resolve,this),typeof n=="function"?n:$2(n))}function aN(t){var e;return((e=this._shadow)==null?void 0:e.get(t))??this._module._resolve(t)}function Qx(t,e,n){const i=this._module._scope,r=this._module._runtime;if(this._inputs.forEach(rN,this),e.forEach(iN,this),this._inputs=e,this._definition=n,this._value=void 0,n===du?r._variables.delete(this):r._variables.add(this),t!==this._name||i.get(t)!==this){let A,d;if(this._name)if(this._outputs.size)i.delete(this._name),d=this._module._resolve(this._name),d._outputs=this._outputs,this._outputs=new Set,d._outputs.forEach(function(l){l._inputs[l._inputs.indexOf(this)]=d},this),d._outputs.forEach(r._updates.add,r._updates),r._dirty.add(d).add(this),i.set(this._name,d);else if((d=i.get(this._name))===this)i.delete(this._name);else if(d._type===Cg)d._duplicates.delete(this),this._duplicate=void 0,d._duplicates.size===1&&(d=d._duplicates.keys().next().value,A=i.get(this._name),d._outputs=A._outputs,A._outputs=new Set,d._outputs.forEach(function(l){l._inputs[l._inputs.indexOf(A)]=d}),d._definition=d._duplicate,d._duplicate=void 0,r._dirty.add(A).add(d),r._updates.add(d),i.set(this._name,d));else throw new Error;if(this._outputs.size)throw new Error;t&&((d=i.get(t))?d._type===Cg?(this._definition=cT(t),this._duplicate=n,d._duplicates.add(this)):d._type===Qd?(this._outputs=d._outputs,d._outputs=new Set,this._outputs.forEach(function(l){l._inputs[l._inputs.indexOf(d)]=this},this),r._dirty.add(d).add(this),i.set(t,this)):(d._duplicate=d._definition,this._duplicate=n,A=new mc(Cg,this._module),A._name=t,A._definition=this._definition=d._definition=cT(t),A._outputs=d._outputs,d._outputs=new Set,A._outputs.forEach(function(l){l._inputs[l._inputs.indexOf(d)]=A}),A._duplicates=new Set([this,d]),r._dirty.add(d).add(A),r._updates.add(d).add(A),i.set(t,A)):i.set(t,this)),this._name=t}return this._version>0&&++this._version,r._updates.add(this),r._compute(),this}function AN(t,e,n){return arguments.length<3&&(n=e,e=t),Qx.call(this,String(e),[n._resolve(String(t))],gm)}function lN(){return Qx.call(this,null,[],du)}function uN(){this._observer.pending&&this._observer.pending()}function cN(t){this._observer.fulfilled&&this._observer.fulfilled(t,this._name)}function hN(t){this._observer.rejected&&this._observer.rejected(t,this._name)}const yI=Symbol("variable"),vI=Symbol("invalidation"),xI=Symbol("visibility");function mm(t,e=[]){Object.defineProperties(this,{_runtime:{value:t},_scope:{value:new Map},_builtins:{value:new Map([["@variable",yI],["invalidation",vI],["visibility",xI],...e])},_source:{value:null,writable:!0}})}Object.defineProperties(mm.prototype,{_resolve:{value:yN,writable:!0,configurable:!0},redefine:{value:fN,writable:!0,configurable:!0},define:{value:dN,writable:!0,configurable:!0},derive:{value:_N,writable:!0,configurable:!0},import:{value:pN,writable:!0,configurable:!0},value:{value:mN,writable:!0,configurable:!0},variable:{value:gN,writable:!0,configurable:!0},builtin:{value:vN,writable:!0,configurable:!0}});function fN(t){const e=this._scope.get(t);if(!e)throw new au(`${t} is not defined`);if(e._type===Cg)throw new au(`${t} is defined more than once`);return e.define.apply(e,arguments)}function dN(){const t=new mc(jx,this);return t.define.apply(t,arguments)}function pN(){const t=new mc(jx,this);return t.import.apply(t,arguments)}function gN(t,e){return new mc(jx,this,t,e)}async function mN(t){let e=this._scope.get(t);if(!e)throw new au(`${t} is not defined`);if(e._observer===gd){e=this.variable(!0).define([t],gm);try{return await Z2(this._runtime,e)}finally{e.delete()}}else return Z2(this._runtime,e)}async function Z2(t,e){await t._compute();try{return await e._promise}catch(n){if(n===Au)return Z2(t,e);throw n}}function _N(t,e){const n=new Map,i=new Set,r=[];function A(l){let S=n.get(l);return S||(S=new mm(l._runtime,l._builtins),S._source=l,n.set(l,S),r.push([S,l]),i.add(l),S)}const d=A(this);for(const l of t){const{alias:S,name:k}=typeof l=="object"?l:{name:l};d.import(k,S??k,e)}for(const l of i)for(const[S,k]of l._scope)if(k._definition===gm){if(l===this&&d._scope.has(S))continue;const U=k._inputs[0]._module;U._source&&A(U)}for(const[l,S]of r)for(const[k,U]of S._scope){const V=l._scope.get(k);if(!(V&&V._type!==Qd))if(U._definition===gm){const $=U._inputs[0],X=$._module;l.import($._name,k,n.get(X)||X)}else l.define(k,U._inputs.map(xN),U._definition)}return d}function yN(t){let e=this._scope.get(t),n;if(!e)if(e=new mc(Qd,this),this._builtins.has(t))e.define(t,$2(this._builtins.get(t)));else if(this._runtime._builtin._scope.has(t))e.import(t,this._runtime._builtin);else{try{n=this._runtime._global(t)}catch(i){return e.define(t,JF(i))}n===void 0?this._scope.set(e._name=t,e):e.define(t,$2(n))}return e}function vN(t,e){this._builtins.set(t,e)}function xN(t){return t._name}const wN=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:t=>setTimeout(t,0);function wI(t=new qF,e=UN){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:e}}),t)for(const i in t)new mc(Qd,n).define(i,[],t[i])}Object.defineProperties(wI.prototype,{_precompute:{value:TN,writable:!0,configurable:!0},_compute:{value:SN,writable:!0,configurable:!0},_computeSoon:{value:CN,writable:!0,configurable:!0},_computeNow:{value:PN,writable:!0,configurable:!0},dispose:{value:bN,writable:!0,configurable:!0},module:{value:EN,writable:!0,configurable:!0},fileAttachments:{value:sF,writable:!0,configurable:!0}});function bN(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach(t=>{t._invalidate(),t._version=NaN})}function EN(t,e=du){let n;if(t===void 0)return(n=this._init)?(this._init=null,n):new mm(this);if(n=this._modules.get(t),n)return n;this._init=n=new mm(this),this._modules.set(t,n);try{t(this,e)}finally{this._init=null}return n}function TN(t){this._precomputes.push(t),this._compute()}function SN(){return this._computing||(this._computing=this._computeSoon())}function CN(){return new Promise(wN).then(()=>this._disposed?void 0:this._computeNow())}async function PN(){let t=[],e,n,i=this._precomputes;if(i.length){this._precomputes=[];for(const A of i)A();await MN(3)}e=new Set(this._dirty),e.forEach(function(A){A._inputs.forEach(e.add,e);const d=NN(A);d>A._reachable?this._updates.add(A):d<A._reachable&&A._invalidate(),A._reachable=d},this),e=new Set(this._updates),e.forEach(function(A){A._reachable?(A._indegree=0,A._outputs.forEach(e.add,e)):(A._indegree=NaN,e.delete(A))}),this._computing=null,this._updates.clear(),this._dirty.clear(),e.forEach(function(A){A._outputs.forEach(kN)});do{for(e.forEach(function(A){A._indegree===0&&t.push(A)});n=t.pop();)RN(n),n._outputs.forEach(r),e.delete(n);e.forEach(function(A){IN(A)&&(zN(A,new au("circular definition")),A._outputs.forEach(LN),e.delete(A))})}while(e.size);function r(A){--A._indegree===0&&t.push(A)}}function MN(t=0){let e=Promise.resolve();for(let n=0;n<t;++n)e=e.then(()=>{});return e}function IN(t){const e=new Set(t._inputs);for(const n of e){if(n===t)return!0;n._inputs.forEach(e.add,e)}return!1}function kN(t){++t._indegree}function LN(t){--t._indegree}function DN(t){return t._promise.catch(t._rejector)}function ty(t){return new Promise(function(e){t._invalidate=e})}function BN(t,e){let n=typeof IntersectionObserver=="function"&&e._observer&&e._observer._node,i=!n,r=du,A=du,d,l;return n&&(l=new IntersectionObserver(([S])=>(i=S.isIntersecting)&&(d=null,r())),l.observe(n),t.then(()=>(l.disconnect(),l=null,A()))),function(S){return i?Promise.resolve(S):l?(d||(d=new Promise((k,U)=>(r=k,A=U))),d.then(()=>S)):Promise.reject()}}function RN(t){t._invalidate(),t._invalidate=du,t._pending();const e=t._value,n=++t._version;let i=null;const r=t._promise=(t._inputs.length?Promise.all(t._inputs.map(DN)).then(A):new Promise(l=>l(t._definition.call(e)))).then(d);function A(l){if(t._version!==n)throw Au;for(let S=0,k=l.length;S<k;++S)switch(l[S]){case vI:{l[S]=i=ty(t);break}case xI:{i||(i=ty(t)),l[S]=BN(i,t);break}case yI:{l[S]=t;break}}return t._definition.apply(e,l)}function d(l){if(t._version!==n)throw Au;return KF(l)?((i||ty(t)).then(FN(l)),ON(t,n,l)):l}r.then(l=>{t._value=l,t._fulfilled(l)},l=>{l!==Au&&(t._value=void 0,t._rejected(l))})}function ON(t,e,n){const i=t._module._runtime;let r;function A(S){return new Promise(k=>k(n.next(r))).then(({done:k,value:U})=>k?void 0:Promise.resolve(U).then(S))}function d(){const S=A(k=>{if(t._version!==e)throw Au;return r=k,l(k,S).then(()=>i._precompute(d)),t._fulfilled(k),k});S.catch(k=>{k===Au||t._version!==e||(l(void 0,S),t._rejected(k))})}function l(S,k){return t._value=S,t._promise=k,t._outputs.forEach(i._updates.add,i._updates),i._compute()}return A(S=>{if(t._version!==e)throw Au;return r=S,i._precompute(d),S})}function zN(t,e){t._invalidate(),t._invalidate=du,t._pending(),++t._version,t._indegree=NaN,(t._promise=Promise.reject(e)).catch(du),t._value=void 0,t._rejected(e)}function FN(t){return function(){t.return()}}function NN(t){if(t._observer!==gd)return!0;const e=new Set(t._outputs);for(const n of e){if(n._observer!==gd)return!0;n._outputs.forEach(e.add,e)}return!1}function UN(t){return globalThis[t]}const VN=Tt.createContext(null);function jN(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,A=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===A}function Pa(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Pa(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n)if(!e.hasOwnProperty(r)||!Pa(t[r],e[r]))return!1;return!0}return!1}function GN(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function hT(t,e){if(!t.getProjection)return;const n=t.getProjection(),i=e.getProjection();Pa(n,i)||e.setProjection(n)}function fT(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function dT(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const r=t.center;t.center=new r.constructor(n.longitude,n.latitude),i=i||r!==t.center}if("zoom"in n){const r=t.zoom;t.zoom=n.zoom,i=i||r!==t.zoom}if("bearing"in n){const r=t.bearing;t.bearing=n.bearing,i=i||r!==t.bearing}if("pitch"in n){const r=t.pitch;t.pitch=n.pitch,i=i||r!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const QN=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function pT(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map(i=>{let r=null;"interactive"in i&&(r=Object.assign({},i),delete r.interactive);const A=e[i.ref];if(A){r=r||Object.assign({},i),delete r.ref;for(const d of QN)d in A&&(r[d]=A[d])}return r||i});return{...t,layers:n}}const gT={version:8,sources:{},layers:[]},mT={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},ny={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},_T={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},HN=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],WN=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class x0{constructor(e,n,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const A=this.props[_T[r.type]];A?A(r):r.type==="error"&&console.error(r.error)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const A=this.props[mT[r.type]];A&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),A(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const A=this.props[ny[r.type]];A&&A(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=n,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const i=this._updateSettings(e,n);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),A=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(i||r||A&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const i=x0.savedMaps.pop();if(!i)return null;const r=i.map,A=r.getContainer();for(n.className=A.className;A.childNodes.length>0;)n.appendChild(A.childNodes[0]);r._container=n;const d=r._resizeObserver;d&&(d.disconnect(),d.observe(n)),i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:l}=e;return l&&(l.bounds?r.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):i._updateViewState(l,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),i}_initialize(e){const{props:n}=this,{mapStyle:i=gT}=n,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||$N()||null,container:e,style:pT(i)},A=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[A.longitude||0,A.latitude||0],zoom:A.zoom||0,pitch:A.pitch||0,bearing:A.bearing||0}),n.gl){const U=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=U,n.gl)}const d=new this._MapClass(r);A.padding&&d.setPadding(A.padding),n.cursor&&(d.getCanvas().style.cursor=n.cursor),this._createShadowTransform(d);const l=d._render;d._render=U=>{this._inRender=!0,l.call(d,U),this._inRender=!1};const S=d._renderTaskQueue.run;d._renderTaskQueue.run=U=>{S.call(d._renderTaskQueue,U),this._onBeforeRepaint()},d.on("render",()=>this._onAfterRepaint());const k=d.fire;d.fire=this._fireEvent.bind(this,k),d.on("resize",()=>{this._renderTransform.resize(d.transform.width,d.transform.height)}),d.on("styledata",()=>{this._updateStyleComponents(this.props,{}),hT(d.transform,this._renderTransform)}),d.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const U in mT)d.on(U,this._onPointerEvent);for(const U in ny)d.on(U,this._onCameraEvent);for(const U in _T)d.on(U,this._onEvent);this._map=d}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),x0.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=GN(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:A,pitch:d,bearing:l}=r,S=i.isMoving();S&&(r.cameraElevationReference="sea");const k=dT(r,{...fT(i.transform),...e});if(S&&(r.cameraElevationReference="ground"),k&&n){const U=this._deferredEvents;U.move=!0,U.zoom||(U.zoom=A!==r.zoom),U.rotate||(U.rotate=l!==r.bearing),U.pitch||(U.pitch=d!==r.pitch)}return S||dT(i.transform,e),k}_updateSettings(e,n){const i=this._map;let r=!1;for(const A of HN)if(A in e&&!Pa(e[A],n[A])){r=!0;const d=i[`set${A[0].toUpperCase()}${A.slice(1)}`];d==null||d.call(i,e[A])}return r}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:i=gT,styleDiffing:r=!0}=e,A={diff:r};return"localIdeographFontFamily"in e&&(A.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(pT(i),A),!0}return!1}_updateStyleComponents(e,n){const i=this._map;let r=!1;return i.isStyleLoaded()&&("light"in e&&i.setLight&&!Pa(e.light,n.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&i.setFog&&!Pa(e.fog,n.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&i.setTerrain&&!Pa(e.terrain,n.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(r=!0,i.setTerrain(e.terrain))),r}_updateHandlers(e,n){var i,r;const A=this._map;let d=!1;for(const l of WN){const S=(i=e[l])!==null&&i!==void 0?i:!0,k=(r=n[l])!==null&&r!==void 0?r:!0;Pa(S,k)||(d=!0,S?A[l].enable(S):A[l].disable())}return d}_queryRenderedFeatures(e){const n=this._map,i=n.transform,{interactiveLayerIds:r=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=i}}_updateHover(e){var n;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const A=e.type,d=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,l=this._queryRenderedFeatures(e.point),S=l.length>0;!S&&d&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=l,S&&!d&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=A}else this._hoveredFeatures=null}_fireEvent(e,n,i){const r=this._map,A=r.transform,d=typeof n=="string"?n:n.type;return d==="move"&&this._updateViewState(this.props,!1),d in ny&&(typeof n=="object"&&(n.viewState=fT(A)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,n,i),r.transform=A,r):(e.call(r,n,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{hT(this._renderTransform,n),e.transform=n}}}x0.savedMaps=[];function $N(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const ZN=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function qN(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>{const r=e.transform;e.transform=t.transform;const A=e.project(i);return e.transform=r,A},unproject:i=>{const r=e.transform;e.transform=t.transform;const A=e.unproject(i);return e.transform=r,A},queryTerrainElevation:(i,r)=>{const A=e.transform;e.transform=t.transform;const d=e.queryTerrainElevation(i,r);return e.transform=A,d},queryRenderedFeatures:(i,r)=>{const A=e.transform;e.transform=t.transform;const d=e.queryRenderedFeatures(i,r);return e.transform=A,d}};for(const i of YN(e))!(i in n)&&!ZN.includes(i)&&(n[i]=e[i].bind(e));return n}function YN(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof t[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}const XN=typeof document<"u"?Tt.useLayoutEffect:Tt.useEffect,KN=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function JN(t,e){for(const i of KN)i in e&&(t[i]=e[i]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,i=>{i&&console.error(i)},!1)}const z0=Tt.createContext(null);function eU(t,e,n){const i=Tt.useContext(VN),[r,A]=Tt.useState(null),d=Tt.useRef(),{current:l}=Tt.useRef({mapLib:null,map:null});Tt.useEffect(()=>{const U=t.mapLib;let V=!0,$;return Promise.resolve(U||n).then(X=>{if(!V)return;if(!X)throw new Error("Invalid mapLib");const ee="Map"in X?X:X.default;if(!ee.Map)throw new Error("Invalid mapLib");if(JN(ee,t),!ee.supported||ee.supported(t))t.reuseMaps&&($=x0.reuse(t,d.current)),$||($=new x0(ee.Map,t,d.current)),l.map=qN($),l.mapLib=ee,A($),i==null||i.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(X=>{const{onError:ee}=t;ee?ee({type:"error",target:null,originalEvent:null,error:X}):console.error(X)}),()=>{V=!1,$&&(i==null||i.onMapUnmount(t.id),t.reuseMaps?$.recycle():$.destroy())}},[]),XN(()=>{r&&r.setProps(t)}),Tt.useImperativeHandle(e,()=>l.map,[r]);const S=Tt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),k={height:"100%"};return Tt.createElement("div",{id:t.id,ref:d,style:S},r&&Tt.createElement(z0.Provider,{value:l},Tt.createElement("div",{"mapboxgl-children":"",style:k},t.children)))}const tU=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ih(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const r=e[i];Number.isFinite(r)&&!tU.test(i)?n[i]=`${r}px`:n[i]=r}}function nU(t,e){const{map:n,mapLib:i}=Tt.useContext(z0),r=Tt.useRef({props:t});r.current.props=t;const A=Tt.useMemo(()=>{let ue=!1;Tt.Children.forEach(t.children,Ae=>{Ae&&(ue=!0)});const we={...t,element:ue?document.createElement("div"):null},ie=new i.Marker(we);return ie.setLngLat([t.longitude,t.latitude]),ie.getElement().addEventListener("click",Ae=>{var ce,Ce;(Ce=(ce=r.current.props).onClick)===null||Ce===void 0||Ce.call(ce,{type:"click",target:ie,originalEvent:Ae})}),ie.on("dragstart",Ae=>{var ce,Ce;const Ne=Ae;Ne.lngLat=A.getLngLat(),(Ce=(ce=r.current.props).onDragStart)===null||Ce===void 0||Ce.call(ce,Ne)}),ie.on("drag",Ae=>{var ce,Ce;const Ne=Ae;Ne.lngLat=A.getLngLat(),(Ce=(ce=r.current.props).onDrag)===null||Ce===void 0||Ce.call(ce,Ne)}),ie.on("dragend",Ae=>{var ce,Ce;const Ne=Ae;Ne.lngLat=A.getLngLat(),(Ce=(ce=r.current.props).onDragEnd)===null||Ce===void 0||Ce.call(ce,Ne)}),ie},[]);Tt.useEffect(()=>(A.addTo(n.getMap()),()=>{A.remove()}),[]);const{longitude:d,latitude:l,offset:S,style:k,draggable:U=!1,popup:V=null,rotation:$=0,rotationAlignment:X="auto",pitchAlignment:ee="auto"}=t;return Tt.useEffect(()=>{ih(A.getElement(),k)},[k]),Tt.useImperativeHandle(e,()=>A,[]),(A.getLngLat().lng!==d||A.getLngLat().lat!==l)&&A.setLngLat([d,l]),S&&!jN(A.getOffset(),S)&&A.setOffset(S),A.isDraggable()!==U&&A.setDraggable(U),A.getRotation()!==$&&A.setRotation($),A.getRotationAlignment()!==X&&A.setRotationAlignment(X),A.getPitchAlignment()!==ee&&A.setPitchAlignment(ee),A.getPopup()!==V&&A.setPopup(V),Dx.createPortal(t.children,A.getElement())}const iU=Tt.memo(Tt.forwardRef(nU));function yT(t){return new Set(t?t.trim().split(/\s+/):[])}function rU(t,e){const{map:n,mapLib:i}=Tt.useContext(z0),r=Tt.useMemo(()=>document.createElement("div"),[]),A=Tt.useRef({props:t});A.current.props=t;const d=Tt.useMemo(()=>{const l={...t},S=new i.Popup(l);return S.setLngLat([t.longitude,t.latitude]),S.once("open",k=>{var U,V;(V=(U=A.current.props).onOpen)===null||V===void 0||V.call(U,k)}),S},[]);if(Tt.useEffect(()=>{const l=S=>{var k,U;(U=(k=A.current.props).onClose)===null||U===void 0||U.call(k,S)};return d.on("close",l),d.setDOMContent(r).addTo(n.getMap()),()=>{d.off("close",l),d.isOpen()&&d.remove()}},[]),Tt.useEffect(()=>{ih(d.getElement(),t.style)},[t.style]),Tt.useImperativeHandle(e,()=>d,[]),d.isOpen()&&((d.getLngLat().lng!==t.longitude||d.getLngLat().lat!==t.latitude)&&d.setLngLat([t.longitude,t.latitude]),t.offset&&!Pa(d.options.offset,t.offset)&&d.setOffset(t.offset),(d.options.anchor!==t.anchor||d.options.maxWidth!==t.maxWidth)&&(d.options.anchor=t.anchor,d.setMaxWidth(t.maxWidth)),d.options.className!==t.className)){const l=yT(d.options.className),S=yT(t.className);for(const k of l)S.has(k)||d.removeClassName(k);for(const k of S)l.has(k)||d.addClassName(k);d.options.className=t.className}return Dx.createPortal(t.children,r)}Tt.memo(Tt.forwardRef(rU));function Hd(t,e,n,i){const r=Tt.useContext(z0),A=Tt.useMemo(()=>t(r),[]);return Tt.useEffect(()=>{const d=i||n||e,l=typeof e=="function"&&typeof n=="function"?e:null,S=typeof n=="function"?n:typeof e=="function"?e:null,{map:k}=r;return k.hasControl(A)||(k.addControl(A,d==null?void 0:d.position),l&&l(r)),()=>{S&&S(r),k.hasControl(A)&&k.removeControl(A)}},[]),A}function sU(t){const e=Hd(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Tt.useEffect(()=>{ih(e._container,t.style)},[t.style]),null}Tt.memo(sU);function oU(t){const e=Hd(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Tt.useEffect(()=>{ih(e._controlContainer,t.style)},[t.style]),null}Tt.memo(oU);function aU(t,e){const n=Tt.useRef({props:t}),i=Hd(({mapLib:r})=>{const A=new r.GeolocateControl(t),d=A._setupUI;return A._setupUI=l=>{A._container.hasChildNodes()||d(l)},A.on("geolocate",l=>{var S,k;(k=(S=n.current.props).onGeolocate)===null||k===void 0||k.call(S,l)}),A.on("error",l=>{var S,k;(k=(S=n.current.props).onError)===null||k===void 0||k.call(S,l)}),A.on("outofmaxbounds",l=>{var S,k;(k=(S=n.current.props).onOutOfMaxBounds)===null||k===void 0||k.call(S,l)}),A.on("trackuserlocationstart",l=>{var S,k;(k=(S=n.current.props).onTrackUserLocationStart)===null||k===void 0||k.call(S,l)}),A.on("trackuserlocationend",l=>{var S,k;(k=(S=n.current.props).onTrackUserLocationEnd)===null||k===void 0||k.call(S,l)}),A},{position:t.position});return n.current.props=t,Tt.useImperativeHandle(e,()=>i,[]),Tt.useEffect(()=>{ih(i._container,t.style)},[t.style]),null}Tt.memo(Tt.forwardRef(aU));function AU(t){const e=Hd(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Tt.useEffect(()=>{ih(e._container,t.style)},[t.style]),null}Tt.memo(AU);function lU(t){const e=Hd(({mapLib:A})=>new A.ScaleControl(t),{position:t.position}),n=Tt.useRef(t),i=n.current;n.current=t;const{style:r}=t;return t.maxWidth!==void 0&&t.maxWidth!==i.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==i.unit&&e.setUnit(t.unit),Tt.useEffect(()=>{ih(e._container,r)},[r]),null}Tt.memo(lU);function _m(t,e){if(!t)throw new Error(e)}function uU(t,e,n,i){if(_m(n.id===i.id,"layer id changed"),_m(n.type===i.type,"layer type changed"),n.type==="custom"||i.type==="custom")return;const{layout:r={},paint:A={},filter:d,minzoom:l,maxzoom:S,beforeId:k}=n;if(k!==i.beforeId&&t.moveLayer(e,k),r!==i.layout){const U=i.layout||{};for(const V in r)Pa(r[V],U[V])||t.setLayoutProperty(e,V,r[V]);for(const V in U)r.hasOwnProperty(V)||t.setLayoutProperty(e,V,void 0)}if(A!==i.paint){const U=i.paint||{};for(const V in A)Pa(A[V],U[V])||t.setPaintProperty(e,V,A[V]);for(const V in U)A.hasOwnProperty(V)||t.setPaintProperty(e,V,void 0)}Pa(d,i.filter)||t.setFilter(e,d),(l!==i.minzoom||S!==i.maxzoom)&&t.setLayerZoomRange(e,l,S)}function cU(t,e,n){if(t.style&&t.style._loaded&&(!("source"in n)||t.getSource(n.source))){const i={...n,id:e};delete i.beforeId,t.addLayer(i,n.beforeId)}}let hU=0;function fU(t){const e=Tt.useContext(z0).map.getMap(),n=Tt.useRef(t),[,i]=Tt.useState(0),r=Tt.useMemo(()=>t.id||`jsx-layer-${hU++}`,[]);if(Tt.useEffect(()=>{if(e){const d=()=>i(l=>l+1);return e.on("styledata",d),d(),()=>{e.off("styledata",d),e.style&&e.style._loaded&&e.getLayer(r)&&e.removeLayer(r)}}},[e]),e&&e.style&&e.getLayer(r))try{uU(e,r,t,n.current)}catch(d){console.warn(d)}else cU(e,r,t);return n.current=t,null}let dU=0;function pU(t,e,n){if(t.style&&t.style._loaded){const i={...n};return delete i.id,delete i.children,t.addSource(e,i),t.getSource(e)}return null}function gU(t,e,n){_m(e.id===n.id,"source id changed"),_m(e.type===n.type,"source type changed");let i="",r=0;for(const d in e)d!=="children"&&d!=="id"&&!Pa(n[d],e[d])&&(i=d,r++);if(!r)return;const A=e.type;if(A==="geojson")t.setData(e.data);else if(A==="image")t.updateImage({url:e.url,coordinates:e.coordinates});else if("setCoordinates"in t&&r===1&&i==="coordinates")t.setCoordinates(e.coordinates);else if("setUrl"in t)switch(i){case"url":t.setUrl(e.url);break;case"tiles":t.setTiles(e.tiles);break}else console.warn(`Unable to update <Source> prop: ${i}`)}function mU(t){const e=Tt.useContext(z0).map.getMap(),n=Tt.useRef(t),[,i]=Tt.useState(0),r=Tt.useMemo(()=>t.id||`jsx-source-${dU++}`,[]);Tt.useEffect(()=>{if(e){const d=()=>setTimeout(()=>i(l=>l+1),0);return e.on("styledata",d),d(),()=>{var l;if(e.off("styledata",d),e.style&&e.style._loaded&&e.getSource(r)){const S=(l=e.getStyle())===null||l===void 0?void 0:l.layers;if(S)for(const k of S)k.source===r&&e.removeLayer(k.id);e.removeSource(r)}}}},[e]);let A=e&&e.style&&e.getSource(r);return A?gU(A,t,n.current):A=pU(e,r,t),n.current=t,A&&Tt.Children.map(t.children,d=>d&&Tt.cloneElement(d,{source:r}))||null}const _U=pd(()=>import("./mapbox-gl-ae992b7c.js").then(t=>t.m),[]),bI=(()=>Tt.forwardRef(function(e,n){return eU(e,n,_U)}))(),yU=iU,vU=fU,xU=mU;var EI={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(AD,function(){var n,i,r;function A(l,S){if(!n)n=S;else if(!i)i=S;else{var k="var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk);",U={};n(U),r=S(U),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}A(["exports"],function(l){function S(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var k=U;function U(h,o){this.x=h,this.y=o}U.prototype={clone:function(){return new U(this.x,this.y)},add:function(h){return this.clone()._add(h)},sub:function(h){return this.clone()._sub(h)},multByPoint:function(h){return this.clone()._multByPoint(h)},divByPoint:function(h){return this.clone()._divByPoint(h)},mult:function(h){return this.clone()._mult(h)},div:function(h){return this.clone()._div(h)},rotate:function(h){return this.clone()._rotate(h)},rotateAround:function(h,o){return this.clone()._rotateAround(h,o)},matMult:function(h){return this.clone()._matMult(h)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(h){return this.x===h.x&&this.y===h.y},dist:function(h){return Math.sqrt(this.distSqr(h))},distSqr:function(h){var o=h.x-this.x,p=h.y-this.y;return o*o+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith:function(h){return this.angleWithSep(h.x,h.y)},angleWithSep:function(h,o){return Math.atan2(this.x*o-this.y*h,this.x*h+this.y*o)},_matMult:function(h){var o=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=o,this},_add:function(h){return this.x+=h.x,this.y+=h.y,this},_sub:function(h){return this.x-=h.x,this.y-=h.y,this},_mult:function(h){return this.x*=h,this.y*=h,this},_div:function(h){return this.x/=h,this.y/=h,this},_multByPoint:function(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint:function(h){return this.x/=h.x,this.y/=h.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var h=this.y;return this.y=this.x,this.x=-h,this},_rotate:function(h){var o=Math.cos(h),p=Math.sin(h),x=p*this.x+o*this.y;return this.x=o*this.x-p*this.y,this.y=x,this},_rotateAround:function(h,o){var p=Math.cos(h),x=Math.sin(h),C=o.y+x*(this.x-o.x)+p*(this.y-o.y);return this.x=o.x+p*(this.x-o.x)-x*(this.y-o.y),this.y=C,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},U.convert=function(h){return h instanceof U?h:Array.isArray(h)?new U(h[0],h[1]):h};var V=S(k),$=X;function X(h,o,p,x){this.cx=3*h,this.bx=3*(p-h)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(x-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=h,this.p1y=o,this.p2x=p,this.p2y=x}X.prototype={sampleCurveX:function(h){return((this.ax*h+this.bx)*h+this.cx)*h},sampleCurveY:function(h){return((this.ay*h+this.by)*h+this.cy)*h},sampleCurveDerivativeX:function(h){return(3*this.ax*h+2*this.bx)*h+this.cx},solveCurveX:function(h,o){if(o===void 0&&(o=1e-6),h<0)return 0;if(h>1)return 1;for(var p=h,x=0;x<8;x++){var C=this.sampleCurveX(p)-h;if(Math.abs(C)<o)return p;var B=this.sampleCurveDerivativeX(p);if(Math.abs(B)<1e-6)break;p-=C/B}var R=0,j=1;for(p=h,x=0;x<20&&(C=this.sampleCurveX(p),!(Math.abs(C-h)<o));x++)h>C?R=p:j=p,p=.5*(j-R)+R;return p},solve:function(h,o){return this.sampleCurveY(this.solveCurveX(h,o))}};var ee=S($);function ue(h,o,p,x){const C=new ee(h,o,p,x);return function(B){return C.solve(B)}}const we=ue(.25,.1,.25,1);function ie(h,o,p){return Math.min(p,Math.max(o,h))}function Ae(h,o,p){const x=p-o,C=((h-o)%x+x)%x+o;return C===o?p:C}function ce(h,...o){for(const p of o)for(const x in p)h[x]=p[x];return h}let Ce=1;function Ne(h,o,p){const x={};for(const C in h)x[C]=o.call(p||this,h[C],C,h);return x}function qe(h,o,p){const x={};for(const C in h)o.call(p||this,h[C],C,h)&&(x[C]=h[C]);return x}function tt(h){return Array.isArray(h)?h.map(tt):typeof h=="object"&&h?Ne(h,tt):h}const lt={};function at(h){lt[h]||(typeof console<"u"&&console.warn(h),lt[h]=!0)}function ht(h,o,p){return(p.y-h.y)*(o.x-h.x)>(o.y-h.y)*(p.x-h.x)}function Et(h){let o=0;for(let p,x,C=0,B=h.length,R=B-1;C<B;R=C++)p=h[C],x=h[R],o+=(x.x-p.x)*(p.y+x.y);return o}function St(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Mt=null;function Kt(h){if(Mt==null){const o=h.navigator?h.navigator.userAgent:null;Mt=!!h.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Mt}function pn(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const ei="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let li,Nt;const dn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(h){const o=requestAnimationFrame(h);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(h,o=0){return this.getImageCanvasContext(h).getImageData(-o,-o,h.width+2*o,h.height+2*o)},getImageCanvasContext(h){const o=window.document.createElement("canvas"),p=o.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return o.width=h.width,o.height=h.height,p.drawImage(h,0,0,h.width,h.height),p},resolveURL:h=>(li||(li=document.createElement("a")),li.href=h,li.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Nt==null&&(Nt=matchMedia("(prefers-reduced-motion: reduce)")),Nt.matches)}},vn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Bn extends Error{constructor(o,p,x,C){super(`AJAXError: ${p} (${o}): ${x}`),this.status=o,this.statusText=p,this.url=x,this.body=C}}const Tn=St()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,wi=h=>vn.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))];function Un(h,o){const p=new AbortController,x=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:Tn(),signal:p.signal});let C=!1,B=!1;return h.type==="json"&&x.headers.set("Accept","application/json"),B||fetch(x).then(R=>R.ok?(j=>{(h.type==="arrayBuffer"||h.type==="image"?j.arrayBuffer():h.type==="json"?j.json():j.text()).then(H=>{B||(C=!0,o(null,H,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(H=>{B||o(new Error(H.message))})})(R):R.blob().then(j=>o(new Bn(R.status,R.statusText,h.url,j)))).catch(R=>{R.code!==20&&o(new Error(R.message))}),{cancel:()=>{B=!0,C||p.abort()}}}const Hr=function(h,o){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){if(St()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,o);if(!St())return(wi(h.url)||Un)(h,o)}if(!(/^file:/.test(p=h.url)||/^file:/.test(Tn())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Un(h,o);if(St()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,o,void 0,!0)}var p;return function(x,C){const B=new XMLHttpRequest;B.open(x.method||"GET",x.url,!0),x.type!=="arrayBuffer"&&x.type!=="image"||(B.responseType="arraybuffer");for(const R in x.headers)B.setRequestHeader(R,x.headers[R]);return x.type==="json"&&(B.responseType="text",B.setRequestHeader("Accept","application/json")),B.withCredentials=x.credentials==="include",B.onerror=()=>{C(new Error(B.statusText))},B.onload=()=>{if((B.status>=200&&B.status<300||B.status===0)&&B.response!==null){let R=B.response;if(x.type==="json")try{R=JSON.parse(B.response)}catch(j){return C(j)}C(null,R,B.getResponseHeader("Cache-Control"),B.getResponseHeader("Expires"))}else{const R=new Blob([B.response],{type:B.getResponseHeader("Content-Type")});C(new Bn(B.status,B.statusText,x.url,R))}},B.send(x.body),{cancel:()=>B.abort()}}(h,o)},qi=function(h,o){return Hr(ce(h,{type:"arrayBuffer"}),o)};function ti(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const o=new URL(h),p=window.location;return o.protocol===p.protocol&&o.host===p.host}function kr(h,o,p){p[h]&&p[h].indexOf(o)!==-1||(p[h]=p[h]||[],p[h].push(o))}function Yn(h,o,p){if(p&&p[h]){const x=p[h].indexOf(o);x!==-1&&p[h].splice(x,1)}}class si{constructor(o,p={}){ce(this,p),this.type=o}}class vr extends si{constructor(o,p={}){super("error",ce({error:o},p))}}class Lr{on(o,p){return this._listeners=this._listeners||{},kr(o,p,this._listeners),this}off(o,p){return Yn(o,p,this._listeners),Yn(o,p,this._oneTimeListeners),this}once(o,p){return p?(this._oneTimeListeners=this._oneTimeListeners||{},kr(o,p,this._oneTimeListeners),this):new Promise(x=>this.once(o,x))}fire(o,p){typeof o=="string"&&(o=new si(o,p||{}));const x=o.type;if(this.listens(x)){o.target=this;const C=this._listeners&&this._listeners[x]?this._listeners[x].slice():[];for(const j of C)j.call(this,o);const B=this._oneTimeListeners&&this._oneTimeListeners[x]?this._oneTimeListeners[x].slice():[];for(const j of B)Yn(x,j,this._oneTimeListeners),j.call(this,o);const R=this._eventedParent;R&&(ce(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),R.fire(o))}else o instanceof vr&&console.error(o.error);return this}listens(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)}setEventedParent(o,p){return this._eventedParent=o,this._eventedParentData=p,this}}var ut={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const xr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function rs(h,o){const p={};for(const x in h)x!=="ref"&&(p[x]=h[x]);return xr.forEach(x=>{x in o&&(p[x]=o[x])}),p}function Ln(h,o){if(Array.isArray(h)){if(!Array.isArray(o)||h.length!==o.length)return!1;for(let p=0;p<h.length;p++)if(!Ln(h[p],o[p]))return!1;return!0}if(typeof h=="object"&&h!==null&&o!==null){if(typeof o!="object"||Object.keys(h).length!==Object.keys(o).length)return!1;for(const p in h)if(!Ln(h[p],o[p]))return!1;return!0}return h===o}const gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ji(h,o,p){p.push({command:gn.addSource,args:[h,o[h]]})}function Ns(h,o,p){o.push({command:gn.removeSource,args:[h]}),p[h]=!0}function ro(h,o,p,x){Ns(h,p,x),ji(h,o,p)}function Qn(h,o,p){let x;for(x in h[p])if(Object.prototype.hasOwnProperty.call(h[p],x)&&x!=="data"&&!Ln(h[p][x],o[p][x]))return!1;for(x in o[p])if(Object.prototype.hasOwnProperty.call(o[p],x)&&x!=="data"&&!Ln(h[p][x],o[p][x]))return!1;return!0}function Jn(h,o,p,x,C,B){let R;for(R in o=o||{},h=h||{})Object.prototype.hasOwnProperty.call(h,R)&&(Ln(h[R],o[R])||p.push({command:B,args:[x,R,o[R],C]}));for(R in o)Object.prototype.hasOwnProperty.call(o,R)&&!Object.prototype.hasOwnProperty.call(h,R)&&(Ln(h[R],o[R])||p.push({command:B,args:[x,R,o[R],C]}))}function so(h){return h.id}function Gi(h,o){return h[o.id]=o,h}class It{constructor(o,p,x,C){this.message=(o?`${o}: `:"")+x,C&&(this.identifier=C),p!=null&&p.__line__&&(this.line=p.__line__)}}function Yi(h,...o){for(const p of o)for(const x in p)h[x]=p[x];return h}class Xi extends Error{constructor(o,p){super(p),this.message=p,this.key=o}}class Dr{constructor(o,p=[]){this.parent=o,this.bindings={};for(const[x,C]of p)this.bindings[x]=C}concat(o){return new Dr(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Wr={kind:"null"},Lt={kind:"number"},yn={kind:"string"},mn={kind:"boolean"},Qi={kind:"color"},Cs={kind:"object"},ln={kind:"value"},Br={kind:"collator"},ss={kind:"formatted"},$r={kind:"padding"},Rr={kind:"resolvedImage"},Or={kind:"variableAnchorOffsetCollection"};function ki(h,o){return{kind:"array",itemType:h,N:o}}function Xn(h){if(h.kind==="array"){const o=Xn(h.itemType);return typeof h.N=="number"?`array<${o}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${o}>`}return h.kind}const Je=[Wr,Lt,yn,mn,Qi,ss,Cs,ki(ln),$r,Rr,Or];function os(h,o){if(o.kind==="error")return null;if(h.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!os(h.itemType,o.itemType))&&(typeof h.N!="number"||h.N===o.N))return null}else{if(h.kind===o.kind)return null;if(h.kind==="value"){for(const p of Je)if(!os(p,o))return null}}return`Expected ${Xn(h)} but found ${Xn(o)} instead.`}function ke(h,o){return o.some(p=>p.kind===h.kind)}function re(h,o){return o.some(p=>p==="null"?h===null:p==="array"?Array.isArray(h):p==="object"?h&&!Array.isArray(h)&&typeof h=="object":p===typeof h)}function fe(h,o){return h.kind==="array"&&o.kind==="array"?h.itemType.kind===o.itemType.kind&&typeof h.N=="number":h.kind===o.kind}const be=.96422,Oe=.82521,je=4/29,Xe=6/29,$e=3*Xe*Xe,We=Xe*Xe*Xe,Ye=Math.PI/180,oe=180/Math.PI;function ve(h){return(h%=360)<0&&(h+=360),h}function Pe([h,o,p,x]){let C,B;const R=s((.2225045*(h=rt(h))+.7168786*(o=rt(o))+.0606169*(p=rt(p)))/1);h===o&&o===p?C=B=R:(C=s((.4360747*h+.3850649*o+.1430804*p)/be),B=s((.0139322*h+.0971045*o+.7141733*p)/Oe));const j=116*R-16;return[j<0?0:j,500*(C-R),200*(R-B),x]}function rt(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function s(h){return h>We?Math.pow(h,1/3):h/$e+je}function Z([h,o,p,x]){let C=(h+16)/116,B=isNaN(o)?C:C+o/500,R=isNaN(p)?C:C-p/200;return C=1*mt(C),B=be*mt(B),R=Oe*mt(R),[ft(3.1338561*B-1.6168667*C-.4906146*R),ft(-.9787684*B+1.9161415*C+.033454*R),ft(.0719453*B-.2289914*C+1.4052427*R),x]}function ft(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function mt(h){return h>Xe?h*h*h:$e*(h-je)}function kt(h){return parseInt(h.padEnd(2,h),16)/255}function yt(h,o){return Pt(o?h/100:h,0,1)}function Pt(h,o,p){return Math.min(Math.max(o,h),p)}function Qt(h){return!h.some(Number.isNaN)}const Vt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class pt{constructor(o,p,x,C=1,B=!0){this.r=o,this.g=p,this.b=x,this.a=C,B||(this.r*=C,this.g*=C,this.b*=C,C||this.overwriteGetter("rgb",[o,p,x,C]))}static parse(o){if(o instanceof pt)return o;if(typeof o!="string")return;const p=function(x){if((x=x.toLowerCase().trim())==="transparent")return[0,0,0,0];const C=Vt[x];if(C){const[R,j,H]=C;return[R/255,j/255,H/255,1]}if(x.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(x)){const R=x.length<6?1:2;let j=1;return[kt(x.slice(j,j+=R)),kt(x.slice(j,j+=R)),kt(x.slice(j,j+=R)),kt(x.slice(j,j+R)||"ff")]}if(x.startsWith("rgb")){const R=x.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(R){const[j,H,q,J,ne,he,me,ye,Me,Ue,He,Ke]=R,Ze=[J||" ",me||" ",Ue].join("");if(Ze==="  "||Ze==="  /"||Ze===",,"||Ze===",,,"){const et=[q,he,Me].join(""),st=et==="%%%"?100:et===""?255:0;if(st){const dt=[Pt(+H/st,0,1),Pt(+ne/st,0,1),Pt(+ye/st,0,1),He?yt(+He,Ke):1];if(Qt(dt))return dt}}return}}const B=x.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(B){const[R,j,H,q,J,ne,he,me,ye]=B,Me=[H||" ",J||" ",he].join("");if(Me==="  "||Me==="  /"||Me===",,"||Me===",,,"){const Ue=[+j,Pt(+q,0,100),Pt(+ne,0,100),me?yt(+me,ye):1];if(Qt(Ue))return function([He,Ke,Ze,et]){function st(dt){const Gt=(dt+He/30)%12,tn=Ke*Math.min(Ze,1-Ze);return Ze-tn*Math.max(-1,Math.min(Gt-3,9-Gt,1))}return He=ve(He),Ke/=100,Ze/=100,[st(0),st(8),st(4),et]}(Ue)}}}(o);return p?new pt(...p,!1):void 0}get rgb(){const{r:o,g:p,b:x,a:C}=this,B=C||1/0;return this.overwriteGetter("rgb",[o/B,p/B,x/B,C])}get hcl(){return this.overwriteGetter("hcl",function(o){const[p,x,C,B]=Pe(o),R=Math.sqrt(x*x+C*C);return[Math.round(1e4*R)?ve(Math.atan2(C,x)*oe):NaN,R,p,B]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Pe(this.rgb))}overwriteGetter(o,p){return Object.defineProperty(this,o,{value:p}),p}toString(){const[o,p,x,C]=this.rgb;return`rgba(${[o,p,x].map(B=>Math.round(255*B)).join(",")},${C})`}}pt.black=new pt(0,0,0,1),pt.white=new pt(1,1,1,1),pt.transparent=new pt(0,0,0,0),pt.red=new pt(1,0,0,1);class Dn{constructor(o,p,x){this.sensitivity=o?p?"variant":"case":p?"accent":"base",this.locale=x,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,p){return this.collator.compare(o,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class hi{constructor(o,p,x,C,B){this.text=o,this.image=p,this.scale=x,this.fontStack=C,this.textColor=B}}class ni{constructor(o){this.sections=o}static fromString(o){return new ni([new hi(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.name.length!==0)}static factory(o){return o instanceof ni?o:ni.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}}class Rn{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof Rn)return o;if(typeof o=="number")return new Rn([o,o,o,o]);if(Array.isArray(o)&&!(o.length<1||o.length>4)){for(const p of o)if(typeof p!="number")return;switch(o.length){case 1:o=[o[0],o[0],o[0],o[0]];break;case 2:o=[o[0],o[1],o[0],o[1]];break;case 3:o=[o[0],o[1],o[2],o[1]]}return new Rn(o)}}toString(){return JSON.stringify(this.values)}}const _i=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class On{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof On)return o;if(Array.isArray(o)&&!(o.length<1)&&o.length%2==0){for(let p=0;p<o.length;p+=2){const x=o[p],C=o[p+1];if(typeof x!="string"||!_i.has(x)||!Array.isArray(C)||C.length!==2||typeof C[0]!="number"||typeof C[1]!="number")return}return new On(o)}}toString(){return JSON.stringify(this.values)}}class qn{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new qn({name:o,available:!1}):null}}function ur(h,o,p,x){return typeof h=="number"&&h>=0&&h<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof p=="number"&&p>=0&&p<=255?x===void 0||typeof x=="number"&&x>=0&&x<=1?null:`Invalid rgba value [${[h,o,p,x].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof x=="number"?[h,o,p,x]:[h,o,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function an(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof pt||h instanceof Dn||h instanceof ni||h instanceof Rn||h instanceof On||h instanceof qn)return!0;if(Array.isArray(h)){for(const o of h)if(!an(o))return!1;return!0}if(typeof h=="object"){for(const o in h)if(!an(h[o]))return!1;return!0}return!1}function Ve(h){if(h===null)return Wr;if(typeof h=="string")return yn;if(typeof h=="boolean")return mn;if(typeof h=="number")return Lt;if(h instanceof pt)return Qi;if(h instanceof Dn)return Br;if(h instanceof ni)return ss;if(h instanceof Rn)return $r;if(h instanceof On)return Or;if(h instanceof qn)return Rr;if(Array.isArray(h)){const o=h.length;let p;for(const x of h){const C=Ve(x);if(p){if(p===C)continue;p=ln;break}p=C}return ki(p||ln,o)}return Cs}function Ut(h){const o=typeof h;return h===null?"":o==="string"||o==="number"||o==="boolean"?String(h):h instanceof pt||h instanceof ni||h instanceof Rn||h instanceof On||h instanceof qn?h.toString():JSON.stringify(h)}class Se{constructor(o,p){this.type=o,this.value=p}static parse(o,p){if(o.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!an(o[1]))return p.error("invalid value");const x=o[1];let C=Ve(x);const B=p.expectedType;return C.kind!=="array"||C.N!==0||!B||B.kind!=="array"||typeof B.N=="number"&&B.N!==0||(C=B),new Se(C,x)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ht{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Ki={string:yn,number:Lt,boolean:mn,object:Cs};class bi{constructor(o,p){this.type=o,this.args=p}static parse(o,p){if(o.length<2)return p.error("Expected at least one argument.");let x,C=1;const B=o[0];if(B==="array"){let j,H;if(o.length>2){const q=o[1];if(typeof q!="string"||!(q in Ki)||q==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);j=Ki[q],C++}else j=ln;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return p.error('The length argument to "array" must be a positive integer literal',2);H=o[2],C++}x=ki(j,H)}else{if(!Ki[B])throw new Error(`Types doesn't contain name = ${B}`);x=Ki[B]}const R=[];for(;C<o.length;C++){const j=p.parse(o[C],C,ln);if(!j)return null;R.push(j)}return new bi(x,R)}evaluate(o){for(let p=0;p<this.args.length;p++){const x=this.args[p].evaluate(o);if(!os(this.type,Ve(x)))return x;if(p===this.args.length-1)throw new Ht(`Expected value to be of type ${Xn(this.type)}, but found ${Xn(Ve(x))} instead.`)}throw new Error}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const Eo={"to-boolean":mn,"to-color":Qi,"to-number":Lt,"to-string":yn};class De{constructor(o,p){this.type=o,this.args=p}static parse(o,p){if(o.length<2)return p.error("Expected at least one argument.");const x=o[0];if(!Eo[x])throw new Error(`Can't parse ${x} as it is not part of the known types`);if((x==="to-boolean"||x==="to-string")&&o.length!==2)return p.error("Expected one argument.");const C=Eo[x],B=[];for(let R=1;R<o.length;R++){const j=p.parse(o[R],R,ln);if(!j)return null;B.push(j)}return new De(C,B)}evaluate(o){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(o);case"color":{let p,x;for(const C of this.args){if(p=C.evaluate(o),x=null,p instanceof pt)return p;if(typeof p=="string"){const B=o.parseColor(p);if(B)return B}else if(Array.isArray(p)&&(x=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:ur(p[0],p[1],p[2],p[3]),!x))return new pt(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Ht(x||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const x of this.args){p=x.evaluate(o);const C=Rn.parse(p);if(C)return C}throw new Ht(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const x of this.args){p=x.evaluate(o);const C=On.parse(p);if(C)return C}throw new Ht(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const x of this.args){if(p=x.evaluate(o),p===null)return 0;const C=Number(p);if(!isNaN(C))return C}throw new Ht(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return ni.fromString(Ut(this.args[0].evaluate(o)));case"resolvedImage":return qn.fromString(Ut(this.args[0].evaluate(o)));default:return Ut(this.args[0].evaluate(o))}}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const oo=["Unknown","Point","LineString","Polygon"];class _e{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?oo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(o){let p=this._parseColorCache[o];return p||(p=this._parseColorCache[o]=pt.parse(o)),p}}class ao{constructor(o,p,x=[],C,B=new Dr,R=[]){this.registry=o,this.path=x,this.key=x.map(j=>`[${j}]`).join(""),this.scope=B,this.errors=R,this.expectedType=C,this._isConstant=p}parse(o,p,x,C,B={}){return p?this.concat(p,x,C)._parse(o,B):this._parse(o,B)}_parse(o,p){function x(C,B,R){return R==="assert"?new bi(B,[C]):R==="coerce"?new De(B,[C]):C}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const C=o[0];if(typeof C!="string")return this.error(`Expression name must be a string, but found ${typeof C} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const B=this.registry[C];if(B){let R=B.parse(o,this);if(!R)return null;if(this.expectedType){const j=this.expectedType,H=R.type;if(j.kind!=="string"&&j.kind!=="number"&&j.kind!=="boolean"&&j.kind!=="object"&&j.kind!=="array"||H.kind!=="value")if(j.kind!=="color"&&j.kind!=="formatted"&&j.kind!=="resolvedImage"||H.kind!=="value"&&H.kind!=="string")if(j.kind!=="padding"||H.kind!=="value"&&H.kind!=="number"&&H.kind!=="array")if(j.kind!=="variableAnchorOffsetCollection"||H.kind!=="value"&&H.kind!=="array"){if(this.checkSubtype(j,H))return null}else R=x(R,j,p.typeAnnotation||"coerce");else R=x(R,j,p.typeAnnotation||"coerce");else R=x(R,j,p.typeAnnotation||"coerce");else R=x(R,j,p.typeAnnotation||"assert")}if(!(R instanceof Se)&&R.type.kind!=="resolvedImage"&&this._isConstant(R)){const j=new _e;try{R=new Se(R.type,R.evaluate(j))}catch(H){return this.error(H.message),null}}return R}return this.error(`Unknown expression "${C}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,p,x){const C=typeof o=="number"?this.path.concat(o):this.path,B=x?this.scope.concat(x):this.scope;return new ao(this.registry,this._isConstant,C,p||null,B,this.errors)}error(o,...p){const x=`${this.key}${p.map(C=>`[${C}]`).join("")}`;this.errors.push(new Xi(x,o))}checkSubtype(o,p){const x=os(o,p);return x&&this.error(x),x}}class cr{constructor(o,p,x){this.type=Br,this.locale=x,this.caseSensitive=o,this.diacriticSensitive=p}static parse(o,p){if(o.length!==2)return p.error("Expected one argument.");const x=o[1];if(typeof x!="object"||Array.isArray(x))return p.error("Collator options argument must be an object.");const C=p.parse(x["case-sensitive"]!==void 0&&x["case-sensitive"],1,mn);if(!C)return null;const B=p.parse(x["diacritic-sensitive"]!==void 0&&x["diacritic-sensitive"],1,mn);if(!B)return null;let R=null;return x.locale&&(R=p.parse(x.locale,1,yn),!R)?null:new cr(C,B,R)}evaluate(o){return new Dn(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}}const Us=8192;function Xo(h,o){h[0]=Math.min(h[0],o[0]),h[1]=Math.min(h[1],o[1]),h[2]=Math.max(h[2],o[0]),h[3]=Math.max(h[3],o[1])}function Vs(h,o){return!(h[0]<=o[0]||h[2]>=o[2]||h[1]<=o[1]||h[3]>=o[3])}function XA(h,o){const p=(180+h[0])/360,x=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,C=Math.pow(2,o.z);return[Math.round(p*C*Us),Math.round(x*C*Us)]}function Ko(h,o,p){const x=h[0]-o[0],C=h[1]-o[1],B=h[0]-p[0],R=h[1]-p[1];return x*R-B*C==0&&x*B<=0&&C*R<=0}function hr(h,o){let p=!1;for(let R=0,j=o.length;R<j;R++){const H=o[R];for(let q=0,J=H.length;q<J-1;q++){if(Ko(h,H[q],H[q+1]))return!1;(C=H[q])[1]>(x=h)[1]!=(B=H[q+1])[1]>x[1]&&x[0]<(B[0]-C[0])*(x[1]-C[1])/(B[1]-C[1])+C[0]&&(p=!p)}}var x,C,B;return p}function ge(h,o){for(let p=0;p<o.length;p++)if(hr(h,o[p]))return!0;return!1}function Ee(h,o,p,x){const C=x[0]-p[0],B=x[1]-p[1],R=(h[0]-p[0])*B-C*(h[1]-p[1]),j=(o[0]-p[0])*B-C*(o[1]-p[1]);return R>0&&j<0||R<0&&j>0}function Ge(h,o,p){for(const q of p)for(let J=0;J<q.length-1;++J)if((j=[(R=q[J+1])[0]-(B=q[J])[0],R[1]-B[1]])[0]*(H=[(C=o)[0]-(x=h)[0],C[1]-x[1]])[1]-j[1]*H[0]!=0&&Ee(x,C,B,R)&&Ee(B,R,x,C))return!0;var x,C,B,R,j,H;return!1}function ot(h,o){for(let p=0;p<h.length;++p)if(!hr(h[p],o))return!1;for(let p=0;p<h.length-1;++p)if(Ge(h[p],h[p+1],o))return!1;return!0}function vt(h,o){for(let p=0;p<o.length;p++)if(ot(h,o[p]))return!0;return!1}function Zt(h,o,p){const x=[];for(let C=0;C<h.length;C++){const B=[];for(let R=0;R<h[C].length;R++){const j=XA(h[C][R],p);Xo(o,j),B.push(j)}x.push(B)}return x}function Cn(h,o,p){const x=[];for(let C=0;C<h.length;C++){const B=Zt(h[C],o,p);x.push(B)}return x}function Ei(h,o,p,x){if(h[0]<p[0]||h[0]>p[2]){const C=.5*x;let B=h[0]-p[0]>C?-x:p[0]-h[0]>C?x:0;B===0&&(B=h[0]-p[2]>C?-x:p[2]-h[0]>C?x:0),h[0]+=B}Xo(o,h)}function wn(h,o,p,x){const C=Math.pow(2,x.z)*Us,B=[x.x*Us,x.y*Us],R=[];for(const j of h)for(const H of j){const q=[H.x+B[0],H.y+B[1]];Ei(q,o,p,C),R.push(q)}return R}function Li(h,o,p,x){const C=Math.pow(2,x.z)*Us,B=[x.x*Us,x.y*Us],R=[];for(const H of h){const q=[];for(const J of H){const ne=[J.x+B[0],J.y+B[1]];Xo(o,ne),q.push(ne)}R.push(q)}if(o[2]-o[0]<=C/2){(j=o)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const H of R)for(const q of H)Ei(q,o,p,C)}var j;return R}class En{constructor(o,p){this.type=mn,this.geojson=o,this.geometries=p}static parse(o,p){if(o.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(an(o[1])){const x=o[1];if(x.type==="FeatureCollection")for(let C=0;C<x.features.length;++C){const B=x.features[C].geometry.type;if(B==="Polygon"||B==="MultiPolygon")return new En(x,x.features[C].geometry)}else if(x.type==="Feature"){const C=x.geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new En(x,x.geometry)}else if(x.type==="Polygon"||x.type==="MultiPolygon")return new En(x,x)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(p,x){const C=[1/0,1/0,-1/0,-1/0],B=[1/0,1/0,-1/0,-1/0],R=p.canonicalID();if(x.type==="Polygon"){const j=Zt(x.coordinates,B,R),H=wn(p.geometry(),C,B,R);if(!Vs(C,B))return!1;for(const q of H)if(!hr(q,j))return!1}if(x.type==="MultiPolygon"){const j=Cn(x.coordinates,B,R),H=wn(p.geometry(),C,B,R);if(!Vs(C,B))return!1;for(const q of H)if(!ge(q,j))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(p,x){const C=[1/0,1/0,-1/0,-1/0],B=[1/0,1/0,-1/0,-1/0],R=p.canonicalID();if(x.type==="Polygon"){const j=Zt(x.coordinates,B,R),H=Li(p.geometry(),C,B,R);if(!Vs(C,B))return!1;for(const q of H)if(!ot(q,j))return!1}if(x.type==="MultiPolygon"){const j=Cn(x.coordinates,B,R),H=Li(p.geometry(),C,B,R);if(!Vs(C,B))return!1;for(const q of H)if(!vt(q,j))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class za{constructor(o,p){this.type=p.type,this.name=o,this.boundExpression=p}static parse(o,p){if(o.length!==2||typeof o[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const x=o[1];return p.scope.has(x)?new za(x,p.scope.get(x)):p.error(`Unknown variable "${x}". Make sure "${x}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}}class zr{constructor(o,p,x,C){this.name=o,this.type=p,this._evaluate=x,this.args=C}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}static parse(o,p){const x=o[0],C=zr.definitions[x];if(!C)return p.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0);const B=Array.isArray(C)?C[0]:C.type,R=Array.isArray(C)?[[C[1],C[2]]]:C.overloads,j=R.filter(([q])=>!Array.isArray(q)||q.length===o.length-1);let H=null;for(const[q,J]of j){H=new ao(p.registry,aA,p.path,null,p.scope);const ne=[];let he=!1;for(let me=1;me<o.length;me++){const ye=o[me],Me=Array.isArray(q)?q[me-1]:q.type,Ue=H.parse(ye,1+ne.length,Me);if(!Ue){he=!0;break}ne.push(Ue)}if(!he)if(Array.isArray(q)&&q.length!==ne.length)H.error(`Expected ${q.length} arguments, but found ${ne.length} instead.`);else{for(let me=0;me<ne.length;me++){const ye=Array.isArray(q)?q[me]:q.type,Me=ne[me];H.concat(me+1).checkSubtype(ye,Me.type)}if(H.errors.length===0)return new zr(x,B,J,ne)}}if(j.length===1)p.errors.push(...H.errors);else{const q=(j.length?j:R).map(([ne])=>{return he=ne,Array.isArray(he)?`(${he.map(Xn).join(", ")})`:`(${Xn(he.type)}...)`;var he}).join(" | "),J=[];for(let ne=1;ne<o.length;ne++){const he=p.parse(o[ne],1+J.length);if(!he)return null;J.push(Xn(he.type))}p.error(`Expected arguments of type ${q}, but found (${J.join(", ")}) instead.`)}return null}static register(o,p){zr.definitions=p;for(const x in p)o[x]=zr}}function aA(h){if(h instanceof za)return aA(h.boundExpression);if(h instanceof zr&&h.name==="error"||h instanceof cr||h instanceof En)return!1;const o=h instanceof De||h instanceof bi;let p=!0;return h.eachChild(x=>{p=o?p&&aA(x):p&&x instanceof Se}),!!p&&AA(h)&&To(h,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function AA(h){if(h instanceof zr&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof En)return!1;let o=!0;return h.eachChild(p=>{o&&!AA(p)&&(o=!1)}),o}function Jo(h){if(h instanceof zr&&h.name==="feature-state")return!1;let o=!0;return h.eachChild(p=>{o&&!Jo(p)&&(o=!1)}),o}function To(h,o){if(h instanceof zr&&o.indexOf(h.name)>=0)return!1;let p=!0;return h.eachChild(x=>{p&&!To(x,o)&&(p=!1)}),p}function ea(h,o){const p=h.length-1;let x,C,B=0,R=p,j=0;for(;B<=R;)if(j=Math.floor((B+R)/2),x=h[j],C=h[j+1],x<=o){if(j===p||o<C)return j;B=j+1}else{if(!(x>o))throw new Ht("Input is not a number.");R=j-1}return 0}class ta{constructor(o,p,x){this.type=o,this.input=p,this.labels=[],this.outputs=[];for(const[C,B]of x)this.labels.push(C),this.outputs.push(B)}static parse(o,p){if(o.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return p.error("Expected an even number of arguments.");const x=p.parse(o[1],1,Lt);if(!x)return null;const C=[];let B=null;p.expectedType&&p.expectedType.kind!=="value"&&(B=p.expectedType);for(let R=1;R<o.length;R+=2){const j=R===1?-1/0:o[R],H=o[R+1],q=R,J=R+1;if(typeof j!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(C.length&&C[C.length-1][0]>=j)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',q);const ne=p.parse(H,J,B);if(!ne)return null;B=B||ne.type,C.push([j,ne])}return new ta(B,x,C)}evaluate(o){const p=this.labels,x=this.outputs;if(p.length===1)return x[0].evaluate(o);const C=this.input.evaluate(o);if(C<=p[0])return x[0].evaluate(o);const B=p.length;return C>=p[B-1]?x[B-1].evaluate(o):x[ea(p,C)].evaluate(o)}eachChild(o){o(this.input);for(const p of this.outputs)o(p)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function So(h,o,p){return h+p*(o-h)}function lA(h,o,p){return h.map((x,C)=>So(x,o[C],p))}const fr={number:So,color:function(h,o,p,x="rgb"){switch(x){case"rgb":{const[C,B,R,j]=lA(h.rgb,o.rgb,p);return new pt(C,B,R,j,!1)}case"hcl":{const[C,B,R,j]=h.hcl,[H,q,J,ne]=o.hcl;let he,me;if(isNaN(C)||isNaN(H))isNaN(C)?isNaN(H)?he=NaN:(he=H,R!==1&&R!==0||(me=q)):(he=C,J!==1&&J!==0||(me=B));else{let Ke=H-C;H>C&&Ke>180?Ke-=360:H<C&&C-H>180&&(Ke+=360),he=C+p*Ke}const[ye,Me,Ue,He]=function([Ke,Ze,et,st]){return Ke=isNaN(Ke)?0:Ke*Ye,Z([et,Math.cos(Ke)*Ze,Math.sin(Ke)*Ze,st])}([he,me??So(B,q,p),So(R,J,p),So(j,ne,p)]);return new pt(ye,Me,Ue,He,!1)}case"lab":{const[C,B,R,j]=Z(lA(h.lab,o.lab,p));return new pt(C,B,R,j,!1)}}},array:lA,padding:function(h,o,p){return new Rn(lA(h.values,o.values,p))},variableAnchorOffsetCollection:function(h,o,p){const x=h.values,C=o.values;if(x.length!==C.length)throw new Ht(`Cannot interpolate values of different length. from: ${h.toString()}, to: ${o.toString()}`);const B=[];for(let R=0;R<x.length;R+=2){if(x[R]!==C[R])throw new Ht(`Cannot interpolate values containing mismatched anchors. from[${R}]: ${x[R]}, to[${R}]: ${C[R]}`);B.push(x[R]);const[j,H]=x[R+1],[q,J]=C[R+1];B.push([So(j,q,p),So(H,J,p)])}return new On(B)}};class Fr{constructor(o,p,x,C,B){this.type=o,this.operator=p,this.interpolation=x,this.input=C,this.labels=[],this.outputs=[];for(const[R,j]of B)this.labels.push(R),this.outputs.push(j)}static interpolationFactor(o,p,x,C){let B=0;if(o.name==="exponential")B=KA(p,o.base,x,C);else if(o.name==="linear")B=KA(p,1,x,C);else if(o.name==="cubic-bezier"){const R=o.controlPoints;B=new ee(R[0],R[1],R[2],R[3]).solve(KA(p,1,x,C))}return B}static parse(o,p){let[x,C,B,...R]=o;if(!Array.isArray(C)||C.length===0)return p.error("Expected an interpolation type expression.",1);if(C[0]==="linear")C={name:"linear"};else if(C[0]==="exponential"){const q=C[1];if(typeof q!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);C={name:"exponential",base:q}}else{if(C[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(C[0])}`,1,0);{const q=C.slice(1);if(q.length!==4||q.some(J=>typeof J!="number"||J<0||J>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);C={name:"cubic-bezier",controlPoints:q}}}if(o.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(B=p.parse(B,2,Lt),!B)return null;const j=[];let H=null;x==="interpolate-hcl"||x==="interpolate-lab"?H=Qi:p.expectedType&&p.expectedType.kind!=="value"&&(H=p.expectedType);for(let q=0;q<R.length;q+=2){const J=R[q],ne=R[q+1],he=q+3,me=q+4;if(typeof J!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',he);if(j.length&&j[j.length-1][0]>=J)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',he);const ye=p.parse(ne,me,H);if(!ye)return null;H=H||ye.type,j.push([J,ye])}return fe(H,Lt)||fe(H,Qi)||fe(H,$r)||fe(H,Or)||fe(H,ki(Lt))?new Fr(H,x,C,B,j):p.error(`Type ${Xn(H)} is not interpolatable.`)}evaluate(o){const p=this.labels,x=this.outputs;if(p.length===1)return x[0].evaluate(o);const C=this.input.evaluate(o);if(C<=p[0])return x[0].evaluate(o);const B=p.length;if(C>=p[B-1])return x[B-1].evaluate(o);const R=ea(p,C),j=Fr.interpolationFactor(this.interpolation,C,p[R],p[R+1]),H=x[R].evaluate(o),q=x[R+1].evaluate(o);switch(this.operator){case"interpolate":return fr[this.type.kind](H,q,j);case"interpolate-hcl":return fr.color(H,q,j,"hcl");case"interpolate-lab":return fr.color(H,q,j,"lab")}}eachChild(o){o(this.input);for(const p of this.outputs)o(p)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function KA(h,o,p,x){const C=x-p,B=h-p;return C===0?0:o===1?B/C:(Math.pow(o,B)-1)/(Math.pow(o,C)-1)}class JA{constructor(o,p){this.type=o,this.args=p}static parse(o,p){if(o.length<2)return p.error("Expectected at least one argument.");let x=null;const C=p.expectedType;C&&C.kind!=="value"&&(x=C);const B=[];for(const j of o.slice(1)){const H=p.parse(j,1+B.length,x,void 0,{typeAnnotation:"omit"});if(!H)return null;x=x||H.type,B.push(H)}if(!x)throw new Error("No output type");const R=C&&B.some(j=>os(C,j.type));return new JA(R?ln:x,B)}evaluate(o){let p,x=null,C=0;for(const B of this.args)if(C++,x=B.evaluate(o),x&&x instanceof qn&&!x.available&&(p||(p=x.name),x=null,C===this.args.length&&(x=p)),x!==null)break;return x}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}class Ti{constructor(o,p){this.type=p.type,this.bindings=[].concat(o),this.result=p}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const p of this.bindings)o(p[1]);o(this.result)}static parse(o,p){if(o.length<4)return p.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const x=[];for(let B=1;B<o.length-1;B+=2){const R=o[B];if(typeof R!="string")return p.error(`Expected string, but found ${typeof R} instead.`,B);if(/[^a-zA-Z0-9_]/.test(R))return p.error("Variable names must contain only alphanumeric characters or '_'.",B);const j=p.parse(o[B+1],B+1);if(!j)return null;x.push([R,j])}const C=p.parse(o[o.length-1],o.length-1,p.expectedType,x);return C?new Ti(x,C):null}outputDefined(){return this.result.outputDefined()}}class as{constructor(o,p,x){this.type=o,this.index=p,this.input=x}static parse(o,p){if(o.length!==3)return p.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const x=p.parse(o[1],1,Lt),C=p.parse(o[2],2,ki(p.expectedType||ln));return x&&C?new as(C.type.itemType,x,C):null}evaluate(o){const p=this.index.evaluate(o),x=this.input.evaluate(o);if(p<0)throw new Ht(`Array index out of bounds: ${p} < 0.`);if(p>=x.length)throw new Ht(`Array index out of bounds: ${p} > ${x.length-1}.`);if(p!==Math.floor(p))throw new Ht(`Array index must be an integer, but found ${p} instead.`);return x[p]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}}class rn{constructor(o,p){this.type=mn,this.needle=o,this.haystack=p}static parse(o,p){if(o.length!==3)return p.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const x=p.parse(o[1],1,ln),C=p.parse(o[2],2,ln);return x&&C?ke(x.type,[mn,yn,Lt,Wr,ln])?new rn(x,C):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(x.type)} instead`):null}evaluate(o){const p=this.needle.evaluate(o),x=this.haystack.evaluate(o);if(!x)return!1;if(!re(p,["boolean","string","number","null"]))throw new Ht(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(Ve(p))} instead.`);if(!re(x,["string","array"]))throw new Ht(`Expected second argument to be of type array or string, but found ${Xn(Ve(x))} instead.`);return x.indexOf(p)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}}class As{constructor(o,p,x){this.type=Lt,this.needle=o,this.haystack=p,this.fromIndex=x}static parse(o,p){if(o.length<=2||o.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const x=p.parse(o[1],1,ln),C=p.parse(o[2],2,ln);if(!x||!C)return null;if(!ke(x.type,[mn,yn,Lt,Wr,ln]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(x.type)} instead`);if(o.length===4){const B=p.parse(o[3],3,Lt);return B?new As(x,C,B):null}return new As(x,C)}evaluate(o){const p=this.needle.evaluate(o),x=this.haystack.evaluate(o);if(!re(p,["boolean","string","number","null"]))throw new Ht(`Expected first argument to be of type boolean, string, number or null, but found ${Xn(Ve(p))} instead.`);if(!re(x,["string","array"]))throw new Ht(`Expected second argument to be of type array or string, but found ${Xn(Ve(x))} instead.`);if(this.fromIndex){const C=this.fromIndex.evaluate(o);return x.indexOf(p,C)}return x.indexOf(p)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}}class Hi{constructor(o,p,x,C,B,R){this.inputType=o,this.type=p,this.input=x,this.cases=C,this.outputs=B,this.otherwise=R}static parse(o,p){if(o.length<5)return p.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return p.error("Expected an even number of arguments.");let x,C;p.expectedType&&p.expectedType.kind!=="value"&&(C=p.expectedType);const B={},R=[];for(let q=2;q<o.length-1;q+=2){let J=o[q];const ne=o[q+1];Array.isArray(J)||(J=[J]);const he=p.concat(q);if(J.length===0)return he.error("Expected at least one branch label.");for(const ye of J){if(typeof ye!="number"&&typeof ye!="string")return he.error("Branch labels must be numbers or strings.");if(typeof ye=="number"&&Math.abs(ye)>Number.MAX_SAFE_INTEGER)return he.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ye=="number"&&Math.floor(ye)!==ye)return he.error("Numeric branch labels must be integer values.");if(x){if(he.checkSubtype(x,Ve(ye)))return null}else x=Ve(ye);if(B[String(ye)]!==void 0)return he.error("Branch labels must be unique.");B[String(ye)]=R.length}const me=p.parse(ne,q,C);if(!me)return null;C=C||me.type,R.push(me)}const j=p.parse(o[1],1,ln);if(!j)return null;const H=p.parse(o[o.length-1],o.length-1,C);return H?j.type.kind!=="value"&&p.concat(1).checkSubtype(x,j.type)?null:new Hi(x,C,j,B,R,H):null}evaluate(o){const p=this.input.evaluate(o);return(Ve(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}}class Co{constructor(o,p,x){this.type=o,this.branches=p,this.otherwise=x}static parse(o,p){if(o.length<4)return p.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return p.error("Expected an odd number of arguments.");let x;p.expectedType&&p.expectedType.kind!=="value"&&(x=p.expectedType);const C=[];for(let R=1;R<o.length-1;R+=2){const j=p.parse(o[R],R,mn);if(!j)return null;const H=p.parse(o[R+1],R+1,x);if(!H)return null;C.push([j,H]),x=x||H.type}const B=p.parse(o[o.length-1],o.length-1,x);if(!B)return null;if(!x)throw new Error("Can't infer output type");return new Co(x,C,B)}evaluate(o){for(const[p,x]of this.branches)if(p.evaluate(o))return x.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[p,x]of this.branches)o(p),o(x);o(this.otherwise)}outputDefined(){return this.branches.every(([o,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class Fa{constructor(o,p,x,C){this.type=o,this.input=p,this.beginIndex=x,this.endIndex=C}static parse(o,p){if(o.length<=2||o.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const x=p.parse(o[1],1,ln),C=p.parse(o[2],2,Lt);if(!x||!C)return null;if(!ke(x.type,[ki(ln),yn,ln]))return p.error(`Expected first argument to be of type array or string, but found ${Xn(x.type)} instead`);if(o.length===4){const B=p.parse(o[3],3,Lt);return B?new Fa(x.type,x,C,B):null}return new Fa(x.type,x,C)}evaluate(o){const p=this.input.evaluate(o),x=this.beginIndex.evaluate(o);if(!re(p,["string","array"]))throw new Ht(`Expected first argument to be of type array or string, but found ${Xn(Ve(p))} instead.`);if(this.endIndex){const C=this.endIndex.evaluate(o);return p.slice(x,C)}return p.slice(x)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}}function na(h,o){return h==="=="||h==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function uA(h,o,p,x){return x.compare(o,p)===0}function ls(h,o,p){const x=h!=="=="&&h!=="!=";return class TI{constructor(B,R,j){this.type=mn,this.lhs=B,this.rhs=R,this.collator=j,this.hasUntypedArgument=B.type.kind==="value"||R.type.kind==="value"}static parse(B,R){if(B.length!==3&&B.length!==4)return R.error("Expected two or three arguments.");const j=B[0];let H=R.parse(B[1],1,ln);if(!H)return null;if(!na(j,H.type))return R.concat(1).error(`"${j}" comparisons are not supported for type '${Xn(H.type)}'.`);let q=R.parse(B[2],2,ln);if(!q)return null;if(!na(j,q.type))return R.concat(2).error(`"${j}" comparisons are not supported for type '${Xn(q.type)}'.`);if(H.type.kind!==q.type.kind&&H.type.kind!=="value"&&q.type.kind!=="value")return R.error(`Cannot compare types '${Xn(H.type)}' and '${Xn(q.type)}'.`);x&&(H.type.kind==="value"&&q.type.kind!=="value"?H=new bi(q.type,[H]):H.type.kind!=="value"&&q.type.kind==="value"&&(q=new bi(H.type,[q])));let J=null;if(B.length===4){if(H.type.kind!=="string"&&q.type.kind!=="string"&&H.type.kind!=="value"&&q.type.kind!=="value")return R.error("Cannot use collator to compare non-string types.");if(J=R.parse(B[3],3,Br),!J)return null}return new TI(H,q,J)}evaluate(B){const R=this.lhs.evaluate(B),j=this.rhs.evaluate(B);if(x&&this.hasUntypedArgument){const H=Ve(R),q=Ve(j);if(H.kind!==q.kind||H.kind!=="string"&&H.kind!=="number")throw new Ht(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${H.kind}, ${q.kind}) instead.`)}if(this.collator&&!x&&this.hasUntypedArgument){const H=Ve(R),q=Ve(j);if(H.kind!=="string"||q.kind!=="string")return o(B,R,j)}return this.collator?p(B,R,j,this.collator.evaluate(B)):o(B,R,j)}eachChild(B){B(this.lhs),B(this.rhs),this.collator&&B(this.collator)}outputDefined(){return!0}}}const Eu=ls("==",function(h,o,p){return o===p},uA),Ml=ls("!=",function(h,o,p){return o!==p},function(h,o,p,x){return!uA(0,o,p,x)}),ia=ls("<",function(h,o,p){return o<p},function(h,o,p,x){return x.compare(o,p)<0}),Zr=ls(">",function(h,o,p){return o>p},function(h,o,p,x){return x.compare(o,p)>0}),Ao=ls("<=",function(h,o,p){return o<=p},function(h,o,p,x){return x.compare(o,p)<=0}),Il=ls(">=",function(h,o,p){return o>=p},function(h,o,p,x){return x.compare(o,p)>=0});class ra{constructor(o,p,x,C,B){this.type=yn,this.number=o,this.locale=p,this.currency=x,this.minFractionDigits=C,this.maxFractionDigits=B}static parse(o,p){if(o.length!==3)return p.error("Expected two arguments.");const x=p.parse(o[1],1,Lt);if(!x)return null;const C=o[2];if(typeof C!="object"||Array.isArray(C))return p.error("NumberFormat options argument must be an object.");let B=null;if(C.locale&&(B=p.parse(C.locale,1,yn),!B))return null;let R=null;if(C.currency&&(R=p.parse(C.currency,1,yn),!R))return null;let j=null;if(C["min-fraction-digits"]&&(j=p.parse(C["min-fraction-digits"],1,Lt),!j))return null;let H=null;return C["max-fraction-digits"]&&(H=p.parse(C["max-fraction-digits"],1,Lt),!H)?null:new ra(x,B,R,j,H)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}}class us{constructor(o){this.type=ss,this.sections=o}static parse(o,p){if(o.length<2)return p.error("Expected at least one argument.");const x=o[1];if(!Array.isArray(x)&&typeof x=="object")return p.error("First argument must be an image or text section.");const C=[];let B=!1;for(let R=1;R<=o.length-1;++R){const j=o[R];if(B&&typeof j=="object"&&!Array.isArray(j)){B=!1;let H=null;if(j["font-scale"]&&(H=p.parse(j["font-scale"],1,Lt),!H))return null;let q=null;if(j["text-font"]&&(q=p.parse(j["text-font"],1,ki(yn)),!q))return null;let J=null;if(j["text-color"]&&(J=p.parse(j["text-color"],1,Qi),!J))return null;const ne=C[C.length-1];ne.scale=H,ne.font=q,ne.textColor=J}else{const H=p.parse(o[R],1,ln);if(!H)return null;const q=H.type.kind;if(q!=="string"&&q!=="value"&&q!=="null"&&q!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");B=!0,C.push({content:H,scale:null,font:null,textColor:null})}}return new us(C)}evaluate(o){return new ni(this.sections.map(p=>{const x=p.content.evaluate(o);return Ve(x)===Rr?new hi("",x,null,null,null):new hi(Ut(x),null,p.scale?p.scale.evaluate(o):null,p.font?p.font.evaluate(o).join(","):null,p.textColor?p.textColor.evaluate(o):null)}))}eachChild(o){for(const p of this.sections)o(p.content),p.scale&&o(p.scale),p.font&&o(p.font),p.textColor&&o(p.textColor)}outputDefined(){return!1}}class js{constructor(o){this.type=Rr,this.input=o}static parse(o,p){if(o.length!==2)return p.error("Expected two arguments.");const x=p.parse(o[1],1,yn);return x?new js(x):p.error("No image name provided.")}evaluate(o){const p=this.input.evaluate(o),x=qn.fromString(p);return x&&o.availableImages&&(x.available=o.availableImages.indexOf(p)>-1),x}eachChild(o){o(this.input)}outputDefined(){return!1}}class el{constructor(o){this.type=Lt,this.input=o}static parse(o,p){if(o.length!==2)return p.error(`Expected 1 argument, but found ${o.length-1} instead.`);const x=p.parse(o[1],1);return x?x.type.kind!=="array"&&x.type.kind!=="string"&&x.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${Xn(x.type)} instead.`):new el(x):null}evaluate(o){const p=this.input.evaluate(o);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Ht(`Expected value to be of type string or array, but found ${Xn(Ve(p))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}}const Po={"==":Eu,"!=":Ml,">":Zr,"<":ia,">=":Il,"<=":Ao,array:bi,at:as,boolean:bi,case:Co,coalesce:JA,collator:cr,format:us,image:js,in:rn,"index-of":As,interpolate:Fr,"interpolate-hcl":Fr,"interpolate-lab":Fr,length:el,let:Ti,literal:Se,match:Hi,number:bi,"number-format":ra,object:bi,slice:Fa,step:ta,string:bi,"to-boolean":De,"to-color":De,"to-number":De,"to-string":De,var:za,within:En};function tl(h,[o,p,x,C]){o=o.evaluate(h),p=p.evaluate(h),x=x.evaluate(h);const B=C?C.evaluate(h):1,R=ur(o,p,x,B);if(R)throw new Ht(R);return new pt(o/255,p/255,x/255,B,!1)}function Tu(h,o){return h in o}function kl(h,o){const p=o[h];return p===void 0?null:p}function cs(h){return{type:h}}function Su(h){return{result:"success",value:h}}function sa(h){return{result:"error",value:h}}function oa(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function aa(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function Ll(h){return!!h.expression&&h.expression.interpolated}function Hn(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function cA(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function hA(h){return h}function Gs(h,o){const p=o.type==="color",x=h.stops&&typeof h.stops[0][0]=="object",C=x||!(x||h.property!==void 0),B=h.type||(Ll(o)?"exponential":"interval");if(p||o.type==="padding"){const J=p?pt.parse:Rn.parse;(h=Yi({},h)).stops&&(h.stops=h.stops.map(ne=>[ne[0],J(ne[1])])),h.default=J(h.default?h.default:o.default)}if(h.colorSpace&&(R=h.colorSpace)!=="rgb"&&R!=="hcl"&&R!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var R;let j,H,q;if(B==="exponential")j=Na;else if(B==="interval")j=vc;else if(B==="categorical"){j=fA,H=Object.create(null);for(const J of h.stops)H[J[0]]=J[1];q=typeof h.stops[0][0]}else{if(B!=="identity")throw new Error(`Unknown function type "${B}"`);j=xc}if(x){const J={},ne=[];for(let ye=0;ye<h.stops.length;ye++){const Me=h.stops[ye],Ue=Me[0].zoom;J[Ue]===void 0&&(J[Ue]={zoom:Ue,type:h.type,property:h.property,default:h.default,stops:[]},ne.push(Ue)),J[Ue].stops.push([Me[0].value,Me[1]])}const he=[];for(const ye of ne)he.push([J[ye].zoom,Gs(J[ye],o)]);const me={name:"linear"};return{kind:"composite",interpolationType:me,interpolationFactor:Fr.interpolationFactor.bind(void 0,me),zoomStops:he.map(ye=>ye[0]),evaluate:({zoom:ye},Me)=>Na({stops:he,base:h.base},o,ye).evaluate(ye,Me)}}if(C){const J=B==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:J,interpolationFactor:Fr.interpolationFactor.bind(void 0,J),zoomStops:h.stops.map(ne=>ne[0]),evaluate:({zoom:ne})=>j(h,o,ne,H,q)}}return{kind:"source",evaluate(J,ne){const he=ne&&ne.properties?ne.properties[h.property]:void 0;return he===void 0?Aa(h.default,o.default):j(h,o,he,H,q)}}}function Aa(h,o,p){return h!==void 0?h:o!==void 0?o:p!==void 0?p:void 0}function fA(h,o,p,x,C){return Aa(typeof p===C?x[p]:void 0,h.default,o.default)}function vc(h,o,p){if(Hn(p)!=="number")return Aa(h.default,o.default);const x=h.stops.length;if(x===1||p<=h.stops[0][0])return h.stops[0][1];if(p>=h.stops[x-1][0])return h.stops[x-1][1];const C=ea(h.stops.map(B=>B[0]),p);return h.stops[C][1]}function Na(h,o,p){const x=h.base!==void 0?h.base:1;if(Hn(p)!=="number")return Aa(h.default,o.default);const C=h.stops.length;if(C===1||p<=h.stops[0][0])return h.stops[0][1];if(p>=h.stops[C-1][0])return h.stops[C-1][1];const B=ea(h.stops.map(J=>J[0]),p),R=function(J,ne,he,me){const ye=me-he,Me=J-he;return ye===0?0:ne===1?Me/ye:(Math.pow(ne,Me)-1)/(Math.pow(ne,ye)-1)}(p,x,h.stops[B][0],h.stops[B+1][0]),j=h.stops[B][1],H=h.stops[B+1][1],q=fr[o.type]||hA;return typeof j.evaluate=="function"?{evaluate(...J){const ne=j.evaluate.apply(void 0,J),he=H.evaluate.apply(void 0,J);if(ne!==void 0&&he!==void 0)return q(ne,he,R,h.colorSpace)}}:q(j,H,R,h.colorSpace)}function xc(h,o,p){switch(o.type){case"color":p=pt.parse(p);break;case"formatted":p=ni.fromString(p.toString());break;case"resolvedImage":p=qn.fromString(p.toString());break;case"padding":p=Rn.parse(p);break;default:Hn(p)===o.type||o.type==="enum"&&o.values[p]||(p=void 0)}return Aa(p,h.default,o.default)}zr.register(Po,{error:[{kind:"error"},[yn],(h,[o])=>{throw new Ht(o.evaluate(h))}],typeof:[yn,[ln],(h,[o])=>Xn(Ve(o.evaluate(h)))],"to-rgba":[ki(Lt,4),[Qi],(h,[o])=>{const[p,x,C,B]=o.evaluate(h).rgb;return[255*p,255*x,255*C,B]}],rgb:[Qi,[Lt,Lt,Lt],tl],rgba:[Qi,[Lt,Lt,Lt,Lt],tl],has:{type:mn,overloads:[[[yn],(h,[o])=>Tu(o.evaluate(h),h.properties())],[[yn,Cs],(h,[o,p])=>Tu(o.evaluate(h),p.evaluate(h))]]},get:{type:ln,overloads:[[[yn],(h,[o])=>kl(o.evaluate(h),h.properties())],[[yn,Cs],(h,[o,p])=>kl(o.evaluate(h),p.evaluate(h))]]},"feature-state":[ln,[yn],(h,[o])=>kl(o.evaluate(h),h.featureState||{})],properties:[Cs,[],h=>h.properties()],"geometry-type":[yn,[],h=>h.geometryType()],id:[ln,[],h=>h.id()],zoom:[Lt,[],h=>h.globals.zoom],"heatmap-density":[Lt,[],h=>h.globals.heatmapDensity||0],"line-progress":[Lt,[],h=>h.globals.lineProgress||0],accumulated:[ln,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[Lt,cs(Lt),(h,o)=>{let p=0;for(const x of o)p+=x.evaluate(h);return p}],"*":[Lt,cs(Lt),(h,o)=>{let p=1;for(const x of o)p*=x.evaluate(h);return p}],"-":{type:Lt,overloads:[[[Lt,Lt],(h,[o,p])=>o.evaluate(h)-p.evaluate(h)],[[Lt],(h,[o])=>-o.evaluate(h)]]},"/":[Lt,[Lt,Lt],(h,[o,p])=>o.evaluate(h)/p.evaluate(h)],"%":[Lt,[Lt,Lt],(h,[o,p])=>o.evaluate(h)%p.evaluate(h)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(h,[o,p])=>Math.pow(o.evaluate(h),p.evaluate(h))],sqrt:[Lt,[Lt],(h,[o])=>Math.sqrt(o.evaluate(h))],log10:[Lt,[Lt],(h,[o])=>Math.log(o.evaluate(h))/Math.LN10],ln:[Lt,[Lt],(h,[o])=>Math.log(o.evaluate(h))],log2:[Lt,[Lt],(h,[o])=>Math.log(o.evaluate(h))/Math.LN2],sin:[Lt,[Lt],(h,[o])=>Math.sin(o.evaluate(h))],cos:[Lt,[Lt],(h,[o])=>Math.cos(o.evaluate(h))],tan:[Lt,[Lt],(h,[o])=>Math.tan(o.evaluate(h))],asin:[Lt,[Lt],(h,[o])=>Math.asin(o.evaluate(h))],acos:[Lt,[Lt],(h,[o])=>Math.acos(o.evaluate(h))],atan:[Lt,[Lt],(h,[o])=>Math.atan(o.evaluate(h))],min:[Lt,cs(Lt),(h,o)=>Math.min(...o.map(p=>p.evaluate(h)))],max:[Lt,cs(Lt),(h,o)=>Math.max(...o.map(p=>p.evaluate(h)))],abs:[Lt,[Lt],(h,[o])=>Math.abs(o.evaluate(h))],round:[Lt,[Lt],(h,[o])=>{const p=o.evaluate(h);return p<0?-Math.round(-p):Math.round(p)}],floor:[Lt,[Lt],(h,[o])=>Math.floor(o.evaluate(h))],ceil:[Lt,[Lt],(h,[o])=>Math.ceil(o.evaluate(h))],"filter-==":[mn,[yn,ln],(h,[o,p])=>h.properties()[o.value]===p.value],"filter-id-==":[mn,[ln],(h,[o])=>h.id()===o.value],"filter-type-==":[mn,[yn],(h,[o])=>h.geometryType()===o.value],"filter-<":[mn,[yn,ln],(h,[o,p])=>{const x=h.properties()[o.value],C=p.value;return typeof x==typeof C&&x<C}],"filter-id-<":[mn,[ln],(h,[o])=>{const p=h.id(),x=o.value;return typeof p==typeof x&&p<x}],"filter->":[mn,[yn,ln],(h,[o,p])=>{const x=h.properties()[o.value],C=p.value;return typeof x==typeof C&&x>C}],"filter-id->":[mn,[ln],(h,[o])=>{const p=h.id(),x=o.value;return typeof p==typeof x&&p>x}],"filter-<=":[mn,[yn,ln],(h,[o,p])=>{const x=h.properties()[o.value],C=p.value;return typeof x==typeof C&&x<=C}],"filter-id-<=":[mn,[ln],(h,[o])=>{const p=h.id(),x=o.value;return typeof p==typeof x&&p<=x}],"filter->=":[mn,[yn,ln],(h,[o,p])=>{const x=h.properties()[o.value],C=p.value;return typeof x==typeof C&&x>=C}],"filter-id->=":[mn,[ln],(h,[o])=>{const p=h.id(),x=o.value;return typeof p==typeof x&&p>=x}],"filter-has":[mn,[ln],(h,[o])=>o.value in h.properties()],"filter-has-id":[mn,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[mn,[ki(yn)],(h,[o])=>o.value.indexOf(h.geometryType())>=0],"filter-id-in":[mn,[ki(ln)],(h,[o])=>o.value.indexOf(h.id())>=0],"filter-in-small":[mn,[yn,ki(ln)],(h,[o,p])=>p.value.indexOf(h.properties()[o.value])>=0],"filter-in-large":[mn,[yn,ki(ln)],(h,[o,p])=>function(x,C,B,R){for(;B<=R;){const j=B+R>>1;if(C[j]===x)return!0;C[j]>x?R=j-1:B=j+1}return!1}(h.properties()[o.value],p.value,0,p.value.length-1)],all:{type:mn,overloads:[[[mn,mn],(h,[o,p])=>o.evaluate(h)&&p.evaluate(h)],[cs(mn),(h,o)=>{for(const p of o)if(!p.evaluate(h))return!1;return!0}]]},any:{type:mn,overloads:[[[mn,mn],(h,[o,p])=>o.evaluate(h)||p.evaluate(h)],[cs(mn),(h,o)=>{for(const p of o)if(p.evaluate(h))return!0;return!1}]]},"!":[mn,[mn],(h,[o])=>!o.evaluate(h)],"is-supported-script":[mn,[yn],(h,[o])=>{const p=h.globals&&h.globals.isSupportedScript;return!p||p(o.evaluate(h))}],upcase:[yn,[yn],(h,[o])=>o.evaluate(h).toUpperCase()],downcase:[yn,[yn],(h,[o])=>o.evaluate(h).toLowerCase()],concat:[yn,cs(ln),(h,o)=>o.map(p=>Ut(p.evaluate(h))).join("")],"resolved-locale":[yn,[Br],(h,[o])=>o.evaluate(h).resolvedLocale()]});class fi{constructor(o,p){var x;this.expression=o,this._warningHistory={},this._evaluator=new _e,this._defaultValue=p?(x=p).type==="color"&&cA(x.default)?new pt(0,0,0,0):x.type==="color"?pt.parse(x.default)||null:x.type==="padding"?Rn.parse(x.default)||null:x.type==="variableAnchorOffsetCollection"?On.parse(x.default)||null:x.default===void 0?null:x.default:null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(o,p,x,C,B,R){return this._evaluator.globals=o,this._evaluator.feature=p,this._evaluator.featureState=x,this._evaluator.canonical=C,this._evaluator.availableImages=B||null,this._evaluator.formattedSection=R,this.expression.evaluate(this._evaluator)}evaluate(o,p,x,C,B,R){this._evaluator.globals=o,this._evaluator.feature=p||null,this._evaluator.featureState=x||null,this._evaluator.canonical=C,this._evaluator.availableImages=B||null,this._evaluator.formattedSection=R||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new Ht(`Expected value to be one of ${Object.keys(this._enumValues).map(H=>JSON.stringify(H)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(j.message)),this._defaultValue}}}function dA(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in Po}function bn(h,o){const p=new ao(Po,aA,[],o?function(C){const B={color:Qi,string:yn,number:Lt,enum:yn,boolean:mn,formatted:ss,padding:$r,resolvedImage:Rr,variableAnchorOffsetCollection:Or};return C.type==="array"?ki(B[C.value]||ln,C.length):B[C.type]}(o):void 0),x=p.parse(h,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?Su(new fi(x,o)):sa(p.errors)}class pA{constructor(o,p){this.kind=o,this._styleExpression=p,this.isStateDependent=o!=="constant"&&!Jo(p.expression)}evaluateWithoutErrorHandling(o,p,x,C,B,R){return this._styleExpression.evaluateWithoutErrorHandling(o,p,x,C,B,R)}evaluate(o,p,x,C,B,R){return this._styleExpression.evaluate(o,p,x,C,B,R)}}class ii{constructor(o,p,x,C){this.kind=o,this.zoomStops=x,this._styleExpression=p,this.isStateDependent=o!=="camera"&&!Jo(p.expression),this.interpolationType=C}evaluateWithoutErrorHandling(o,p,x,C,B,R){return this._styleExpression.evaluateWithoutErrorHandling(o,p,x,C,B,R)}evaluate(o,p,x,C,B,R){return this._styleExpression.evaluate(o,p,x,C,B,R)}interpolationFactor(o,p,x){return this.interpolationType?Fr.interpolationFactor(this.interpolationType,o,p,x):0}}function Wn(h,o){const p=bn(h,o);if(p.result==="error")return p;const x=p.value.expression,C=AA(x);if(!C&&!oa(o))return sa([new Xi("","data expressions not supported")]);const B=To(x,["zoom"]);if(!B&&!aa(o))return sa([new Xi("","zoom expressions not supported")]);const R=Ua(x);return R||B?R instanceof Xi?sa([R]):R instanceof Fr&&!Ll(o)?sa([new Xi("",'"interpolate" expressions cannot be used with this property')]):Su(R?new ii(C?"camera":"composite",p.value,R.labels,R instanceof Fr?R.interpolation:void 0):new pA(C?"constant":"source",p.value)):sa([new Xi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class la{constructor(o,p){this._parameters=o,this._specification=p,Yi(this,Gs(this._parameters,this._specification))}static deserialize(o){return new la(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Ua(h){let o=null;if(h instanceof Ti)o=Ua(h.result);else if(h instanceof JA){for(const p of h.args)if(o=Ua(p),o)break}else(h instanceof ta||h instanceof Fr)&&h.input instanceof zr&&h.input.name==="zoom"&&(o=h);return o instanceof Xi||h.eachChild(p=>{const x=Ua(p);x instanceof Xi?o=x:!o&&x?o=new Xi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&x&&o!==x&&(o=new Xi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}function gA(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const o of h.slice(1))if(!gA(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}const Dl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Va(h){if(h==null)return{filter:()=>!0,needGeometry:!1};gA(h)||(h=ja(h));const o=bn(h,Dl);if(o.result==="error")throw new Error(o.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,x,C)=>o.value.evaluate(p,x,{},C),needGeometry:Bl(h)}}function ui(h,o){return h<o?-1:h>o?1:0}function Bl(h){if(!Array.isArray(h))return!1;if(h[0]==="within")return!0;for(let o=1;o<h.length;o++)if(Bl(h[o]))return!0;return!1}function ja(h){if(!h)return!0;const o=h[0];return h.length<=1?o!=="any":o==="=="?mA(h[1],h[2],"=="):o==="!="?Ji(mA(h[1],h[2],"==")):o==="<"||o===">"||o==="<="||o===">="?mA(h[1],h[2],o):o==="any"?(p=h.slice(1),["any"].concat(p.map(ja))):o==="all"?["all"].concat(h.slice(1).map(ja)):o==="none"?["all"].concat(h.slice(1).map(ja).map(Ji)):o==="in"?_A(h[1],h.slice(2)):o==="!in"?Ji(_A(h[1],h.slice(2))):o==="has"?nl(h[1]):o==="!has"?Ji(nl(h[1])):o!=="within"||h;var p}function mA(h,o,p){switch(h){case"$type":return[`filter-type-${p}`,o];case"$id":return[`filter-id-${p}`,o];default:return[`filter-${p}`,h,o]}}function _A(h,o){if(o.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(p=>typeof p!=typeof o[0])?["filter-in-large",h,["literal",o.sort(ui)]]:["filter-in-small",h,["literal",o]]}}function nl(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Ji(h){return["!",h]}function Si(h){const o=typeof h;if(o==="number"||o==="boolean"||o==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let C="[";for(const B of h)C+=`${Si(B)},`;return`${C}]`}const p=Object.keys(h).sort();let x="{";for(let C=0;C<p.length;C++)x+=`${JSON.stringify(p[C])}:${Si(h[p[C]])},`;return`${x}}`}function Nr(h){let o="";for(const p of xr)o+=`/${Si(h[p])}`;return o}function il(h){const o=h.value;return o?[new It(h.key,o,"constants have been deprecated as of v8")]:[]}function oi(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function ua(h){if(Array.isArray(h))return h.map(ua);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const o={};for(const p in h)o[p]=ua(h[p]);return o}return oi(h)}function Ur(h){const o=h.key,p=h.value,x=h.valueSpec||{},C=h.objectElementValidators||{},B=h.style,R=h.styleSpec,j=h.validateSpec;let H=[];const q=Hn(p);if(q!=="object")return[new It(o,p,`object expected, ${q} found`)];for(const J in p){const ne=J.split(".")[0],he=x[ne]||x["*"];let me;if(C[ne])me=C[ne];else if(x[ne])me=j;else if(C["*"])me=C["*"];else{if(!x["*"]){H.push(new It(o,p[J],`unknown property "${J}"`));continue}me=j}H=H.concat(me({key:(o&&`${o}.`)+J,value:p[J],valueSpec:he,style:B,styleSpec:R,object:p,objectKey:J,validateSpec:j},p))}for(const J in x)C[J]||x[J].required&&x[J].default===void 0&&p[J]===void 0&&H.push(new It(o,p,`missing required property "${J}"`));return H}function dr(h){const o=h.value,p=h.valueSpec,x=h.style,C=h.styleSpec,B=h.key,R=h.arrayElementValidator||h.validateSpec;if(Hn(o)!=="array")return[new It(B,o,`array expected, ${Hn(o)} found`)];if(p.length&&o.length!==p.length)return[new It(B,o,`array length ${p.length} expected, length ${o.length} found`)];if(p["min-length"]&&o.length<p["min-length"])return[new It(B,o,`array length at least ${p["min-length"]} expected, length ${o.length} found`)];let j={type:p.value,values:p.values};C.$version<7&&(j.function=p.function),Hn(p.value)==="object"&&(j=p.value);let H=[];for(let q=0;q<o.length;q++)H=H.concat(R({array:o,arrayIndex:q,value:o[q],valueSpec:j,validateSpec:h.validateSpec,style:x,styleSpec:C,key:`${B}[${q}]`}));return H}function er(h){const o=h.key,p=h.value,x=h.valueSpec;let C=Hn(p);return C==="number"&&p!=p&&(C="NaN"),C!=="number"?[new It(o,p,`number expected, ${C} found`)]:"minimum"in x&&p<x.minimum?[new It(o,p,`${p} is less than the minimum value ${x.minimum}`)]:"maximum"in x&&p>x.maximum?[new It(o,p,`${p} is greater than the maximum value ${x.maximum}`)]:[]}function Ps(h){const o=h.valueSpec,p=oi(h.value.type);let x,C,B,R={};const j=p!=="categorical"&&h.value.property===void 0,H=!j,q=Hn(h.value.stops)==="array"&&Hn(h.value.stops[0])==="array"&&Hn(h.value.stops[0][0])==="object",J=Ur({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(me){if(p==="identity")return[new It(me.key,me.value,'identity function may not have a "stops" property')];let ye=[];const Me=me.value;return ye=ye.concat(dr({key:me.key,value:Me,valueSpec:me.valueSpec,validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec,arrayElementValidator:ne})),Hn(Me)==="array"&&Me.length===0&&ye.push(new It(me.key,Me,"array must have at least one stop")),ye},default:function(me){return me.validateSpec({key:me.key,value:me.value,valueSpec:o,validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec})}}});return p==="identity"&&j&&J.push(new It(h.key,h.value,'missing required property "property"')),p==="identity"||h.value.stops||J.push(new It(h.key,h.value,'missing required property "stops"')),p==="exponential"&&h.valueSpec.expression&&!Ll(h.valueSpec)&&J.push(new It(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(H&&!oa(h.valueSpec)?J.push(new It(h.key,h.value,"property functions not supported")):j&&!aa(h.valueSpec)&&J.push(new It(h.key,h.value,"zoom functions not supported"))),p!=="categorical"&&!q||h.value.property!==void 0||J.push(new It(h.key,h.value,'"property" property is required')),J;function ne(me){let ye=[];const Me=me.value,Ue=me.key;if(Hn(Me)!=="array")return[new It(Ue,Me,`array expected, ${Hn(Me)} found`)];if(Me.length!==2)return[new It(Ue,Me,`array length 2 expected, length ${Me.length} found`)];if(q){if(Hn(Me[0])!=="object")return[new It(Ue,Me,`object expected, ${Hn(Me[0])} found`)];if(Me[0].zoom===void 0)return[new It(Ue,Me,"object stop key must have zoom")];if(Me[0].value===void 0)return[new It(Ue,Me,"object stop key must have value")];if(B&&B>oi(Me[0].zoom))return[new It(Ue,Me[0].zoom,"stop zoom values must appear in ascending order")];oi(Me[0].zoom)!==B&&(B=oi(Me[0].zoom),C=void 0,R={}),ye=ye.concat(Ur({key:`${Ue}[0]`,value:Me[0],valueSpec:{zoom:{}},validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec,objectElementValidators:{zoom:er,value:he}}))}else ye=ye.concat(he({key:`${Ue}[0]`,value:Me[0],valueSpec:{},validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec},Me));return dA(ua(Me[1]))?ye.concat([new It(`${Ue}[1]`,Me[1],"expressions are not allowed in function stops.")]):ye.concat(me.validateSpec({key:`${Ue}[1]`,value:Me[1],valueSpec:o,validateSpec:me.validateSpec,style:me.style,styleSpec:me.styleSpec}))}function he(me,ye){const Me=Hn(me.value),Ue=oi(me.value),He=me.value!==null?me.value:ye;if(x){if(Me!==x)return[new It(me.key,He,`${Me} stop domain type must match previous stop domain type ${x}`)]}else x=Me;if(Me!=="number"&&Me!=="string"&&Me!=="boolean")return[new It(me.key,He,"stop domain value must be a number, string, or boolean")];if(Me!=="number"&&p!=="categorical"){let Ke=`number expected, ${Me} found`;return oa(o)&&p===void 0&&(Ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(me.key,He,Ke)]}return p!=="categorical"||Me!=="number"||isFinite(Ue)&&Math.floor(Ue)===Ue?p!=="categorical"&&Me==="number"&&C!==void 0&&Ue<C?[new It(me.key,He,"stop domain values must appear in ascending order")]:(C=Ue,p==="categorical"&&Ue in R?[new It(me.key,He,"stop domain values must be unique")]:(R[Ue]=!0,[])):[new It(me.key,He,`integer expected, found ${Ue}`)]}}function Ms(h){const o=(h.expressionContext==="property"?Wn:bn)(ua(h.value),h.valueSpec);if(o.result==="error")return o.value.map(x=>new It(`${h.key}${x.key}`,h.value,x.message));const p=o.value.expression||o.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!p.outputDefined())return[new It(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Jo(p))return[new It(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Jo(p))return[new It(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!To(p,["zoom","feature-state"]))return[new It(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!AA(p))return[new It(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hs(h){const o=h.key,p=h.value,x=h.valueSpec,C=[];return Array.isArray(x.values)?x.values.indexOf(oi(p))===-1&&C.push(new It(o,p,`expected one of [${x.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(x.values).indexOf(oi(p))===-1&&C.push(new It(o,p,`expected one of [${Object.keys(x.values).join(", ")}], ${JSON.stringify(p)} found`)),C}function Mo(h){return gA(ua(h.value))?Ms(Yi({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):tr(h)}function tr(h){const o=h.value,p=h.key;if(Hn(o)!=="array")return[new It(p,o,`array expected, ${Hn(o)} found`)];const x=h.styleSpec;let C,B=[];if(o.length<1)return[new It(p,o,"filter array must have at least 1 element")];switch(B=B.concat(hs({key:`${p}[0]`,value:o[0],valueSpec:x.filter_operator,style:h.style,styleSpec:h.styleSpec})),oi(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&oi(o[1])==="$type"&&B.push(new It(p,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&B.push(new It(p,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(C=Hn(o[1]),C!=="string"&&B.push(new It(`${p}[1]`,o[1],`string expected, ${C} found`)));for(let R=2;R<o.length;R++)C=Hn(o[R]),oi(o[1])==="$type"?B=B.concat(hs({key:`${p}[${R}]`,value:o[R],valueSpec:x.geometry_type,style:h.style,styleSpec:h.styleSpec})):C!=="string"&&C!=="number"&&C!=="boolean"&&B.push(new It(`${p}[${R}]`,o[R],`string, number, or boolean expected, ${C} found`));break;case"any":case"all":case"none":for(let R=1;R<o.length;R++)B=B.concat(tr({key:`${p}[${R}]`,value:o[R],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":C=Hn(o[1]),o.length!==2?B.push(new It(p,o,`filter array for "${o[0]}" operator must have 2 elements`)):C!=="string"&&B.push(new It(`${p}[1]`,o[1],`string expected, ${C} found`));break;case"within":C=Hn(o[1]),o.length!==2?B.push(new It(p,o,`filter array for "${o[0]}" operator must have 2 elements`)):C!=="object"&&B.push(new It(`${p}[1]`,o[1],`object expected, ${C} found`))}return B}function yA(h,o){const p=h.key,x=h.validateSpec,C=h.style,B=h.styleSpec,R=h.value,j=h.objectKey,H=B[`${o}_${h.layerType}`];if(!H)return[];const q=j.match(/^(.*)-transition$/);if(o==="paint"&&q&&H[q[1]]&&H[q[1]].transition)return x({key:p,value:R,valueSpec:B.transition,style:C,styleSpec:B});const J=h.valueSpec||H[j];if(!J)return[new It(p,R,`unknown property "${j}"`)];let ne;if(Hn(R)==="string"&&oa(J)&&!J.tokens&&(ne=/^{([^}]+)}$/.exec(R)))return[new It(p,R,`"${j}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(ne[1])} }\`.`)];const he=[];return h.layerType==="symbol"&&(j==="text-field"&&C&&!C.glyphs&&he.push(new It(p,R,'use of "text-field" requires a style "glyphs" property')),j==="text-font"&&cA(ua(R))&&oi(R.type)==="identity"&&he.push(new It(p,R,'"text-font" does not support identity functions'))),he.concat(x({key:h.key,value:R,valueSpec:J,style:C,styleSpec:B,expressionContext:"property",propertyType:o,propertyKey:j}))}function Io(h){return yA(h,"paint")}function ko(h){return yA(h,"layout")}function fs(h){let o=[];const p=h.value,x=h.key,C=h.style,B=h.styleSpec;p.type||p.ref||o.push(new It(x,p,'either "type" or "ref" is required'));let R=oi(p.type);const j=oi(p.ref);if(p.id){const H=oi(p.id);for(let q=0;q<h.arrayIndex;q++){const J=C.layers[q];oi(J.id)===H&&o.push(new It(x,p.id,`duplicate layer id "${p.id}", previously used at line ${J.id.__line__}`))}}if("ref"in p){let H;["type","source","source-layer","filter","layout"].forEach(q=>{q in p&&o.push(new It(x,p[q],`"${q}" is prohibited for ref layers`))}),C.layers.forEach(q=>{oi(q.id)===j&&(H=q)}),H?H.ref?o.push(new It(x,p.ref,"ref cannot reference another ref layer")):R=oi(H.type):o.push(new It(x,p.ref,`ref layer "${j}" not found`))}else if(R!=="background")if(p.source){const H=C.sources&&C.sources[p.source],q=H&&oi(H.type);H?q==="vector"&&R==="raster"?o.push(new It(x,p.source,`layer "${p.id}" requires a raster source`)):q==="raster"&&R!=="raster"?o.push(new It(x,p.source,`layer "${p.id}" requires a vector source`)):q!=="vector"||p["source-layer"]?q==="raster-dem"&&R!=="hillshade"?o.push(new It(x,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):R!=="line"||!p.paint||!p.paint["line-gradient"]||q==="geojson"&&H.lineMetrics||o.push(new It(x,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new It(x,p,`layer "${p.id}" must specify a "source-layer"`)):o.push(new It(x,p.source,`source "${p.source}" not found`))}else o.push(new It(x,p,'missing required property "source"'));return o=o.concat(Ur({key:x,value:p,valueSpec:B.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${x}.type`,value:p.type,valueSpec:B.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:p,objectKey:"type"}),filter:Mo,layout:H=>Ur({layer:p,key:H.key,value:H.value,style:H.style,styleSpec:H.styleSpec,validateSpec:H.validateSpec,objectElementValidators:{"*":q=>ko(Yi({layerType:R},q))}}),paint:H=>Ur({layer:p,key:H.key,value:H.value,style:H.style,styleSpec:H.styleSpec,validateSpec:H.validateSpec,objectElementValidators:{"*":q=>Io(Yi({layerType:R},q))}})}})),o}function Vr(h){const o=h.value,p=h.key,x=Hn(o);return x!=="string"?[new It(p,o,`string expected, ${x} found`)]:[]}const Cu={promoteId:function({key:h,value:o}){if(Hn(o)==="string")return Vr({key:h,value:o});{const p=[];for(const x in o)p.push(...Vr({key:`${h}.${x}`,value:o[x]}));return p}}};function ca(h){const o=h.value,p=h.key,x=h.styleSpec,C=h.style,B=h.validateSpec;if(!o.type)return[new It(p,o,'"type" is required')];const R=oi(o.type);let j;switch(R){case"vector":case"raster":case"raster-dem":return j=Ur({key:p,value:o,valueSpec:x[`source_${R.replace("-","_")}`],style:h.style,styleSpec:x,objectElementValidators:Cu,validateSpec:B}),j;case"geojson":if(j=Ur({key:p,value:o,valueSpec:x.source_geojson,style:C,styleSpec:x,validateSpec:B,objectElementValidators:Cu}),o.cluster)for(const H in o.clusterProperties){const[q,J]=o.clusterProperties[H],ne=typeof q=="string"?[q,["accumulated"],["get",H]]:q;j.push(...Ms({key:`${p}.${H}.map`,value:J,validateSpec:B,expressionContext:"cluster-map"})),j.push(...Ms({key:`${p}.${H}.reduce`,value:ne,validateSpec:B,expressionContext:"cluster-reduce"}))}return j;case"video":return Ur({key:p,value:o,valueSpec:x.source_video,style:C,validateSpec:B,styleSpec:x});case"image":return Ur({key:p,value:o,valueSpec:x.source_image,style:C,validateSpec:B,styleSpec:x});case"canvas":return[new It(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hs({key:`${p}.type`,value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:C,validateSpec:B,styleSpec:x})}}function Rl(h){const o=h.value,p=h.styleSpec,x=p.light,C=h.style;let B=[];const R=Hn(o);if(o===void 0)return B;if(R!=="object")return B=B.concat([new It("light",o,`object expected, ${R} found`)]),B;for(const j in o){const H=j.match(/^(.*)-transition$/);B=B.concat(H&&x[H[1]]&&x[H[1]].transition?h.validateSpec({key:j,value:o[j],valueSpec:p.transition,validateSpec:h.validateSpec,style:C,styleSpec:p}):x[j]?h.validateSpec({key:j,value:o[j],valueSpec:x[j],validateSpec:h.validateSpec,style:C,styleSpec:p}):[new It(j,o[j],`unknown property "${j}"`)])}return B}function Lo(h){const o=h.value,p=h.styleSpec,x=p.terrain,C=h.style;let B=[];const R=Hn(o);if(o===void 0)return B;if(R!=="object")return B=B.concat([new It("terrain",o,`object expected, ${R} found`)]),B;for(const j in o)B=B.concat(x[j]?h.validateSpec({key:j,value:o[j],valueSpec:x[j],validateSpec:h.validateSpec,style:C,styleSpec:p}):[new It(j,o[j],`unknown property "${j}"`)]);return B}function Do(h){let o=[];const p=h.value,x=h.key;if(Array.isArray(p)){const C=[],B=[];for(const R in p)p[R].id&&C.includes(p[R].id)&&o.push(new It(x,p,`all the sprites' ids must be unique, but ${p[R].id} is duplicated`)),C.push(p[R].id),p[R].url&&B.includes(p[R].url)&&o.push(new It(x,p,`all the sprites' URLs must be unique, but ${p[R].url} is duplicated`)),B.push(p[R].url),o=o.concat(Ur({key:`${x}[${R}]`,value:p[R],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return o}return Vr({key:x,value:p})}const Pu={"*":()=>[],array:dr,boolean:function(h){const o=h.value,p=h.key,x=Hn(o);return x!=="boolean"?[new It(p,o,`boolean expected, ${x} found`)]:[]},number:er,color:function(h){const o=h.key,p=h.value,x=Hn(p);return x!=="string"?[new It(o,p,`color expected, ${x} found`)]:pt.parse(String(p))?[]:[new It(o,p,`color expected, "${p}" found`)]},constants:il,enum:hs,filter:Mo,function:Ps,layer:fs,object:Ur,source:ca,light:Rl,terrain:Lo,string:Vr,formatted:function(h){return Vr(h).length===0?[]:Ms(h)},resolvedImage:function(h){return Vr(h).length===0?[]:Ms(h)},padding:function(h){const o=h.key,p=h.value;if(Hn(p)==="array"){if(p.length<1||p.length>4)return[new It(o,p,`padding requires 1 to 4 values; ${p.length} values found`)];const x={type:"number"};let C=[];for(let B=0;B<p.length;B++)C=C.concat(h.validateSpec({key:`${o}[${B}]`,value:p[B],validateSpec:h.validateSpec,valueSpec:x}));return C}return er({key:o,value:p,valueSpec:{}})},variableAnchorOffsetCollection:function(h){const o=h.key,p=h.value,x=Hn(p),C=h.styleSpec;if(x!=="array"||p.length<1||p.length%2!=0)return[new It(o,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let B=[];for(let R=0;R<p.length;R+=2)B=B.concat(hs({key:`${o}[${R}]`,value:p[R],valueSpec:C.layout_symbol["text-anchor"]})),B=B.concat(dr({key:`${o}[${R+1}]`,value:p[R+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:C}));return B},sprite:Do};function lo(h){const o=h.value,p=h.valueSpec,x=h.styleSpec;return h.validateSpec=lo,p.expression&&cA(oi(o))?Ps(h):p.expression&&dA(ua(o))?Ms(h):p.type&&Pu[p.type]?Pu[p.type](h):Ur(Yi({},h,{valueSpec:p.type?x[p.type]:p}))}function vA(h){const o=h.value,p=h.key,x=Vr(h);return x.length||(o.indexOf("{fontstack}")===-1&&x.push(new It(p,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&x.push(new It(p,o,'"glyphs" url must include a "{range}" token'))),x}function qr(h,o=ut){let p=[];return p=p.concat(lo({key:"",value:h,valueSpec:o.$root,styleSpec:o,style:h,validateSpec:lo,objectElementValidators:{glyphs:vA,"*":()=>[]}})),h.constants&&(p=p.concat(il({key:"constants",value:h.constants,style:h,styleSpec:o,validateSpec:lo}))),xA(p)}function Di(h){return function(o){return h({...o,validateSpec:lo})}}function xA(h){return[].concat(h).sort((o,p)=>o.line-p.line)}function ds(h){return function(...o){return xA(h.apply(this,o))}}qr.source=ds(Di(ca)),qr.sprite=ds(Di(Do)),qr.glyphs=ds(Di(vA)),qr.light=ds(Di(Rl)),qr.terrain=ds(Di(Lo)),qr.layer=ds(Di(fs)),qr.filter=ds(Di(Mo)),qr.paintProperty=ds(Di(Io)),qr.layoutProperty=ds(Di(ko));const wA=qr,wc=wA.light,ha=wA.paintProperty,Ol=wA.layoutProperty;function fa(h,o){let p=!1;if(o&&o.length)for(const x of o)h.fire(new vr(new Error(x.message))),p=!0;return p}class Yr{constructor(o,p,x){const C=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;const R=new Int32Array(this.arrayBuffer);o=R[0],this.d=(p=R[1])+2*(x=R[2]);for(let H=0;H<this.d*this.d;H++){const q=R[3+H],J=R[3+H+1];C.push(q===J?null:R.subarray(q,J))}const j=R[3+C.length+1];this.keys=R.subarray(R[3+C.length],j),this.bboxes=R.subarray(j),this.insert=this._insertReadonly}else{this.d=p+2*x;for(let R=0;R<this.d*this.d;R++)C.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=o,this.padding=x,this.scale=p/o,this.uid=0;const B=x/p*o;this.min=-B,this.max=o+B}insert(o,p,x,C,B){this._forEachCell(p,x,C,B,this._insertCell,this.uid++,void 0,void 0),this.keys.push(o),this.bboxes.push(p),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(B)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(o,p,x,C,B,R){this.cells[B].push(R)}query(o,p,x,C,B){const R=this.min,j=this.max;if(o<=R&&p<=R&&j<=x&&j<=C&&!B)return Array.prototype.slice.call(this.keys);{const H=[];return this._forEachCell(o,p,x,C,this._queryCell,H,{},B),H}}_queryCell(o,p,x,C,B,R,j,H){const q=this.cells[B];if(q!==null){const J=this.keys,ne=this.bboxes;for(let he=0;he<q.length;he++){const me=q[he];if(j[me]===void 0){const ye=4*me;(H?H(ne[ye+0],ne[ye+1],ne[ye+2],ne[ye+3]):o<=ne[ye+2]&&p<=ne[ye+3]&&x>=ne[ye+0]&&C>=ne[ye+1])?(j[me]=!0,R.push(J[me])):j[me]=!1}}}}_forEachCell(o,p,x,C,B,R,j,H){const q=this._convertToCellCoord(o),J=this._convertToCellCoord(p),ne=this._convertToCellCoord(x),he=this._convertToCellCoord(C);for(let me=q;me<=ne;me++)for(let ye=J;ye<=he;ye++){const Me=this.d*ye+me;if((!H||H(this._convertFromCellCoord(me),this._convertFromCellCoord(ye),this._convertFromCellCoord(me+1),this._convertFromCellCoord(ye+1)))&&B.call(this,o,p,x,C,Me,R,j,H))return}}_convertFromCellCoord(o){return(o-this.padding)/this.scale}_convertToCellCoord(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const o=this.cells,p=3+this.cells.length+1+1;let x=0;for(let R=0;R<this.cells.length;R++)x+=this.cells[R].length;const C=new Int32Array(p+x+this.keys.length+this.bboxes.length);C[0]=this.extent,C[1]=this.n,C[2]=this.padding;let B=p;for(let R=0;R<o.length;R++){const j=o[R];C[3+R]=B,C.set(j,B),B+=j.length}return C[3+o.length]=B,C.set(this.keys,B),B+=this.keys.length,C[3+o.length+1]=B,C.set(this.bboxes,B),B+=this.bboxes.length,C.buffer}static serialize(o,p){const x=o.toArrayBuffer();return p&&p.push(x),{buffer:x}}static deserialize(o){return new Yr(o.buffer)}}const Is={};function Wt(h,o,p={}){if(Is[h])throw new Error(`${h} is already registered.`);Object.defineProperty(o,"_classRegistryKey",{value:h,writeable:!1}),Is[h]={klass:o,omit:p.omit||[],shallow:p.shallow||[]}}Wt("Object",Object),Wt("TransferableGridIndex",Yr),Wt("Color",pt),Wt("Error",Error),Wt("AJAXError",Bn),Wt("ResolvedImage",qn),Wt("StylePropertyFunction",la),Wt("StyleExpression",fi,{omit:["_evaluator"]}),Wt("ZoomDependentExpression",ii),Wt("ZoomConstantExpression",pA),Wt("CompoundExpression",zr,{omit:["_evaluate"]});for(const h in Po)Po[h]._classRegistryKey||Wt(`Expression_${h}`,Po[h]);function Ga(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function bA(h,o){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob)return h;if(Ga(h)||pn(h))return o&&o.push(h),h;if(ArrayBuffer.isView(h)){const p=h;return o&&o.push(p.buffer),p}if(h instanceof ImageData)return o&&o.push(h.data.buffer),h;if(Array.isArray(h)){const p=[];for(const x of h)p.push(bA(x,o));return p}if(typeof h=="object"){const p=h.constructor,x=p._classRegistryKey;if(!x)throw new Error("can't serialize object of unregistered class");if(!Is[x])throw new Error(`${x} is not registered.`);const C=p.serialize?p.serialize(h,o):{};if(p.serialize){if(o&&C===o[o.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const B in h){if(!h.hasOwnProperty(B)||Is[x].omit.indexOf(B)>=0)continue;const R=h[B];C[B]=Is[x].shallow.indexOf(B)>=0?R:bA(R,o)}h instanceof Error&&(C.message=h.message)}if(C.$name)throw new Error("$name property is reserved for worker serialization logic.");return x!=="Object"&&(C.$name=x),C}throw new Error("can't serialize object of type "+typeof h)}function da(h){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||Ga(h)||pn(h)||ArrayBuffer.isView(h)||h instanceof ImageData)return h;if(Array.isArray(h))return h.map(da);if(typeof h=="object"){const o=h.$name||"Object";if(!Is[o])throw new Error(`can't deserialize unregistered class ${o}`);const{klass:p}=Is[o];if(!p)throw new Error(`can't deserialize unregistered class ${o}`);if(p.deserialize)return p.deserialize(h);const x=Object.create(p.prototype);for(const C of Object.keys(h)){if(C==="$name")continue;const B=h[C];x[C]=Is[o].shallow.indexOf(C)>=0?B:da(B)}return x}throw new Error("can't deserialize object of type "+typeof h)}class zl{constructor(){this.first=!0}update(o,p){const x=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=x,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=x,!0):(this.lastFloorZoom>x?(this.lastIntegerZoom=x+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<x&&(this.lastIntegerZoom=x,this.lastIntegerZoomTime=p),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=x,!0))}}const Bt={"Latin-1 Supplement":h=>h>=128&&h<=255,Arabic:h=>h>=1536&&h<=1791,"Arabic Supplement":h=>h>=1872&&h<=1919,"Arabic Extended-A":h=>h>=2208&&h<=2303,"Hangul Jamo":h=>h>=4352&&h<=4607,"Unified Canadian Aboriginal Syllabics":h=>h>=5120&&h<=5759,Khmer:h=>h>=6016&&h<=6143,"Unified Canadian Aboriginal Syllabics Extended":h=>h>=6320&&h<=6399,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"CJK Radicals Supplement":h=>h>=11904&&h<=12031,"Kangxi Radicals":h=>h>=12032&&h<=12255,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Bopomofo:h=>h>=12544&&h<=12591,"Hangul Compatibility Jamo":h=>h>=12592&&h<=12687,Kanbun:h=>h>=12688&&h<=12703,"Bopomofo Extended":h=>h>=12704&&h<=12735,"CJK Strokes":h=>h>=12736&&h<=12783,"Katakana Phonetic Extensions":h=>h>=12784&&h<=12799,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"CJK Unified Ideographs Extension A":h=>h>=13312&&h<=19903,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Yi Syllables":h=>h>=40960&&h<=42127,"Yi Radicals":h=>h>=42128&&h<=42191,"Hangul Jamo Extended-A":h=>h>=43360&&h<=43391,"Hangul Syllables":h=>h>=44032&&h<=55215,"Hangul Jamo Extended-B":h=>h>=55216&&h<=55295,"Private Use Area":h=>h>=57344&&h<=63743,"CJK Compatibility Ideographs":h=>h>=63744&&h<=64255,"Arabic Presentation Forms-A":h=>h>=64336&&h<=65023,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Arabic Presentation Forms-B":h=>h>=65136&&h<=65279,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function EA(h){for(const o of h)if(Qa(o.charCodeAt(0)))return!0;return!1}function TA(h){for(const o of h)if(!uo(o.charCodeAt(0)))return!1;return!0}function uo(h){return!(Bt.Arabic(h)||Bt["Arabic Supplement"](h)||Bt["Arabic Extended-A"](h)||Bt["Arabic Presentation Forms-A"](h)||Bt["Arabic Presentation Forms-B"](h))}function Qa(h){return!(h!==746&&h!==747&&(h<4352||!(Bt["Bopomofo Extended"](h)||Bt.Bopomofo(h)||Bt["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||Bt["CJK Compatibility Ideographs"](h)||Bt["CJK Compatibility"](h)||Bt["CJK Radicals Supplement"](h)||Bt["CJK Strokes"](h)||!(!Bt["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||Bt["CJK Unified Ideographs Extension A"](h)||Bt["CJK Unified Ideographs"](h)||Bt["Enclosed CJK Letters and Months"](h)||Bt["Hangul Compatibility Jamo"](h)||Bt["Hangul Jamo Extended-A"](h)||Bt["Hangul Jamo Extended-B"](h)||Bt["Hangul Jamo"](h)||Bt["Hangul Syllables"](h)||Bt.Hiragana(h)||Bt["Ideographic Description Characters"](h)||Bt.Kanbun(h)||Bt["Kangxi Radicals"](h)||Bt["Katakana Phonetic Extensions"](h)||Bt.Katakana(h)&&h!==12540||!(!Bt["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!Bt["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||Bt["Unified Canadian Aboriginal Syllabics"](h)||Bt["Unified Canadian Aboriginal Syllabics Extended"](h)||Bt["Vertical Forms"](h)||Bt["Yijing Hexagram Symbols"](h)||Bt["Yi Syllables"](h)||Bt["Yi Radicals"](h))))}function SA(h){return!(Qa(h)||function(o){return!!(Bt["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||Bt["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||Bt["Letterlike Symbols"](o)||Bt["Number Forms"](o)||Bt["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||Bt["Control Pictures"](o)&&o!==9251||Bt["Optical Character Recognition"](o)||Bt["Enclosed Alphanumerics"](o)||Bt["Geometric Shapes"](o)||Bt["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Bt["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Bt["CJK Symbols and Punctuation"](o)||Bt.Katakana(o)||Bt["Private Use Area"](o)||Bt["CJK Compatibility Forms"](o)||Bt["Small Form Variants"](o)||Bt["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(h))}function Fl(h){return h>=1424&&h<=2303||Bt["Arabic Presentation Forms-A"](h)||Bt["Arabic Presentation Forms-B"](h)}function bc(h,o){return!(!o&&Fl(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||Bt.Khmer(h))}function Mu(h){for(const o of h)if(Fl(o.charCodeAt(0)))return!0;return!1}const Nl="deferred",ps="loading",rl="loaded";let sl=null,wr="unavailable",co=null;const yi=function(h){h&&typeof h=="string"&&h.indexOf("NetworkError")>-1&&(wr="error"),sl&&sl(h)};function Ul(){Vl.fire(new si("pluginStateChange",{pluginStatus:wr,pluginURL:co}))}const Vl=new Lr,jl=function(){return wr},Gl=function(){if(wr!==Nl||!co)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");wr=ps,Ul(),co&&qi({url:co},h=>{h?yi(h):(wr=rl,Ul())})},Xr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>wr===rl||Xr.applyArabicShaping!=null,isLoading:()=>wr===ps,setState(h){if(!St())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");wr=h.pluginStatus,co=h.pluginURL},isParsed(){if(!St())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Xr.applyArabicShaping!=null&&Xr.processBidirectionalText!=null&&Xr.processStyledBidirectionalText!=null},getPluginURL(){if(!St())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return co}};class ci{constructor(o,p){this.zoom=o,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new zl,this.transition={})}isSupportedScript(o){return function(p,x){for(const C of p)if(!bc(C.charCodeAt(0),x))return!1;return!0}(o,Xr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const o=this.zoom,p=o-Math.floor(o),x=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*x}:{fromScale:.5,toScale:1,t:1-(1-x)*p}}}class CA{constructor(o,p){this.property=o,this.value=p,this.expression=function(x,C){if(cA(x))return new la(x,C);if(dA(x)){const B=Wn(x,C);if(B.result==="error")throw new Error(B.value.map(R=>`${R.key}: ${R.message}`).join(", "));return B.value}{let B=x;return C.type==="color"&&typeof x=="string"?B=pt.parse(x):C.type!=="padding"||typeof x!="number"&&!Array.isArray(x)?C.type==="variableAnchorOffsetCollection"&&Array.isArray(x)&&(B=On.parse(x)):B=Rn.parse(x),{kind:"constant",evaluate:()=>B}}}(p===void 0?o.specification.default:p,o.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,p,x){return this.property.possiblyEvaluate(this,o,p,x)}}class Ha{constructor(o){this.property=o,this.value=new CA(o,void 0)}transitioned(o,p){return new PA(this.property,this.value,p,ce({},o.transition,this.transition),o.now)}untransitioned(){return new PA(this.property,this.value,null,{},0)}}class Ql{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return tt(this._values[o].value.value)}setValue(o,p){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new Ha(this._values[o].property)),this._values[o].value=new CA(this._values[o].property,p===null?void 0:tt(p))}getTransition(o){return tt(this._values[o].transition)}setTransition(o,p){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new Ha(this._values[o].property)),this._values[o].transition=tt(p)||void 0}serialize(){const o={};for(const p of Object.keys(this._values)){const x=this.getValue(p);x!==void 0&&(o[p]=x);const C=this.getTransition(p);C!==void 0&&(o[`${p}-transition`]=C)}return o}transitioned(o,p){const x=new Ci(this._properties);for(const C of Object.keys(this._values))x._values[C]=this._values[C].transitioned(o,p._values[C]);return x}untransitioned(){const o=new Ci(this._properties);for(const p of Object.keys(this._values))o._values[p]=this._values[p].untransitioned();return o}}class PA{constructor(o,p,x,C,B){this.property=o,this.value=p,this.begin=B+C.delay||0,this.end=this.begin+C.duration||0,o.specification.transition&&(C.delay||C.duration)&&(this.prior=x)}possiblyEvaluate(o,p,x){const C=o.now||0,B=this.value.possiblyEvaluate(o,p,x),R=this.prior;if(R){if(C>this.end)return this.prior=null,B;if(this.value.isDataDriven())return this.prior=null,B;if(C<this.begin)return R.possiblyEvaluate(o,p,x);{const j=(C-this.begin)/(this.end-this.begin);return this.property.interpolate(R.possiblyEvaluate(o,p,x),B,function(H){if(H<=0)return 0;if(H>=1)return 1;const q=H*H,J=q*H;return 4*(H<.5?J:3*(H-q)+J-.75)}(j))}}return B}}class Ci{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,p,x){const C=new Wi(this._properties);for(const B of Object.keys(this._values))C._values[B]=this._values[B].possiblyEvaluate(o,p,x);return C}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class Ec{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}hasValue(o){return this._values[o].value!==void 0}getValue(o){return tt(this._values[o].value)}setValue(o,p){this._values[o]=new CA(this._values[o].property,p===null?void 0:tt(p))}serialize(){const o={};for(const p of Object.keys(this._values)){const x=this.getValue(p);x!==void 0&&(o[p]=x)}return o}possiblyEvaluate(o,p,x){const C=new Wi(this._properties);for(const B of Object.keys(this._values))C._values[B]=this._values[B].possiblyEvaluate(o,p,x);return C}}class jr{constructor(o,p,x){this.property=o,this.value=p,this.parameters=x}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,p,x,C){return this.property.evaluate(this.value,this.parameters,o,p,x,C)}}class Wi{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class gt{constructor(o){this.specification=o}possiblyEvaluate(o,p){if(o.isDataDriven())throw new Error("Value should not be data driven");return o.expression.evaluate(p)}interpolate(o,p,x){const C=fr[this.specification.type];return C?C(o,p,x):o}}class Jt{constructor(o,p){this.specification=o,this.overrides=p}possiblyEvaluate(o,p,x,C){return new jr(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(p,null,{},x,C)}:o.expression,p)}interpolate(o,p,x){if(o.value.kind!=="constant"||p.value.kind!=="constant")return o;if(o.value.value===void 0||p.value.value===void 0)return new jr(this,{kind:"constant",value:void 0},o.parameters);const C=fr[this.specification.type];if(C){const B=C(o.value.value,p.value.value,x);return new jr(this,{kind:"constant",value:B},o.parameters)}return o}evaluate(o,p,x,C,B,R){return o.kind==="constant"?o.value:o.evaluate(p,x,C,B,R)}}class ol extends Jt{possiblyEvaluate(o,p,x,C){if(o.value===void 0)return new jr(this,{kind:"constant",value:void 0},p);if(o.expression.kind==="constant"){const B=o.expression.evaluate(p,null,{},x,C),R=o.property.specification.type==="resolvedImage"&&typeof B!="string"?B.name:B,j=this._calculate(R,R,R,p);return new jr(this,{kind:"constant",value:j},p)}if(o.expression.kind==="camera"){const B=this._calculate(o.expression.evaluate({zoom:p.zoom-1}),o.expression.evaluate({zoom:p.zoom}),o.expression.evaluate({zoom:p.zoom+1}),p);return new jr(this,{kind:"constant",value:B},p)}return new jr(this,o.expression,p)}evaluate(o,p,x,C,B,R){if(o.kind==="source"){const j=o.evaluate(p,x,C,B,R);return this._calculate(j,j,j,p)}return o.kind==="composite"?this._calculate(o.evaluate({zoom:Math.floor(p.zoom)-1},x,C),o.evaluate({zoom:Math.floor(p.zoom)},x,C),o.evaluate({zoom:Math.floor(p.zoom)+1},x,C),p):o.value}_calculate(o,p,x,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:o,to:p}:{from:x,to:p}}interpolate(o){return o}}class pa{constructor(o){this.specification=o}possiblyEvaluate(o,p,x,C){if(o.value!==void 0){if(o.expression.kind==="constant"){const B=o.expression.evaluate(p,null,{},x,C);return this._calculate(B,B,B,p)}return this._calculate(o.expression.evaluate(new ci(Math.floor(p.zoom-1),p)),o.expression.evaluate(new ci(Math.floor(p.zoom),p)),o.expression.evaluate(new ci(Math.floor(p.zoom+1),p)),p)}}_calculate(o,p,x,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:o,to:p}:{from:x,to:p}}interpolate(o){return o}}class MA{constructor(o){this.specification=o}possiblyEvaluate(o,p,x,C){return!!o.expression.evaluate(p,null,{},x,C)}interpolate(){return!1}}class br{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in o){const x=o[p];x.specification.overridable&&this.overridableProperties.push(p);const C=this.defaultPropertyValues[p]=new CA(x,void 0),B=this.defaultTransitionablePropertyValues[p]=new Ha(x);this.defaultTransitioningPropertyValues[p]=B.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=C.possiblyEvaluate({})}}}Wt("DataDrivenProperty",Jt),Wt("DataConstantProperty",gt),Wt("CrossFadedDataDrivenProperty",ol),Wt("CrossFadedProperty",pa),Wt("ColorRampProperty",MA);const Er="-transition";class xt extends Lr{constructor(o,p){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1},o.type!=="custom"&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type!=="background"&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),p.layout&&(this._unevaluatedLayout=new Ec(p.layout)),p.paint)){this._transitionablePaint=new Ql(p.paint);for(const x in o.paint)this.setPaintProperty(x,o.paint[x],{validate:!1});for(const x in o.layout)this.setLayoutProperty(x,o.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wi(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,p,x={}){p!=null&&this._validate(Ol,`layers.${this.id}.layout.${o}`,o,p,x)||(o!=="visibility"?this._unevaluatedLayout.setValue(o,p):this.visibility=p)}getPaintProperty(o){return o.endsWith(Er)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,p,x={}){if(p!=null&&this._validate(ha,`layers.${this.id}.paint.${o}`,o,p,x))return!1;if(o.endsWith(Er))return this._transitionablePaint.setTransition(o.slice(0,-11),p||void 0),!1;{const C=this._transitionablePaint._values[o],B=C.property.specification["property-type"]==="cross-faded-data-driven",R=C.value.isDataDriven(),j=C.value;this._transitionablePaint.setValue(o,p),this._handleSpecialPaintPropertyUpdate(o);const H=this._transitionablePaint._values[o].value;return H.isDataDriven()||R||B||this._handleOverridablePaintPropertyUpdate(o,j,H)}}_handleSpecialPaintPropertyUpdate(o){}_handleOverridablePaintPropertyUpdate(o,p,x){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,p){o.getCrossfadeParameters&&(this._crossfadeParameters=o.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,p)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),qe(o,(p,x)=>!(p===void 0||x==="layout"&&!Object.keys(p).length||x==="paint"&&!Object.keys(p).length))}_validate(o,p,x,C,B={}){return(!B||B.validate!==!1)&&fa(this,o.call(wA,{key:p,layerType:this.type,objectKey:x,value:C,styleSpec:ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const p=this.paint.get(o);if(p instanceof jr&&oa(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const qt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Wa{constructor(o,p){this._structArray=o,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ai{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,p){return o._trim(),p&&(o.isTransferred=!0,p.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const p=Object.create(this.prototype);return p.arrayBuffer=o.arrayBuffer,p.length=o.length,p.capacity=o.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pi(h,o=1){let p=0,x=0;return{members:h.map(C=>{const B=qt[C.type].BYTES_PER_ELEMENT,R=p=gs(p,Math.max(o,B)),j=C.components||1;return x=Math.max(x,B),p+=B*j,{name:C.name,type:C.type,components:j,offset:R}}),size:gs(p,Math.max(x,o)),alignment:o}}function gs(h,o){return Math.ceil(h/o)*o}class Bi extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,p){const x=this.length;return this.resize(x+1),this.emplace(x,o,p)}emplace(o,p,x){const C=2*o;return this.int16[C+0]=p,this.int16[C+1]=x,o}}Bi.prototype.bytesPerElement=4,Wt("StructArrayLayout2i4",Bi);class Pi extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,p,x)}emplace(o,p,x,C){const B=3*o;return this.int16[B+0]=p,this.int16[B+1]=x,this.int16[B+2]=C,o}}Pi.prototype.bytesPerElement=6,Wt("StructArrayLayout3i6",Pi);class _ extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,p,x,C){const B=this.length;return this.resize(B+1),this.emplace(B,o,p,x,C)}emplace(o,p,x,C,B){const R=4*o;return this.int16[R+0]=p,this.int16[R+1]=x,this.int16[R+2]=C,this.int16[R+3]=B,o}}_.prototype.bytesPerElement=8,Wt("StructArrayLayout4i8",_);class v extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R){const j=this.length;return this.resize(j+1),this.emplace(j,o,p,x,C,B,R)}emplace(o,p,x,C,B,R,j){const H=6*o;return this.int16[H+0]=p,this.int16[H+1]=x,this.int16[H+2]=C,this.int16[H+3]=B,this.int16[H+4]=R,this.int16[H+5]=j,o}}v.prototype.bytesPerElement=12,Wt("StructArrayLayout2i4i12",v);class E extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R){const j=this.length;return this.resize(j+1),this.emplace(j,o,p,x,C,B,R)}emplace(o,p,x,C,B,R,j){const H=4*o,q=8*o;return this.int16[H+0]=p,this.int16[H+1]=x,this.uint8[q+4]=C,this.uint8[q+5]=B,this.uint8[q+6]=R,this.uint8[q+7]=j,o}}E.prototype.bytesPerElement=8,Wt("StructArrayLayout2i4ub8",E);class L extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,p){const x=this.length;return this.resize(x+1),this.emplace(x,o,p)}emplace(o,p,x){const C=2*o;return this.float32[C+0]=p,this.float32[C+1]=x,o}}L.prototype.bytesPerElement=8,Wt("StructArrayLayout2f8",L);class O extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R,j,H,q,J){const ne=this.length;return this.resize(ne+1),this.emplace(ne,o,p,x,C,B,R,j,H,q,J)}emplace(o,p,x,C,B,R,j,H,q,J,ne){const he=10*o;return this.uint16[he+0]=p,this.uint16[he+1]=x,this.uint16[he+2]=C,this.uint16[he+3]=B,this.uint16[he+4]=R,this.uint16[he+5]=j,this.uint16[he+6]=H,this.uint16[he+7]=q,this.uint16[he+8]=J,this.uint16[he+9]=ne,o}}O.prototype.bytesPerElement=20,Wt("StructArrayLayout10ui20",O);class F extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R,j,H,q,J,ne,he){const me=this.length;return this.resize(me+1),this.emplace(me,o,p,x,C,B,R,j,H,q,J,ne,he)}emplace(o,p,x,C,B,R,j,H,q,J,ne,he,me){const ye=12*o;return this.int16[ye+0]=p,this.int16[ye+1]=x,this.int16[ye+2]=C,this.int16[ye+3]=B,this.uint16[ye+4]=R,this.uint16[ye+5]=j,this.uint16[ye+6]=H,this.uint16[ye+7]=q,this.int16[ye+8]=J,this.int16[ye+9]=ne,this.int16[ye+10]=he,this.int16[ye+11]=me,o}}F.prototype.bytesPerElement=24,Wt("StructArrayLayout4i4ui4i24",F);class z extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,p,x)}emplace(o,p,x,C){const B=3*o;return this.float32[B+0]=p,this.float32[B+1]=x,this.float32[B+2]=C,o}}z.prototype.bytesPerElement=12,Wt("StructArrayLayout3f12",z);class Q extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const p=this.length;return this.resize(p+1),this.emplace(p,o)}emplace(o,p){return this.uint32[1*o+0]=p,o}}Q.prototype.bytesPerElement=4,Wt("StructArrayLayout1ul4",Q);class Y extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R,j,H,q){const J=this.length;return this.resize(J+1),this.emplace(J,o,p,x,C,B,R,j,H,q)}emplace(o,p,x,C,B,R,j,H,q,J){const ne=10*o,he=5*o;return this.int16[ne+0]=p,this.int16[ne+1]=x,this.int16[ne+2]=C,this.int16[ne+3]=B,this.int16[ne+4]=R,this.int16[ne+5]=j,this.uint32[he+3]=H,this.uint16[ne+8]=q,this.uint16[ne+9]=J,o}}Y.prototype.bytesPerElement=20,Wt("StructArrayLayout6i1ul2ui20",Y);class le extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R){const j=this.length;return this.resize(j+1),this.emplace(j,o,p,x,C,B,R)}emplace(o,p,x,C,B,R,j){const H=6*o;return this.int16[H+0]=p,this.int16[H+1]=x,this.int16[H+2]=C,this.int16[H+3]=B,this.int16[H+4]=R,this.int16[H+5]=j,o}}le.prototype.bytesPerElement=12,Wt("StructArrayLayout2i2i2i12",le);class pe extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B){const R=this.length;return this.resize(R+1),this.emplace(R,o,p,x,C,B)}emplace(o,p,x,C,B,R){const j=4*o,H=8*o;return this.float32[j+0]=p,this.float32[j+1]=x,this.float32[j+2]=C,this.int16[H+6]=B,this.int16[H+7]=R,o}}pe.prototype.bytesPerElement=16,Wt("StructArrayLayout2f1f2i16",pe);class Qe extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,p,x,C){const B=this.length;return this.resize(B+1),this.emplace(B,o,p,x,C)}emplace(o,p,x,C,B){const R=12*o,j=3*o;return this.uint8[R+0]=p,this.uint8[R+1]=x,this.float32[j+1]=C,this.float32[j+2]=B,o}}Qe.prototype.bytesPerElement=12,Wt("StructArrayLayout2ub2f12",Qe);class Te extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,p,x)}emplace(o,p,x,C){const B=3*o;return this.uint16[B+0]=p,this.uint16[B+1]=x,this.uint16[B+2]=C,o}}Te.prototype.bytesPerElement=6,Wt("StructArrayLayout3ui6",Te);class ze extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R,j,H,q,J,ne,he,me,ye,Me,Ue,He){const Ke=this.length;return this.resize(Ke+1),this.emplace(Ke,o,p,x,C,B,R,j,H,q,J,ne,he,me,ye,Me,Ue,He)}emplace(o,p,x,C,B,R,j,H,q,J,ne,he,me,ye,Me,Ue,He,Ke){const Ze=24*o,et=12*o,st=48*o;return this.int16[Ze+0]=p,this.int16[Ze+1]=x,this.uint16[Ze+2]=C,this.uint16[Ze+3]=B,this.uint32[et+2]=R,this.uint32[et+3]=j,this.uint32[et+4]=H,this.uint16[Ze+10]=q,this.uint16[Ze+11]=J,this.uint16[Ze+12]=ne,this.float32[et+7]=he,this.float32[et+8]=me,this.uint8[st+36]=ye,this.uint8[st+37]=Me,this.uint8[st+38]=Ue,this.uint32[et+10]=He,this.int16[Ze+22]=Ke,o}}ze.prototype.bytesPerElement=48,Wt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ze);class it extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,p,x,C,B,R,j,H,q,J,ne,he,me,ye,Me,Ue,He,Ke,Ze,et,st,dt,Gt,tn,jt,Ft,Dt,Xt){const Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,o,p,x,C,B,R,j,H,q,J,ne,he,me,ye,Me,Ue,He,Ke,Ze,et,st,dt,Gt,tn,jt,Ft,Dt,Xt)}emplace(o,p,x,C,B,R,j,H,q,J,ne,he,me,ye,Me,Ue,He,Ke,Ze,et,st,dt,Gt,tn,jt,Ft,Dt,Xt,Ot){const bt=32*o,hn=16*o;return this.int16[bt+0]=p,this.int16[bt+1]=x,this.int16[bt+2]=C,this.int16[bt+3]=B,this.int16[bt+4]=R,this.int16[bt+5]=j,this.int16[bt+6]=H,this.int16[bt+7]=q,this.uint16[bt+8]=J,this.uint16[bt+9]=ne,this.uint16[bt+10]=he,this.uint16[bt+11]=me,this.uint16[bt+12]=ye,this.uint16[bt+13]=Me,this.uint16[bt+14]=Ue,this.uint16[bt+15]=He,this.uint16[bt+16]=Ke,this.uint16[bt+17]=Ze,this.uint16[bt+18]=et,this.uint16[bt+19]=st,this.uint16[bt+20]=dt,this.uint16[bt+21]=Gt,this.uint16[bt+22]=tn,this.uint32[hn+12]=jt,this.float32[hn+13]=Ft,this.float32[hn+14]=Dt,this.uint16[bt+30]=Xt,this.uint16[bt+31]=Ot,o}}it.prototype.bytesPerElement=64,Wt("StructArrayLayout8i15ui1ul2f2ui64",it);class M extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const p=this.length;return this.resize(p+1),this.emplace(p,o)}emplace(o,p){return this.float32[1*o+0]=p,o}}M.prototype.bytesPerElement=4,Wt("StructArrayLayout1f4",M);class a extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,p,x)}emplace(o,p,x,C){const B=3*o;return this.uint16[6*o+0]=p,this.float32[B+1]=x,this.float32[B+2]=C,o}}a.prototype.bytesPerElement=12,Wt("StructArrayLayout1ui2f12",a);class m extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,o,p,x)}emplace(o,p,x,C){const B=4*o;return this.uint32[2*o+0]=p,this.uint16[B+2]=x,this.uint16[B+3]=C,o}}m.prototype.bytesPerElement=8,Wt("StructArrayLayout1ul2ui8",m);class w extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,p){const x=this.length;return this.resize(x+1),this.emplace(x,o,p)}emplace(o,p,x){const C=2*o;return this.uint16[C+0]=p,this.uint16[C+1]=x,o}}w.prototype.bytesPerElement=4,Wt("StructArrayLayout2ui4",w);class T extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const p=this.length;return this.resize(p+1),this.emplace(p,o)}emplace(o,p){return this.uint16[1*o+0]=p,o}}T.prototype.bytesPerElement=2,Wt("StructArrayLayout1ui2",T);class I extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,p,x,C){const B=this.length;return this.resize(B+1),this.emplace(B,o,p,x,C)}emplace(o,p,x,C,B){const R=4*o;return this.float32[R+0]=p,this.float32[R+1]=x,this.float32[R+2]=C,this.float32[R+3]=B,o}}I.prototype.bytesPerElement=16,Wt("StructArrayLayout4f16",I);class u extends Wa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new V(this.anchorPointX,this.anchorPointY)}}u.prototype.size=20;class c extends Y{get(o){return new u(this,o)}}Wt("CollisionBoxArray",c);class f extends Wa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(o){this._structArray.uint8[this._pos1+37]=o}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(o){this._structArray.uint8[this._pos1+38]=o}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(o){this._structArray.uint32[this._pos4+10]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}f.prototype.size=48;class g extends ze{get(o){return new f(this,o)}}Wt("PlacedSymbolArray",g);class y extends Wa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(o){this._structArray.uint32[this._pos4+12]=o}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}y.prototype.size=64;class b extends it{get(o){return new y(this,o)}}Wt("SymbolInstanceArray",b);class P extends M{getoffsetX(o){return this.float32[1*o+0]}}Wt("GlyphOffsetArray",P);class D extends Pi{getx(o){return this.int16[3*o+0]}gety(o){return this.int16[3*o+1]}gettileUnitDistanceFromAnchor(o){return this.int16[3*o+2]}}Wt("SymbolLineVertexArray",D);class N extends Wa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}N.prototype.size=12;class G extends a{get(o){return new N(this,o)}}Wt("TextAnchorOffsetArray",G);class W extends Wa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}W.prototype.size=8;class K extends m{get(o){return new W(this,o)}}Wt("FeatureIndexArray",K);class de extends Bi{}class te extends Bi{}class se extends Bi{}class xe extends v{}class Ie extends E{}class Fe extends L{}class Re extends O{}class Be extends F{}class Le extends z{}class At extends Q{}class _t extends le{}class nt extends Qe{}class ct extends Te{}class Ct extends w{}const un=pi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yt}=un;class wt{constructor(o=[]){this.segments=o}prepareSegment(o,p,x,C){let B=this.segments[this.segments.length-1];return o>wt.MAX_VERTEX_ARRAY_LENGTH&&at(`Max vertices per segment is ${wt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!B||B.vertexLength+o>wt.MAX_VERTEX_ARRAY_LENGTH||B.sortKey!==C)&&(B={vertexOffset:p.length,primitiveOffset:x.length,vertexLength:0,primitiveLength:0},C!==void 0&&(B.sortKey=C),this.segments.push(B)),B}get(){return this.segments}destroy(){for(const o of this.segments)for(const p in o.vaos)o.vaos[p].destroy()}static simpleSegment(o,p,x,C){return new wt([{vertexOffset:o,primitiveOffset:p,vertexLength:x,primitiveLength:C,vaos:{},sortKey:0}])}}function zt(h,o){return 256*(h=ie(Math.floor(h),0,255))+ie(Math.floor(o),0,255)}wt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Wt("SegmentVector",wt);const nn=pi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var fn={exports:{}},cn={exports:{}};cn.exports=function(h,o){var p,x,C,B,R,j,H,q;for(x=h.length-(p=3&h.length),C=o,R=3432918353,j=461845907,q=0;q<x;)H=255&h.charCodeAt(q)|(255&h.charCodeAt(++q))<<8|(255&h.charCodeAt(++q))<<16|(255&h.charCodeAt(++q))<<24,++q,C=27492+(65535&(B=5*(65535&(C=(C^=H=(65535&(H=(H=(65535&H)*R+(((H>>>16)*R&65535)<<16)&4294967295)<<15|H>>>17))*j+(((H>>>16)*j&65535)<<16)&4294967295)<<13|C>>>19))+((5*(C>>>16)&65535)<<16)&4294967295))+((58964+(B>>>16)&65535)<<16);switch(H=0,p){case 3:H^=(255&h.charCodeAt(q+2))<<16;case 2:H^=(255&h.charCodeAt(q+1))<<8;case 1:C^=H=(65535&(H=(H=(65535&(H^=255&h.charCodeAt(q)))*R+(((H>>>16)*R&65535)<<16)&4294967295)<<15|H>>>17))*j+(((H>>>16)*j&65535)<<16)&4294967295}return C^=h.length,C=2246822507*(65535&(C^=C>>>16))+((2246822507*(C>>>16)&65535)<<16)&4294967295,C=3266489909*(65535&(C^=C>>>13))+((3266489909*(C>>>16)&65535)<<16)&4294967295,(C^=C>>>16)>>>0};var Pn=cn.exports,Gn={exports:{}};Gn.exports=function(h,o){for(var p,x=h.length,C=o^x,B=0;x>=4;)p=1540483477*(65535&(p=255&h.charCodeAt(B)|(255&h.charCodeAt(++B))<<8|(255&h.charCodeAt(++B))<<16|(255&h.charCodeAt(++B))<<24))+((1540483477*(p>>>16)&65535)<<16),C=1540483477*(65535&C)+((1540483477*(C>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),x-=4,++B;switch(x){case 3:C^=(255&h.charCodeAt(B+2))<<16;case 2:C^=(255&h.charCodeAt(B+1))<<8;case 1:C=1540483477*(65535&(C^=255&h.charCodeAt(B)))+((1540483477*(C>>>16)&65535)<<16)}return C=1540483477*(65535&(C^=C>>>13))+((1540483477*(C>>>16)&65535)<<16),(C^=C>>>15)>>>0};var Kr=Pn,$a=Gn.exports;fn.exports=Kr,fn.exports.murmur3=Kr,fn.exports.murmur2=$a;var ga=S(fn.exports);class Za{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,p,x,C){this.ids.push(Iu(o)),this.positions.push(p,x,C)}getPositions(o){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=Iu(o);let x=0,C=this.ids.length-1;for(;x<C;){const R=x+C>>1;this.ids[R]>=p?C=R:x=R+1}const B=[];for(;this.ids[x]===p;)B.push({index:this.positions[3*x],start:this.positions[3*x+1],end:this.positions[3*x+2]}),x++;return B}static serialize(o,p){const x=new Float64Array(o.ids),C=new Uint32Array(o.positions);return al(x,C,0,x.length-1),p&&p.push(x.buffer,C.buffer),{ids:x,positions:C}}static deserialize(o){const p=new Za;return p.ids=o.ids,p.positions=o.positions,p.indexed=!0,p}}function Iu(h){const o=+h;return!isNaN(o)&&o<=Number.MAX_SAFE_INTEGER?o:ga(String(h))}function al(h,o,p,x){for(;p<x;){const C=h[p+x>>1];let B=p-1,R=x+1;for(;;){do B++;while(h[B]<C);do R--;while(h[R]>C);if(B>=R)break;IA(h,B,R),IA(o,3*B,3*R),IA(o,3*B+1,3*R+1),IA(o,3*B+2,3*R+2)}R-p<x-R?(al(h,o,p,R),p=R+1):(al(h,o,R+1,x),x=R)}}function IA(h,o,p){const x=h[o];h[o]=h[p],h[p]=x}Wt("FeaturePositionMap",Za);class nr{constructor(o,p){this.gl=o.gl,this.location=p}}class Tr extends nr{constructor(o,p){super(o,p),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class ms extends nr{constructor(o,p){super(o,p),this.current=[0,0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3]))}}class ku extends nr{constructor(o,p){super(o,p),this.current=pt.transparent}set(o){o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a))}}const Sr=new Float32Array(16);function pr(h){return[zt(255*h.r,255*h.g),zt(255*h.b,255*h.a)]}class _s{constructor(o,p,x){this.value=o,this.uniformNames=p.map(C=>`u_${C}`),this.type=x}setUniform(o,p,x){o.set(x.constantOr(this.value))}getBinding(o,p,x){return this.type==="color"?new ku(o,p):new Tr(o,p)}}class Ri{constructor(o,p){this.uniformNames=p.map(x=>`u_${x}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(o,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=o.tlbr}setUniform(o,p,x,C){const B=C==="u_pattern_to"?this.patternTo:C==="u_pattern_from"?this.patternFrom:C==="u_pixel_ratio_to"?this.pixelRatioTo:C==="u_pixel_ratio_from"?this.pixelRatioFrom:null;B&&o.set(B)}getBinding(o,p,x){return x.substr(0,9)==="u_pattern"?new ms(o,p):new Tr(o,p)}}class kA{constructor(o,p,x,C){this.expression=o,this.type=x,this.maxValue=0,this.paintVertexAttributes=p.map(B=>({name:`a_${B}`,type:"Float32",components:x==="color"?2:1,offset:0})),this.paintVertexArray=new C}populatePaintArray(o,p,x,C,B){const R=this.paintVertexArray.length,j=this.expression.evaluate(new ci(0),p,{},C,[],B);this.paintVertexArray.resize(o),this._setPaintValue(R,o,j)}updatePaintArray(o,p,x,C){const B=this.expression.evaluate({zoom:0},x,C);this._setPaintValue(o,p,B)}_setPaintValue(o,p,x){if(this.type==="color"){const C=pr(x);for(let B=o;B<p;B++)this.paintVertexArray.emplace(B,C[0],C[1])}else{for(let C=o;C<p;C++)this.paintVertexArray.emplace(C,x);this.maxValue=Math.max(this.maxValue,Math.abs(x))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ma{constructor(o,p,x,C,B,R){this.expression=o,this.uniformNames=p.map(j=>`u_${j}_t`),this.type=x,this.useIntegerZoom=C,this.zoom=B,this.maxValue=0,this.paintVertexAttributes=p.map(j=>({name:`a_${j}`,type:"Float32",components:x==="color"?4:2,offset:0})),this.paintVertexArray=new R}populatePaintArray(o,p,x,C,B){const R=this.expression.evaluate(new ci(this.zoom),p,{},C,[],B),j=this.expression.evaluate(new ci(this.zoom+1),p,{},C,[],B),H=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(H,o,R,j)}updatePaintArray(o,p,x,C){const B=this.expression.evaluate({zoom:this.zoom},x,C),R=this.expression.evaluate({zoom:this.zoom+1},x,C);this._setPaintValue(o,p,B,R)}_setPaintValue(o,p,x,C){if(this.type==="color"){const B=pr(x),R=pr(C);for(let j=o;j<p;j++)this.paintVertexArray.emplace(j,B[0],B[1],R[0],R[1])}else{for(let B=o;B<p;B++)this.paintVertexArray.emplace(B,x,C);this.maxValue=Math.max(this.maxValue,Math.abs(x),Math.abs(C))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,p){const x=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,C=ie(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);o.set(C)}getBinding(o,p,x){return new Tr(o,p)}}class Al{constructor(o,p,x,C,B,R){this.expression=o,this.type=p,this.useIntegerZoom=x,this.zoom=C,this.layerId=R,this.zoomInPaintVertexArray=new B,this.zoomOutPaintVertexArray=new B}populatePaintArray(o,p,x){const C=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(C,o,p.patterns&&p.patterns[this.layerId],x)}updatePaintArray(o,p,x,C,B){this._setPaintValues(o,p,x.patterns&&x.patterns[this.layerId],B)}_setPaintValues(o,p,x,C){if(!C||!x)return;const{min:B,mid:R,max:j}=x,H=C[B],q=C[R],J=C[j];if(H&&q&&J)for(let ne=o;ne<p;ne++)this.zoomInPaintVertexArray.emplace(ne,q.tl[0],q.tl[1],q.br[0],q.br[1],H.tl[0],H.tl[1],H.br[0],H.br[1],q.pixelRatio,H.pixelRatio),this.zoomOutPaintVertexArray.emplace(ne,q.tl[0],q.tl[1],q.br[0],q.br[1],J.tl[0],J.tl[1],J.br[0],J.br[1],q.pixelRatio,J.pixelRatio)}upload(o){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,nn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,nn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ap{constructor(o,p,x){this.binders={},this._buffers=[];const C=[];for(const B in o.paint._values){if(!x(B))continue;const R=o.paint.get(B);if(!(R instanceof jr&&oa(R.property.specification)))continue;const j=L_(B,o.type),H=R.value,q=R.property.specification.type,J=R.property.useIntegerZoom,ne=R.property.specification["property-type"],he=ne==="cross-faded"||ne==="cross-faded-data-driven";if(H.kind==="constant")this.binders[B]=he?new Ri(H.value,j):new _s(H.value,j,q),C.push(`/u_${B}`);else if(H.kind==="source"||he){const me=Wl(B,q,"source");this.binders[B]=he?new Al(H,q,J,p,me,o.id):new kA(H,j,q,me),C.push(`/a_${B}`)}else{const me=Wl(B,q,"composite");this.binders[B]=new ma(H,j,q,J,p,me),C.push(`/z_${B}`)}}this.cacheKey=C.sort().join("")}getMaxValue(o){const p=this.binders[o];return p instanceof kA||p instanceof ma?p.maxValue:0}populatePaintArrays(o,p,x,C,B){for(const R in this.binders){const j=this.binders[R];(j instanceof kA||j instanceof ma||j instanceof Al)&&j.populatePaintArray(o,p,x,C,B)}}setConstantPatternPositions(o,p){for(const x in this.binders){const C=this.binders[x];C instanceof Ri&&C.setConstantPatternPositions(o,p)}}updatePaintArrays(o,p,x,C,B){let R=!1;for(const j in o){const H=p.getPositions(j);for(const q of H){const J=x.feature(q.index);for(const ne in this.binders){const he=this.binders[ne];if((he instanceof kA||he instanceof ma||he instanceof Al)&&he.expression.isStateDependent===!0){const me=C.paint.get(ne);he.expression=me.value,he.updatePaintArray(q.start,q.end,J,o[j],B),R=!0}}}}return R}defines(){const o=[];for(const p in this.binders){const x=this.binders[p];(x instanceof _s||x instanceof Ri)&&o.push(...x.uniformNames.map(C=>`#define HAS_UNIFORM_${C}`))}return o}getBinderAttributes(){const o=[];for(const p in this.binders){const x=this.binders[p];if(x instanceof kA||x instanceof ma)for(let C=0;C<x.paintVertexAttributes.length;C++)o.push(x.paintVertexAttributes[C].name);else if(x instanceof Al)for(let C=0;C<nn.members.length;C++)o.push(nn.members[C].name)}return o}getBinderUniforms(){const o=[];for(const p in this.binders){const x=this.binders[p];if(x instanceof _s||x instanceof Ri||x instanceof ma)for(const C of x.uniformNames)o.push(C)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o,p){const x=[];for(const C in this.binders){const B=this.binders[C];if(B instanceof _s||B instanceof Ri||B instanceof ma){for(const R of B.uniformNames)if(p[R]){const j=B.getBinding(o,p[R],R);x.push({name:R,property:C,binding:j})}}}return x}setUniforms(o,p,x,C){for(const{name:B,property:R,binding:j}of p)this.binders[R].setUniform(j,C,x.get(R),B)}updatePaintBuffers(o){this._buffers=[];for(const p in this.binders){const x=this.binders[p];if(o&&x instanceof Al){const C=o.fromScale===2?x.zoomInPaintVertexBuffer:x.zoomOutPaintVertexBuffer;C&&this._buffers.push(C)}else(x instanceof kA||x instanceof ma)&&x.paintVertexBuffer&&this._buffers.push(x.paintVertexBuffer)}}upload(o){for(const p in this.binders){const x=this.binders[p];(x instanceof kA||x instanceof ma||x instanceof Al)&&x.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const p=this.binders[o];(p instanceof kA||p instanceof ma||p instanceof Al)&&p.destroy()}}}class Hl{constructor(o,p,x=()=>!0){this.programConfigurations={};for(const C of o)this.programConfigurations[C.id]=new ap(C,p,x);this.needsUpload=!1,this._featureMap=new Za,this._bufferOffset=0}populatePaintArrays(o,p,x,C,B,R){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(o,p,C,B,R);p.id!==void 0&&this._featureMap.add(p.id,x,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,p,x,C){for(const B of x)this.needsUpload=this.programConfigurations[B.id].updatePaintArrays(o,this._featureMap,p,B,C)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}function L_(h,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${o}-`,"").replace(/-/g,"_")]}function Wl(h,o,p){const x={color:{source:L,composite:I},number:{source:M,composite:L}},C=function(B){return{"line-pattern":{source:Re,composite:Re},"fill-pattern":{source:Re,composite:Re},"fill-extrusion-pattern":{source:Re,composite:Re}}[B]}(h);return C&&C[p]||x[o][p]}Wt("ConstantBinder",_s),Wt("CrossFadedConstantBinder",Ri),Wt("SourceExpressionBinder",kA),Wt("CrossFadedCompositeBinder",Al),Wt("CompositeExpressionBinder",ma),Wt("ProgramConfiguration",ap,{omit:["_buffers"]}),Wt("ProgramConfigurationSet",Hl);const Fi=8192,dh=Math.pow(2,14)-1,j0=-dh-1;function LA(h){const o=Fi/h.extent,p=h.loadGeometry();for(let x=0;x<p.length;x++){const C=p[x];for(let B=0;B<C.length;B++){const R=C[B],j=Math.round(R.x*o),H=Math.round(R.y*o);R.x=ie(j,j0,dh),R.y=ie(H,j0,dh),(j<R.x||j>R.x+1||H<R.y||H>R.y+1)&&at("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function ll(h,o){return{type:h.type,id:h.id,properties:h.properties,geometry:o?LA(h):[]}}function Lu(h,o,p,x,C){h.emplaceBack(2*o+(x+1)/2,2*p+(C+1)/2)}class D_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(p=>p.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new te,this.indexArray=new ct,this.segments=new wt,this.programConfigurations=new Hl(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(o,p,x){const C=this.layers[0],B=[];let R=null,j=!1;C.type==="circle"&&(R=C.layout.get("circle-sort-key"),j=!R.isConstant());for(const{feature:H,id:q,index:J,sourceLayerIndex:ne}of o){const he=this.layers[0]._featureFilter.needGeometry,me=ll(H,he);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),me,x))continue;const ye=j?R.evaluate(me,{},x):void 0,Me={id:q,properties:H.properties,type:H.type,sourceLayerIndex:ne,index:J,geometry:he?me.geometry:LA(H),patterns:{},sortKey:ye};B.push(Me)}j&&B.sort((H,q)=>H.sortKey-q.sortKey);for(const H of B){const{geometry:q,index:J,sourceLayerIndex:ne}=H,he=o[J].feature;this.addFeature(H,q,J,x),p.featureIndex.insert(he,q,J,ne,this.index)}}update(o,p,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,p,this.stateDependentLayers,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Yt),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,p,x,C){for(const B of p)for(const R of B){const j=R.x,H=R.y;if(j<0||j>=Fi||H<0||H>=Fi)continue;const q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),J=q.vertexLength;Lu(this.layoutVertexArray,j,H,-1,-1),Lu(this.layoutVertexArray,j,H,1,-1),Lu(this.layoutVertexArray,j,H,1,1),Lu(this.layoutVertexArray,j,H,-1,1),this.indexArray.emplaceBack(J,J+1,J+2),this.indexArray.emplaceBack(J,J+3,J+2),q.vertexLength+=4,q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,x,{},C)}}function nb(h,o){for(let p=0;p<h.length;p++)if(ph(o,h[p]))return!0;for(let p=0;p<o.length;p++)if(ph(h,o[p]))return!0;return!!B_(h,o)}function f6(h,o,p){return!!ph(h,o)||!!R_(o,h,p)}function ib(h,o){if(h.length===1)return sb(o,h[0]);for(let p=0;p<o.length;p++){const x=o[p];for(let C=0;C<x.length;C++)if(ph(h,x[C]))return!0}for(let p=0;p<h.length;p++)if(sb(o,h[p]))return!0;for(let p=0;p<o.length;p++)if(B_(h,o[p]))return!0;return!1}function d6(h,o,p){if(h.length>1){if(B_(h,o))return!0;for(let x=0;x<o.length;x++)if(R_(o[x],h,p))return!0}for(let x=0;x<h.length;x++)if(R_(h[x],o,p))return!0;return!1}function B_(h,o){if(h.length===0||o.length===0)return!1;for(let p=0;p<h.length-1;p++){const x=h[p],C=h[p+1];for(let B=0;B<o.length-1;B++)if(p6(x,C,o[B],o[B+1]))return!0}return!1}function p6(h,o,p,x){return ht(h,p,x)!==ht(o,p,x)&&ht(h,o,p)!==ht(h,o,x)}function R_(h,o,p){const x=p*p;if(o.length===1)return h.distSqr(o[0])<x;for(let C=1;C<o.length;C++)if(rb(h,o[C-1],o[C])<x)return!0;return!1}function rb(h,o,p){const x=o.distSqr(p);if(x===0)return h.distSqr(o);const C=((h.x-o.x)*(p.x-o.x)+(h.y-o.y)*(p.y-o.y))/x;return h.distSqr(C<0?o:C>1?p:p.sub(o)._mult(C)._add(o))}function sb(h,o){let p,x,C,B=!1;for(let R=0;R<h.length;R++){p=h[R];for(let j=0,H=p.length-1;j<p.length;H=j++)x=p[j],C=p[H],x.y>o.y!=C.y>o.y&&o.x<(C.x-x.x)*(o.y-x.y)/(C.y-x.y)+x.x&&(B=!B)}return B}function ph(h,o){let p=!1;for(let x=0,C=h.length-1;x<h.length;C=x++){const B=h[x],R=h[C];B.y>o.y!=R.y>o.y&&o.x<(R.x-B.x)*(o.y-B.y)/(R.y-B.y)+B.x&&(p=!p)}return p}function g6(h,o,p){const x=p[0],C=p[2];if(h.x<x.x&&o.x<x.x||h.x>C.x&&o.x>C.x||h.y<x.y&&o.y<x.y||h.y>C.y&&o.y>C.y)return!1;const B=ht(h,o,p[0]);return B!==ht(h,o,p[1])||B!==ht(h,o,p[2])||B!==ht(h,o,p[3])}function G0(h,o,p){const x=o.paint.get(h).value;return x.kind==="constant"?x.value:p.programConfigurations.get(o.id).getMaxValue(h)}function Ap(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function lp(h,o,p,x,C){if(!o[0]&&!o[1])return h;const B=V.convert(o)._mult(C);p==="viewport"&&B._rotate(-x);const R=[];for(let j=0;j<h.length;j++)R.push(h[j].sub(B));return R}let ob,ab;Wt("CircleBucket",D_,{omit:["layers"]});var m6={get paint(){return ab=ab||new br({"circle-radius":new Jt(ut.paint_circle["circle-radius"]),"circle-color":new Jt(ut.paint_circle["circle-color"]),"circle-blur":new Jt(ut.paint_circle["circle-blur"]),"circle-opacity":new Jt(ut.paint_circle["circle-opacity"]),"circle-translate":new gt(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new gt(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gt(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gt(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Jt(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Jt(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Jt(ut.paint_circle["circle-stroke-opacity"])})},get layout(){return ob=ob||new br({"circle-sort-key":new Jt(ut.layout_circle["circle-sort-key"])})}},Qs=1e-6,gh=typeof Float32Array<"u"?Float32Array:Array;function O_(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function Ab(h,o,p){var x=o[0],C=o[1],B=o[2],R=o[3],j=o[4],H=o[5],q=o[6],J=o[7],ne=o[8],he=o[9],me=o[10],ye=o[11],Me=o[12],Ue=o[13],He=o[14],Ke=o[15],Ze=p[0],et=p[1],st=p[2],dt=p[3];return h[0]=Ze*x+et*j+st*ne+dt*Me,h[1]=Ze*C+et*H+st*he+dt*Ue,h[2]=Ze*B+et*q+st*me+dt*He,h[3]=Ze*R+et*J+st*ye+dt*Ke,h[4]=(Ze=p[4])*x+(et=p[5])*j+(st=p[6])*ne+(dt=p[7])*Me,h[5]=Ze*C+et*H+st*he+dt*Ue,h[6]=Ze*B+et*q+st*me+dt*He,h[7]=Ze*R+et*J+st*ye+dt*Ke,h[8]=(Ze=p[8])*x+(et=p[9])*j+(st=p[10])*ne+(dt=p[11])*Me,h[9]=Ze*C+et*H+st*he+dt*Ue,h[10]=Ze*B+et*q+st*me+dt*He,h[11]=Ze*R+et*J+st*ye+dt*Ke,h[12]=(Ze=p[12])*x+(et=p[13])*j+(st=p[14])*ne+(dt=p[15])*Me,h[13]=Ze*C+et*H+st*he+dt*Ue,h[14]=Ze*B+et*q+st*me+dt*He,h[15]=Ze*R+et*J+st*ye+dt*Ke,h}Math.hypot||(Math.hypot=function(){for(var h=0,o=arguments.length;o--;)h+=arguments[o]*arguments[o];return Math.sqrt(h)});var Q0,_6=Ab;function up(h,o,p){var x=o[0],C=o[1],B=o[2],R=o[3];return h[0]=p[0]*x+p[4]*C+p[8]*B+p[12]*R,h[1]=p[1]*x+p[5]*C+p[9]*B+p[13]*R,h[2]=p[2]*x+p[6]*C+p[10]*B+p[14]*R,h[3]=p[3]*x+p[7]*C+p[11]*B+p[15]*R,h}Q0=new gh(4),gh!=Float32Array&&(Q0[0]=0,Q0[1]=0,Q0[2]=0,Q0[3]=0);class y6 extends xt{constructor(o){super(o,m6)}createBucket(o){return new D_(o)}queryRadius(o){const p=o;return G0("circle-radius",this,p)+G0("circle-stroke-width",this,p)+Ap(this.paint.get("circle-translate"))}queryIntersectsFeature(o,p,x,C,B,R,j,H){const q=lp(o,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),R.angle,j),J=this.paint.get("circle-radius").evaluate(p,x)+this.paint.get("circle-stroke-width").evaluate(p,x),ne=this.paint.get("circle-pitch-alignment")==="map",he=ne?q:function(ye,Me){return ye.map(Ue=>lb(Ue,Me))}(q,H),me=ne?J*j:J;for(const ye of C)for(const Me of ye){const Ue=ne?Me:lb(Me,H);let He=me;const Ke=up([],[Me.x,Me.y,0,1],H);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?He*=Ke[3]/R.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(He*=R.cameraToCenterDistance/Ke[3]),f6(he,Ue,He))return!0}return!1}}function lb(h,o){const p=up([],[h.x,h.y,0,1],o);return new V(p[0]/p[3],p[1]/p[3])}class ub extends D_{}let cb;Wt("HeatmapBucket",ub,{omit:["layers"]});var v6={get paint(){return cb=cb||new br({"heatmap-radius":new Jt(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Jt(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gt(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new MA(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gt(ut.paint_heatmap["heatmap-opacity"])})}};function z_(h,{width:o,height:p},x,C){if(C){if(C instanceof Uint8ClampedArray)C=new Uint8Array(C.buffer);else if(C.length!==o*p*x)throw new RangeError(`mismatched image size. expected: ${C.length} but got: ${o*p*x}`)}else C=new Uint8Array(o*p*x);return h.width=o,h.height=p,h.data=C,h}function hb(h,{width:o,height:p},x){if(o===h.width&&p===h.height)return;const C=z_({},{width:o,height:p},x);F_(h,C,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,o),height:Math.min(h.height,p)},x),h.width=o,h.height=p,h.data=C.data}function F_(h,o,p,x,C,B){if(C.width===0||C.height===0)return o;if(C.width>h.width||C.height>h.height||p.x>h.width-C.width||p.y>h.height-C.height)throw new RangeError("out of range source coordinates for image copy");if(C.width>o.width||C.height>o.height||x.x>o.width-C.width||x.y>o.height-C.height)throw new RangeError("out of range destination coordinates for image copy");const R=h.data,j=o.data;if(R===j)throw new Error("srcData equals dstData, so image is already copied");for(let H=0;H<C.height;H++){const q=((p.y+H)*h.width+p.x)*B,J=((x.y+H)*o.width+x.x)*B;for(let ne=0;ne<C.width*B;ne++)j[J+ne]=R[q+ne]}return o}class H0{constructor(o,p){z_(this,o,1,p)}resize(o){hb(this,o,1)}clone(){return new H0({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,p,x,C,B){F_(o,p,x,C,B,1)}}class _a{constructor(o,p){z_(this,o,4,p)}resize(o){hb(this,o,4)}replace(o,p){p?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new _a({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,p,x,C,B){F_(o,p,x,C,B,4)}}function fb(h){const o={},p=h.resolution||256,x=h.clips?h.clips.length:1,C=h.image||new _a({width:p,height:x});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const B=(R,j,H)=>{o[h.evaluationKey]=H;const q=h.expression.evaluate(o);C.data[R+j+0]=Math.floor(255*q.r/q.a),C.data[R+j+1]=Math.floor(255*q.g/q.a),C.data[R+j+2]=Math.floor(255*q.b/q.a),C.data[R+j+3]=Math.floor(255*q.a)};if(h.clips)for(let R=0,j=0;R<x;++R,j+=4*p)for(let H=0,q=0;H<p;H++,q+=4){const J=H/(p-1),{start:ne,end:he}=h.clips[R];B(j,q,ne*(1-J)+he*J)}else for(let R=0,j=0;R<p;R++,j+=4)B(0,j,R/(p-1));return C}Wt("AlphaImage",H0),Wt("RGBAImage",_a);class x6 extends xt{createBucket(o){return new ub(o)}constructor(o){super(o,v6),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){o==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=fb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let db;var w6={get paint(){return db=db||new br({"hillshade-illumination-direction":new gt(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gt(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gt(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gt(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gt(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gt(ut.paint_hillshade["hillshade-accent-color"])})}};class b6 extends xt{constructor(o){super(o,w6)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const E6=pi([{name:"a_pos",components:2,type:"Int16"}],4),{members:T6}=E6;var N_={exports:{}};function cp(h,o,p){p=p||2;var x,C,B,R,j,H,q,J=o&&o.length,ne=J?o[0]*p:h.length,he=pb(h,0,ne,p,!0),me=[];if(!he||he.next===he.prev)return me;if(J&&(he=function(Me,Ue,He,Ke){var Ze,et,st,dt=[];for(Ze=0,et=Ue.length;Ze<et;Ze++)(st=pb(Me,Ue[Ze]*Ke,Ze<et-1?Ue[Ze+1]*Ke:Me.length,Ke,!1))===st.next&&(st.steiner=!0),dt.push(D6(st));for(dt.sort(I6),Ze=0;Ze<dt.length;Ze++)He=k6(dt[Ze],He);return He}(h,o,he,p)),h.length>80*p){x=B=h[0],C=R=h[1];for(var ye=p;ye<ne;ye+=p)(j=h[ye])<x&&(x=j),(H=h[ye+1])<C&&(C=H),j>B&&(B=j),H>R&&(R=H);q=(q=Math.max(B-x,R-C))!==0?32767/q:0}return W0(he,me,p,x,C,q,0),me}function pb(h,o,p,x,C){var B,R;if(C===j_(h,o,p,x)>0)for(B=o;B<p;B+=x)R=_b(B,h[B],h[B+1],R);else for(B=p-x;B>=o;B-=x)R=_b(B,h[B],h[B+1],R);return R&&hp(R,R.next)&&(Z0(R),R=R.next),R}function Tc(h,o){if(!h)return h;o||(o=h);var p,x=h;do if(p=!1,x.steiner||!hp(x,x.next)&&ir(x.prev,x,x.next)!==0)x=x.next;else{if(Z0(x),(x=o=x.prev)===x.next)break;p=!0}while(p||x!==o);return o}function W0(h,o,p,x,C,B,R){if(h){!R&&B&&function(J,ne,he,me){var ye=J;do ye.z===0&&(ye.z=U_(ye.x,ye.y,ne,he,me)),ye.prevZ=ye.prev,ye.nextZ=ye.next,ye=ye.next;while(ye!==J);ye.prevZ.nextZ=null,ye.prevZ=null,function(Me){var Ue,He,Ke,Ze,et,st,dt,Gt,tn=1;do{for(He=Me,Me=null,et=null,st=0;He;){for(st++,Ke=He,dt=0,Ue=0;Ue<tn&&(dt++,Ke=Ke.nextZ);Ue++);for(Gt=tn;dt>0||Gt>0&&Ke;)dt!==0&&(Gt===0||!Ke||He.z<=Ke.z)?(Ze=He,He=He.nextZ,dt--):(Ze=Ke,Ke=Ke.nextZ,Gt--),et?et.nextZ=Ze:Me=Ze,Ze.prevZ=et,et=Ze;He=Ke}et.nextZ=null,tn*=2}while(st>1)}(ye)}(h,x,C,B);for(var j,H,q=h;h.prev!==h.next;)if(j=h.prev,H=h.next,B?C6(h,x,C,B):S6(h))o.push(j.i/p|0),o.push(h.i/p|0),o.push(H.i/p|0),Z0(h),h=H.next,q=H.next;else if((h=H)===q){R?R===1?W0(h=P6(Tc(h),o,p),o,p,x,C,B,2):R===2&&M6(h,o,p,x,C,B):W0(Tc(h),o,p,x,C,B,1);break}}}function S6(h){var o=h.prev,p=h,x=h.next;if(ir(o,p,x)>=0)return!1;for(var C=o.x,B=p.x,R=x.x,j=o.y,H=p.y,q=x.y,J=C<B?C<R?C:R:B<R?B:R,ne=j<H?j<q?j:q:H<q?H:q,he=C>B?C>R?C:R:B>R?B:R,me=j>H?j>q?j:q:H>q?H:q,ye=x.next;ye!==o;){if(ye.x>=J&&ye.x<=he&&ye.y>=ne&&ye.y<=me&&mh(C,j,B,H,R,q,ye.x,ye.y)&&ir(ye.prev,ye,ye.next)>=0)return!1;ye=ye.next}return!0}function C6(h,o,p,x){var C=h.prev,B=h,R=h.next;if(ir(C,B,R)>=0)return!1;for(var j=C.x,H=B.x,q=R.x,J=C.y,ne=B.y,he=R.y,me=j<H?j<q?j:q:H<q?H:q,ye=J<ne?J<he?J:he:ne<he?ne:he,Me=j>H?j>q?j:q:H>q?H:q,Ue=J>ne?J>he?J:he:ne>he?ne:he,He=U_(me,ye,o,p,x),Ke=U_(Me,Ue,o,p,x),Ze=h.prevZ,et=h.nextZ;Ze&&Ze.z>=He&&et&&et.z<=Ke;){if(Ze.x>=me&&Ze.x<=Me&&Ze.y>=ye&&Ze.y<=Ue&&Ze!==C&&Ze!==R&&mh(j,J,H,ne,q,he,Ze.x,Ze.y)&&ir(Ze.prev,Ze,Ze.next)>=0||(Ze=Ze.prevZ,et.x>=me&&et.x<=Me&&et.y>=ye&&et.y<=Ue&&et!==C&&et!==R&&mh(j,J,H,ne,q,he,et.x,et.y)&&ir(et.prev,et,et.next)>=0))return!1;et=et.nextZ}for(;Ze&&Ze.z>=He;){if(Ze.x>=me&&Ze.x<=Me&&Ze.y>=ye&&Ze.y<=Ue&&Ze!==C&&Ze!==R&&mh(j,J,H,ne,q,he,Ze.x,Ze.y)&&ir(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.prevZ}for(;et&&et.z<=Ke;){if(et.x>=me&&et.x<=Me&&et.y>=ye&&et.y<=Ue&&et!==C&&et!==R&&mh(j,J,H,ne,q,he,et.x,et.y)&&ir(et.prev,et,et.next)>=0)return!1;et=et.nextZ}return!0}function P6(h,o,p){var x=h;do{var C=x.prev,B=x.next.next;!hp(C,B)&&gb(C,x,x.next,B)&&$0(C,B)&&$0(B,C)&&(o.push(C.i/p|0),o.push(x.i/p|0),o.push(B.i/p|0),Z0(x),Z0(x.next),x=h=B),x=x.next}while(x!==h);return Tc(x)}function M6(h,o,p,x,C,B){var R=h;do{for(var j=R.next.next;j!==R.prev;){if(R.i!==j.i&&B6(R,j)){var H=mb(R,j);return R=Tc(R,R.next),H=Tc(H,H.next),W0(R,o,p,x,C,B,0),void W0(H,o,p,x,C,B,0)}j=j.next}R=R.next}while(R!==h)}function I6(h,o){return h.x-o.x}function k6(h,o){var p=function(C,B){var R,j=B,H=C.x,q=C.y,J=-1/0;do{if(q<=j.y&&q>=j.next.y&&j.next.y!==j.y){var ne=j.x+(q-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(ne<=H&&ne>J&&(J=ne,R=j.x<j.next.x?j:j.next,ne===H))return R}j=j.next}while(j!==B);if(!R)return null;var he,me=R,ye=R.x,Me=R.y,Ue=1/0;j=R;do H>=j.x&&j.x>=ye&&H!==j.x&&mh(q<Me?H:J,q,ye,Me,q<Me?J:H,q,j.x,j.y)&&(he=Math.abs(q-j.y)/(H-j.x),$0(j,C)&&(he<Ue||he===Ue&&(j.x>R.x||j.x===R.x&&L6(R,j)))&&(R=j,Ue=he)),j=j.next;while(j!==me);return R}(h,o);if(!p)return o;var x=mb(p,h);return Tc(x,x.next),Tc(p,p.next)}function L6(h,o){return ir(h.prev,h,o.prev)<0&&ir(o.next,h,h.next)<0}function U_(h,o,p,x,C){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-p)*C|0)|h<<8))|h<<4))|h<<2))|h<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-x)*C|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function D6(h){var o=h,p=h;do(o.x<p.x||o.x===p.x&&o.y<p.y)&&(p=o),o=o.next;while(o!==h);return p}function mh(h,o,p,x,C,B,R,j){return(C-R)*(o-j)>=(h-R)*(B-j)&&(h-R)*(x-j)>=(p-R)*(o-j)&&(p-R)*(B-j)>=(C-R)*(x-j)}function B6(h,o){return h.next.i!==o.i&&h.prev.i!==o.i&&!function(p,x){var C=p;do{if(C.i!==p.i&&C.next.i!==p.i&&C.i!==x.i&&C.next.i!==x.i&&gb(C,C.next,p,x))return!0;C=C.next}while(C!==p);return!1}(h,o)&&($0(h,o)&&$0(o,h)&&function(p,x){var C=p,B=!1,R=(p.x+x.x)/2,j=(p.y+x.y)/2;do C.y>j!=C.next.y>j&&C.next.y!==C.y&&R<(C.next.x-C.x)*(j-C.y)/(C.next.y-C.y)+C.x&&(B=!B),C=C.next;while(C!==p);return B}(h,o)&&(ir(h.prev,h,o.prev)||ir(h,o.prev,o))||hp(h,o)&&ir(h.prev,h,h.next)>0&&ir(o.prev,o,o.next)>0)}function ir(h,o,p){return(o.y-h.y)*(p.x-o.x)-(o.x-h.x)*(p.y-o.y)}function hp(h,o){return h.x===o.x&&h.y===o.y}function gb(h,o,p,x){var C=dp(ir(h,o,p)),B=dp(ir(h,o,x)),R=dp(ir(p,x,h)),j=dp(ir(p,x,o));return C!==B&&R!==j||!(C!==0||!fp(h,p,o))||!(B!==0||!fp(h,x,o))||!(R!==0||!fp(p,h,x))||!(j!==0||!fp(p,o,x))}function fp(h,o,p){return o.x<=Math.max(h.x,p.x)&&o.x>=Math.min(h.x,p.x)&&o.y<=Math.max(h.y,p.y)&&o.y>=Math.min(h.y,p.y)}function dp(h){return h>0?1:h<0?-1:0}function $0(h,o){return ir(h.prev,h,h.next)<0?ir(h,o,h.next)>=0&&ir(h,h.prev,o)>=0:ir(h,o,h.prev)<0||ir(h,h.next,o)<0}function mb(h,o){var p=new V_(h.i,h.x,h.y),x=new V_(o.i,o.x,o.y),C=h.next,B=o.prev;return h.next=o,o.prev=h,p.next=C,C.prev=p,x.next=p,p.prev=x,B.next=x,x.prev=B,x}function _b(h,o,p,x){var C=new V_(h,o,p);return x?(C.next=x.next,C.prev=x,x.next.prev=C,x.next=C):(C.prev=C,C.next=C),C}function Z0(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function V_(h,o,p){this.i=h,this.x=o,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function j_(h,o,p,x){for(var C=0,B=o,R=p-x;B<p;B+=x)C+=(h[R]-h[B])*(h[B+1]+h[R+1]),R=B;return C}N_.exports=cp,N_.exports.default=cp,cp.deviation=function(h,o,p,x){var C=o&&o.length,B=Math.abs(j_(h,0,C?o[0]*p:h.length,p));if(C)for(var R=0,j=o.length;R<j;R++)B-=Math.abs(j_(h,o[R]*p,R<j-1?o[R+1]*p:h.length,p));var H=0;for(R=0;R<x.length;R+=3){var q=x[R]*p,J=x[R+1]*p,ne=x[R+2]*p;H+=Math.abs((h[q]-h[ne])*(h[J+1]-h[q+1])-(h[q]-h[J])*(h[ne+1]-h[q+1]))}return B===0&&H===0?0:Math.abs((H-B)/B)},cp.flatten=function(h){for(var o=h[0][0].length,p={vertices:[],holes:[],dimensions:o},x=0,C=0;C<h.length;C++){for(var B=0;B<h[C].length;B++)for(var R=0;R<o;R++)p.vertices.push(h[C][B][R]);C>0&&p.holes.push(x+=h[C-1].length)}return p};var yb=S(N_.exports);function R6(h,o,p,x,C){vb(h,o,p||0,x||h.length-1,C||O6)}function vb(h,o,p,x,C){for(;x>p;){if(x-p>600){var B=x-p+1,R=o-p+1,j=Math.log(B),H=.5*Math.exp(2*j/3),q=.5*Math.sqrt(j*H*(B-H)/B)*(R-B/2<0?-1:1);vb(h,o,Math.max(p,Math.floor(o-R*H/B+q)),Math.min(x,Math.floor(o+(B-R)*H/B+q)),C)}var J=h[o],ne=p,he=x;for(q0(h,p,o),C(h[x],J)>0&&q0(h,p,x);ne<he;){for(q0(h,ne,he),ne++,he--;C(h[ne],J)<0;)ne++;for(;C(h[he],J)>0;)he--}C(h[p],J)===0?q0(h,p,he):q0(h,++he,x),he<=o&&(p=he+1),o<=he&&(x=he-1)}}function q0(h,o,p){var x=h[o];h[o]=h[p],h[p]=x}function O6(h,o){return h<o?-1:h>o?1:0}function G_(h,o){const p=h.length;if(p<=1)return[h];const x=[];let C,B;for(let R=0;R<p;R++){const j=Et(h[R]);j!==0&&(h[R].area=Math.abs(j),B===void 0&&(B=j<0),B===j<0?(C&&x.push(C),C=[h[R]]):C.push(h[R]))}if(C&&x.push(C),o>1)for(let R=0;R<x.length;R++)x[R].length<=o||(R6(x[R],o,1,x[R].length-1,z6),x[R]=x[R].slice(0,o));return x}function z6(h,o){return o.area-h.area}function Q_(h,o,p){const x=p.patternDependencies;let C=!1;for(const B of o){const R=B.paint.get(`${h}-pattern`);R.isConstant()||(C=!0);const j=R.constantOr(null);j&&(C=!0,x[j.to]=!0,x[j.from]=!0)}return C}function H_(h,o,p,x,C){const B=C.patternDependencies;for(const R of o){const j=R.paint.get(`${h}-pattern`).value;if(j.kind!=="constant"){let H=j.evaluate({zoom:x-1},p,{},C.availableImages),q=j.evaluate({zoom:x},p,{},C.availableImages),J=j.evaluate({zoom:x+1},p,{},C.availableImages);H=H&&H.name?H.name:H,q=q&&q.name?q.name:q,J=J&&J.name?J.name:J,B[H]=!0,B[q]=!0,B[J]=!0,p.patterns[R.id]={min:H,mid:q,max:J}}}return p}class W_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(p=>p.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new se,this.indexArray=new ct,this.indexArray2=new Ct,this.programConfigurations=new Hl(o.layers,o.zoom),this.segments=new wt,this.segments2=new wt,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(o,p,x){this.hasPattern=Q_("fill",this.layers,p);const C=this.layers[0].layout.get("fill-sort-key"),B=!C.isConstant(),R=[];for(const{feature:j,id:H,index:q,sourceLayerIndex:J}of o){const ne=this.layers[0]._featureFilter.needGeometry,he=ll(j,ne);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),he,x))continue;const me=B?C.evaluate(he,{},x,p.availableImages):void 0,ye={id:H,properties:j.properties,type:j.type,sourceLayerIndex:J,index:q,geometry:ne?he.geometry:LA(j),patterns:{},sortKey:me};R.push(ye)}B&&R.sort((j,H)=>j.sortKey-H.sortKey);for(const j of R){const{geometry:H,index:q,sourceLayerIndex:J}=j;if(this.hasPattern){const ne=H_("fill",this.layers,j,this.zoom,p);this.patternFeatures.push(ne)}else this.addFeature(j,H,q,x,{});p.featureIndex.insert(o[q].feature,H,q,J,this.index)}}update(o,p,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,p,this.stateDependentLayers,x)}addFeatures(o,p,x){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,p,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,T6),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,p,x,C,B){for(const R of G_(p,500)){let j=0;for(const me of R)j+=me.length;const H=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),q=H.vertexLength,J=[],ne=[];for(const me of R){if(me.length===0)continue;me!==R[0]&&ne.push(J.length/2);const ye=this.segments2.prepareSegment(me.length,this.layoutVertexArray,this.indexArray2),Me=ye.vertexLength;this.layoutVertexArray.emplaceBack(me[0].x,me[0].y),this.indexArray2.emplaceBack(Me+me.length-1,Me),J.push(me[0].x),J.push(me[0].y);for(let Ue=1;Ue<me.length;Ue++)this.layoutVertexArray.emplaceBack(me[Ue].x,me[Ue].y),this.indexArray2.emplaceBack(Me+Ue-1,Me+Ue),J.push(me[Ue].x),J.push(me[Ue].y);ye.vertexLength+=me.length,ye.primitiveLength+=me.length}const he=yb(J,ne);for(let me=0;me<he.length;me+=3)this.indexArray.emplaceBack(q+he[me],q+he[me+1],q+he[me+2]);H.vertexLength+=j,H.primitiveLength+=he.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,x,B,C)}}let xb,wb;Wt("FillBucket",W_,{omit:["layers","patternFeatures"]});var F6={get paint(){return wb=wb||new br({"fill-antialias":new gt(ut.paint_fill["fill-antialias"]),"fill-opacity":new Jt(ut.paint_fill["fill-opacity"]),"fill-color":new Jt(ut.paint_fill["fill-color"]),"fill-outline-color":new Jt(ut.paint_fill["fill-outline-color"]),"fill-translate":new gt(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new gt(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new ol(ut.paint_fill["fill-pattern"])})},get layout(){return xb=xb||new br({"fill-sort-key":new Jt(ut.layout_fill["fill-sort-key"])})}};class N6 extends xt{constructor(o){super(o,F6)}recalculate(o,p){super.recalculate(o,p);const x=this.paint._values["fill-outline-color"];x.value.kind==="constant"&&x.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new W_(o)}queryRadius(){return Ap(this.paint.get("fill-translate"))}queryIntersectsFeature(o,p,x,C,B,R,j){return ib(lp(o,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),R.angle,j),C)}isTileClipped(){return!0}}const U6=pi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),V6=pi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:j6}=U6;var Du={},G6=k,bb=_h;function _h(h,o,p,x,C){this.properties={},this.extent=p,this.type=0,this._pbf=h,this._geometry=-1,this._keys=x,this._values=C,h.readFields(Q6,this,o)}function Q6(h,o,p){h==1?o.id=p.readVarint():h==2?function(x,C){for(var B=x.readVarint()+x.pos;x.pos<B;){var R=C._keys[x.readVarint()],j=C._values[x.readVarint()];C.properties[R]=j}}(p,o):h==3?o.type=p.readVarint():h==4&&(o._geometry=p.pos)}function H6(h){for(var o,p,x=0,C=0,B=h.length,R=B-1;C<B;R=C++)x+=((p=h[R]).x-(o=h[C]).x)*(o.y+p.y);return x}_h.types=["Unknown","Point","LineString","Polygon"],_h.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var o,p=h.readVarint()+h.pos,x=1,C=0,B=0,R=0,j=[];h.pos<p;){if(C<=0){var H=h.readVarint();x=7&H,C=H>>3}if(C--,x===1||x===2)B+=h.readSVarint(),R+=h.readSVarint(),x===1&&(o&&j.push(o),o=[]),o.push(new G6(B,R));else{if(x!==7)throw new Error("unknown command "+x);o&&o.push(o[0].clone())}}return o&&j.push(o),j},_h.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var o=h.readVarint()+h.pos,p=1,x=0,C=0,B=0,R=1/0,j=-1/0,H=1/0,q=-1/0;h.pos<o;){if(x<=0){var J=h.readVarint();p=7&J,x=J>>3}if(x--,p===1||p===2)(C+=h.readSVarint())<R&&(R=C),C>j&&(j=C),(B+=h.readSVarint())<H&&(H=B),B>q&&(q=B);else if(p!==7)throw new Error("unknown command "+p)}return[R,H,j,q]},_h.prototype.toGeoJSON=function(h,o,p){var x,C,B=this.extent*Math.pow(2,p),R=this.extent*h,j=this.extent*o,H=this.loadGeometry(),q=_h.types[this.type];function J(me){for(var ye=0;ye<me.length;ye++){var Me=me[ye];me[ye]=[360*(Me.x+R)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(Me.y+j)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var ne=[];for(x=0;x<H.length;x++)ne[x]=H[x][0];J(H=ne);break;case 2:for(x=0;x<H.length;x++)J(H[x]);break;case 3:for(H=function(me){var ye=me.length;if(ye<=1)return[me];for(var Me,Ue,He=[],Ke=0;Ke<ye;Ke++){var Ze=H6(me[Ke]);Ze!==0&&(Ue===void 0&&(Ue=Ze<0),Ue===Ze<0?(Me&&He.push(Me),Me=[me[Ke]]):Me.push(me[Ke]))}return Me&&He.push(Me),He}(H),x=0;x<H.length;x++)for(C=0;C<H[x].length;C++)J(H[x][C])}H.length===1?H=H[0]:q="Multi"+q;var he={type:"Feature",geometry:{type:q,coordinates:H},properties:this.properties};return"id"in this&&(he.id=this.id),he};var W6=bb,Eb=Tb;function Tb(h,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields($6,this,o),this.length=this._features.length}function $6(h,o,p){h===15?o.version=p.readVarint():h===1?o.name=p.readString():h===5?o.extent=p.readVarint():h===2?o._features.push(p.pos):h===3?o._keys.push(p.readString()):h===4&&o._values.push(function(x){for(var C=null,B=x.readVarint()+x.pos;x.pos<B;){var R=x.readVarint()>>3;C=R===1?x.readString():R===2?x.readFloat():R===3?x.readDouble():R===4?x.readVarint64():R===5?x.readVarint():R===6?x.readSVarint():R===7?x.readBoolean():null}return C}(p))}Tb.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var o=this._pbf.readVarint()+this._pbf.pos;return new W6(this._pbf,o,this.extent,this._keys,this._values)};var Z6=Eb;function q6(h,o,p){if(h===3){var x=new Z6(p,p.readVarint()+p.pos);x.length&&(o[x.name]=x)}}Du.VectorTile=function(h,o){this.layers=h.readFields(q6,{},o)},Du.VectorTileFeature=bb,Du.VectorTileLayer=Eb;const Y6=Du.VectorTileFeature.types,$_=Math.pow(2,13);function Y0(h,o,p,x,C,B,R,j){h.emplaceBack(o,p,2*Math.floor(x*$_)+R,C*$_*2,B*$_*2,Math.round(j))}class Z_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(p=>p.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new xe,this.centroidVertexArray=new de,this.indexArray=new ct,this.programConfigurations=new Hl(o.layers,o.zoom),this.segments=new wt,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(o,p,x){this.features=[],this.hasPattern=Q_("fill-extrusion",this.layers,p);for(const{feature:C,id:B,index:R,sourceLayerIndex:j}of o){const H=this.layers[0]._featureFilter.needGeometry,q=ll(C,H);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),q,x))continue;const J={id:B,sourceLayerIndex:j,index:R,geometry:H?q.geometry:LA(C),properties:C.properties,type:C.type,patterns:{}};this.hasPattern?this.features.push(H_("fill-extrusion",this.layers,J,this.zoom,p)):this.addFeature(J,J.geometry,R,x,{}),p.featureIndex.insert(C,J.geometry,R,j,this.index,!0)}}addFeatures(o,p,x){for(const C of this.features){const{geometry:B}=C;this.addFeature(C,B,C.index,p,x)}}update(o,p,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,p,this.stateDependentLayers,x)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,j6),this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,V6.members,!0),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(o,p,x,C,B){const R={x:0,y:0,vertexCount:0};for(const j of G_(p,500)){let H=0;for(const ye of j)H+=ye.length;let q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ye of j){if(ye.length===0||K6(ye))continue;let Me=0;for(let Ue=0;Ue<ye.length;Ue++){const He=ye[Ue];if(Ue>=1){const Ke=ye[Ue-1];if(!X6(He,Ke)){q.vertexLength+4>wt.MAX_VERTEX_ARRAY_LENGTH&&(q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ze=He.sub(Ke)._perp()._unit(),et=Ke.dist(He);Me+et>32768&&(Me=0),Y0(this.layoutVertexArray,He.x,He.y,Ze.x,Ze.y,0,0,Me),Y0(this.layoutVertexArray,He.x,He.y,Ze.x,Ze.y,0,1,Me),R.x+=2*He.x,R.y+=2*He.y,R.vertexCount+=2,Me+=et,Y0(this.layoutVertexArray,Ke.x,Ke.y,Ze.x,Ze.y,0,0,Me),Y0(this.layoutVertexArray,Ke.x,Ke.y,Ze.x,Ze.y,0,1,Me),R.x+=2*Ke.x,R.y+=2*Ke.y,R.vertexCount+=2;const st=q.vertexLength;this.indexArray.emplaceBack(st,st+2,st+1),this.indexArray.emplaceBack(st+1,st+2,st+3),q.vertexLength+=4,q.primitiveLength+=2}}}}if(q.vertexLength+H>wt.MAX_VERTEX_ARRAY_LENGTH&&(q=this.segments.prepareSegment(H,this.layoutVertexArray,this.indexArray)),Y6[o.type]!=="Polygon")continue;const J=[],ne=[],he=q.vertexLength;for(const ye of j)if(ye.length!==0){ye!==j[0]&&ne.push(J.length/2);for(let Me=0;Me<ye.length;Me++){const Ue=ye[Me];Y0(this.layoutVertexArray,Ue.x,Ue.y,0,0,1,1,0),R.x+=Ue.x,R.y+=Ue.y,R.vertexCount+=1,J.push(Ue.x),J.push(Ue.y)}}const me=yb(J,ne);for(let ye=0;ye<me.length;ye+=3)this.indexArray.emplaceBack(he+me[ye],he+me[ye+2],he+me[ye+1]);q.primitiveLength+=me.length/3,q.vertexLength+=H}for(let j=0;j<R.vertexCount;j++)this.centroidVertexArray.emplaceBack(Math.floor(R.x/R.vertexCount),Math.floor(R.y/R.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,x,B,C)}}function X6(h,o){return h.x===o.x&&(h.x<0||h.x>Fi)||h.y===o.y&&(h.y<0||h.y>Fi)}function K6(h){return h.every(o=>o.x<0)||h.every(o=>o.x>Fi)||h.every(o=>o.y<0)||h.every(o=>o.y>Fi)}let Sb;Wt("FillExtrusionBucket",Z_,{omit:["layers","features"]});var J6={get paint(){return Sb=Sb||new br({"fill-extrusion-opacity":new gt(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Jt(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gt(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gt(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ol(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Jt(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Jt(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class e8 extends xt{constructor(o){super(o,J6)}createBucket(o){return new Z_(o)}queryRadius(){return Ap(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(o,p,x,C,B,R,j,H){const q=lp(o,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),R.angle,j),J=this.paint.get("fill-extrusion-height").evaluate(p,x),ne=this.paint.get("fill-extrusion-base").evaluate(p,x),he=function(ye,Me,Ue,He){const Ke=[];for(const Ze of ye){const et=[Ze.x,Ze.y,0,1];up(et,et,Me),Ke.push(new V(et[0]/et[3],et[1]/et[3]))}return Ke}(q,H),me=function(ye,Me,Ue,He){const Ke=[],Ze=[],et=He[8]*Me,st=He[9]*Me,dt=He[10]*Me,Gt=He[11]*Me,tn=He[8]*Ue,jt=He[9]*Ue,Ft=He[10]*Ue,Dt=He[11]*Ue;for(const Xt of ye){const Ot=[],bt=[];for(const hn of Xt){const sn=hn.x,zn=hn.y,vi=He[0]*sn+He[4]*zn+He[12],Mi=He[1]*sn+He[5]*zn+He[13],Pr=He[2]*sn+He[6]*zn+He[14],Bo=He[3]*sn+He[7]*zn+He[15],Hs=Pr+dt,gr=Bo+Gt,Gr=vi+tn,vs=Mi+jt,fo=Pr+Ft,Ws=Bo+Dt,mr=new V((vi+et)/gr,(Mi+st)/gr);mr.z=Hs/gr,Ot.push(mr);const Mr=new V(Gr/Ws,vs/Ws);Mr.z=fo/Ws,bt.push(Mr)}Ke.push(Ot),Ze.push(bt)}return[Ke,Ze]}(C,ne,J,H);return function(ye,Me,Ue){let He=1/0;ib(Ue,Me)&&(He=Cb(Ue,Me[0]));for(let Ke=0;Ke<Me.length;Ke++){const Ze=Me[Ke],et=ye[Ke];for(let st=0;st<Ze.length-1;st++){const dt=Ze[st],Gt=[dt,Ze[st+1],et[st+1],et[st],dt];nb(Ue,Gt)&&(He=Math.min(He,Cb(Ue,Gt)))}}return He!==1/0&&He}(me[0],me[1],he)}}function X0(h,o){return h.x*o.x+h.y*o.y}function Cb(h,o){if(h.length===1){let p=0;const x=o[p++];let C;for(;!C||x.equals(C);)if(C=o[p++],!C)return 1/0;for(;p<o.length;p++){const B=o[p],R=h[0],j=C.sub(x),H=B.sub(x),q=R.sub(x),J=X0(j,j),ne=X0(j,H),he=X0(H,H),me=X0(q,j),ye=X0(q,H),Me=J*he-ne*ne,Ue=(he*me-ne*ye)/Me,He=(J*ye-ne*me)/Me,Ke=x.z*(1-Ue-He)+C.z*Ue+B.z*He;if(isFinite(Ke))return Ke}return 1/0}{let p=1/0;for(const x of o)p=Math.min(p,x.z);return p}}const t8=pi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:n8}=t8,i8=pi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:r8}=i8,s8=Du.VectorTileFeature.types,o8=Math.cos(Math.PI/180*37.5),Pb=Math.pow(2,14)/.5;class q_{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(p=>p.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new Ie,this.layoutVertexArray2=new Fe,this.indexArray=new ct,this.programConfigurations=new Hl(o.layers,o.zoom),this.segments=new wt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(o,p,x){this.hasPattern=Q_("line",this.layers,p);const C=this.layers[0].layout.get("line-sort-key"),B=!C.isConstant(),R=[];for(const{feature:j,id:H,index:q,sourceLayerIndex:J}of o){const ne=this.layers[0]._featureFilter.needGeometry,he=ll(j,ne);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),he,x))continue;const me=B?C.evaluate(he,{},x):void 0,ye={id:H,properties:j.properties,type:j.type,sourceLayerIndex:J,index:q,geometry:ne?he.geometry:LA(j),patterns:{},sortKey:me};R.push(ye)}B&&R.sort((j,H)=>j.sortKey-H.sortKey);for(const j of R){const{geometry:H,index:q,sourceLayerIndex:J}=j;if(this.hasPattern){const ne=H_("line",this.layers,j,this.zoom,p);this.patternFeatures.push(ne)}else this.addFeature(j,H,q,x,{});p.featureIndex.insert(o[q].feature,H,q,J,this.index)}}update(o,p,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,p,this.stateDependentLayers,x)}addFeatures(o,p,x){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,p,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,r8)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,n8),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,p,x,C,B){const R=this.layers[0].layout,j=R.get("line-join").evaluate(o,{}),H=R.get("line-cap"),q=R.get("line-miter-limit"),J=R.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const ne of p)this.addLine(ne,o,j,H,q,J);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,x,B,C)}addLine(o,p,x,C,B,R){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let He=0;He<o.length-1;He++)this.totalDistance+=o[He].dist(o[He+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=s8[p.type]==="Polygon";let H=o.length;for(;H>=2&&o[H-1].equals(o[H-2]);)H--;let q=0;for(;q<H-1&&o[q].equals(o[q+1]);)q++;if(H<(j?3:2))return;x==="bevel"&&(B=1.05);const J=this.overscaling<=16?15*Fi/(512*this.overscaling):0,ne=this.segments.prepareSegment(10*H,this.layoutVertexArray,this.indexArray);let he,me,ye,Me,Ue;this.e1=this.e2=-1,j&&(he=o[H-2],Ue=o[q].sub(he)._unit()._perp());for(let He=q;He<H;He++){if(ye=He===H-1?j?o[q+1]:void 0:o[He+1],ye&&o[He].equals(ye))continue;Ue&&(Me=Ue),he&&(me=he),he=o[He],Ue=ye?ye.sub(he)._unit()._perp():Me,Me=Me||Ue;let Ke=Me.add(Ue);Ke.x===0&&Ke.y===0||Ke._unit();const Ze=Me.x*Ue.x+Me.y*Ue.y,et=Ke.x*Ue.x+Ke.y*Ue.y,st=et!==0?1/et:1/0,dt=2*Math.sqrt(2-2*et),Gt=et<o8&&me&&ye,tn=Me.x*Ue.y-Me.y*Ue.x>0;if(Gt&&He>q){const Dt=he.dist(me);if(Dt>2*J){const Xt=he.sub(he.sub(me)._mult(J/Dt)._round());this.updateDistance(me,Xt),this.addCurrentVertex(Xt,Me,0,0,ne),me=Xt}}const jt=me&&ye;let Ft=jt?x:j?"butt":C;if(jt&&Ft==="round"&&(st<R?Ft="miter":st<=2&&(Ft="fakeround")),Ft==="miter"&&st>B&&(Ft="bevel"),Ft==="bevel"&&(st>2&&(Ft="flipbevel"),st<B&&(Ft="miter")),me&&this.updateDistance(me,he),Ft==="miter")Ke._mult(st),this.addCurrentVertex(he,Ke,0,0,ne);else if(Ft==="flipbevel"){if(st>100)Ke=Ue.mult(-1);else{const Dt=st*Me.add(Ue).mag()/Me.sub(Ue).mag();Ke._perp()._mult(Dt*(tn?-1:1))}this.addCurrentVertex(he,Ke,0,0,ne),this.addCurrentVertex(he,Ke.mult(-1),0,0,ne)}else if(Ft==="bevel"||Ft==="fakeround"){const Dt=-Math.sqrt(st*st-1),Xt=tn?Dt:0,Ot=tn?0:Dt;if(me&&this.addCurrentVertex(he,Me,Xt,Ot,ne),Ft==="fakeround"){const bt=Math.round(180*dt/Math.PI/20);for(let hn=1;hn<bt;hn++){let sn=hn/bt;if(sn!==.5){const vi=sn-.5;sn+=sn*vi*(sn-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*vi*vi+(.848013+Ze*(.215638*Ze-1.06021)))}const zn=Ue.sub(Me)._mult(sn)._add(Me)._unit()._mult(tn?-1:1);this.addHalfVertex(he,zn.x,zn.y,!1,tn,0,ne)}}ye&&this.addCurrentVertex(he,Ue,-Xt,-Ot,ne)}else if(Ft==="butt")this.addCurrentVertex(he,Ke,0,0,ne);else if(Ft==="square"){const Dt=me?1:-1;this.addCurrentVertex(he,Ke,Dt,Dt,ne)}else Ft==="round"&&(me&&(this.addCurrentVertex(he,Me,0,0,ne),this.addCurrentVertex(he,Me,1,1,ne,!0)),ye&&(this.addCurrentVertex(he,Ue,-1,-1,ne,!0),this.addCurrentVertex(he,Ue,0,0,ne)));if(Gt&&He<H-1){const Dt=he.dist(ye);if(Dt>2*J){const Xt=he.add(ye.sub(he)._mult(J/Dt)._round());this.updateDistance(he,Xt),this.addCurrentVertex(Xt,Ue,0,0,ne),he=Xt}}}}addCurrentVertex(o,p,x,C,B,R=!1){const j=p.y*C-p.x,H=-p.y-p.x*C;this.addHalfVertex(o,p.x+p.y*x,p.y-p.x*x,R,!1,x,B),this.addHalfVertex(o,j,H,R,!0,-C,B),this.distance>Pb/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(o,p,x,C,B,R))}addHalfVertex({x:o,y:p},x,C,B,R,j,H){const q=.5*(this.lineClips?this.scaledDistance*(Pb-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(B?1:0),(p<<1)+(R?1:0),Math.round(63*x)+128,Math.round(63*C)+128,1+(j===0?0:j<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const J=H.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,J),H.primitiveLength++),R?this.e2=J:this.e1=J}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(o,p){this.distance+=o.dist(p),this.updateScaledDistance()}}let Mb,Ib;Wt("LineBucket",q_,{omit:["layers","patternFeatures"]});var kb={get paint(){return Ib=Ib||new br({"line-opacity":new Jt(ut.paint_line["line-opacity"]),"line-color":new Jt(ut.paint_line["line-color"]),"line-translate":new gt(ut.paint_line["line-translate"]),"line-translate-anchor":new gt(ut.paint_line["line-translate-anchor"]),"line-width":new Jt(ut.paint_line["line-width"]),"line-gap-width":new Jt(ut.paint_line["line-gap-width"]),"line-offset":new Jt(ut.paint_line["line-offset"]),"line-blur":new Jt(ut.paint_line["line-blur"]),"line-dasharray":new pa(ut.paint_line["line-dasharray"]),"line-pattern":new ol(ut.paint_line["line-pattern"]),"line-gradient":new MA(ut.paint_line["line-gradient"])})},get layout(){return Mb=Mb||new br({"line-cap":new gt(ut.layout_line["line-cap"]),"line-join":new Jt(ut.layout_line["line-join"]),"line-miter-limit":new gt(ut.layout_line["line-miter-limit"]),"line-round-limit":new gt(ut.layout_line["line-round-limit"]),"line-sort-key":new Jt(ut.layout_line["line-sort-key"])})}};class a8 extends Jt{possiblyEvaluate(o,p){return p=new ci(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),super.possiblyEvaluate(o,p)}evaluate(o,p,x,C){return p=ce({},p,{zoom:Math.floor(p.zoom)}),super.evaluate(o,p,x,C)}}let pp;class A8 extends xt{constructor(o){super(o,kb),this.gradientVersion=0,pp||(pp=new a8(kb.paint.properties["line-width"].specification),pp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(o){o==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ta,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(o,p){super.recalculate(o,p),this.paint._values["line-floorwidth"]=pp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new q_(o)}queryRadius(o){const p=o,x=Lb(G0("line-width",this,p),G0("line-gap-width",this,p)),C=G0("line-offset",this,p);return x/2+Math.abs(C)+Ap(this.paint.get("line-translate"))}queryIntersectsFeature(o,p,x,C,B,R,j){const H=lp(o,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),R.angle,j),q=j/2*Lb(this.paint.get("line-width").evaluate(p,x),this.paint.get("line-gap-width").evaluate(p,x)),J=this.paint.get("line-offset").evaluate(p,x);return J&&(C=function(ne,he){const me=[];for(let ye=0;ye<ne.length;ye++){const Me=ne[ye],Ue=[];for(let He=0;He<Me.length;He++){const Ke=Me[He-1],Ze=Me[He],et=Me[He+1],st=He===0?new V(0,0):Ze.sub(Ke)._unit()._perp(),dt=He===Me.length-1?new V(0,0):et.sub(Ze)._unit()._perp(),Gt=st._add(dt)._unit(),tn=Gt.x*dt.x+Gt.y*dt.y;tn!==0&&Gt._mult(1/tn),Ue.push(Gt._mult(he)._add(Ze))}me.push(Ue)}return me}(C,J*j)),function(ne,he,me){for(let ye=0;ye<he.length;ye++){const Me=he[ye];if(ne.length>=3){for(let Ue=0;Ue<Me.length;Ue++)if(ph(ne,Me[Ue]))return!0}if(d6(ne,Me,me))return!0}return!1}(H,C,q)}isTileClipped(){return!0}}function Lb(h,o){return o>0?o+2*h:h}const l8=pi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),u8=pi([{name:"a_projected_pos",components:3,type:"Float32"}],4);pi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const c8=pi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);pi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Db=pi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),h8=pi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function f8(h,o,p){return h.sections.forEach(x=>{x.text=function(C,B,R){const j=B.layout.get("text-transform").evaluate(R,{});return j==="uppercase"?C=C.toLocaleUpperCase():j==="lowercase"&&(C=C.toLocaleLowerCase()),Xr.applyArabicShaping&&(C=Xr.applyArabicShaping(C)),C}(x.text,o,p)}),h}pi([{name:"triangle",components:3,type:"Uint16"}]),pi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pi([{type:"Float32",name:"offsetX"}]),pi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const K0={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Cr=24,Bb=di,Rb=function(h,o,p,x,C){var B,R,j=8*C-x-1,H=(1<<j)-1,q=H>>1,J=-7,ne=p?C-1:0,he=p?-1:1,me=h[o+ne];for(ne+=he,B=me&(1<<-J)-1,me>>=-J,J+=j;J>0;B=256*B+h[o+ne],ne+=he,J-=8);for(R=B&(1<<-J)-1,B>>=-J,J+=x;J>0;R=256*R+h[o+ne],ne+=he,J-=8);if(B===0)B=1-q;else{if(B===H)return R?NaN:1/0*(me?-1:1);R+=Math.pow(2,x),B-=q}return(me?-1:1)*R*Math.pow(2,B-x)},Ob=function(h,o,p,x,C,B){var R,j,H,q=8*B-C-1,J=(1<<q)-1,ne=J>>1,he=C===23?Math.pow(2,-24)-Math.pow(2,-77):0,me=x?0:B-1,ye=x?1:-1,Me=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(j=isNaN(o)?1:0,R=J):(R=Math.floor(Math.log(o)/Math.LN2),o*(H=Math.pow(2,-R))<1&&(R--,H*=2),(o+=R+ne>=1?he/H:he*Math.pow(2,1-ne))*H>=2&&(R++,H/=2),R+ne>=J?(j=0,R=J):R+ne>=1?(j=(o*H-1)*Math.pow(2,C),R+=ne):(j=o*Math.pow(2,ne-1)*Math.pow(2,C),R=0));C>=8;h[p+me]=255&j,me+=ye,j/=256,C-=8);for(R=R<<C|j,q+=C;q>0;h[p+me]=255&R,me+=ye,R/=256,q-=8);h[p+me-ye]|=128*Me};function di(h){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(h)?h:new Uint8Array(h||0),this.pos=0,this.type=0,this.length=this.buf.length}di.Varint=0,di.Fixed64=1,di.Bytes=2,di.Fixed32=5;var Y_=4294967296,zb=1/Y_,Fb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $l(h){return h.type===di.Bytes?h.readVarint()+h.pos:h.pos+1}function yh(h,o,p){return p?4294967296*o+(h>>>0):4294967296*(o>>>0)+(h>>>0)}function Nb(h,o,p){var x=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));p.realloc(x);for(var C=p.pos-1;C>=h;C--)p.buf[C+x]=p.buf[C]}function d8(h,o){for(var p=0;p<h.length;p++)o.writeVarint(h[p])}function p8(h,o){for(var p=0;p<h.length;p++)o.writeSVarint(h[p])}function g8(h,o){for(var p=0;p<h.length;p++)o.writeFloat(h[p])}function m8(h,o){for(var p=0;p<h.length;p++)o.writeDouble(h[p])}function _8(h,o){for(var p=0;p<h.length;p++)o.writeBoolean(h[p])}function y8(h,o){for(var p=0;p<h.length;p++)o.writeFixed32(h[p])}function v8(h,o){for(var p=0;p<h.length;p++)o.writeSFixed32(h[p])}function x8(h,o){for(var p=0;p<h.length;p++)o.writeFixed64(h[p])}function w8(h,o){for(var p=0;p<h.length;p++)o.writeSFixed64(h[p])}function gp(h,o){return(h[o]|h[o+1]<<8|h[o+2]<<16)+16777216*h[o+3]}function vh(h,o,p){h[p]=o,h[p+1]=o>>>8,h[p+2]=o>>>16,h[p+3]=o>>>24}function Ub(h,o){return(h[o]|h[o+1]<<8|h[o+2]<<16)+(h[o+3]<<24)}di.prototype={destroy:function(){this.buf=null},readFields:function(h,o,p){for(p=p||this.length;this.pos<p;){var x=this.readVarint(),C=x>>3,B=this.pos;this.type=7&x,h(C,o,this),this.pos===B&&this.skip(x)}return o},readMessage:function(h,o){return this.readFields(h,o,this.readVarint()+this.pos)},readFixed32:function(){var h=gp(this.buf,this.pos);return this.pos+=4,h},readSFixed32:function(){var h=Ub(this.buf,this.pos);return this.pos+=4,h},readFixed64:function(){var h=gp(this.buf,this.pos)+gp(this.buf,this.pos+4)*Y_;return this.pos+=8,h},readSFixed64:function(){var h=gp(this.buf,this.pos)+Ub(this.buf,this.pos+4)*Y_;return this.pos+=8,h},readFloat:function(){var h=Rb(this.buf,this.pos,!0,23,4);return this.pos+=4,h},readDouble:function(){var h=Rb(this.buf,this.pos,!0,52,8);return this.pos+=8,h},readVarint:function(h){var o,p,x=this.buf;return o=127&(p=x[this.pos++]),p<128?o:(o|=(127&(p=x[this.pos++]))<<7,p<128?o:(o|=(127&(p=x[this.pos++]))<<14,p<128?o:(o|=(127&(p=x[this.pos++]))<<21,p<128?o:function(C,B,R){var j,H,q=R.buf;if(j=(112&(H=q[R.pos++]))>>4,H<128||(j|=(127&(H=q[R.pos++]))<<3,H<128)||(j|=(127&(H=q[R.pos++]))<<10,H<128)||(j|=(127&(H=q[R.pos++]))<<17,H<128)||(j|=(127&(H=q[R.pos++]))<<24,H<128)||(j|=(1&(H=q[R.pos++]))<<31,H<128))return yh(C,j,B);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(p=x[this.pos]))<<28,h,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var h=this.readVarint();return h%2==1?(h+1)/-2:h/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var h=this.readVarint()+this.pos,o=this.pos;return this.pos=h,h-o>=12&&Fb?function(p,x,C){return Fb.decode(p.subarray(x,C))}(this.buf,o,h):function(p,x,C){for(var B="",R=x;R<C;){var j,H,q,J=p[R],ne=null,he=J>239?4:J>223?3:J>191?2:1;if(R+he>C)break;he===1?J<128&&(ne=J):he===2?(192&(j=p[R+1]))==128&&(ne=(31&J)<<6|63&j)<=127&&(ne=null):he===3?(H=p[R+2],(192&(j=p[R+1]))==128&&(192&H)==128&&((ne=(15&J)<<12|(63&j)<<6|63&H)<=2047||ne>=55296&&ne<=57343)&&(ne=null)):he===4&&(H=p[R+2],q=p[R+3],(192&(j=p[R+1]))==128&&(192&H)==128&&(192&q)==128&&((ne=(15&J)<<18|(63&j)<<12|(63&H)<<6|63&q)<=65535||ne>=1114112)&&(ne=null)),ne===null?(ne=65533,he=1):ne>65535&&(ne-=65536,B+=String.fromCharCode(ne>>>10&1023|55296),ne=56320|1023&ne),B+=String.fromCharCode(ne),R+=he}return B}(this.buf,o,h)},readBytes:function(){var h=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,h);return this.pos=h,o},readPackedVarint:function(h,o){if(this.type!==di.Bytes)return h.push(this.readVarint(o));var p=$l(this);for(h=h||[];this.pos<p;)h.push(this.readVarint(o));return h},readPackedSVarint:function(h){if(this.type!==di.Bytes)return h.push(this.readSVarint());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readSVarint());return h},readPackedBoolean:function(h){if(this.type!==di.Bytes)return h.push(this.readBoolean());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readBoolean());return h},readPackedFloat:function(h){if(this.type!==di.Bytes)return h.push(this.readFloat());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readFloat());return h},readPackedDouble:function(h){if(this.type!==di.Bytes)return h.push(this.readDouble());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readDouble());return h},readPackedFixed32:function(h){if(this.type!==di.Bytes)return h.push(this.readFixed32());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readFixed32());return h},readPackedSFixed32:function(h){if(this.type!==di.Bytes)return h.push(this.readSFixed32());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readSFixed32());return h},readPackedFixed64:function(h){if(this.type!==di.Bytes)return h.push(this.readFixed64());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readFixed64());return h},readPackedSFixed64:function(h){if(this.type!==di.Bytes)return h.push(this.readSFixed64());var o=$l(this);for(h=h||[];this.pos<o;)h.push(this.readSFixed64());return h},skip:function(h){var o=7&h;if(o===di.Varint)for(;this.buf[this.pos++]>127;);else if(o===di.Bytes)this.pos=this.readVarint()+this.pos;else if(o===di.Fixed32)this.pos+=4;else{if(o!==di.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(h,o){this.writeVarint(h<<3|o)},realloc:function(h){for(var o=this.length||16;o<this.pos+h;)o*=2;if(o!==this.length){var p=new Uint8Array(o);p.set(this.buf),this.buf=p,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(h){this.realloc(4),vh(this.buf,h,this.pos),this.pos+=4},writeSFixed32:function(h){this.realloc(4),vh(this.buf,h,this.pos),this.pos+=4},writeFixed64:function(h){this.realloc(8),vh(this.buf,-1&h,this.pos),vh(this.buf,Math.floor(h*zb),this.pos+4),this.pos+=8},writeSFixed64:function(h){this.realloc(8),vh(this.buf,-1&h,this.pos),vh(this.buf,Math.floor(h*zb),this.pos+4),this.pos+=8},writeVarint:function(h){(h=+h||0)>268435455||h<0?function(o,p){var x,C;if(o>=0?(x=o%4294967296|0,C=o/4294967296|0):(C=~(-o/4294967296),4294967295^(x=~(-o%4294967296))?x=x+1|0:(x=0,C=C+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(B,R,j){j.buf[j.pos++]=127&B|128,B>>>=7,j.buf[j.pos++]=127&B|128,B>>>=7,j.buf[j.pos++]=127&B|128,B>>>=7,j.buf[j.pos++]=127&B|128,j.buf[j.pos]=127&(B>>>=7)}(x,0,p),function(B,R){var j=(7&B)<<4;R.buf[R.pos++]|=j|((B>>>=3)?128:0),B&&(R.buf[R.pos++]=127&B|((B>>>=7)?128:0),B&&(R.buf[R.pos++]=127&B|((B>>>=7)?128:0),B&&(R.buf[R.pos++]=127&B|((B>>>=7)?128:0),B&&(R.buf[R.pos++]=127&B|((B>>>=7)?128:0),B&&(R.buf[R.pos++]=127&B)))))}(C,p)}(h,this):(this.realloc(4),this.buf[this.pos++]=127&h|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=127&(h>>>=7)|(h>127?128:0),h<=127||(this.buf[this.pos++]=h>>>7&127))))},writeSVarint:function(h){this.writeVarint(h<0?2*-h-1:2*h)},writeBoolean:function(h){this.writeVarint(!!h)},writeString:function(h){h=String(h),this.realloc(4*h.length),this.pos++;var o=this.pos;this.pos=function(x,C,B){for(var R,j,H=0;H<C.length;H++){if((R=C.charCodeAt(H))>55295&&R<57344){if(!j){R>56319||H+1===C.length?(x[B++]=239,x[B++]=191,x[B++]=189):j=R;continue}if(R<56320){x[B++]=239,x[B++]=191,x[B++]=189,j=R;continue}R=j-55296<<10|R-56320|65536,j=null}else j&&(x[B++]=239,x[B++]=191,x[B++]=189,j=null);R<128?x[B++]=R:(R<2048?x[B++]=R>>6|192:(R<65536?x[B++]=R>>12|224:(x[B++]=R>>18|240,x[B++]=R>>12&63|128),x[B++]=R>>6&63|128),x[B++]=63&R|128)}return B}(this.buf,h,this.pos);var p=this.pos-o;p>=128&&Nb(o,p,this),this.pos=o-1,this.writeVarint(p),this.pos+=p},writeFloat:function(h){this.realloc(4),Ob(this.buf,h,this.pos,!0,23,4),this.pos+=4},writeDouble:function(h){this.realloc(8),Ob(this.buf,h,this.pos,!0,52,8),this.pos+=8},writeBytes:function(h){var o=h.length;this.writeVarint(o),this.realloc(o);for(var p=0;p<o;p++)this.buf[this.pos++]=h[p]},writeRawMessage:function(h,o){this.pos++;var p=this.pos;h(o,this);var x=this.pos-p;x>=128&&Nb(p,x,this),this.pos=p-1,this.writeVarint(x),this.pos+=x},writeMessage:function(h,o,p){this.writeTag(h,di.Bytes),this.writeRawMessage(o,p)},writePackedVarint:function(h,o){o.length&&this.writeMessage(h,d8,o)},writePackedSVarint:function(h,o){o.length&&this.writeMessage(h,p8,o)},writePackedBoolean:function(h,o){o.length&&this.writeMessage(h,_8,o)},writePackedFloat:function(h,o){o.length&&this.writeMessage(h,g8,o)},writePackedDouble:function(h,o){o.length&&this.writeMessage(h,m8,o)},writePackedFixed32:function(h,o){o.length&&this.writeMessage(h,y8,o)},writePackedSFixed32:function(h,o){o.length&&this.writeMessage(h,v8,o)},writePackedFixed64:function(h,o){o.length&&this.writeMessage(h,x8,o)},writePackedSFixed64:function(h,o){o.length&&this.writeMessage(h,w8,o)},writeBytesField:function(h,o){this.writeTag(h,di.Bytes),this.writeBytes(o)},writeFixed32Field:function(h,o){this.writeTag(h,di.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(h,o){this.writeTag(h,di.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(h,o){this.writeTag(h,di.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(h,o){this.writeTag(h,di.Fixed64),this.writeSFixed64(o)},writeVarintField:function(h,o){this.writeTag(h,di.Varint),this.writeVarint(o)},writeSVarintField:function(h,o){this.writeTag(h,di.Varint),this.writeSVarint(o)},writeStringField:function(h,o){this.writeTag(h,di.Bytes),this.writeString(o)},writeFloatField:function(h,o){this.writeTag(h,di.Fixed32),this.writeFloat(o)},writeDoubleField:function(h,o){this.writeTag(h,di.Fixed64),this.writeDouble(o)},writeBooleanField:function(h,o){this.writeVarintField(h,!!o)}};var X_=S(Bb);const K_=3;function b8(h,o,p){h===1&&p.readMessage(E8,o)}function E8(h,o,p){if(h===3){const{id:x,bitmap:C,width:B,height:R,left:j,top:H,advance:q}=p.readMessage(T8,{});o.push({id:x,bitmap:new H0({width:B+2*K_,height:R+2*K_},C),metrics:{width:B,height:R,left:j,top:H,advance:q}})}}function T8(h,o,p){h===1?o.id=p.readVarint():h===2?o.bitmap=p.readBytes():h===3?o.width=p.readVarint():h===4?o.height=p.readVarint():h===5?o.left=p.readSVarint():h===6?o.top=p.readSVarint():h===7&&(o.advance=p.readVarint())}const Vb=K_;function jb(h){let o=0,p=0;for(const R of h)o+=R.w*R.h,p=Math.max(p,R.w);h.sort((R,j)=>j.h-R.h);const x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),p),h:1/0}];let C=0,B=0;for(const R of h)for(let j=x.length-1;j>=0;j--){const H=x[j];if(!(R.w>H.w||R.h>H.h)){if(R.x=H.x,R.y=H.y,B=Math.max(B,R.y+R.h),C=Math.max(C,R.x+R.w),R.w===H.w&&R.h===H.h){const q=x.pop();j<x.length&&(x[j]=q)}else R.h===H.h?(H.x+=R.w,H.w-=R.w):R.w===H.w?(H.y+=R.h,H.h-=R.h):(x.push({x:H.x+R.w,y:H.y,w:H.w-R.w,h:R.h}),H.y+=R.h,H.h-=R.h);break}}return{w:C,h:B,fill:o/(C*B)||0}}const ho=1;class J_{constructor(o,{pixelRatio:p,version:x,stretchX:C,stretchY:B,content:R}){this.paddedRect=o,this.pixelRatio=p,this.stretchX=C,this.stretchY=B,this.content=R,this.version=x}get tl(){return[this.paddedRect.x+ho,this.paddedRect.y+ho]}get br(){return[this.paddedRect.x+this.paddedRect.w-ho,this.paddedRect.y+this.paddedRect.h-ho]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ho)/this.pixelRatio,(this.paddedRect.h-2*ho)/this.pixelRatio]}}class Gb{constructor(o,p){const x={},C={};this.haveRenderCallbacks=[];const B=[];this.addImages(o,x,B),this.addImages(p,C,B);const{w:R,h:j}=jb(B),H=new _a({width:R||1,height:j||1});for(const q in o){const J=o[q],ne=x[q].paddedRect;_a.copy(J.data,H,{x:0,y:0},{x:ne.x+ho,y:ne.y+ho},J.data)}for(const q in p){const J=p[q],ne=C[q].paddedRect,he=ne.x+ho,me=ne.y+ho,ye=J.data.width,Me=J.data.height;_a.copy(J.data,H,{x:0,y:0},{x:he,y:me},J.data),_a.copy(J.data,H,{x:0,y:Me-1},{x:he,y:me-1},{width:ye,height:1}),_a.copy(J.data,H,{x:0,y:0},{x:he,y:me+Me},{width:ye,height:1}),_a.copy(J.data,H,{x:ye-1,y:0},{x:he-1,y:me},{width:1,height:Me}),_a.copy(J.data,H,{x:0,y:0},{x:he+ye,y:me},{width:1,height:Me})}this.image=H,this.iconPositions=x,this.patternPositions=C}addImages(o,p,x){for(const C in o){const B=o[C],R={x:0,y:0,w:B.data.width+2*ho,h:B.data.height+2*ho};x.push(R),p[C]=new J_(R,B),B.hasRenderCallback&&this.haveRenderCallbacks.push(C)}}patchUpdatedImages(o,p){o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const x in o.updatedImages)this.patchUpdatedImage(this.iconPositions[x],o.getImage(x),p),this.patchUpdatedImage(this.patternPositions[x],o.getImage(x),p)}patchUpdatedImage(o,p,x){if(!o||!p||o.version===p.version)return;o.version=p.version;const[C,B]=o.tl;x.update(p.data,void 0,{x:C,y:B})}}var Bu;Wt("ImagePosition",J_),Wt("ImageAtlas",Gb),l.WritingMode=void 0,(Bu=l.WritingMode||(l.WritingMode={}))[Bu.none=0]="none",Bu[Bu.horizontal=1]="horizontal",Bu[Bu.vertical=2]="vertical",Bu[Bu.horizontalOnly=3]="horizontalOnly";const J0=-17;class ef{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,p){const x=new ef;return x.scale=o||1,x.fontStack=p,x}static forImage(o){const p=new ef;return p.imageName=o,p}}class xh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,p){const x=new xh;for(let C=0;C<o.sections.length;C++){const B=o.sections[C];B.image?x.addImageSection(B):x.addTextSection(B,p)}return x}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(){this.text=function(o){let p="";for(let x=0;x<o.length;x++){const C=o.charCodeAt(x+1)||null,B=o.charCodeAt(x-1)||null;p+=C&&SA(C)&&!K0[o[x+1]]||B&&SA(B)&&!K0[o[x-1]]||!K0[o[x]]?o[x]:K0[o[x]]}return p}(this.text)}trim(){let o=0;for(let x=0;x<this.text.length&&_p[this.text.charCodeAt(x)];x++)o++;let p=this.text.length;for(let x=this.text.length-1;x>=0&&x>=o&&_p[this.text.charCodeAt(x)];x--)p--;this.text=this.text.substring(o,p),this.sectionIndex=this.sectionIndex.slice(o,p)}substring(o,p){const x=new xh;return x.text=this.text.substring(o,p),x.sectionIndex=this.sectionIndex.slice(o,p),x.sections=this.sections,x}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,p)=>Math.max(o,this.sections[p].scale),0)}addTextSection(o,p){this.text+=o.text,this.sections.push(ef.forText(o.scale,o.fontStack||p));const x=this.sections.length-1;for(let C=0;C<o.text.length;++C)this.sectionIndex.push(x)}addImageSection(o){const p=o.image?o.image.name:"";if(p.length===0)return void at("Can't add FormattedSection with an empty image.");const x=this.getNextImageSectionCharCode();x?(this.text+=String.fromCharCode(x),this.sections.push(ef.forImage(p)),this.sectionIndex.push(this.sections.length-1)):at("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function mp(h,o,p,x,C,B,R,j,H,q,J,ne,he,me,ye,Me){const Ue=xh.fromFeature(h,C);let He;ne===l.WritingMode.vertical&&Ue.verticalizePunctuation();const{processBidirectionalText:Ke,processStyledBidirectionalText:Ze}=Xr;if(Ke&&Ue.sections.length===1){He=[];const dt=Ke(Ue.toString(),e1(Ue,q,B,o,x,me,ye));for(const Gt of dt){const tn=new xh;tn.text=Gt,tn.sections=Ue.sections;for(let jt=0;jt<Gt.length;jt++)tn.sectionIndex.push(0);He.push(tn)}}else if(Ze){He=[];const dt=Ze(Ue.text,Ue.sectionIndex,e1(Ue,q,B,o,x,me,ye));for(const Gt of dt){const tn=new xh;tn.text=Gt[0],tn.sectionIndex=Gt[1],tn.sections=Ue.sections,He.push(tn)}}else He=function(dt,Gt){const tn=[],jt=dt.text;let Ft=0;for(const Dt of Gt)tn.push(dt.substring(Ft,Dt)),Ft=Dt;return Ft<jt.length&&tn.push(dt.substring(Ft,jt.length)),tn}(Ue,e1(Ue,q,B,o,x,me,ye));const et=[],st={positionedLines:et,text:Ue.toString(),top:J[1],bottom:J[1],left:J[0],right:J[0],writingMode:ne,iconsInText:!1,verticalizable:!1};return function(dt,Gt,tn,jt,Ft,Dt,Xt,Ot,bt,hn,sn,zn){let vi=0,Mi=J0,Pr=0,Bo=0;const Hs=Ot==="right"?1:Ot==="left"?0:.5;let gr=0;for(const mr of Ft){mr.trim();const Mr=mr.getMaxScale(),ks=(Mr-1)*Cr,$s={positionedGlyphs:[],lineOffset:0};dt.positionedLines[gr]=$s;const po=$s.positionedGlyphs;let go=0;if(!mr.length()){Mi+=Dt,++gr;continue}for(let xs=0;xs<mr.length();xs++){const Vn=mr.getSection(xs),Ro=mr.getSectionIndex(xs),ws=mr.getCharCode(xs);let Zs=0,qa=null,DA=null,BA=null,Zl=Cr;const Ya=!(bt===l.WritingMode.horizontal||!sn&&!Qa(ws)||sn&&(_p[ws]||(Gr=ws,Bt.Arabic(Gr)||Bt["Arabic Supplement"](Gr)||Bt["Arabic Extended-A"](Gr)||Bt["Arabic Presentation Forms-A"](Gr)||Bt["Arabic Presentation Forms-B"](Gr))));if(Vn.imageName){const va=jt[Vn.imageName];if(!va)continue;BA=Vn.imageName,dt.iconsInText=dt.iconsInText||!0,DA=va.paddedRect;const mo=va.displaySize;Vn.scale=Vn.scale*Cr/zn,qa={width:mo[0],height:mo[1],left:ho,top:-Vb,advance:Ya?mo[1]:mo[0]},Zs=ks+(Cr-mo[1]*Vn.scale),Zl=qa.advance;const ql=Ya?mo[0]*Vn.scale-Cr*Mr:mo[1]*Vn.scale-Cr*Mr;ql>0&&ql>go&&(go=ql)}else{const va=tn[Vn.fontStack],mo=va&&va[ws];if(mo&&mo.rect)DA=mo.rect,qa=mo.metrics;else{const ql=Gt[Vn.fontStack],of=ql&&ql[ws];if(!of)continue;qa=of.metrics}Zs=(Mr-Vn.scale)*Cr}Ya?(dt.verticalizable=!0,po.push({glyph:ws,imageName:BA,x:vi,y:Mi+Zs,vertical:Ya,scale:Vn.scale,fontStack:Vn.fontStack,sectionIndex:Ro,metrics:qa,rect:DA}),vi+=Zl*Vn.scale+hn):(po.push({glyph:ws,imageName:BA,x:vi,y:Mi+Zs,vertical:Ya,scale:Vn.scale,fontStack:Vn.fontStack,sectionIndex:Ro,metrics:qa,rect:DA}),vi+=qa.advance*Vn.scale+hn)}po.length!==0&&(Pr=Math.max(vi-hn,Pr),P8(po,0,po.length-1,Hs,go)),vi=0;const $i=Dt*Mr+go;$s.lineOffset=Math.max(go,ks),Mi+=$i,Bo=Math.max($i,Bo),++gr}var Gr;const vs=Mi-J0,{horizontalAlign:fo,verticalAlign:Ws}=t1(Xt);(function(mr,Mr,ks,$s,po,go,$i,xs,Vn){const Ro=(Mr-ks)*po;let ws=0;ws=go!==$i?-xs*$s-J0:(-$s*Vn+.5)*$i;for(const Zs of mr)for(const qa of Zs.positionedGlyphs)qa.x+=Ro,qa.y+=ws})(dt.positionedLines,Hs,fo,Ws,Pr,Bo,Dt,vs,Ft.length),dt.top+=-Ws*vs,dt.bottom=dt.top+vs,dt.left+=-fo*Pr,dt.right=dt.left+Pr}(st,o,p,x,He,R,j,H,ne,q,he,Me),!function(dt){for(const Gt of dt)if(Gt.positionedGlyphs.length!==0)return!1;return!0}(et)&&st}const _p={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},S8={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qb(h,o,p,x,C,B){if(o.imageName){const R=x[o.imageName];return R?R.displaySize[0]*o.scale*Cr/B+C:0}{const R=p[o.fontStack],j=R&&R[h];return j?j.metrics.advance*o.scale+C:0}}function Hb(h,o,p,x){const C=Math.pow(h-o,2);return x?h<o?C/2:2*C:C+Math.abs(p)*p}function C8(h,o,p){let x=0;return h===10&&(x-=1e4),p&&(x+=150),h!==40&&h!==65288||(x+=50),o!==41&&o!==65289||(x+=50),x}function Wb(h,o,p,x,C,B){let R=null,j=Hb(o,p,C,B);for(const H of x){const q=Hb(o-H.x,p,C,B)+H.badness;q<=j&&(R=H,j=q)}return{index:h,x:o,priorBreak:R,badness:j}}function $b(h){return h?$b(h.priorBreak).concat(h.index):[]}function e1(h,o,p,x,C,B,R){if(B!=="point")return[];if(!h)return[];const j=[],H=function(he,me,ye,Me,Ue,He){let Ke=0;for(let Ze=0;Ze<he.length();Ze++){const et=he.getSection(Ze);Ke+=Qb(he.getCharCode(Ze),et,Me,Ue,me,He)}return Ke/Math.max(1,Math.ceil(Ke/ye))}(h,o,p,x,C,R),q=h.text.indexOf("​")>=0;let J=0;for(let he=0;he<h.length();he++){const me=h.getSection(he),ye=h.getCharCode(he);if(_p[ye]||(J+=Qb(ye,me,x,C,o,R)),he<h.length()-1){const Me=!((ne=ye)<11904||!(Bt["Bopomofo Extended"](ne)||Bt.Bopomofo(ne)||Bt["CJK Compatibility Forms"](ne)||Bt["CJK Compatibility Ideographs"](ne)||Bt["CJK Compatibility"](ne)||Bt["CJK Radicals Supplement"](ne)||Bt["CJK Strokes"](ne)||Bt["CJK Symbols and Punctuation"](ne)||Bt["CJK Unified Ideographs Extension A"](ne)||Bt["CJK Unified Ideographs"](ne)||Bt["Enclosed CJK Letters and Months"](ne)||Bt["Halfwidth and Fullwidth Forms"](ne)||Bt.Hiragana(ne)||Bt["Ideographic Description Characters"](ne)||Bt["Kangxi Radicals"](ne)||Bt["Katakana Phonetic Extensions"](ne)||Bt.Katakana(ne)||Bt["Vertical Forms"](ne)||Bt["Yi Radicals"](ne)||Bt["Yi Syllables"](ne)));(S8[ye]||Me||me.imageName)&&j.push(Wb(he+1,J,H,j,C8(ye,h.getCharCode(he+1),Me&&q),!1))}}var ne;return $b(Wb(h.length(),J,H,j,0,!0))}function t1(h){let o=.5,p=.5;switch(h){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:o,verticalAlign:p}}function P8(h,o,p,x,C){if(!x&&!C)return;const B=h[p],R=(h[p].x+B.metrics.advance*B.scale)*x;for(let j=o;j<=p;j++)h[j].x-=R,h[j].y+=C}function M8(h,o,p){const{horizontalAlign:x,verticalAlign:C}=t1(p),B=o[0]-h.displaySize[0]*x,R=o[1]-h.displaySize[1]*C;return{image:h,top:R,bottom:R+h.displaySize[1],left:B,right:B+h.displaySize[0]}}function Zb(h,o,p,x,C,B){const R=h.image;let j;if(R.content){const Ue=R.content,He=R.pixelRatio||1;j=[Ue[0]/He,Ue[1]/He,R.displaySize[0]-Ue[2]/He,R.displaySize[1]-Ue[3]/He]}const H=o.left*B,q=o.right*B;let J,ne,he,me;p==="width"||p==="both"?(me=C[0]+H-x[3],ne=C[0]+q+x[1]):(me=C[0]+(H+q-R.displaySize[0])/2,ne=me+R.displaySize[0]);const ye=o.top*B,Me=o.bottom*B;return p==="height"||p==="both"?(J=C[1]+ye-x[0],he=C[1]+Me+x[2]):(J=C[1]+(ye+Me-R.displaySize[1])/2,he=J+R.displaySize[1]),{image:R,top:J,right:ne,bottom:he,left:me,collisionPadding:j}}const tf=255,ul=128,Ru=tf*ul;function qb(h,o){const{expression:p}=o;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new ci(h+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:x,interpolationType:C}=p;let B=0;for(;B<x.length&&x[B]<=h;)B++;B=Math.max(0,B-1);let R=B;for(;R<x.length&&x[R]<h+1;)R++;R=Math.min(x.length-1,R);const j=x[B],H=x[R];return p.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:H,interpolationType:C}:{kind:"camera",minZoom:j,maxZoom:H,minSize:p.evaluate(new ci(j)),maxSize:p.evaluate(new ci(H)),interpolationType:C}}}function n1(h,o,p){let x="never";const C=h.get(o);return C?x=C:h.get(p)&&(x="always"),x}const I8=Du.VectorTileFeature.types,k8=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function yp(h,o,p,x,C,B,R,j,H,q,J,ne,he){const me=j?Math.min(Ru,Math.round(j[0])):0,ye=j?Math.min(Ru,Math.round(j[1])):0;h.emplaceBack(o,p,Math.round(32*x),Math.round(32*C),B,R,(me<<1)+(H?1:0),ye,16*q,16*J,256*ne,256*he)}function i1(h,o,p){h.emplaceBack(o.x,o.y,p),h.emplaceBack(o.x,o.y,p),h.emplaceBack(o.x,o.y,p),h.emplaceBack(o.x,o.y,p)}function L8(h){for(const o of h.sections)if(Mu(o.text))return!0;return!1}class r1{constructor(o){this.layoutVertexArray=new Be,this.indexArray=new ct,this.programConfigurations=o,this.segments=new wt,this.dynamicLayoutVertexArray=new Le,this.opacityVertexArray=new At,this.hasVisibleVertices=!1,this.placedSymbolArray=new g}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(o,p,x,C){this.isEmpty()||(x&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,l8.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,u8.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,k8,!0),this.opacityVertexBuffer.itemSize=1),(x||C)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Wt("SymbolBuffers",r1);class s1{constructor(o,p,x){this.layoutVertexArray=new o,this.layoutAttributes=p,this.indexArray=new x,this.segments=new wt,this.collisionVertexArray=new nt}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,c8.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Wt("CollisionBuffers",s1);class wh{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(R=>R.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=O_([]),this.placementViewportMatrix=O_([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=qb(this.zoom,p["text-size"]),this.iconSizeData=qb(this.zoom,p["icon-size"]);const x=this.layers[0].layout,C=x.get("symbol-sort-key"),B=x.get("symbol-z-order");this.canOverlap=n1(x,"text-overlap","text-allow-overlap")!=="never"||n1(x,"icon-overlap","icon-allow-overlap")!=="never"||x.get("text-ignore-placement")||x.get("icon-ignore-placement"),this.sortFeaturesByKey=B!=="viewport-y"&&!C.isConstant(),this.sortFeaturesByY=(B==="viewport-y"||B==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,x.get("symbol-placement")==="point"&&(this.writingModes=x.get("text-writing-mode").map(R=>l.WritingMode[R])),this.stateDependentLayerIds=this.layers.filter(R=>R.isStateDependent()).map(R=>R.id),this.sourceID=o.sourceID}createArrays(){this.text=new r1(new Hl(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new r1(new Hl(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new P,this.lineVertexArray=new D,this.symbolInstances=new b,this.textAnchorOffsets=new G}calculateGlyphDependencies(o,p,x,C,B){for(let R=0;R<o.length;R++)if(p[o.charCodeAt(R)]=!0,(x||C)&&B){const j=K0[o.charAt(R)];j&&(p[j.charCodeAt(0)]=!0)}}populate(o,p,x){const C=this.layers[0],B=C.layout,R=B.get("text-font"),j=B.get("text-field"),H=B.get("icon-image"),q=(j.value.kind!=="constant"||j.value.value instanceof ni&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(R.value.kind!=="constant"||R.value.value.length>0),J=H.value.kind!=="constant"||!!H.value.value||Object.keys(H.parameters).length>0,ne=B.get("symbol-sort-key");if(this.features=[],!q&&!J)return;const he=p.iconDependencies,me=p.glyphDependencies,ye=p.availableImages,Me=new ci(this.zoom);for(const{feature:Ue,id:He,index:Ke,sourceLayerIndex:Ze}of o){const et=C._featureFilter.needGeometry,st=ll(Ue,et);if(!C._featureFilter.filter(Me,st,x))continue;let dt,Gt;if(et||(st.geometry=LA(Ue)),q){const jt=C.getValueAndResolveTokens("text-field",st,x,ye),Ft=ni.factory(jt);L8(Ft)&&(this.hasRTLText=!0),(!this.hasRTLText||jl()==="unavailable"||this.hasRTLText&&Xr.isParsed())&&(dt=f8(Ft,C,st))}if(J){const jt=C.getValueAndResolveTokens("icon-image",st,x,ye);Gt=jt instanceof qn?jt:qn.fromString(jt)}if(!dt&&!Gt)continue;const tn=this.sortFeaturesByKey?ne.evaluate(st,{},x):void 0;if(this.features.push({id:He,text:dt,icon:Gt,index:Ke,sourceLayerIndex:Ze,geometry:st.geometry,properties:Ue.properties,type:I8[Ue.type],sortKey:tn}),Gt&&(he[Gt.name]=!0),dt){const jt=R.evaluate(st,{},x).join(","),Ft=B.get("text-rotation-alignment")!=="viewport"&&B.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.WritingMode.vertical)>=0;for(const Dt of dt.sections)if(Dt.image)he[Dt.image.name]=!0;else{const Xt=EA(dt.toString()),Ot=Dt.fontStack||jt,bt=me[Ot]=me[Ot]||{};this.calculateGlyphDependencies(Dt.text,bt,Ft,this.allowVerticalPlacement,Xt)}}}B.get("symbol-placement")==="line"&&(this.features=function(Ue){const He={},Ke={},Ze=[];let et=0;function st(jt){Ze.push(Ue[jt]),et++}function dt(jt,Ft,Dt){const Xt=Ke[jt];return delete Ke[jt],Ke[Ft]=Xt,Ze[Xt].geometry[0].pop(),Ze[Xt].geometry[0]=Ze[Xt].geometry[0].concat(Dt[0]),Xt}function Gt(jt,Ft,Dt){const Xt=He[Ft];return delete He[Ft],He[jt]=Xt,Ze[Xt].geometry[0].shift(),Ze[Xt].geometry[0]=Dt[0].concat(Ze[Xt].geometry[0]),Xt}function tn(jt,Ft,Dt){const Xt=Dt?Ft[0][Ft[0].length-1]:Ft[0][0];return`${jt}:${Xt.x}:${Xt.y}`}for(let jt=0;jt<Ue.length;jt++){const Ft=Ue[jt],Dt=Ft.geometry,Xt=Ft.text?Ft.text.toString():null;if(!Xt){st(jt);continue}const Ot=tn(Xt,Dt),bt=tn(Xt,Dt,!0);if(Ot in Ke&&bt in He&&Ke[Ot]!==He[bt]){const hn=Gt(Ot,bt,Dt),sn=dt(Ot,bt,Ze[hn].geometry);delete He[Ot],delete Ke[bt],Ke[tn(Xt,Ze[sn].geometry,!0)]=sn,Ze[hn].geometry=null}else Ot in Ke?dt(Ot,bt,Dt):bt in He?Gt(Ot,bt,Dt):(st(jt),He[Ot]=et-1,Ke[bt]=et-1)}return Ze.filter(jt=>jt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ue,He)=>Ue.sortKey-He.sortKey)}update(o,p,x){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,p,this.layers,x),this.icon.programConfigurations.updatePaintArrays(o,p,this.layers,x))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,p){const x=this.lineVertexArray.length;if(o.segment!==void 0){let C=o.dist(p[o.segment+1]),B=o.dist(p[o.segment]);const R={};for(let j=o.segment+1;j<p.length;j++)R[j]={x:p[j].x,y:p[j].y,tileUnitDistanceFromAnchor:C},j<p.length-1&&(C+=p[j+1].dist(p[j]));for(let j=o.segment||0;j>=0;j--)R[j]={x:p[j].x,y:p[j].y,tileUnitDistanceFromAnchor:B},j>0&&(B+=p[j-1].dist(p[j]));for(let j=0;j<p.length;j++){const H=R[j];this.lineVertexArray.emplaceBack(H.x,H.y,H.tileUnitDistanceFromAnchor)}}return{lineStartIndex:x,lineLength:this.lineVertexArray.length-x}}addSymbols(o,p,x,C,B,R,j,H,q,J,ne,he){const me=o.indexArray,ye=o.layoutVertexArray,Me=o.segments.prepareSegment(4*p.length,ye,me,this.canOverlap?R.sortKey:void 0),Ue=this.glyphOffsetArray.length,He=Me.vertexLength,Ke=this.allowVerticalPlacement&&j===l.WritingMode.vertical?Math.PI/2:0,Ze=R.text&&R.text.sections;for(let et=0;et<p.length;et++){const{tl:st,tr:dt,bl:Gt,br:tn,tex:jt,pixelOffsetTL:Ft,pixelOffsetBR:Dt,minFontScaleX:Xt,minFontScaleY:Ot,glyphOffset:bt,isSDF:hn,sectionIndex:sn}=p[et],zn=Me.vertexLength,vi=bt[1];yp(ye,H.x,H.y,st.x,vi+st.y,jt.x,jt.y,x,hn,Ft.x,Ft.y,Xt,Ot),yp(ye,H.x,H.y,dt.x,vi+dt.y,jt.x+jt.w,jt.y,x,hn,Dt.x,Ft.y,Xt,Ot),yp(ye,H.x,H.y,Gt.x,vi+Gt.y,jt.x,jt.y+jt.h,x,hn,Ft.x,Dt.y,Xt,Ot),yp(ye,H.x,H.y,tn.x,vi+tn.y,jt.x+jt.w,jt.y+jt.h,x,hn,Dt.x,Dt.y,Xt,Ot),i1(o.dynamicLayoutVertexArray,H,Ke),me.emplaceBack(zn,zn+1,zn+2),me.emplaceBack(zn+1,zn+2,zn+3),Me.vertexLength+=4,Me.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(bt[0]),et!==p.length-1&&sn===p[et+1].sectionIndex||o.programConfigurations.populatePaintArrays(ye.length,R,R.index,{},he,Ze&&Ze[sn])}o.placedSymbolArray.emplaceBack(H.x,H.y,Ue,this.glyphOffsetArray.length-Ue,He,q,J,H.segment,x?x[0]:0,x?x[1]:0,C[0],C[1],j,0,!1,0,ne)}_addCollisionDebugVertex(o,p,x,C,B,R){return p.emplaceBack(0,0),o.emplaceBack(x.x,x.y,C,B,Math.round(R.x),Math.round(R.y))}addCollisionDebugVertices(o,p,x,C,B,R,j){const H=B.segments.prepareSegment(4,B.layoutVertexArray,B.indexArray),q=H.vertexLength,J=B.layoutVertexArray,ne=B.collisionVertexArray,he=j.anchorX,me=j.anchorY;this._addCollisionDebugVertex(J,ne,R,he,me,new V(o,p)),this._addCollisionDebugVertex(J,ne,R,he,me,new V(x,p)),this._addCollisionDebugVertex(J,ne,R,he,me,new V(x,C)),this._addCollisionDebugVertex(J,ne,R,he,me,new V(o,C)),H.vertexLength+=4;const ye=B.indexArray;ye.emplaceBack(q,q+1),ye.emplaceBack(q+1,q+2),ye.emplaceBack(q+2,q+3),ye.emplaceBack(q+3,q),H.primitiveLength+=4}addDebugCollisionBoxes(o,p,x,C){for(let B=o;B<p;B++){const R=this.collisionBoxArray.get(B);this.addCollisionDebugVertices(R.x1,R.y1,R.x2,R.y2,C?this.textCollisionBox:this.iconCollisionBox,R.anchorPoint,x)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new s1(_t,Db.members,Ct),this.iconCollisionBox=new s1(_t,Db.members,Ct);for(let o=0;o<this.symbolInstances.length;o++){const p=this.symbolInstances.get(o);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(o,p,x,C,B,R,j,H,q){const J={};for(let ne=p;ne<x;ne++){const he=o.get(ne);J.textBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},J.textFeatureIndex=he.featureIndex;break}for(let ne=C;ne<B;ne++){const he=o.get(ne);J.verticalTextBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},J.verticalTextFeatureIndex=he.featureIndex;break}for(let ne=R;ne<j;ne++){const he=o.get(ne);J.iconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},J.iconFeatureIndex=he.featureIndex;break}for(let ne=H;ne<q;ne++){const he=o.get(ne);J.verticalIconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},J.verticalIconFeatureIndex=he.featureIndex;break}return J}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const x=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,x.textBoxStartIndex,x.textBoxEndIndex,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x.iconBoxStartIndex,x.iconBoxEndIndex,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,p){const x=o.placedSymbolArray.get(p),C=x.vertexStartIndex+4*x.numGlyphs;for(let B=x.vertexStartIndex;B<C;B+=4)o.indexArray.emplaceBack(B,B+1,B+2),o.indexArray.emplaceBack(B+1,B+2,B+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(o),x=Math.cos(o),C=[],B=[],R=[];for(let j=0;j<this.symbolInstances.length;++j){R.push(j);const H=this.symbolInstances.get(j);C.push(0|Math.round(p*H.anchorX+x*H.anchorY)),B.push(H.featureIndex)}return R.sort((j,H)=>C[j]-C[H]||B[H]-B[j]),R}addToSortKeyRanges(o,p){const x=this.sortKeyRanges[this.sortKeyRanges.length-1];x&&x.sortKey===p?x.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const x=this.symbolInstances.get(p);this.featureSortOrder.push(x.featureIndex),[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach((C,B,R)=>{C>=0&&R.indexOf(C)===B&&this.addIndicesForPlacedSymbol(this.text,C)}),x.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,x.verticalPlacedTextSymbolIndex),x.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.placedIconSymbolIndex),x.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Yb,Xb;Wt("SymbolBucket",wh,{omit:["layers","collisionBoxArray","features","compareText"]}),wh.MAX_GLYPHS=65535,wh.addDynamicAttributes=i1;var o1={get paint(){return Xb=Xb||new br({"icon-opacity":new Jt(ut.paint_symbol["icon-opacity"]),"icon-color":new Jt(ut.paint_symbol["icon-color"]),"icon-halo-color":new Jt(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new Jt(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Jt(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new gt(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new gt(ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new Jt(ut.paint_symbol["text-opacity"]),"text-color":new Jt(ut.paint_symbol["text-color"],{runtimeType:Qi,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new Jt(ut.paint_symbol["text-halo-color"]),"text-halo-width":new Jt(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new Jt(ut.paint_symbol["text-halo-blur"]),"text-translate":new gt(ut.paint_symbol["text-translate"]),"text-translate-anchor":new gt(ut.paint_symbol["text-translate-anchor"])})},get layout(){return Yb=Yb||new br({"symbol-placement":new gt(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new gt(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gt(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Jt(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gt(ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new gt(ut.layout_symbol["icon-allow-overlap"]),"icon-overlap":new gt(ut.layout_symbol["icon-overlap"]),"icon-ignore-placement":new gt(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new gt(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gt(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new Jt(ut.layout_symbol["icon-size"]),"icon-text-fit":new gt(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new gt(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new Jt(ut.layout_symbol["icon-image"]),"icon-rotate":new Jt(ut.layout_symbol["icon-rotate"]),"icon-padding":new Jt(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new gt(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new Jt(ut.layout_symbol["icon-offset"]),"icon-anchor":new Jt(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gt(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gt(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gt(ut.layout_symbol["text-rotation-alignment"]),"text-field":new Jt(ut.layout_symbol["text-field"]),"text-font":new Jt(ut.layout_symbol["text-font"]),"text-size":new Jt(ut.layout_symbol["text-size"]),"text-max-width":new Jt(ut.layout_symbol["text-max-width"]),"text-line-height":new gt(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new Jt(ut.layout_symbol["text-letter-spacing"]),"text-justify":new Jt(ut.layout_symbol["text-justify"]),"text-radial-offset":new Jt(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gt(ut.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Jt(ut.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Jt(ut.layout_symbol["text-anchor"]),"text-max-angle":new gt(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new gt(ut.layout_symbol["text-writing-mode"]),"text-rotate":new Jt(ut.layout_symbol["text-rotate"]),"text-padding":new gt(ut.layout_symbol["text-padding"]),"text-keep-upright":new gt(ut.layout_symbol["text-keep-upright"]),"text-transform":new Jt(ut.layout_symbol["text-transform"]),"text-offset":new Jt(ut.layout_symbol["text-offset"]),"text-allow-overlap":new gt(ut.layout_symbol["text-allow-overlap"]),"text-overlap":new gt(ut.layout_symbol["text-overlap"]),"text-ignore-placement":new gt(ut.layout_symbol["text-ignore-placement"]),"text-optional":new gt(ut.layout_symbol["text-optional"])})}};class Kb{constructor(o){if(o.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=o.property.overrides?o.property.overrides.runtimeType:Wr,this.defaultValue=o}evaluate(o){if(o.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(o.formattedSection))return p.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Wt("FormatSectionOverride",Kb,{omit:["defaultValue"]});class vp extends xt{constructor(o){super(o,o1)}recalculate(o,p){if(super.recalculate(o,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const x=this.layout.get("text-writing-mode");if(x){const C=[];for(const B of x)C.indexOf(B)<0&&C.push(B);this.layout._values["text-writing-mode"]=C}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(o,p,x,C){const B=this.layout.get(o).evaluate(p,{},x,C),R=this._unevaluatedLayout._values[o];return R.isDataDriven()||dA(R.value)||!B?B:function(j,H){return H.replace(/{([^{}]+)}/g,(q,J)=>J in j?String(j[J]):"")}(p.properties,B)}createBucket(o){return new wh(o)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const o of o1.paint.overridableProperties){if(!vp.hasPaintOverride(this.layout,o))continue;const p=this.paint.get(o),x=new Kb(p),C=new fi(x,p.property.specification);let B=null;B=p.value.kind==="constant"||p.value.kind==="source"?new pA("source",C):new ii("composite",C,p.value.zoomStops),this.paint._values[o]=new jr(p.property,B,p.parameters)}}_handleOverridablePaintPropertyUpdate(o,p,x){return!(!this.layout||p.isDataDriven()||x.isDataDriven())&&vp.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,p){const x=o.get("text-field"),C=o1.paint.properties[p];let B=!1;const R=j=>{for(const H of j)if(C.overrides&&C.overrides.hasOverride(H))return void(B=!0)};if(x.value.kind==="constant"&&x.value.value instanceof ni)R(x.value.value.sections);else if(x.value.kind==="source"){const j=q=>{B||(q instanceof Se&&Ve(q.value)===ss?R(q.value.sections):q instanceof us?R(q.sections):q.eachChild(j))},H=x.value;H._styleExpression&&j(H._styleExpression.expression)}return B}}let Jb;var D8={get paint(){return Jb=Jb||new br({"background-color":new gt(ut.paint_background["background-color"]),"background-pattern":new pa(ut.paint_background["background-pattern"]),"background-opacity":new gt(ut.paint_background["background-opacity"])})}};class B8 extends xt{constructor(o){super(o,D8)}}let eE;var R8={get paint(){return eE=eE||new br({"raster-opacity":new gt(ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new gt(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gt(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gt(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new gt(ut.paint_raster["raster-saturation"]),"raster-contrast":new gt(ut.paint_raster["raster-contrast"]),"raster-resampling":new gt(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new gt(ut.paint_raster["raster-fade-duration"])})}};class O8 extends xt{constructor(o){super(o,R8)}}class z8 extends xt{constructor(o){super(o,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=o}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class F8{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const a1=63710088e-1;class Ou{constructor(o,p){if(isNaN(o)||isNaN(p))throw new Error(`Invalid LngLat object: (${o}, ${p})`);if(this.lng=+o,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ou(Ae(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const p=Math.PI/180,x=this.lat*p,C=o.lat*p,B=Math.sin(x)*Math.sin(C)+Math.cos(x)*Math.cos(C)*Math.cos((o.lng-this.lng)*p);return a1*Math.acos(Math.min(B,1))}static convert(o){if(o instanceof Ou)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new Ou(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new Ou(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const tE=2*Math.PI*a1;function nE(h){return tE*Math.cos(h*Math.PI/180)}function iE(h){return(180+h)/360}function rE(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function sE(h,o){return h/nE(o)}function A1(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}class xp{constructor(o,p,x=0){this.x=+o,this.y=+p,this.z=+x}static fromLngLat(o,p=0){const x=Ou.convert(o);return new xp(iE(x.lng),rE(x.lat),sE(p,x.lat))}toLngLat(){return new Ou(360*this.x-180,A1(this.y))}toAltitude(){return this.z*nE(A1(this.y))}meterInMercatorCoordinateUnits(){return 1/tE*(o=A1(this.y),1/Math.cos(o*Math.PI/180));var o}}function oE(h,o,p){var x=2*Math.PI*6378137/256/Math.pow(2,p);return[h*x-2*Math.PI*6378137/2,o*x-2*Math.PI*6378137/2]}class l1{constructor(o,p,x){if(o<0||o>25||x<0||x>=Math.pow(2,o)||p<0||p>=Math.pow(2,o))throw new Error(`x=${p}, y=${x}, z=${o} outside of bounds. 0<=x<${Math.pow(2,o)}, 0<=y<${Math.pow(2,o)} 0<=z<=25 `);this.z=o,this.x=p,this.y=x,this.key=nf(0,o,o,p,x)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,p,x){const C=(R=this.y,j=this.z,H=oE(256*(B=this.x),256*(R=Math.pow(2,j)-R-1),j),q=oE(256*(B+1),256*(R+1),j),H[0]+","+H[1]+","+q[0]+","+q[1]);var B,R,j,H,q;const J=function(ne,he,me){let ye,Me="";for(let Ue=ne;Ue>0;Ue--)ye=1<<Ue-1,Me+=(he&ye?1:0)+(me&ye?2:0);return Me}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(x==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,J).replace(/{bbox-epsg-3857}/g,C)}isChildOf(o){const p=this.z-o.z;return p>0&&o.x===this.x>>p&&o.y===this.y>>p}getTilePoint(o){const p=Math.pow(2,this.z);return new V((o.x*p-this.x)*Fi,(o.y*p-this.y)*Fi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class aE{constructor(o,p){this.wrap=o,this.canonical=p,this.key=nf(o,p.z,p.z,p.x,p.y)}}class ya{constructor(o,p,x,C,B){if(o<x)throw new Error(`overscaledZ should be >= z; overscaledZ = ${o}; z = ${x}`);this.overscaledZ=o,this.wrap=p,this.canonical=new l1(x,+C,+B),this.key=nf(p,o,x,C,B)}clone(){return new ya(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-o;return o>this.canonical.z?new ya(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ya(o,this.wrap,o,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(o,p){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const x=this.canonical.z-o;return o>this.canonical.z?nf(this.wrap*+p,o,this.canonical.z,this.canonical.x,this.canonical.y):nf(this.wrap*+p,o,o,this.canonical.x>>x,this.canonical.y>>x)}isChildOf(o){if(o.wrap!==this.wrap)return!1;const p=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>p&&o.canonical.y===this.canonical.y>>p}children(o){if(this.overscaledZ>=o)return[new ya(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,x=2*this.canonical.x,C=2*this.canonical.y;return[new ya(p,this.wrap,p,x,C),new ya(p,this.wrap,p,x+1,C),new ya(p,this.wrap,p,x,C+1),new ya(p,this.wrap,p,x+1,C+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new ya(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new ya(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new aE(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(o){return this.canonical.getTilePoint(new xp(o.x-this.wrap,o.y))}}function nf(h,o,p,x,C){(h*=2)<0&&(h=-1*h-1);const B=1<<p;return(B*B*h+B*C+x).toString(36)+p.toString(36)+o.toString(36)}Wt("CanonicalTileID",l1),Wt("OverscaledTileID",ya,{omit:["posMatrix"]});class AE{constructor(o,p,x){if(this.uid=o,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(x&&x!=="mapbox"&&x!=="terrarium")return void at(`"${x}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=p.height;const C=this.dim=p.height-2;this.data=new Uint32Array(p.data.buffer),this.encoding=x||"mapbox";for(let B=0;B<C;B++)this.data[this._idx(-1,B)]=this.data[this._idx(0,B)],this.data[this._idx(C,B)]=this.data[this._idx(C-1,B)],this.data[this._idx(B,-1)]=this.data[this._idx(B,0)],this.data[this._idx(B,C)]=this.data[this._idx(B,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let B=0;B<C;B++)for(let R=0;R<C;R++){const j=this.get(B,R);j>this.max&&(this.max=j),j<this.min&&(this.min=j)}}get(o,p){const x=new Uint8Array(this.data.buffer),C=4*this._idx(o,p);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(x[C],x[C+1],x[C+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(o,p){if(o<-1||o>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(o+1)}_unpackMapbox(o,p,x){return(256*o*256+256*p+x)/10-1e4}_unpackTerrarium(o,p,x){return 256*o+p+x/256-32768}getPixels(){return new _a({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(o,p,x){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let C=p*this.dim,B=p*this.dim+this.dim,R=x*this.dim,j=x*this.dim+this.dim;switch(p){case-1:C=B-1;break;case 1:B=C+1}switch(x){case-1:R=j-1;break;case 1:j=R+1}const H=-p*this.dim,q=-x*this.dim;for(let J=R;J<j;J++)for(let ne=C;ne<B;ne++)this.data[this._idx(ne,J)]=o.data[this._idx(ne+H,J+q)]}}Wt("DEMData",AE);class lE{constructor(o){this._stringToNumber={},this._numberToString=[];for(let p=0;p<o.length;p++){const x=o[p];this._stringToNumber[x]=p,this._numberToString[p]=x}}encode(o){return this._stringToNumber[o]}decode(o){if(o>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${o} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[o]}}class uE{constructor(o,p,x,C,B){this.type="Feature",this._vectorTileFeature=o,o._z=p,o._x=x,o._y=C,this.properties=o.properties,this.id=B}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(o[p]=this[p]);return o}}class cE{constructor(o,p){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Yr(Fi,16,0),this.grid3D=new Yr(Fi,16,0),this.featureIndexArray=new K,this.promoteId=p}insert(o,p,x,C,B,R){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(x,C,B);const H=R?this.grid3D:this.grid;for(let q=0;q<p.length;q++){const J=p[q],ne=[1/0,1/0,-1/0,-1/0];for(let he=0;he<J.length;he++){const me=J[he];ne[0]=Math.min(ne[0],me.x),ne[1]=Math.min(ne[1],me.y),ne[2]=Math.max(ne[2],me.x),ne[3]=Math.max(ne[3],me.y)}ne[0]<Fi&&ne[1]<Fi&&ne[2]>=0&&ne[3]>=0&&H.insert(j,ne[0],ne[1],ne[2],ne[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Du.VectorTile(new X_(this.rawTileData)).layers,this.sourceLayerCoder=new lE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(o,p,x,C){this.loadVTLayers();const B=o.params||{},R=Fi/o.tileSize/o.scale,j=Va(B.filter),H=o.queryGeometry,q=o.queryPadding*R,J=fE(H),ne=this.grid.query(J.minX-q,J.minY-q,J.maxX+q,J.maxY+q),he=fE(o.cameraQueryGeometry),me=this.grid3D.query(he.minX-q,he.minY-q,he.maxX+q,he.maxY+q,(Ue,He,Ke,Ze)=>function(et,st,dt,Gt,tn){for(const Ft of et)if(st<=Ft.x&&dt<=Ft.y&&Gt>=Ft.x&&tn>=Ft.y)return!0;const jt=[new V(st,dt),new V(st,tn),new V(Gt,tn),new V(Gt,dt)];if(et.length>2){for(const Ft of jt)if(ph(et,Ft))return!0}for(let Ft=0;Ft<et.length-1;Ft++)if(g6(et[Ft],et[Ft+1],jt))return!0;return!1}(o.cameraQueryGeometry,Ue-q,He-q,Ke+q,Ze+q));for(const Ue of me)ne.push(Ue);ne.sort(N8);const ye={};let Me;for(let Ue=0;Ue<ne.length;Ue++){const He=ne[Ue];if(He===Me)continue;Me=He;const Ke=this.featureIndexArray.get(He);let Ze=null;this.loadMatchingFeature(ye,Ke.bucketIndex,Ke.sourceLayerIndex,Ke.featureIndex,j,B.layers,B.availableImages,p,x,C,(et,st,dt)=>(Ze||(Ze=LA(et)),st.queryIntersectsFeature(H,et,dt,Ze,this.z,o.transform,R,o.pixelPosMatrix)))}return ye}loadMatchingFeature(o,p,x,C,B,R,j,H,q,J,ne){const he=this.bucketLayerIDs[p];if(R&&!function(Ue,He){for(let Ke=0;Ke<Ue.length;Ke++)if(He.indexOf(Ue[Ke])>=0)return!0;return!1}(R,he))return;const me=this.sourceLayerCoder.decode(x),ye=this.vtLayers[me].feature(C);if(B.needGeometry){const Ue=ll(ye,!0);if(!B.filter(new ci(this.tileID.overscaledZ),Ue,this.tileID.canonical))return}else if(!B.filter(new ci(this.tileID.overscaledZ),ye))return;const Me=this.getId(ye,me);for(let Ue=0;Ue<he.length;Ue++){const He=he[Ue];if(R&&R.indexOf(He)<0)continue;const Ke=H[He];if(!Ke)continue;let Ze={};Me&&J&&(Ze=J.getState(Ke.sourceLayer||"_geojsonTileLayer",Me));const et=ce({},q[He]);et.paint=hE(et.paint,Ke.paint,ye,Ze,j),et.layout=hE(et.layout,Ke.layout,ye,Ze,j);const st=!ne||ne(ye,Ke,Ze);if(!st)continue;const dt=new uE(ye,this.z,this.x,this.y,Me);dt.layer=et;let Gt=o[He];Gt===void 0&&(Gt=o[He]=[]),Gt.push({featureIndex:C,feature:dt,intersectionZ:st})}}lookupSymbolFeatures(o,p,x,C,B,R,j,H){const q={};this.loadVTLayers();const J=Va(B);for(const ne of o)this.loadMatchingFeature(q,x,C,ne,J,R,j,H,p);return q}hasLayer(o){for(const p of this.bucketLayerIDs)for(const x of p)if(o===x)return!0;return!1}getId(o,p){let x=o.id;return this.promoteId&&(x=o.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof x=="boolean"&&(x=Number(x))),x}}function hE(h,o,p,x,C){return Ne(h,(B,R)=>{const j=o instanceof Wi?o.get(R):null;return j&&j.evaluate?j.evaluate(p,x,C):j})}function fE(h){let o=1/0,p=1/0,x=-1/0,C=-1/0;for(const B of h)o=Math.min(o,B.x),p=Math.min(p,B.y),x=Math.max(x,B.x),C=Math.max(C,B.y);return{minX:o,minY:p,maxX:x,maxY:C}}function N8(h,o){return o-h}function dE(h,o,p,x,C){const B=[];for(let R=0;R<h.length;R++){const j=h[R];let H;for(let q=0;q<j.length-1;q++){let J=j[q],ne=j[q+1];J.x<o&&ne.x<o||(J.x<o?J=new V(o,J.y+(o-J.x)/(ne.x-J.x)*(ne.y-J.y))._round():ne.x<o&&(ne=new V(o,J.y+(o-J.x)/(ne.x-J.x)*(ne.y-J.y))._round()),J.y<p&&ne.y<p||(J.y<p?J=new V(J.x+(p-J.y)/(ne.y-J.y)*(ne.x-J.x),p)._round():ne.y<p&&(ne=new V(J.x+(p-J.y)/(ne.y-J.y)*(ne.x-J.x),p)._round()),J.x>=x&&ne.x>=x||(J.x>=x?J=new V(x,J.y+(x-J.x)/(ne.x-J.x)*(ne.y-J.y))._round():ne.x>=x&&(ne=new V(x,J.y+(x-J.x)/(ne.x-J.x)*(ne.y-J.y))._round()),J.y>=C&&ne.y>=C||(J.y>=C?J=new V(J.x+(C-J.y)/(ne.y-J.y)*(ne.x-J.x),C)._round():ne.y>=C&&(ne=new V(J.x+(C-J.y)/(ne.y-J.y)*(ne.x-J.x),C)._round()),H&&J.equals(H[H.length-1])||(H=[J],B.push(H)),H.push(ne)))))}}return B}Wt("FeatureIndex",cE,{omit:["rawTileData","sourceLayerCoder"]});class zu extends V{constructor(o,p,x,C){super(o,p),this.angle=x,C!==void 0&&(this.segment=C)}clone(){return new zu(this.x,this.y,this.angle,this.segment)}}function pE(h,o,p,x,C){if(o.segment===void 0||p===0)return!0;let B=o,R=o.segment+1,j=0;for(;j>-p/2;){if(R--,R<0)return!1;j-=h[R].dist(B),B=h[R]}j+=h[R].dist(h[R+1]),R++;const H=[];let q=0;for(;j<p/2;){const J=h[R],ne=h[R+1];if(!ne)return!1;let he=h[R-1].angleTo(J)-J.angleTo(ne);for(he=Math.abs((he+3*Math.PI)%(2*Math.PI)-Math.PI),H.push({distance:j,angleDelta:he}),q+=he;j-H[0].distance>x;)q-=H.shift().angleDelta;if(q>C)return!1;R++,j+=J.dist(ne)}return!0}function gE(h){let o=0;for(let p=0;p<h.length-1;p++)o+=h[p].dist(h[p+1]);return o}function mE(h,o,p){return h?.6*o*p:0}function _E(h,o){return Math.max(h?h.right-h.left:0,o?o.right-o.left:0)}function U8(h,o,p,x,C,B){const R=mE(p,C,B),j=_E(p,x)*B;let H=0;const q=gE(h)/2;for(let J=0;J<h.length-1;J++){const ne=h[J],he=h[J+1],me=ne.dist(he);if(H+me>q){const ye=(q-H)/me,Me=fr.number(ne.x,he.x,ye),Ue=fr.number(ne.y,he.y,ye),He=new zu(Me,Ue,he.angleTo(ne),J);return He._round(),!R||pE(h,He,j,R,o)?He:void 0}H+=me}}function V8(h,o,p,x,C,B,R,j,H){const q=mE(x,B,R),J=_E(x,C),ne=J*R,he=h[0].x===0||h[0].x===H||h[0].y===0||h[0].y===H;return o-ne<o/4&&(o=ne+o/4),yE(h,he?o/2*j%o:(J/2+2*B)*R*j%o,o,q,p,ne,he,!1,H)}function yE(h,o,p,x,C,B,R,j,H){const q=B/2,J=gE(h);let ne=0,he=o-p,me=[];for(let ye=0;ye<h.length-1;ye++){const Me=h[ye],Ue=h[ye+1],He=Me.dist(Ue),Ke=Ue.angleTo(Me);for(;he+p<ne+He;){he+=p;const Ze=(he-ne)/He,et=fr.number(Me.x,Ue.x,Ze),st=fr.number(Me.y,Ue.y,Ze);if(et>=0&&et<H&&st>=0&&st<H&&he-q>=0&&he+q<=J){const dt=new zu(et,st,Ke,ye);dt._round(),x&&!pE(h,dt,B,x,C)||me.push(dt)}}ne+=He}return j||me.length||R||(me=yE(h,ne/2,p,x,C,B,R,!0,H)),me}Wt("Anchor",zu);const bh=ho;function vE(h,o,p,x){const C=[],B=h.image,R=B.pixelRatio,j=B.paddedRect.w-2*bh,H=B.paddedRect.h-2*bh,q=h.right-h.left,J=h.bottom-h.top,ne=B.stretchX||[[0,j]],he=B.stretchY||[[0,H]],me=(Dt,Xt)=>Dt+Xt[1]-Xt[0],ye=ne.reduce(me,0),Me=he.reduce(me,0),Ue=j-ye,He=H-Me;let Ke=0,Ze=ye,et=0,st=Me,dt=0,Gt=Ue,tn=0,jt=He;if(B.content&&x){const Dt=B.content;Ke=wp(ne,0,Dt[0]),et=wp(he,0,Dt[1]),Ze=wp(ne,Dt[0],Dt[2]),st=wp(he,Dt[1],Dt[3]),dt=Dt[0]-Ke,tn=Dt[1]-et,Gt=Dt[2]-Dt[0]-Ze,jt=Dt[3]-Dt[1]-st}const Ft=(Dt,Xt,Ot,bt)=>{const hn=bp(Dt.stretch-Ke,Ze,q,h.left),sn=Ep(Dt.fixed-dt,Gt,Dt.stretch,ye),zn=bp(Xt.stretch-et,st,J,h.top),vi=Ep(Xt.fixed-tn,jt,Xt.stretch,Me),Mi=bp(Ot.stretch-Ke,Ze,q,h.left),Pr=Ep(Ot.fixed-dt,Gt,Ot.stretch,ye),Bo=bp(bt.stretch-et,st,J,h.top),Hs=Ep(bt.fixed-tn,jt,bt.stretch,Me),gr=new V(hn,zn),Gr=new V(Mi,zn),vs=new V(Mi,Bo),fo=new V(hn,Bo),Ws=new V(sn/R,vi/R),mr=new V(Pr/R,Hs/R),Mr=o*Math.PI/180;if(Mr){const po=Math.sin(Mr),go=Math.cos(Mr),$i=[go,-po,po,go];gr._matMult($i),Gr._matMult($i),fo._matMult($i),vs._matMult($i)}const ks=Dt.stretch+Dt.fixed,$s=Xt.stretch+Xt.fixed;return{tl:gr,tr:Gr,bl:fo,br:vs,tex:{x:B.paddedRect.x+bh+ks,y:B.paddedRect.y+bh+$s,w:Ot.stretch+Ot.fixed-ks,h:bt.stretch+bt.fixed-$s},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ws,pixelOffsetBR:mr,minFontScaleX:Gt/R/q,minFontScaleY:jt/R/J,isSDF:p}};if(x&&(B.stretchX||B.stretchY)){const Dt=xE(ne,Ue,ye),Xt=xE(he,He,Me);for(let Ot=0;Ot<Dt.length-1;Ot++){const bt=Dt[Ot],hn=Dt[Ot+1];for(let sn=0;sn<Xt.length-1;sn++)C.push(Ft(bt,Xt[sn],hn,Xt[sn+1]))}}else C.push(Ft({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:H+1}));return C}function wp(h,o,p){let x=0;for(const C of h)x+=Math.max(o,Math.min(p,C[1]))-Math.max(o,Math.min(p,C[0]));return x}function xE(h,o,p){const x=[{fixed:-bh,stretch:0}];for(const[C,B]of h){const R=x[x.length-1];x.push({fixed:C-R.stretch,stretch:R.stretch}),x.push({fixed:C-R.stretch,stretch:R.stretch+(B-C)})}return x.push({fixed:o+bh,stretch:p}),x}function bp(h,o,p,x){return h/o*p+x}function Ep(h,o,p,x){return h-o*p/x}class Tp{constructor(o,p,x,C,B,R,j,H,q,J){if(this.boxStartIndex=o.length,q){let ne=R.top,he=R.bottom;const me=R.collisionPadding;me&&(ne-=me[1],he+=me[3]);let ye=he-ne;ye>0&&(ye=Math.max(10,ye),this.circleDiameter=ye)}else{let ne=R.top*j-H[0],he=R.bottom*j+H[2],me=R.left*j-H[3],ye=R.right*j+H[1];const Me=R.collisionPadding;if(Me&&(me-=Me[0]*j,ne-=Me[1]*j,ye+=Me[2]*j,he+=Me[3]*j),J){const Ue=new V(me,ne),He=new V(ye,ne),Ke=new V(me,he),Ze=new V(ye,he),et=J*Math.PI/180;Ue._rotate(et),He._rotate(et),Ke._rotate(et),Ze._rotate(et),me=Math.min(Ue.x,He.x,Ke.x,Ze.x),ye=Math.max(Ue.x,He.x,Ke.x,Ze.x),ne=Math.min(Ue.y,He.y,Ke.y,Ze.y),he=Math.max(Ue.y,He.y,Ke.y,Ze.y)}o.emplaceBack(p.x,p.y,me,ne,ye,he,x,C,B)}this.boxEndIndex=o.length}}class j8{constructor(o=[],p=G8){if(this.data=o,this.length=this.data.length,this.compare=p,this.length>0)for(let x=(this.length>>1)-1;x>=0;x--)this._down(x)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const o=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:p,compare:x}=this,C=p[o];for(;o>0;){const B=o-1>>1,R=p[B];if(x(C,R)>=0)break;p[o]=R,o=B}p[o]=C}_down(o){const{data:p,compare:x}=this,C=this.length>>1,B=p[o];for(;o<C;){let R=1+(o<<1),j=p[R];const H=R+1;if(H<this.length&&x(p[H],j)<0&&(R=H,j=p[H]),x(j,B)>=0)break;p[o]=j,o=R}p[o]=B}}function G8(h,o){return h<o?-1:h>o?1:0}function Q8(h,o=1,p=!1){let x=1/0,C=1/0,B=-1/0,R=-1/0;const j=h[0];for(let me=0;me<j.length;me++){const ye=j[me];(!me||ye.x<x)&&(x=ye.x),(!me||ye.y<C)&&(C=ye.y),(!me||ye.x>B)&&(B=ye.x),(!me||ye.y>R)&&(R=ye.y)}const H=Math.min(B-x,R-C);let q=H/2;const J=new j8([],H8);if(H===0)return new V(x,C);for(let me=x;me<B;me+=H)for(let ye=C;ye<R;ye+=H)J.push(new Eh(me+q,ye+q,q,h));let ne=function(me){let ye=0,Me=0,Ue=0;const He=me[0];for(let Ke=0,Ze=He.length,et=Ze-1;Ke<Ze;et=Ke++){const st=He[Ke],dt=He[et],Gt=st.x*dt.y-dt.x*st.y;Me+=(st.x+dt.x)*Gt,Ue+=(st.y+dt.y)*Gt,ye+=3*Gt}return new Eh(Me/ye,Ue/ye,0,me)}(h),he=J.length;for(;J.length;){const me=J.pop();(me.d>ne.d||!ne.d)&&(ne=me,p&&console.log("found best %d after %d probes",Math.round(1e4*me.d)/1e4,he)),me.max-ne.d<=o||(q=me.h/2,J.push(new Eh(me.p.x-q,me.p.y-q,q,h)),J.push(new Eh(me.p.x+q,me.p.y-q,q,h)),J.push(new Eh(me.p.x-q,me.p.y+q,q,h)),J.push(new Eh(me.p.x+q,me.p.y+q,q,h)),he+=4)}return p&&(console.log(`num probes: ${he}`),console.log(`best distance: ${ne.d}`)),ne.p}function H8(h,o){return o.max-h.max}function Eh(h,o,p,x){this.p=new V(h,o),this.h=p,this.d=function(C,B){let R=!1,j=1/0;for(let H=0;H<B.length;H++){const q=B[H];for(let J=0,ne=q.length,he=ne-1;J<ne;he=J++){const me=q[J],ye=q[he];me.y>C.y!=ye.y>C.y&&C.x<(ye.x-me.x)*(C.y-me.y)/(ye.y-me.y)+me.x&&(R=!R),j=Math.min(j,rb(C,me,ye))}}return(R?1:-1)*Math.sqrt(j)}(this.p,x),this.max=this.d+this.h*Math.SQRT2}var ys;l.TextAnchorEnum=void 0,(ys=l.TextAnchorEnum||(l.TextAnchorEnum={}))[ys.center=1]="center",ys[ys.left=2]="left",ys[ys.right=3]="right",ys[ys.top=4]="top",ys[ys.bottom=5]="bottom",ys[ys["top-left"]=6]="top-left",ys[ys["top-right"]=7]="top-right",ys[ys["bottom-left"]=8]="bottom-left",ys[ys["bottom-right"]=9]="bottom-right";const Fu=7,u1=Number.POSITIVE_INFINITY;function wE(h,o){return o[1]!==u1?function(p,x,C){let B=0,R=0;switch(x=Math.abs(x),C=Math.abs(C),p){case"top-right":case"top-left":case"top":R=C-Fu;break;case"bottom-right":case"bottom-left":case"bottom":R=-C+Fu}switch(p){case"top-right":case"bottom-right":case"right":B=-x;break;case"top-left":case"bottom-left":case"left":B=x}return[B,R]}(h,o[0],o[1]):function(p,x){let C=0,B=0;x<0&&(x=0);const R=x/Math.SQRT2;switch(p){case"top-right":case"top-left":B=R-Fu;break;case"bottom-right":case"bottom-left":B=-R+Fu;break;case"bottom":B=-x+Fu;break;case"top":B=x-Fu}switch(p){case"top-right":case"bottom-right":C=-R;break;case"top-left":case"bottom-left":C=R;break;case"left":C=x;break;case"right":C=-x}return[C,B]}(h,o[0])}function bE(h,o,p){var x;const C=h.layout,B=(x=C.get("text-variable-anchor-offset"))===null||x===void 0?void 0:x.evaluate(o,{},p);if(B){const j=B.values,H=[];for(let q=0;q<j.length;q+=2){const J=H[q]=j[q],ne=j[q+1].map(he=>he*Cr);J.startsWith("top")?ne[1]-=Fu:J.startsWith("bottom")&&(ne[1]+=Fu),H[q+1]=ne}return new On(H)}const R=C.get("text-variable-anchor");if(R){let j;j=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[C.get("text-radial-offset").evaluate(o,{},p)*Cr,u1]:C.get("text-offset").evaluate(o,{},p).map(q=>q*Cr);const H=[];for(const q of R)H.push(q,wE(q,j));return new On(H)}return null}function c1(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function W8(h,o,p,x,C,B,R,j,H,q,J){let ne=B.textMaxSize.evaluate(o,{});ne===void 0&&(ne=R);const he=h.layers[0].layout,me=he.get("icon-offset").evaluate(o,{},J),ye=TE(p.horizontal),Me=R/24,Ue=h.tilePixelRatio*Me,He=h.tilePixelRatio*ne/24,Ke=h.tilePixelRatio*j,Ze=h.tilePixelRatio*he.get("symbol-spacing"),et=he.get("text-padding")*h.tilePixelRatio,st=function(bt,hn,sn,zn=1){const vi=bt.get("icon-padding").evaluate(hn,{},sn),Mi=vi&&vi.values;return[Mi[0]*zn,Mi[1]*zn,Mi[2]*zn,Mi[3]*zn]}(he,o,J,h.tilePixelRatio),dt=he.get("text-max-angle")/180*Math.PI,Gt=he.get("text-rotation-alignment")!=="viewport"&&he.get("symbol-placement")!=="point",tn=he.get("icon-rotation-alignment")==="map"&&he.get("symbol-placement")!=="point",jt=he.get("symbol-placement"),Ft=Ze/2,Dt=he.get("icon-text-fit");let Xt;x&&Dt!=="none"&&(h.allowVerticalPlacement&&p.vertical&&(Xt=Zb(x,p.vertical,Dt,he.get("icon-text-fit-padding"),me,Me)),ye&&(x=Zb(x,ye,Dt,he.get("icon-text-fit-padding"),me,Me)));const Ot=(bt,hn)=>{hn.x<0||hn.x>=Fi||hn.y<0||hn.y>=Fi||function(sn,zn,vi,Mi,Pr,Bo,Hs,gr,Gr,vs,fo,Ws,mr,Mr,ks,$s,po,go,$i,xs,Vn,Ro,ws,Zs,qa){const DA=sn.addToLineVertexArray(zn,vi);let BA,Zl,Ya,va,mo=0,ql=0,of=0,ME=0,y1=-1,v1=-1;const Yl={};let IE=ga("");if(sn.allowVerticalPlacement&&Mi.vertical){const Ls=gr.layout.get("text-rotate").evaluate(Vn,{},Zs)+90;Ya=new Tp(Gr,zn,vs,fo,Ws,Mi.vertical,mr,Mr,ks,Ls),Hs&&(va=new Tp(Gr,zn,vs,fo,Ws,Hs,po,go,ks,Ls))}if(Pr){const Ls=gr.layout.get("icon-rotate").evaluate(Vn,{}),xa=gr.layout.get("icon-text-fit")!=="none",Sc=vE(Pr,Ls,ws,xa),OA=Hs?vE(Hs,Ls,ws,xa):void 0;Zl=new Tp(Gr,zn,vs,fo,Ws,Pr,po,go,!1,Ls),mo=4*Sc.length;const Cc=sn.iconSizeData;let cl=null;Cc.kind==="source"?(cl=[ul*gr.layout.get("icon-size").evaluate(Vn,{})],cl[0]>Ru&&at(`${sn.layerIds[0]}: Value for "icon-size" is >= ${tf}. Reduce your "icon-size".`)):Cc.kind==="composite"&&(cl=[ul*Ro.compositeIconSizes[0].evaluate(Vn,{},Zs),ul*Ro.compositeIconSizes[1].evaluate(Vn,{},Zs)],(cl[0]>Ru||cl[1]>Ru)&&at(`${sn.layerIds[0]}: Value for "icon-size" is >= ${tf}. Reduce your "icon-size".`)),sn.addSymbols(sn.icon,Sc,cl,xs,$i,Vn,l.WritingMode.none,zn,DA.lineStartIndex,DA.lineLength,-1,Zs),y1=sn.icon.placedSymbolArray.length-1,OA&&(ql=4*OA.length,sn.addSymbols(sn.icon,OA,cl,xs,$i,Vn,l.WritingMode.vertical,zn,DA.lineStartIndex,DA.lineLength,-1,Zs),v1=sn.icon.placedSymbolArray.length-1)}const kE=Object.keys(Mi.horizontal);for(const Ls of kE){const xa=Mi.horizontal[Ls];if(!BA){IE=ga(xa.text);const OA=gr.layout.get("text-rotate").evaluate(Vn,{},Zs);BA=new Tp(Gr,zn,vs,fo,Ws,xa,mr,Mr,ks,OA)}const Sc=xa.positionedLines.length===1;if(of+=EE(sn,zn,xa,Bo,gr,ks,Vn,$s,DA,Mi.vertical?l.WritingMode.horizontal:l.WritingMode.horizontalOnly,Sc?kE:[Ls],Yl,y1,Ro,Zs),Sc)break}Mi.vertical&&(ME+=EE(sn,zn,Mi.vertical,Bo,gr,ks,Vn,$s,DA,l.WritingMode.vertical,["vertical"],Yl,v1,Ro,Zs));const q8=BA?BA.boxStartIndex:sn.collisionBoxArray.length,Y8=BA?BA.boxEndIndex:sn.collisionBoxArray.length,X8=Ya?Ya.boxStartIndex:sn.collisionBoxArray.length,K8=Ya?Ya.boxEndIndex:sn.collisionBoxArray.length,J8=Zl?Zl.boxStartIndex:sn.collisionBoxArray.length,eD=Zl?Zl.boxEndIndex:sn.collisionBoxArray.length,tD=va?va.boxStartIndex:sn.collisionBoxArray.length,nD=va?va.boxEndIndex:sn.collisionBoxArray.length;let RA=-1;const Cp=(Ls,xa)=>Ls&&Ls.circleDiameter?Math.max(Ls.circleDiameter,xa):xa;RA=Cp(BA,RA),RA=Cp(Ya,RA),RA=Cp(Zl,RA),RA=Cp(va,RA);const LE=RA>-1?1:0;LE&&(RA*=qa/Cr),sn.glyphOffsetArray.length>=wh.MAX_GLYPHS&&at("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Vn.sortKey!==void 0&&sn.addToSortKeyRanges(sn.symbolInstances.length,Vn.sortKey);const iD=bE(gr,Vn,Zs),[rD,sD]=function(Ls,xa){const Sc=Ls.length,OA=xa==null?void 0:xa.values;if((OA==null?void 0:OA.length)>0)for(let Cc=0;Cc<OA.length;Cc+=2){const cl=OA[Cc+1];Ls.emplaceBack(l.TextAnchorEnum[OA[Cc]],cl[0],cl[1])}return[Sc,Ls.length]}(sn.textAnchorOffsets,iD);sn.symbolInstances.emplaceBack(zn.x,zn.y,Yl.right>=0?Yl.right:-1,Yl.center>=0?Yl.center:-1,Yl.left>=0?Yl.left:-1,Yl.vertical||-1,y1,v1,IE,q8,Y8,X8,K8,J8,eD,tD,nD,vs,of,ME,mo,ql,LE,0,mr,RA,rD,sD)}(h,hn,bt,p,x,C,Xt,h.layers[0],h.collisionBoxArray,o.index,o.sourceLayerIndex,h.index,Ue,[et,et,et,et],Gt,H,Ke,st,tn,me,o,B,q,J,R)};if(jt==="line")for(const bt of dE(o.geometry,0,0,Fi,Fi)){const hn=V8(bt,Ze,dt,p.vertical||ye,x,24,He,h.overscaling,Fi);for(const sn of hn)ye&&$8(h,ye.text,Ft,sn)||Ot(bt,sn)}else if(jt==="line-center"){for(const bt of o.geometry)if(bt.length>1){const hn=U8(bt,dt,p.vertical||ye,x,24,He);hn&&Ot(bt,hn)}}else if(o.type==="Polygon")for(const bt of G_(o.geometry,0)){const hn=Q8(bt,16);Ot(bt[0],new zu(hn.x,hn.y,0))}else if(o.type==="LineString")for(const bt of o.geometry)Ot(bt,new zu(bt[0].x,bt[0].y,0));else if(o.type==="Point")for(const bt of o.geometry)for(const hn of bt)Ot([hn],new zu(hn.x,hn.y,0))}function EE(h,o,p,x,C,B,R,j,H,q,J,ne,he,me,ye){const Me=function(Ke,Ze,et,st,dt,Gt,tn,jt){const Ft=st.layout.get("text-rotate").evaluate(Gt,{})*Math.PI/180,Dt=[];for(const Xt of Ze.positionedLines)for(const Ot of Xt.positionedGlyphs){if(!Ot.rect)continue;const bt=Ot.rect||{};let hn=Vb+1,sn=!0,zn=1,vi=0;const Mi=(dt||jt)&&Ot.vertical,Pr=Ot.metrics.advance*Ot.scale/2;if(jt&&Ze.verticalizable&&(vi=Xt.lineOffset/2-(Ot.imageName?-(Cr-Ot.metrics.width*Ot.scale)/2:(Ot.scale-1)*Cr)),Ot.imageName){const $i=tn[Ot.imageName];sn=$i.sdf,zn=$i.pixelRatio,hn=ho/zn}const Bo=dt?[Ot.x+Pr,Ot.y]:[0,0];let Hs=dt?[0,0]:[Ot.x+Pr+et[0],Ot.y+et[1]-vi],gr=[0,0];Mi&&(gr=Hs,Hs=[0,0]);const Gr=(Ot.metrics.left-hn)*Ot.scale-Pr+Hs[0],vs=(-Ot.metrics.top-hn)*Ot.scale+Hs[1],fo=Gr+bt.w*Ot.scale/zn,Ws=vs+bt.h*Ot.scale/zn,mr=new V(Gr,vs),Mr=new V(fo,vs),ks=new V(Gr,Ws),$s=new V(fo,Ws);if(Mi){const $i=new V(-Pr,Pr-J0),xs=-Math.PI/2,Vn=Cr/2-Pr,Ro=new V(5-J0-Vn,-(Ot.imageName?Vn:0)),ws=new V(...gr);mr._rotateAround(xs,$i)._add(Ro)._add(ws),Mr._rotateAround(xs,$i)._add(Ro)._add(ws),ks._rotateAround(xs,$i)._add(Ro)._add(ws),$s._rotateAround(xs,$i)._add(Ro)._add(ws)}if(Ft){const $i=Math.sin(Ft),xs=Math.cos(Ft),Vn=[xs,-$i,$i,xs];mr._matMult(Vn),Mr._matMult(Vn),ks._matMult(Vn),$s._matMult(Vn)}const po=new V(0,0),go=new V(0,0);Dt.push({tl:mr,tr:Mr,bl:ks,br:$s,tex:bt,writingMode:Ze.writingMode,glyphOffset:Bo,sectionIndex:Ot.sectionIndex,isSDF:sn,pixelOffsetTL:po,pixelOffsetBR:go,minFontScaleX:0,minFontScaleY:0})}return Dt}(0,p,j,C,B,R,x,h.allowVerticalPlacement),Ue=h.textSizeData;let He=null;Ue.kind==="source"?(He=[ul*C.layout.get("text-size").evaluate(R,{})],He[0]>Ru&&at(`${h.layerIds[0]}: Value for "text-size" is >= ${tf}. Reduce your "text-size".`)):Ue.kind==="composite"&&(He=[ul*me.compositeTextSizes[0].evaluate(R,{},ye),ul*me.compositeTextSizes[1].evaluate(R,{},ye)],(He[0]>Ru||He[1]>Ru)&&at(`${h.layerIds[0]}: Value for "text-size" is >= ${tf}. Reduce your "text-size".`)),h.addSymbols(h.text,Me,He,j,B,R,q,o,H.lineStartIndex,H.lineLength,he,ye);for(const Ke of J)ne[Ke]=h.text.placedSymbolArray.length-1;return 4*Me.length}function TE(h){for(const o in h)return h[o];return null}function $8(h,o,p,x){const C=h.compareText;if(o in C){const B=C[o];for(let R=B.length-1;R>=0;R--)if(x.dist(B[R])<p)return!0}else C[o]=[];return C[o].push(x),!1}const SE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class h1{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[p,x]=new Uint8Array(o,0,2);if(p!==219)throw new Error("Data does not appear to be in a KDBush format.");const C=x>>4;if(C!==1)throw new Error(`Got v${C} data when expected v1.`);const B=SE[15&x];if(!B)throw new Error("Unrecognized array type.");const[R]=new Uint16Array(o,2,1),[j]=new Uint32Array(o,4,1);return new h1(j,R,B,o)}constructor(o,p=64,x=Float64Array,C){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+p,2),65535),this.ArrayType=x,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const B=SE.indexOf(this.ArrayType),R=2*o*this.ArrayType.BYTES_PER_ELEMENT,j=o*this.IndexArrayType.BYTES_PER_ELEMENT,H=(8-j%8)%8;if(B<0)throw new Error(`Unexpected typed array class: ${x}.`);C&&C instanceof ArrayBuffer?(this.data=C,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+j+H,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+R+j+H),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+j+H,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+B]),new Uint16Array(this.data,2,1)[0]=p,new Uint32Array(this.data,4,1)[0]=o)}add(o,p){const x=this._pos>>1;return this.ids[x]=x,this.coords[this._pos++]=o,this.coords[this._pos++]=p,x}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return f1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,p,x,C){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:B,coords:R,nodeSize:j}=this,H=[0,B.length-1,0],q=[];for(;H.length;){const J=H.pop()||0,ne=H.pop()||0,he=H.pop()||0;if(ne-he<=j){for(let Ue=he;Ue<=ne;Ue++){const He=R[2*Ue],Ke=R[2*Ue+1];He>=o&&He<=x&&Ke>=p&&Ke<=C&&q.push(B[Ue])}continue}const me=he+ne>>1,ye=R[2*me],Me=R[2*me+1];ye>=o&&ye<=x&&Me>=p&&Me<=C&&q.push(B[me]),(J===0?o<=ye:p<=Me)&&(H.push(he),H.push(me-1),H.push(1-J)),(J===0?x>=ye:C>=Me)&&(H.push(me+1),H.push(ne),H.push(1-J))}return q}within(o,p,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:B,nodeSize:R}=this,j=[0,C.length-1,0],H=[],q=x*x;for(;j.length;){const J=j.pop()||0,ne=j.pop()||0,he=j.pop()||0;if(ne-he<=R){for(let Ue=he;Ue<=ne;Ue++)PE(B[2*Ue],B[2*Ue+1],o,p)<=q&&H.push(C[Ue]);continue}const me=he+ne>>1,ye=B[2*me],Me=B[2*me+1];PE(ye,Me,o,p)<=q&&H.push(C[me]),(J===0?o-x<=ye:p-x<=Me)&&(j.push(he),j.push(me-1),j.push(1-J)),(J===0?o+x>=ye:p+x>=Me)&&(j.push(me+1),j.push(ne),j.push(1-J))}return H}}function f1(h,o,p,x,C,B){if(C-x<=p)return;const R=x+C>>1;CE(h,o,R,x,C,B),f1(h,o,p,x,R-1,1-B),f1(h,o,p,R+1,C,1-B)}function CE(h,o,p,x,C,B){for(;C>x;){if(C-x>600){const q=C-x+1,J=p-x+1,ne=Math.log(q),he=.5*Math.exp(2*ne/3),me=.5*Math.sqrt(ne*he*(q-he)/q)*(J-q/2<0?-1:1);CE(h,o,p,Math.max(x,Math.floor(p-J*he/q+me)),Math.min(C,Math.floor(p+(q-J)*he/q+me)),B)}const R=o[2*p+B];let j=x,H=C;for(rf(h,o,x,p),o[2*C+B]>R&&rf(h,o,x,C);j<H;){for(rf(h,o,j,H),j++,H--;o[2*j+B]<R;)j++;for(;o[2*H+B]>R;)H--}o[2*x+B]===R?rf(h,o,x,H):(H++,rf(h,o,H,C)),H<=p&&(x=H+1),p<=H&&(C=H-1)}}function rf(h,o,p,x){d1(h,p,x),d1(o,2*p,2*x),d1(o,2*p+1,2*x+1)}function d1(h,o,p){const x=h[o];h[o]=h[p],h[p]=x}function PE(h,o,p,x){const C=h-p,B=o-x;return C*C+B*B}var p1;l.PerformanceMarkers=void 0,(p1=l.PerformanceMarkers||(l.PerformanceMarkers={})).create="create",p1.load="load",p1.fullLoad="fullLoad";let Sp=null,sf=[];const g1=1e3/60,m1="loadTime",_1="fullLoadTime",Z8={mark(h){performance.mark(h)},frame(h){const o=h;Sp!=null&&sf.push(o-Sp),Sp=o},clearMetrics(){Sp=null,sf=[],performance.clearMeasures(m1),performance.clearMeasures(_1);for(const h in l.PerformanceMarkers)performance.clearMarks(l.PerformanceMarkers[h])},getPerformanceMetrics(){performance.measure(m1,l.PerformanceMarkers.create,l.PerformanceMarkers.load),performance.measure(_1,l.PerformanceMarkers.create,l.PerformanceMarkers.fullLoad);const h=performance.getEntriesByName(m1)[0].duration,o=performance.getEntriesByName(_1)[0].duration,p=sf.length,x=1/(sf.reduce((B,R)=>B+R,0)/p/1e3),C=sf.filter(B=>B>g1).reduce((B,R)=>B+(R-g1)/g1,0);return{loadTime:h,fullLoadTime:o,fps:x,percentDroppedFrames:C/(p+C)*100,totalFrames:p}}};l.AJAXError=Bn,l.ARRAY_TYPE=gh,l.Actor=class{constructor(h,o,p){this.receive=x=>{const C=x.data,B=C.id;if(B&&(!C.targetMapId||this.mapId===C.targetMapId))if(C.type==="<cancel>"){delete this.tasks[B];const R=this.cancelCallbacks[B];delete this.cancelCallbacks[B],R&&R()}else St()||C.mustQueue?(this.tasks[B]=C,this.taskQueue.push(B),this.invoker.trigger()):this.processTask(B,C)},this.process=()=>{if(!this.taskQueue.length)return;const x=this.taskQueue.shift(),C=this.tasks[x];delete this.tasks[x],this.taskQueue.length&&this.invoker.trigger(),C&&this.processTask(x,C)},this.target=h,this.parent=o,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new F8(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=St()?h:window}send(h,o,p,x,C=!1){const B=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[B]=p);const R=Kt(this.globalScope)?void 0:[];return this.target.postMessage({id:B,type:h,hasCallback:!!p,targetMapId:x,mustQueue:C,sourceMapId:this.mapId,data:bA(o,R)},R),{cancel:()=>{p&&delete this.callbacks[B],this.target.postMessage({id:B,type:"<cancel>",targetMapId:x,sourceMapId:this.mapId})}}}processTask(h,o){if(o.type==="<response>"){const p=this.callbacks[h];delete this.callbacks[h],p&&(o.error?p(da(o.error)):p(null,da(o.data)))}else{let p=!1;const x=Kt(this.globalScope)?void 0:[],C=o.hasCallback?(j,H)=>{p=!0,delete this.cancelCallbacks[h],this.target.postMessage({id:h,type:"<response>",sourceMapId:this.mapId,error:j?bA(j):null,data:bA(H,x)},x)}:j=>{p=!0};let B=null;const R=da(o.data);if(this.parent[o.type])B=this.parent[o.type](o.sourceMapId,R,C);else if(this.parent.getWorkerSource){const j=o.type.split(".");B=this.parent.getWorkerSource(o.sourceMapId,j[0],R.source)[j[1]](R,C)}else C(new Error(`Could not find function ${o.type}`));!p&&B&&B.cancel&&(this.cancelCallbacks[h]=B.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.AlphaImage=H0,l.CanonicalTileID=l1,l.CollisionBoxArray=c,l.CollisionCircleLayoutArray=class extends pe{},l.Color=pt,l.DEMData=AE,l.DataConstantProperty=gt,l.DictionaryCoder=lE,l.EXTENT=Fi,l.ErrorEvent=vr,l.EvaluationParameters=ci,l.Event=si,l.Evented=Lr,l.FeatureIndex=cE,l.FillBucket=W_,l.FillExtrusionBucket=Z_,l.GeoJSONFeature=uE,l.ImageAtlas=Gb,l.ImagePosition=J_,l.KDBush=h1,l.LineBucket=q_,l.LineStripIndexArray=class extends T{},l.LngLat=Ou,l.MercatorCoordinate=xp,l.ONE_EM=Cr,l.OverscaledTileID=ya,l.PerformanceUtils=Z8,l.Point=V,l.Pos3dArray=class extends Pi{},l.PosArray=de,l.Properties=br,l.Protobuf=X_,l.QuadTriangleArray=class extends Te{},l.RGBAImage=_a,l.RasterBoundsArray=class extends _{},l.RequestPerformance=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},l.SegmentVector=wt,l.SymbolBucket=wh,l.Transitionable=Ql,l.TriangleIndexArray=ct,l.Uniform1f=Tr,l.Uniform1i=class extends nr{constructor(h,o){super(h,o),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},l.Uniform2f=class extends nr{constructor(h,o){super(h,o),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},l.Uniform3f=class extends nr{constructor(h,o){super(h,o),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},l.Uniform4f=ms,l.UniformColor=ku,l.UniformMatrix4f=class extends nr{constructor(h,o){super(h,o),this.current=Sr}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let o=1;o<16;o++)if(h[o]!==this.current[o]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},l.UnwrappedTileID=aE,l.ValidationError=It,l.ZoomHistory=zl,l.addDynamicAttributes=i1,l.arrayBufferToImage=function(h,o){const p=new Image;p.onload=()=>{o(null,p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=ei})},p.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const x=new Blob([new Uint8Array(h)],{type:"image/png"});p.src=h.byteLength?URL.createObjectURL(x):ei},l.arrayBufferToImageBitmap=function(h,o){const p=new Blob([new Uint8Array(h)],{type:"image/png"});createImageBitmap(p).then(x=>{o(null,x)}).catch(x=>{o(new Error(`Could not load image because of ${x.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.asyncAll=function(h,o,p){if(!h.length)return p(null,[]);let x=h.length;const C=new Array(h.length);let B=null;h.forEach((R,j)=>{o(R,(H,q)=>{H&&(B=H),C[j]=q,--x==0&&p(B,C)})})},l.bezier=ue,l.browser=dn,l.clamp=ie,l.clipLine=dE,l.clone=function(h){var o=new gh(16);return o[0]=h[0],o[1]=h[1],o[2]=h[2],o[3]=h[3],o[4]=h[4],o[5]=h[5],o[6]=h[6],o[7]=h[7],o[8]=h[8],o[9]=h[9],o[10]=h[10],o[11]=h[11],o[12]=h[12],o[13]=h[13],o[14]=h[14],o[15]=h[15],o},l.clone$1=tt,l.collisionCircleLayout=h8,l.config=vn,l.copy=function(h,o){return h[0]=o[0],h[1]=o[1],h[2]=o[2],h[3]=o[3],h[4]=o[4],h[5]=o[5],h[6]=o[6],h[7]=o[7],h[8]=o[8],h[9]=o[9],h[10]=o[10],h[11]=o[11],h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15],h},l.create=function(){var h=new gh(16);return gh!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},l.createExpression=bn,l.createFilter=Va,l.createLayout=pi,l.createStyleLayer=function(h){if(h.type==="custom")return new z8(h);switch(h.type){case"background":return new B8(h);case"circle":return new y6(h);case"fill":return new N6(h);case"fill-extrusion":return new e8(h);case"heatmap":return new x6(h);case"hillshade":return new b6(h);case"line":return new A8(h);case"raster":return new O8(h);case"symbol":return new vp(h)}},l.deepEqual=function h(o,p){if(Array.isArray(o)){if(!Array.isArray(p)||o.length!==p.length)return!1;for(let x=0;x<o.length;x++)if(!h(o[x],p[x]))return!1;return!0}if(typeof o=="object"&&o!==null&&p!==null){if(typeof p!="object"||Object.keys(o).length!==Object.keys(p).length)return!1;for(const x in o)if(!h(o[x],p[x]))return!1;return!0}return o===p},l.defaultEasing=we,l.derefLayers=function(h){h=h.slice();const o=Object.create(null);for(let p=0;p<h.length;p++)o[h[p].id]=h[p];for(let p=0;p<h.length;p++)"ref"in h[p]&&(h[p]=rs(h[p],o[h[p].ref]));return h},l.diffStyles=function(h,o){if(!h)return[{command:gn.setStyle,args:[o]}];let p=[];try{if(!Ln(h.version,o.version))return[{command:gn.setStyle,args:[o]}];Ln(h.center,o.center)||p.push({command:gn.setCenter,args:[o.center]}),Ln(h.zoom,o.zoom)||p.push({command:gn.setZoom,args:[o.zoom]}),Ln(h.bearing,o.bearing)||p.push({command:gn.setBearing,args:[o.bearing]}),Ln(h.pitch,o.pitch)||p.push({command:gn.setPitch,args:[o.pitch]}),Ln(h.sprite,o.sprite)||p.push({command:gn.setSprite,args:[o.sprite]}),Ln(h.glyphs,o.glyphs)||p.push({command:gn.setGlyphs,args:[o.glyphs]}),Ln(h.transition,o.transition)||p.push({command:gn.setTransition,args:[o.transition]}),Ln(h.light,o.light)||p.push({command:gn.setLight,args:[o.light]});const x={},C=[];(function(R,j,H,q){let J;for(J in j=j||{},R=R||{})Object.prototype.hasOwnProperty.call(R,J)&&(Object.prototype.hasOwnProperty.call(j,J)||Ns(J,H,q));for(J in j)Object.prototype.hasOwnProperty.call(j,J)&&(Object.prototype.hasOwnProperty.call(R,J)?Ln(R[J],j[J])||(R[J].type==="geojson"&&j[J].type==="geojson"&&Qn(R,j,J)?H.push({command:gn.setGeoJSONSourceData,args:[J,j[J].data]}):ro(J,j,H,q)):ji(J,j,H))})(h.sources,o.sources,C,x);const B=[];h.layers&&h.layers.forEach(R=>{x[R.source]?p.push({command:gn.removeLayer,args:[R.id]}):B.push(R)}),p=p.concat(C),function(R,j,H){j=j||[];const q=(R=R||[]).map(so),J=j.map(so),ne=R.reduce(Gi,{}),he=j.reduce(Gi,{}),me=q.slice(),ye=Object.create(null);let Me,Ue,He,Ke,Ze,et,st;for(Me=0,Ue=0;Me<q.length;Me++)He=q[Me],Object.prototype.hasOwnProperty.call(he,He)?Ue++:(H.push({command:gn.removeLayer,args:[He]}),me.splice(me.indexOf(He,Ue),1));for(Me=0,Ue=0;Me<J.length;Me++)He=J[J.length-1-Me],me[me.length-1-Me]!==He&&(Object.prototype.hasOwnProperty.call(ne,He)?(H.push({command:gn.removeLayer,args:[He]}),me.splice(me.lastIndexOf(He,me.length-Ue),1)):Ue++,et=me[me.length-Me],H.push({command:gn.addLayer,args:[he[He],et]}),me.splice(me.length-Me,0,He),ye[He]=!0);for(Me=0;Me<J.length;Me++)if(He=J[Me],Ke=ne[He],Ze=he[He],!ye[He]&&!Ln(Ke,Ze))if(Ln(Ke.source,Ze.source)&&Ln(Ke["source-layer"],Ze["source-layer"])&&Ln(Ke.type,Ze.type)){for(st in Jn(Ke.layout,Ze.layout,H,He,null,gn.setLayoutProperty),Jn(Ke.paint,Ze.paint,H,He,null,gn.setPaintProperty),Ln(Ke.filter,Ze.filter)||H.push({command:gn.setFilter,args:[He,Ze.filter]}),Ln(Ke.minzoom,Ze.minzoom)&&Ln(Ke.maxzoom,Ze.maxzoom)||H.push({command:gn.setLayerZoomRange,args:[He,Ze.minzoom,Ze.maxzoom]}),Ke)Object.prototype.hasOwnProperty.call(Ke,st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&(st.indexOf("paint.")===0?Jn(Ke[st],Ze[st],H,He,st.slice(6),gn.setPaintProperty):Ln(Ke[st],Ze[st])||H.push({command:gn.setLayerProperty,args:[He,st,Ze[st]]}));for(st in Ze)Object.prototype.hasOwnProperty.call(Ze,st)&&!Object.prototype.hasOwnProperty.call(Ke,st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&(st.indexOf("paint.")===0?Jn(Ke[st],Ze[st],H,He,st.slice(6),gn.setPaintProperty):Ln(Ke[st],Ze[st])||H.push({command:gn.setLayerProperty,args:[He,st,Ze[st]]}))}else H.push({command:gn.removeLayer,args:[He]}),et=me[me.lastIndexOf(He)+1],H.push({command:gn.addLayer,args:[Ze,et]})}(B,o.layers,p)}catch(x){console.warn("Unable to compute style diff:",x),p=[{command:gn.setStyle,args:[o]}]}return p},l.dot=function(h,o){return h[0]*o[0]+h[1]*o[1]+h[2]*o[2]+h[3]*o[3]},l.earthRadius=a1,l.emitValidationErrors=fa,l.emptyStyle=function(){const h={},o=ut.$version;for(const p in ut.$root){const x=ut.$root[p];if(x.required){let C=null;C=p==="version"?o:x.type==="array"?[]:{},C!=null&&(h[p]=C)}}return h},l.equals=function(h,o){var p=h[0],x=h[1],C=h[2],B=h[3],R=h[4],j=h[5],H=h[6],q=h[7],J=h[8],ne=h[9],he=h[10],me=h[11],ye=h[12],Me=h[13],Ue=h[14],He=h[15],Ke=o[0],Ze=o[1],et=o[2],st=o[3],dt=o[4],Gt=o[5],tn=o[6],jt=o[7],Ft=o[8],Dt=o[9],Xt=o[10],Ot=o[11],bt=o[12],hn=o[13],sn=o[14],zn=o[15];return Math.abs(p-Ke)<=Qs*Math.max(1,Math.abs(p),Math.abs(Ke))&&Math.abs(x-Ze)<=Qs*Math.max(1,Math.abs(x),Math.abs(Ze))&&Math.abs(C-et)<=Qs*Math.max(1,Math.abs(C),Math.abs(et))&&Math.abs(B-st)<=Qs*Math.max(1,Math.abs(B),Math.abs(st))&&Math.abs(R-dt)<=Qs*Math.max(1,Math.abs(R),Math.abs(dt))&&Math.abs(j-Gt)<=Qs*Math.max(1,Math.abs(j),Math.abs(Gt))&&Math.abs(H-tn)<=Qs*Math.max(1,Math.abs(H),Math.abs(tn))&&Math.abs(q-jt)<=Qs*Math.max(1,Math.abs(q),Math.abs(jt))&&Math.abs(J-Ft)<=Qs*Math.max(1,Math.abs(J),Math.abs(Ft))&&Math.abs(ne-Dt)<=Qs*Math.max(1,Math.abs(ne),Math.abs(Dt))&&Math.abs(he-Xt)<=Qs*Math.max(1,Math.abs(he),Math.abs(Xt))&&Math.abs(me-Ot)<=Qs*Math.max(1,Math.abs(me),Math.abs(Ot))&&Math.abs(ye-bt)<=Qs*Math.max(1,Math.abs(ye),Math.abs(bt))&&Math.abs(Me-hn)<=Qs*Math.max(1,Math.abs(Me),Math.abs(hn))&&Math.abs(Ue-sn)<=Qs*Math.max(1,Math.abs(Ue),Math.abs(sn))&&Math.abs(He-zn)<=Qs*Math.max(1,Math.abs(He),Math.abs(zn))},l.evaluateSizeForFeature=function(h,{uSize:o,uSizeT:p},{lowerSize:x,upperSize:C}){return h.kind==="source"?x/ul:h.kind==="composite"?fr.number(x/ul,C/ul,p):o},l.evaluateSizeForZoom=function(h,o){let p=0,x=0;if(h.kind==="constant")x=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:C,minZoom:B,maxZoom:R}=h,j=C?ie(Fr.interpolationFactor(C,o,B,R),0,1):0;h.kind==="camera"?x=fr.number(h.minSize,h.maxSize,j):p=j}return{uSizeT:p,uSize:x}},l.evented=Vl,l.extend=ce,l.filterObject=qe,l.findLineIntersection=function(h,o,p,x){const C=o.y-h.y,B=o.x-h.x,R=x.y-p.y,j=x.x-p.x,H=R*B-j*C;if(H===0)return null;const q=(j*(h.y-p.y)-R*(h.x-p.x))/H;return new V(h.x+q*B,h.y+q*C)},l.fromScaling=function(h,o){return h[0]=o[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=o[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=o[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.getAnchorAlignment=t1,l.getAnchorJustification=c1,l.getArrayBuffer=qi,l.getDefaultExportFromCjs=S,l.getJSON=function(h,o){return Hr(ce(h,{type:"json"}),o)},l.getOverlapMode=n1,l.getProtocolAction=wi,l.getRTLTextPluginStatus=jl,l.getReferrer=Tn,l.getVideo=function(h,o){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){o(null,p)};for(let x=0;x<h.length;x++){const C=window.document.createElement("source");ti(h[x])||(p.crossOrigin="Anonymous"),C.src=h[x],p.appendChild(C)}return{cancel:()=>{}}},l.groupByLayout=function(h,o){const p={};for(let C=0;C<h.length;C++){const B=o&&o[h[C].id]||Nr(h[C]);o&&(o[h[C].id]=B);let R=p[B];R||(R=p[B]=[]),R.push(h[C])}const x=[];for(const C in p)x.push(p[C]);return x},l.identity=O_,l.interpolate=fr,l.invert=function(h,o){var p=o[0],x=o[1],C=o[2],B=o[3],R=o[4],j=o[5],H=o[6],q=o[7],J=o[8],ne=o[9],he=o[10],me=o[11],ye=o[12],Me=o[13],Ue=o[14],He=o[15],Ke=p*j-x*R,Ze=p*H-C*R,et=p*q-B*R,st=x*H-C*j,dt=x*q-B*j,Gt=C*q-B*H,tn=J*Me-ne*ye,jt=J*Ue-he*ye,Ft=J*He-me*ye,Dt=ne*Ue-he*Me,Xt=ne*He-me*Me,Ot=he*He-me*Ue,bt=Ke*Ot-Ze*Xt+et*Dt+st*Ft-dt*jt+Gt*tn;return bt?(h[0]=(j*Ot-H*Xt+q*Dt)*(bt=1/bt),h[1]=(C*Xt-x*Ot-B*Dt)*bt,h[2]=(Me*Gt-Ue*dt+He*st)*bt,h[3]=(he*dt-ne*Gt-me*st)*bt,h[4]=(H*Ft-R*Ot-q*jt)*bt,h[5]=(p*Ot-C*Ft+B*jt)*bt,h[6]=(Ue*et-ye*Gt-He*Ze)*bt,h[7]=(J*Gt-he*et+me*Ze)*bt,h[8]=(R*Xt-j*Ft+q*tn)*bt,h[9]=(x*Ft-p*Xt-B*tn)*bt,h[10]=(ye*dt-Me*et+He*Ke)*bt,h[11]=(ne*et-J*dt-me*Ke)*bt,h[12]=(j*jt-R*Dt-H*tn)*bt,h[13]=(p*Dt-x*jt+C*tn)*bt,h[14]=(Me*Ze-ye*st-Ue*Ke)*bt,h[15]=(J*st-ne*Ze+he*Ke)*bt,h):null},l.isImageBitmap=pn,l.isSafari=Kt,l.isWorker=St,l.keysDifference=function(h,o){const p=[];for(const x in h)x in o||p.push(x);return p},l.lazyLoadRTLTextPlugin=function(){Xr.isLoading()||Xr.isLoaded()||jl()!=="deferred"||Gl()},l.makeRequest=Hr,l.mapObject=Ne,l.mercatorXfromLng=iE,l.mercatorYfromLat=rE,l.mercatorZfromAltitude=sE,l.mul=_6,l.mul$1=function(h,o,p){return h[0]=o[0]*p[0],h[1]=o[1]*p[1],h[2]=o[2]*p[2],h[3]=o[3]*p[3],h},l.multiply=Ab,l.nextPowerOfTwo=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},l.operations=gn,l.ortho=function(h,o,p,x,C,B,R){var j=1/(o-p),H=1/(x-C),q=1/(B-R);return h[0]=-2*j,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*H,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*q,h[11]=0,h[12]=(o+p)*j,h[13]=(C+x)*H,h[14]=(R+B)*q,h[15]=1,h},l.parseCacheControl=function(h){const o={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,x,C,B)=>{const R=C||B;return o[x]=!R||R.toLowerCase(),""}),o["max-age"]){const p=parseInt(o["max-age"],10);isNaN(p)?delete o["max-age"]:o["max-age"]=p}return o},l.parseGlyphPbf=function(h){return new X_(h).readFields(b8,[])},l.pbf=Bb,l.performSymbolLayout=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=Fi/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const o=h.bucket.layers[0],p=o.layout,x=o._unevaluatedLayout._values,C={layoutIconSize:x["icon-size"].possiblyEvaluate(new ci(h.bucket.zoom+1),h.canonical),layoutTextSize:x["text-size"].possiblyEvaluate(new ci(h.bucket.zoom+1),h.canonical),textMaxSize:x["text-size"].possiblyEvaluate(new ci(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:q,maxZoom:J}=h.bucket.textSizeData;C.compositeTextSizes=[x["text-size"].possiblyEvaluate(new ci(q),h.canonical),x["text-size"].possiblyEvaluate(new ci(J),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:q,maxZoom:J}=h.bucket.iconSizeData;C.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new ci(q),h.canonical),x["icon-size"].possiblyEvaluate(new ci(J),h.canonical)]}const B=p.get("text-line-height")*Cr,R=p.get("text-rotation-alignment")!=="viewport"&&p.get("symbol-placement")!=="point",j=p.get("text-keep-upright"),H=p.get("text-size");for(const q of h.bucket.features){const J=p.get("text-font").evaluate(q,{},h.canonical).join(","),ne=H.evaluate(q,{},h.canonical),he=C.layoutTextSize.evaluate(q,{},h.canonical),me=C.layoutIconSize.evaluate(q,{},h.canonical),ye={horizontal:{},vertical:void 0},Me=q.text;let Ue,He=[0,0];if(Me){const et=Me.toString(),st=p.get("text-letter-spacing").evaluate(q,{},h.canonical)*Cr,dt=TA(et)?st:0,Gt=p.get("text-anchor").evaluate(q,{},h.canonical),tn=bE(o,q,h.canonical);if(!tn){const Ot=p.get("text-radial-offset").evaluate(q,{},h.canonical);He=Ot?wE(Gt,[Ot*Cr,u1]):p.get("text-offset").evaluate(q,{},h.canonical).map(bt=>bt*Cr)}let jt=R?"center":p.get("text-justify").evaluate(q,{},h.canonical);const Ft=p.get("symbol-placement"),Dt=Ft==="point"?p.get("text-max-width").evaluate(q,{},h.canonical)*Cr:0,Xt=()=>{h.bucket.allowVerticalPlacement&&EA(et)&&(ye.vertical=mp(Me,h.glyphMap,h.glyphPositions,h.imagePositions,J,Dt,B,Gt,"left",dt,He,l.WritingMode.vertical,!0,Ft,he,ne))};if(!R&&tn){const Ot=new Set;if(jt==="auto")for(let hn=0;hn<tn.values.length;hn+=2)Ot.add(c1(tn.values[hn]));else Ot.add(jt);let bt=!1;for(const hn of Ot)if(!ye.horizontal[hn])if(bt)ye.horizontal[hn]=ye.horizontal[0];else{const sn=mp(Me,h.glyphMap,h.glyphPositions,h.imagePositions,J,Dt,B,"center",hn,dt,He,l.WritingMode.horizontal,!1,Ft,he,ne);sn&&(ye.horizontal[hn]=sn,bt=sn.positionedLines.length===1)}Xt()}else{jt==="auto"&&(jt=c1(Gt));const Ot=mp(Me,h.glyphMap,h.glyphPositions,h.imagePositions,J,Dt,B,Gt,jt,dt,He,l.WritingMode.horizontal,!1,Ft,he,ne);Ot&&(ye.horizontal[jt]=Ot),Xt(),EA(et)&&R&&j&&(ye.vertical=mp(Me,h.glyphMap,h.glyphPositions,h.imagePositions,J,Dt,B,Gt,jt,dt,He,l.WritingMode.vertical,!1,Ft,he,ne))}}let Ke=!1;if(q.icon&&q.icon.name){const et=h.imageMap[q.icon.name];et&&(Ue=M8(h.imagePositions[q.icon.name],p.get("icon-offset").evaluate(q,{},h.canonical),p.get("icon-anchor").evaluate(q,{},h.canonical)),Ke=!!et.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=Ke:h.bucket.sdfIcons!==Ke&&at("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(et.pixelRatio!==h.bucket.pixelRatio||p.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const Ze=TE(ye.horizontal)||ye.vertical;h.bucket.iconsInText=!!Ze&&Ze.iconsInText,(Ze||Ue)&&W8(h.bucket,q,ye,Ue,h.imageMap,C,he,me,He,Ke,h.canonical)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},l.perspective=function(h,o,p,x,C){var B,R=1/Math.tan(o/2);return h[0]=R/p,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=R,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,C!=null&&C!==1/0?(h[10]=(C+x)*(B=1/(x-C)),h[14]=2*C*x*B):(h[10]=-1,h[14]=-2*x),h},l.pick=function(h,o){const p={};for(let x=0;x<o.length;x++){const C=o[x];C in h&&(p[C]=h[C])}return p},l.plugin=Xr,l.pointGeometry=k,l.polygonIntersectsPolygon=nb,l.potpack=jb,l.register=Wt,l.registerForPluginStateChange=function(h){return h({pluginStatus:wr,pluginURL:co}),Vl.on("pluginStateChange",h),h},l.renderColorRamp=fb,l.rotateX=function(h,o,p){var x=Math.sin(p),C=Math.cos(p),B=o[4],R=o[5],j=o[6],H=o[7],q=o[8],J=o[9],ne=o[10],he=o[11];return o!==h&&(h[0]=o[0],h[1]=o[1],h[2]=o[2],h[3]=o[3],h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15]),h[4]=B*C+q*x,h[5]=R*C+J*x,h[6]=j*C+ne*x,h[7]=H*C+he*x,h[8]=q*C-B*x,h[9]=J*C-R*x,h[10]=ne*C-j*x,h[11]=he*C-H*x,h},l.rotateZ=function(h,o,p){var x=Math.sin(p),C=Math.cos(p),B=o[0],R=o[1],j=o[2],H=o[3],q=o[4],J=o[5],ne=o[6],he=o[7];return o!==h&&(h[8]=o[8],h[9]=o[9],h[10]=o[10],h[11]=o[11],h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15]),h[0]=B*C+q*x,h[1]=R*C+J*x,h[2]=j*C+ne*x,h[3]=H*C+he*x,h[4]=q*C-B*x,h[5]=J*C-R*x,h[6]=ne*C-j*x,h[7]=he*C-H*x,h},l.sameOrigin=ti,l.scale=function(h,o,p){var x=p[0],C=p[1],B=p[2];return h[0]=o[0]*x,h[1]=o[1]*x,h[2]=o[2]*x,h[3]=o[3]*x,h[4]=o[4]*C,h[5]=o[5]*C,h[6]=o[6]*C,h[7]=o[7]*C,h[8]=o[8]*B,h[9]=o[9]*B,h[10]=o[10]*B,h[11]=o[11]*B,h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15],h},l.setRTLTextPlugin=function(h,o,p=!1){if(wr===Nl||wr===ps||wr===rl)throw new Error("setRTLTextPlugin cannot be called multiple times.");co=dn.resolveURL(h),wr=Nl,sl=o,Ul(),p||Gl()},l.sphericalToCartesian=function([h,o,p]){return o+=90,o*=Math.PI/180,p*=Math.PI/180,{x:h*Math.cos(o)*Math.sin(p),y:h*Math.sin(o)*Math.sin(p),z:h*Math.cos(p)}},l.toEvaluationFeature=ll,l.transformMat4=up,l.translate=function(h,o,p){var x,C,B,R,j,H,q,J,ne,he,me,ye,Me=p[0],Ue=p[1],He=p[2];return o===h?(h[12]=o[0]*Me+o[4]*Ue+o[8]*He+o[12],h[13]=o[1]*Me+o[5]*Ue+o[9]*He+o[13],h[14]=o[2]*Me+o[6]*Ue+o[10]*He+o[14],h[15]=o[3]*Me+o[7]*Ue+o[11]*He+o[15]):(C=o[1],B=o[2],R=o[3],j=o[4],H=o[5],q=o[6],J=o[7],ne=o[8],he=o[9],me=o[10],ye=o[11],h[0]=x=o[0],h[1]=C,h[2]=B,h[3]=R,h[4]=j,h[5]=H,h[6]=q,h[7]=J,h[8]=ne,h[9]=he,h[10]=me,h[11]=ye,h[12]=x*Me+j*Ue+ne*He+o[12],h[13]=C*Me+H*Ue+he*He+o[13],h[14]=B*Me+q*Ue+me*He+o[14],h[15]=R*Me+J*Ue+ye*He+o[15]),h},l.triggerPluginCompletionEvent=yi,l.unicodeBlockLookup=Bt,l.uniqueId=function(){return Ce++},l.v8Spec=ut,l.validateCustomStyleLayer=function(h){const o=[],p=h.id;return p===void 0&&o.push({message:`layers.${p}: missing required property "id"`}),h.render===void 0&&o.push({message:`layers.${p}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&o.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),o},l.validateLight=wc,l.validateStyle=wA,l.vectorTile=Du,l.warnOnce=at,l.wrap=Ae}),A(["./shared"],function(l){class S{constructor(re){this.keyCache={},re&&this.replace(re)}replace(re){this._layerConfigs={},this._layers={},this.update(re,[])}update(re,fe){for(const Oe of re){this._layerConfigs[Oe.id]=Oe;const je=this._layers[Oe.id]=l.createStyleLayer(Oe);je._featureFilter=l.createFilter(je.filter),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id]}for(const Oe of fe)delete this.keyCache[Oe],delete this._layerConfigs[Oe],delete this._layers[Oe];this.familiesBySource={};const be=l.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const Oe of be){const je=Oe.map(ve=>this._layers[ve.id]),Xe=je[0];if(Xe.visibility==="none")continue;const $e=Xe.source||"";let We=this.familiesBySource[$e];We||(We=this.familiesBySource[$e]={});const Ye=Xe.sourceLayer||"_geojsonTileLayer";let oe=We[Ye];oe||(oe=We[Ye]=[]),oe.push(je)}}}class k{constructor(re){const fe={},be=[];for(const $e in re){const We=re[$e],Ye=fe[$e]={};for(const oe in We){const ve=We[+oe];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const Pe={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};be.push(Pe),Ye[oe]={rect:Pe,metrics:ve.metrics}}}const{w:Oe,h:je}=l.potpack(be),Xe=new l.AlphaImage({width:Oe||1,height:je||1});for(const $e in re){const We=re[$e];for(const Ye in We){const oe=We[+Ye];if(!oe||oe.bitmap.width===0||oe.bitmap.height===0)continue;const ve=fe[$e][Ye].rect;l.AlphaImage.copy(oe.bitmap,Xe,{x:0,y:0},{x:ve.x+1,y:ve.y+1},oe.bitmap)}}this.image=Xe,this.positions=fe}}l.register("GlyphAtlas",k);class U{constructor(re){this.tileID=new l.OverscaledTileID(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.uid=re.uid,this.zoom=re.zoom,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=re.showCollisionBoxes,this.collectResourceTiming=!!re.collectResourceTiming,this.returnDependencies=!!re.returnDependencies,this.promoteId=re.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(re,fe,be,Oe,je){this.status="parsing",this.data=re,this.collisionBoxArray=new l.CollisionBoxArray;const Xe=new l.DictionaryCoder(Object.keys(re.layers).sort()),$e=new l.FeatureIndex(this.tileID,this.promoteId);$e.bucketLayerIDs=[];const We={},Ye={featureIndex:$e,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:be},oe=fe.familiesBySource[this.source];for(const Pt in oe){const Qt=re.layers[Pt];if(!Qt)continue;Qt.version===1&&l.warnOnce(`Vector tile source "${this.source}" layer "${Pt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Vt=Xe.encode(Pt),pt=[];for(let Dn=0;Dn<Qt.length;Dn++){const hi=Qt.feature(Dn),ni=$e.getId(hi,Pt);pt.push({feature:hi,id:ni,index:Dn,sourceLayerIndex:Vt})}for(const Dn of oe[Pt]){const hi=Dn[0];hi.source!==this.source&&l.warnOnce(`layer.source = ${hi.source} does not equal this.source = ${this.source}`),hi.minzoom&&this.zoom<Math.floor(hi.minzoom)||hi.maxzoom&&this.zoom>=hi.maxzoom||hi.visibility!=="none"&&(V(Dn,this.zoom,be),(We[hi.id]=hi.createBucket({index:$e.bucketLayerIDs.length,layers:Dn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Vt,sourceID:this.source})).populate(pt,Ye,this.tileID.canonical),$e.bucketLayerIDs.push(Dn.map(ni=>ni.id)))}}let ve,Pe,rt,s;const Z=l.mapObject(Ye.glyphDependencies,Pt=>Object.keys(Pt).map(Number));this.inFlightDependencies.forEach(Pt=>Pt==null?void 0:Pt.cancel()),this.inFlightDependencies=[];const ft=++this.dependencySentinel;Object.keys(Z).length?this.inFlightDependencies.push(Oe.send("getGlyphs",{uid:this.uid,stacks:Z,source:this.source,tileID:this.tileID,type:"glyphs"},(Pt,Qt)=>{ft===this.dependencySentinel&&(ve||(ve=Pt,Pe=Qt,yt.call(this)))})):Pe={};const mt=Object.keys(Ye.iconDependencies);mt.length?this.inFlightDependencies.push(Oe.send("getImages",{icons:mt,source:this.source,tileID:this.tileID,type:"icons"},(Pt,Qt)=>{ft===this.dependencySentinel&&(ve||(ve=Pt,rt=Qt,yt.call(this)))})):rt={};const kt=Object.keys(Ye.patternDependencies);function yt(){if(ve)return je(ve);if(Pe&&rt&&s){const Pt=new k(Pe),Qt=new l.ImageAtlas(rt,s);for(const Vt in We){const pt=We[Vt];pt instanceof l.SymbolBucket?(V(pt.layers,this.zoom,be),l.performSymbolLayout({bucket:pt,glyphMap:Pe,glyphPositions:Pt.positions,imageMap:rt,imagePositions:Qt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):pt.hasPattern&&(pt instanceof l.LineBucket||pt instanceof l.FillBucket||pt instanceof l.FillExtrusionBucket)&&(V(pt.layers,this.zoom,be),pt.addFeatures(Ye,this.tileID.canonical,Qt.patternPositions))}this.status="done",je(null,{buckets:Object.values(We).filter(Vt=>!Vt.isEmpty()),featureIndex:$e,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Pt.image,imageAtlas:Qt,glyphMap:this.returnDependencies?Pe:null,iconMap:this.returnDependencies?rt:null,glyphPositions:this.returnDependencies?Pt.positions:null})}}kt.length?this.inFlightDependencies.push(Oe.send("getImages",{icons:kt,source:this.source,tileID:this.tileID,type:"patterns"},(Pt,Qt)=>{ft===this.dependencySentinel&&(ve||(ve=Pt,s=Qt,yt.call(this)))})):s={},yt.call(this)}}function V(ke,re,fe){const be=new l.EvaluationParameters(re);for(const Oe of ke)Oe.recalculate(be,fe)}function $(ke,re){const fe=l.getArrayBuffer(ke.request,(be,Oe,je,Xe)=>{be?re(be):Oe&&re(null,{vectorTile:new l.vectorTile.VectorTile(new l.Protobuf(Oe)),rawData:Oe,cacheControl:je,expires:Xe})});return()=>{fe.cancel(),re()}}class X{constructor(re,fe,be,Oe){this.actor=re,this.layerIndex=fe,this.availableImages=be,this.loadVectorData=Oe||$,this.fetching={},this.loading={},this.loaded={}}loadTile(re,fe){const be=re.uid;this.loading||(this.loading={});const Oe=!!(re&&re.request&&re.request.collectResourceTiming)&&new l.RequestPerformance(re.request),je=this.loading[be]=new U(re);je.abort=this.loadVectorData(re,(Xe,$e)=>{if(delete this.loading[be],Xe||!$e)return je.status="done",this.loaded[be]=je,fe(Xe);const We=$e.rawData,Ye={};$e.expires&&(Ye.expires=$e.expires),$e.cacheControl&&(Ye.cacheControl=$e.cacheControl);const oe={};if(Oe){const ve=Oe.finish();ve&&(oe.resourceTiming=JSON.parse(JSON.stringify(ve)))}je.vectorTile=$e.vectorTile,je.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,(ve,Pe)=>{if(delete this.fetching[be],ve||!Pe)return fe(ve);fe(null,l.extend({rawTileData:We.slice(0)},Pe,Ye,oe))}),this.loaded=this.loaded||{},this.loaded[be]=je,this.fetching[be]={rawTileData:We,cacheControl:Ye,resourceTiming:oe}})}reloadTile(re,fe){const be=this.loaded,Oe=re.uid;if(be&&be[Oe]){const je=be[Oe];je.showCollisionBoxes=re.showCollisionBoxes,je.status==="parsing"?je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,(Xe,$e)=>{if(Xe||!$e)return fe(Xe,$e);let We;if(this.fetching[Oe]){const{rawTileData:Ye,cacheControl:oe,resourceTiming:ve}=this.fetching[Oe];delete this.fetching[Oe],We=l.extend({rawTileData:Ye.slice(0)},$e,oe,ve)}else We=$e;fe(null,We)}):je.status==="done"&&(je.vectorTile?je.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,fe):fe())}}abortTile(re,fe){const be=this.loading,Oe=re.uid;be&&be[Oe]&&be[Oe].abort&&(be[Oe].abort(),delete be[Oe]),fe()}removeTile(re,fe){const be=this.loaded,Oe=re.uid;be&&be[Oe]&&delete be[Oe],fe()}}class ee{constructor(){this.loaded={}}loadTile(re,fe){const{uid:be,encoding:Oe,rawImageData:je}=re,Xe=l.isImageBitmap(je)?this.getImageData(je):je,$e=new l.DEMData(be,Xe,Oe);this.loaded=this.loaded||{},this.loaded[be]=$e,fe(null,$e)}getImageData(re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(re.width,re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=re.width,this.offscreenCanvas.height=re.height,this.offscreenCanvasContext.drawImage(re,0,0,re.width,re.height);const fe=this.offscreenCanvasContext.getImageData(-1,-1,re.width+2,re.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:fe.width,height:fe.height},fe.data)}removeTile(re){const fe=this.loaded,be=re.uid;fe&&fe[be]&&delete fe[be]}}function ue(ke,re){if(ke.length!==0){we(ke[0],re);for(var fe=1;fe<ke.length;fe++)we(ke[fe],!re)}}function we(ke,re){for(var fe=0,be=0,Oe=0,je=ke.length,Xe=je-1;Oe<je;Xe=Oe++){var $e=(ke[Oe][0]-ke[Xe][0])*(ke[Xe][1]+ke[Oe][1]),We=fe+$e;be+=Math.abs(fe)>=Math.abs($e)?fe-We+$e:$e-We+fe,fe=We}fe+be>=0!=!!re&&ke.reverse()}var ie=l.getDefaultExportFromCjs(function ke(re,fe){var be,Oe=re&&re.type;if(Oe==="FeatureCollection")for(be=0;be<re.features.length;be++)ke(re.features[be],fe);else if(Oe==="GeometryCollection")for(be=0;be<re.geometries.length;be++)ke(re.geometries[be],fe);else if(Oe==="Feature")ke(re.geometry,fe);else if(Oe==="Polygon")ue(re.coordinates,fe);else if(Oe==="MultiPolygon")for(be=0;be<re.coordinates.length;be++)ue(re.coordinates[be],fe);return re});const Ae=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;var ce={exports:{}},Ce=l.pointGeometry,Ne=l.vectorTile.VectorTileFeature,qe=tt;function tt(ke,re){this.options=re||{},this.features=ke,this.length=ke.length}function lt(ke,re){this.id=typeof ke.id=="number"?ke.id:void 0,this.type=ke.type,this.rawGeometry=ke.type===1?[ke.geometry]:ke.geometry,this.properties=ke.tags,this.extent=re||4096}tt.prototype.feature=function(ke){return new lt(this.features[ke],this.options.extent)},lt.prototype.loadGeometry=function(){var ke=this.rawGeometry;this.geometry=[];for(var re=0;re<ke.length;re++){for(var fe=ke[re],be=[],Oe=0;Oe<fe.length;Oe++)be.push(new Ce(fe[Oe][0],fe[Oe][1]));this.geometry.push(be)}return this.geometry},lt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ke=this.geometry,re=1/0,fe=-1/0,be=1/0,Oe=-1/0,je=0;je<ke.length;je++)for(var Xe=ke[je],$e=0;$e<Xe.length;$e++){var We=Xe[$e];re=Math.min(re,We.x),fe=Math.max(fe,We.x),be=Math.min(be,We.y),Oe=Math.max(Oe,We.y)}return[re,be,fe,Oe]},lt.prototype.toGeoJSON=Ne.prototype.toGeoJSON;var at=l.pbf,ht=qe;function Et(ke){var re=new at;return function(fe,be){for(var Oe in fe.layers)be.writeMessage(3,St,fe.layers[Oe])}(ke,re),re.finish()}function St(ke,re){var fe;re.writeVarintField(15,ke.version||1),re.writeStringField(1,ke.name||""),re.writeVarintField(5,ke.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(fe=0;fe<ke.length;fe++)be.feature=ke.feature(fe),re.writeMessage(2,Mt,be);var Oe=be.keys;for(fe=0;fe<Oe.length;fe++)re.writeStringField(3,Oe[fe]);var je=be.values;for(fe=0;fe<je.length;fe++)re.writeMessage(4,Nt,je[fe])}function Mt(ke,re){var fe=ke.feature;fe.id!==void 0&&re.writeVarintField(1,fe.id),re.writeMessage(2,Kt,ke),re.writeVarintField(3,fe.type),re.writeMessage(4,li,fe)}function Kt(ke,re){var fe=ke.feature,be=ke.keys,Oe=ke.values,je=ke.keycache,Xe=ke.valuecache;for(var $e in fe.properties){var We=fe.properties[$e],Ye=je[$e];if(We!==null){Ye===void 0&&(be.push($e),je[$e]=Ye=be.length-1),re.writeVarint(Ye);var oe=typeof We;oe!=="string"&&oe!=="boolean"&&oe!=="number"&&(We=JSON.stringify(We));var ve=oe+":"+We,Pe=Xe[ve];Pe===void 0&&(Oe.push(We),Xe[ve]=Pe=Oe.length-1),re.writeVarint(Pe)}}}function pn(ke,re){return(re<<3)+(7&ke)}function ei(ke){return ke<<1^ke>>31}function li(ke,re){for(var fe=ke.loadGeometry(),be=ke.type,Oe=0,je=0,Xe=fe.length,$e=0;$e<Xe;$e++){var We=fe[$e],Ye=1;be===1&&(Ye=We.length),re.writeVarint(pn(1,Ye));for(var oe=be===3?We.length-1:We.length,ve=0;ve<oe;ve++){ve===1&&be!==1&&re.writeVarint(pn(2,oe-1));var Pe=We[ve].x-Oe,rt=We[ve].y-je;re.writeVarint(ei(Pe)),re.writeVarint(ei(rt)),Oe+=Pe,je+=rt}be===3&&re.writeVarint(pn(7,1))}}function Nt(ke,re){var fe=typeof ke;fe==="string"?re.writeStringField(1,ke):fe==="boolean"?re.writeBooleanField(7,ke):fe==="number"&&(ke%1!=0?re.writeDoubleField(3,ke):ke<0?re.writeSVarintField(6,ke):re.writeVarintField(5,ke))}ce.exports=Et,ce.exports.fromVectorTileJs=Et,ce.exports.fromGeojsonVt=function(ke,re){re=re||{};var fe={};for(var be in ke)fe[be]=new ht(ke[be].features,re),fe[be].name=be,fe[be].version=re.version,fe[be].extent=re.extent;return Et({layers:fe})},ce.exports.GeoJSONWrapper=ht;var dn=l.getDefaultExportFromCjs(ce.exports);const vn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ke=>ke},Bn=Math.fround||(Tn=new Float32Array(1),ke=>(Tn[0]=+ke,Tn[0]));var Tn;const wi=3,Un=5,Hr=6;class qi{constructor(re){this.options=Object.assign(Object.create(vn),re),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(re){const{log:fe,minZoom:be,maxZoom:Oe}=this.options;fe&&console.time("total time");const je=`prepare ${re.length} points`;fe&&console.time(je),this.points=re;const Xe=[];for(let We=0;We<re.length;We++){const Ye=re[We];if(!Ye.geometry)continue;const[oe,ve]=Ye.geometry.coordinates,Pe=Bn(Yn(oe)),rt=Bn(si(ve));Xe.push(Pe,rt,1/0,We,-1,1),this.options.reduce&&Xe.push(0)}let $e=this.trees[Oe+1]=this._createTree(Xe);fe&&console.timeEnd(je);for(let We=Oe;We>=be;We--){const Ye=+Date.now();$e=this.trees[We]=this._createTree(this._cluster($e,We)),fe&&console.log("z%d: %d clusters in %dms",We,$e.numItems,+Date.now()-Ye)}return fe&&console.timeEnd("total time"),this}getClusters(re,fe){let be=((re[0]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,re[1]));let je=re[2]===180?180:((re[2]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)be=-180,je=180;else if(be>je){const ve=this.getClusters([be,Oe,180,Xe],fe),Pe=this.getClusters([-180,Oe,je,Xe],fe);return ve.concat(Pe)}const $e=this.trees[this._limitZoom(fe)],We=$e.range(Yn(be),si(Xe),Yn(je),si(Oe)),Ye=$e.data,oe=[];for(const ve of We){const Pe=this.stride*ve;oe.push(Ye[Pe+Un]>1?ti(Ye,Pe,this.clusterProps):this.points[Ye[Pe+wi]])}return oe}getChildren(re){const fe=this._getOriginId(re),be=this._getOriginZoom(re),Oe="No cluster with the specified id.",je=this.trees[be];if(!je)throw new Error(Oe);const Xe=je.data;if(fe*this.stride>=Xe.length)throw new Error(Oe);const $e=this.options.radius/(this.options.extent*Math.pow(2,be-1)),We=je.within(Xe[fe*this.stride],Xe[fe*this.stride+1],$e),Ye=[];for(const oe of We){const ve=oe*this.stride;Xe[ve+4]===re&&Ye.push(Xe[ve+Un]>1?ti(Xe,ve,this.clusterProps):this.points[Xe[ve+wi]])}if(Ye.length===0)throw new Error(Oe);return Ye}getLeaves(re,fe,be){const Oe=[];return this._appendLeaves(Oe,re,fe=fe||10,be=be||0,0),Oe}getTile(re,fe,be){const Oe=this.trees[this._limitZoom(re)],je=Math.pow(2,re),{extent:Xe,radius:$e}=this.options,We=$e/Xe,Ye=(be-We)/je,oe=(be+1+We)/je,ve={features:[]};return this._addTileFeatures(Oe.range((fe-We)/je,Ye,(fe+1+We)/je,oe),Oe.data,fe,be,je,ve),fe===0&&this._addTileFeatures(Oe.range(1-We/je,Ye,1,oe),Oe.data,je,be,je,ve),fe===je-1&&this._addTileFeatures(Oe.range(0,Ye,We/je,oe),Oe.data,-1,be,je,ve),ve.features.length?ve:null}getClusterExpansionZoom(re){let fe=this._getOriginZoom(re)-1;for(;fe<=this.options.maxZoom;){const be=this.getChildren(re);if(fe++,be.length!==1)break;re=be[0].properties.cluster_id}return fe}_appendLeaves(re,fe,be,Oe,je){const Xe=this.getChildren(fe);for(const $e of Xe){const We=$e.properties;if(We&&We.cluster?je+We.point_count<=Oe?je+=We.point_count:je=this._appendLeaves(re,We.cluster_id,be,Oe,je):je<Oe?je++:re.push($e),re.length===be)break}return je}_createTree(re){const fe=new l.KDBush(re.length/this.stride|0,this.options.nodeSize,Float32Array);for(let be=0;be<re.length;be+=this.stride)fe.add(re[be],re[be+1]);return fe.finish(),fe.data=re,fe}_addTileFeatures(re,fe,be,Oe,je,Xe){for(const $e of re){const We=$e*this.stride,Ye=fe[We+Un]>1;let oe,ve,Pe;if(Ye)oe=kr(fe,We,this.clusterProps),ve=fe[We],Pe=fe[We+1];else{const Z=this.points[fe[We+wi]];oe=Z.properties;const[ft,mt]=Z.geometry.coordinates;ve=Yn(ft),Pe=si(mt)}const rt={type:1,geometry:[[Math.round(this.options.extent*(ve*je-be)),Math.round(this.options.extent*(Pe*je-Oe))]],tags:oe};let s;s=Ye||this.options.generateId?fe[We+wi]:this.points[fe[We+wi]].id,s!==void 0&&(rt.id=s),Xe.features.push(rt)}}_limitZoom(re){return Math.max(this.options.minZoom,Math.min(Math.floor(+re),this.options.maxZoom+1))}_cluster(re,fe){const{radius:be,extent:Oe,reduce:je,minPoints:Xe}=this.options,$e=be/(Oe*Math.pow(2,fe)),We=re.data,Ye=[],oe=this.stride;for(let ve=0;ve<We.length;ve+=oe){if(We[ve+2]<=fe)continue;We[ve+2]=fe;const Pe=We[ve],rt=We[ve+1],s=re.within(We[ve],We[ve+1],$e),Z=We[ve+Un];let ft=Z;for(const mt of s){const kt=mt*oe;We[kt+2]>fe&&(ft+=We[kt+Un])}if(ft>Z&&ft>=Xe){let mt,kt=Pe*Z,yt=rt*Z,Pt=-1;const Qt=((ve/oe|0)<<5)+(fe+1)+this.points.length;for(const Vt of s){const pt=Vt*oe;if(We[pt+2]<=fe)continue;We[pt+2]=fe;const Dn=We[pt+Un];kt+=We[pt]*Dn,yt+=We[pt+1]*Dn,We[pt+4]=Qt,je&&(mt||(mt=this._map(We,ve,!0),Pt=this.clusterProps.length,this.clusterProps.push(mt)),je(mt,this._map(We,pt)))}We[ve+4]=Qt,Ye.push(kt/ft,yt/ft,1/0,Qt,-1,ft),je&&Ye.push(Pt)}else{for(let mt=0;mt<oe;mt++)Ye.push(We[ve+mt]);if(ft>1)for(const mt of s){const kt=mt*oe;if(!(We[kt+2]<=fe)){We[kt+2]=fe;for(let yt=0;yt<oe;yt++)Ye.push(We[kt+yt])}}}}return Ye}_getOriginId(re){return re-this.points.length>>5}_getOriginZoom(re){return(re-this.points.length)%32}_map(re,fe,be){if(re[fe+Un]>1){const Xe=this.clusterProps[re[fe+Hr]];return be?Object.assign({},Xe):Xe}const Oe=this.points[re[fe+wi]].properties,je=this.options.map(Oe);return be&&je===Oe?Object.assign({},je):je}}function ti(ke,re,fe){return{type:"Feature",id:ke[re+wi],properties:kr(ke,re,fe),geometry:{type:"Point",coordinates:[(be=ke[re],360*(be-.5)),vr(ke[re+1])]}};var be}function kr(ke,re,fe){const be=ke[re+Un],Oe=be>=1e4?`${Math.round(be/1e3)}k`:be>=1e3?Math.round(be/100)/10+"k":be,je=ke[re+Hr],Xe=je===-1?{}:Object.assign({},fe[je]);return Object.assign(Xe,{cluster:!0,cluster_id:ke[re+wi],point_count:be,point_count_abbreviated:Oe})}function Yn(ke){return ke/360+.5}function si(ke){const re=Math.sin(ke*Math.PI/180),fe=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return fe<0?0:fe>1?1:fe}function vr(ke){const re=(180-360*ke)*Math.PI/180;return 360*Math.atan(Math.exp(re))/Math.PI-90}function Lr(ke,re,fe,be){for(var Oe,je=be,Xe=fe-re>>1,$e=fe-re,We=ke[re],Ye=ke[re+1],oe=ke[fe],ve=ke[fe+1],Pe=re+3;Pe<fe;Pe+=3){var rt=ut(ke[Pe],ke[Pe+1],We,Ye,oe,ve);if(rt>je)Oe=Pe,je=rt;else if(rt===je){var s=Math.abs(Pe-Xe);s<$e&&(Oe=Pe,$e=s)}}je>be&&(Oe-re>3&&Lr(ke,re,Oe,be),ke[Oe+2]=je,fe-Oe>3&&Lr(ke,Oe,fe,be))}function ut(ke,re,fe,be,Oe,je){var Xe=Oe-fe,$e=je-be;if(Xe!==0||$e!==0){var We=((ke-fe)*Xe+(re-be)*$e)/(Xe*Xe+$e*$e);We>1?(fe=Oe,be=je):We>0&&(fe+=Xe*We,be+=$e*We)}return(Xe=ke-fe)*Xe+($e=re-be)*$e}function xr(ke,re,fe,be){var Oe={id:ke===void 0?null:ke,type:re,geometry:fe,tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(je){var Xe=je.geometry,$e=je.type;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")rs(je,Xe);else if($e==="Polygon"||$e==="MultiLineString")for(var We=0;We<Xe.length;We++)rs(je,Xe[We]);else if($e==="MultiPolygon")for(We=0;We<Xe.length;We++)for(var Ye=0;Ye<Xe[We].length;Ye++)rs(je,Xe[We][Ye])}(Oe),Oe}function rs(ke,re){for(var fe=0;fe<re.length;fe+=3)ke.minX=Math.min(ke.minX,re[fe]),ke.minY=Math.min(ke.minY,re[fe+1]),ke.maxX=Math.max(ke.maxX,re[fe]),ke.maxY=Math.max(ke.maxY,re[fe+1])}function Ln(ke,re,fe,be){if(re.geometry){var Oe=re.geometry.coordinates,je=re.geometry.type,Xe=Math.pow(fe.tolerance/((1<<fe.maxZoom)*fe.extent),2),$e=[],We=re.id;if(fe.promoteId?We=re.properties[fe.promoteId]:fe.generateId&&(We=be||0),je==="Point")gn(Oe,$e);else if(je==="MultiPoint")for(var Ye=0;Ye<Oe.length;Ye++)gn(Oe[Ye],$e);else if(je==="LineString")ji(Oe,$e,Xe,!1);else if(je==="MultiLineString"){if(fe.lineMetrics){for(Ye=0;Ye<Oe.length;Ye++)ji(Oe[Ye],$e=[],Xe,!1),ke.push(xr(We,"LineString",$e,re.properties));return}Ns(Oe,$e,Xe,!1)}else if(je==="Polygon")Ns(Oe,$e,Xe,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(Ye=0;Ye<re.geometry.geometries.length;Ye++)Ln(ke,{id:We,geometry:re.geometry.geometries[Ye],properties:re.properties},fe,be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ye=0;Ye<Oe.length;Ye++){var oe=[];Ns(Oe[Ye],oe,Xe,!0),$e.push(oe)}}ke.push(xr(We,je,$e,re.properties))}}function gn(ke,re){re.push(ro(ke[0])),re.push(Qn(ke[1])),re.push(0)}function ji(ke,re,fe,be){for(var Oe,je,Xe=0,$e=0;$e<ke.length;$e++){var We=ro(ke[$e][0]),Ye=Qn(ke[$e][1]);re.push(We),re.push(Ye),re.push(0),$e>0&&(Xe+=be?(Oe*Ye-We*je)/2:Math.sqrt(Math.pow(We-Oe,2)+Math.pow(Ye-je,2))),Oe=We,je=Ye}var oe=re.length-3;re[2]=1,Lr(re,0,oe,fe),re[oe+2]=1,re.size=Math.abs(Xe),re.start=0,re.end=re.size}function Ns(ke,re,fe,be){for(var Oe=0;Oe<ke.length;Oe++){var je=[];ji(ke[Oe],je,fe,be),re.push(je)}}function ro(ke){return ke/360+.5}function Qn(ke){var re=Math.sin(ke*Math.PI/180),fe=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return fe<0?0:fe>1?1:fe}function Jn(ke,re,fe,be,Oe,je,Xe,$e){if(be/=re,je>=(fe/=re)&&Xe<be)return ke;if(Xe<fe||je>=be)return null;for(var We=[],Ye=0;Ye<ke.length;Ye++){var oe=ke[Ye],ve=oe.geometry,Pe=oe.type,rt=Oe===0?oe.minX:oe.minY,s=Oe===0?oe.maxX:oe.maxY;if(rt>=fe&&s<be)We.push(oe);else if(!(s<fe||rt>=be)){var Z=[];if(Pe==="Point"||Pe==="MultiPoint")so(ve,Z,fe,be,Oe);else if(Pe==="LineString")Gi(ve,Z,fe,be,Oe,!1,$e.lineMetrics);else if(Pe==="MultiLineString")Yi(ve,Z,fe,be,Oe,!1);else if(Pe==="Polygon")Yi(ve,Z,fe,be,Oe,!0);else if(Pe==="MultiPolygon")for(var ft=0;ft<ve.length;ft++){var mt=[];Yi(ve[ft],mt,fe,be,Oe,!0),mt.length&&Z.push(mt)}if(Z.length){if($e.lineMetrics&&Pe==="LineString"){for(ft=0;ft<Z.length;ft++)We.push(xr(oe.id,Pe,Z[ft],oe.tags));continue}Pe!=="LineString"&&Pe!=="MultiLineString"||(Z.length===1?(Pe="LineString",Z=Z[0]):Pe="MultiLineString"),Pe!=="Point"&&Pe!=="MultiPoint"||(Pe=Z.length===3?"Point":"MultiPoint"),We.push(xr(oe.id,Pe,Z,oe.tags))}}}return We.length?We:null}function so(ke,re,fe,be,Oe){for(var je=0;je<ke.length;je+=3){var Xe=ke[je+Oe];Xe>=fe&&Xe<=be&&(re.push(ke[je]),re.push(ke[je+1]),re.push(ke[je+2]))}}function Gi(ke,re,fe,be,Oe,je,Xe){for(var $e,We,Ye=It(ke),oe=Oe===0?Dr:Wr,ve=ke.start,Pe=0;Pe<ke.length-3;Pe+=3){var rt=ke[Pe],s=ke[Pe+1],Z=ke[Pe+2],ft=ke[Pe+3],mt=ke[Pe+4],kt=Oe===0?rt:s,yt=Oe===0?ft:mt,Pt=!1;Xe&&($e=Math.sqrt(Math.pow(rt-ft,2)+Math.pow(s-mt,2))),kt<fe?yt>fe&&(We=oe(Ye,rt,s,ft,mt,fe),Xe&&(Ye.start=ve+$e*We)):kt>be?yt<be&&(We=oe(Ye,rt,s,ft,mt,be),Xe&&(Ye.start=ve+$e*We)):Xi(Ye,rt,s,Z),yt<fe&&kt>=fe&&(We=oe(Ye,rt,s,ft,mt,fe),Pt=!0),yt>be&&kt<=be&&(We=oe(Ye,rt,s,ft,mt,be),Pt=!0),!je&&Pt&&(Xe&&(Ye.end=ve+$e*We),re.push(Ye),Ye=It(ke)),Xe&&(ve+=$e)}var Qt=ke.length-3;rt=ke[Qt],s=ke[Qt+1],Z=ke[Qt+2],(kt=Oe===0?rt:s)>=fe&&kt<=be&&Xi(Ye,rt,s,Z),Qt=Ye.length-3,je&&Qt>=3&&(Ye[Qt]!==Ye[0]||Ye[Qt+1]!==Ye[1])&&Xi(Ye,Ye[0],Ye[1],Ye[2]),Ye.length&&re.push(Ye)}function It(ke){var re=[];return re.size=ke.size,re.start=ke.start,re.end=ke.end,re}function Yi(ke,re,fe,be,Oe,je){for(var Xe=0;Xe<ke.length;Xe++)Gi(ke[Xe],re,fe,be,Oe,je,!1)}function Xi(ke,re,fe,be){ke.push(re),ke.push(fe),ke.push(be)}function Dr(ke,re,fe,be,Oe,je){var Xe=(je-re)/(be-re);return ke.push(je),ke.push(fe+(Oe-fe)*Xe),ke.push(1),Xe}function Wr(ke,re,fe,be,Oe,je){var Xe=(je-fe)/(Oe-fe);return ke.push(re+(be-re)*Xe),ke.push(je),ke.push(1),Xe}function Lt(ke,re){for(var fe=[],be=0;be<ke.length;be++){var Oe,je=ke[be],Xe=je.type;if(Xe==="Point"||Xe==="MultiPoint"||Xe==="LineString")Oe=yn(je.geometry,re);else if(Xe==="MultiLineString"||Xe==="Polygon"){Oe=[];for(var $e=0;$e<je.geometry.length;$e++)Oe.push(yn(je.geometry[$e],re))}else if(Xe==="MultiPolygon")for(Oe=[],$e=0;$e<je.geometry.length;$e++){for(var We=[],Ye=0;Ye<je.geometry[$e].length;Ye++)We.push(yn(je.geometry[$e][Ye],re));Oe.push(We)}fe.push(xr(je.id,Xe,Oe,je.tags))}return fe}function yn(ke,re){var fe=[];fe.size=ke.size,ke.start!==void 0&&(fe.start=ke.start,fe.end=ke.end);for(var be=0;be<ke.length;be+=3)fe.push(ke[be]+re,ke[be+1],ke[be+2]);return fe}function mn(ke,re){if(ke.transformed)return ke;var fe,be,Oe,je=1<<ke.z,Xe=ke.x,$e=ke.y;for(fe=0;fe<ke.features.length;fe++){var We=ke.features[fe],Ye=We.geometry,oe=We.type;if(We.geometry=[],oe===1)for(be=0;be<Ye.length;be+=2)We.geometry.push(Qi(Ye[be],Ye[be+1],re,je,Xe,$e));else for(be=0;be<Ye.length;be++){var ve=[];for(Oe=0;Oe<Ye[be].length;Oe+=2)ve.push(Qi(Ye[be][Oe],Ye[be][Oe+1],re,je,Xe,$e));We.geometry.push(ve)}}return ke.transformed=!0,ke}function Qi(ke,re,fe,be,Oe,je){return[Math.round(fe*(ke*be-Oe)),Math.round(fe*(re*be-je))]}function Cs(ke,re,fe,be,Oe){for(var je=re===Oe.maxZoom?0:Oe.tolerance/((1<<re)*Oe.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:fe,y:be,z:re,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},$e=0;$e<ke.length;$e++){Xe.numFeatures++,ln(Xe,ke[$e],je,Oe);var We=ke[$e].minX,Ye=ke[$e].minY,oe=ke[$e].maxX,ve=ke[$e].maxY;We<Xe.minX&&(Xe.minX=We),Ye<Xe.minY&&(Xe.minY=Ye),oe>Xe.maxX&&(Xe.maxX=oe),ve>Xe.maxY&&(Xe.maxY=ve)}return Xe}function ln(ke,re,fe,be){var Oe=re.geometry,je=re.type,Xe=[];if(je==="Point"||je==="MultiPoint")for(var $e=0;$e<Oe.length;$e+=3)Xe.push(Oe[$e]),Xe.push(Oe[$e+1]),ke.numPoints++,ke.numSimplified++;else if(je==="LineString")Br(Xe,Oe,ke,fe,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for($e=0;$e<Oe.length;$e++)Br(Xe,Oe[$e],ke,fe,je==="Polygon",$e===0);else if(je==="MultiPolygon")for(var We=0;We<Oe.length;We++){var Ye=Oe[We];for($e=0;$e<Ye.length;$e++)Br(Xe,Ye[$e],ke,fe,!0,$e===0)}if(Xe.length){var oe=re.tags||null;if(je==="LineString"&&be.lineMetrics){for(var ve in oe={},re.tags)oe[ve]=re.tags[ve];oe.mapbox_clip_start=Oe.start/Oe.size,oe.mapbox_clip_end=Oe.end/Oe.size}var Pe={geometry:Xe,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:oe};re.id!==null&&(Pe.id=re.id),ke.features.push(Pe)}}function Br(ke,re,fe,be,Oe,je){var Xe=be*be;if(be>0&&re.size<(Oe?Xe:be))fe.numPoints+=re.length/3;else{for(var $e=[],We=0;We<re.length;We+=3)(be===0||re[We+2]>Xe)&&(fe.numSimplified++,$e.push(re[We]),$e.push(re[We+1])),fe.numPoints++;Oe&&function(Ye,oe){for(var ve=0,Pe=0,rt=Ye.length,s=rt-2;Pe<rt;s=Pe,Pe+=2)ve+=(Ye[Pe]-Ye[s])*(Ye[Pe+1]+Ye[s+1]);if(ve>0===oe)for(Pe=0,rt=Ye.length;Pe<rt/2;Pe+=2){var Z=Ye[Pe],ft=Ye[Pe+1];Ye[Pe]=Ye[rt-2-Pe],Ye[Pe+1]=Ye[rt-1-Pe],Ye[rt-2-Pe]=Z,Ye[rt-1-Pe]=ft}}($e,je),ke.push($e)}}function ss(ke,re){var fe=(re=this.options=function(Oe,je){for(var Xe in je)Oe[Xe]=je[Xe];return Oe}(Object.create(this.options),re)).debug;if(fe&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");var be=function(Oe,je){var Xe=[];if(Oe.type==="FeatureCollection")for(var $e=0;$e<Oe.features.length;$e++)Ln(Xe,Oe.features[$e],je,$e);else Ln(Xe,Oe.type==="Feature"?Oe:{geometry:Oe},je);return Xe}(ke,re);this.tiles={},this.tileCoords=[],fe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),be=function(Oe,je){var Xe=je.buffer/je.extent,$e=Oe,We=Jn(Oe,1,-1-Xe,Xe,0,-1,2,je),Ye=Jn(Oe,1,1-Xe,2+Xe,0,-1,2,je);return(We||Ye)&&($e=Jn(Oe,1,-Xe,1+Xe,0,-1,2,je)||[],We&&($e=Lt(We,1).concat($e)),Ye&&($e=$e.concat(Lt(Ye,-1)))),$e}(be,re),be.length&&this.splitTile(be,0,0,0),fe&&(be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $r(ke,re,fe){return 32*((1<<ke)*fe+re)+ke}function Rr(ke,re){return re?ke.properties[re]:ke.id}function Or(ke,re){if(ke==null)return!0;if(ke.type==="Feature")return Rr(ke,re)!=null;if(ke.type==="FeatureCollection"){const fe=new Set;for(const be of ke.features){const Oe=Rr(be,re);if(Oe==null||fe.has(Oe))return!1;fe.add(Oe)}return!0}return!1}function ki(ke,re){const fe=new Map;if(ke!=null)if(ke.type==="Feature")fe.set(Rr(ke,re),ke);else for(const be of ke.features)fe.set(Rr(be,re),be);return fe}function Xn(ke,re){const fe=ke.tileID.canonical;if(!this._geoJSONIndex)return re(null,null);const be=this._geoJSONIndex.getTile(fe.z,fe.x,fe.y);if(!be)return re(null,null);const Oe=new class{constructor(Xe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=Xe.length,this._features=Xe}feature(Xe){return new class{constructor($e){this._feature=$e,this.extent=l.EXTENT,this.type=$e.type,this.properties=$e.tags,"id"in $e&&!isNaN($e.id)&&(this.id=parseInt($e.id,10))}loadGeometry(){if(this._feature.type===1){const $e=[];for(const We of this._feature.geometry)$e.push([new l.Point(We[0],We[1])]);return $e}{const $e=[];for(const We of this._feature.geometry){const Ye=[];for(const oe of We)Ye.push(new l.Point(oe[0],oe[1]));$e.push(Ye)}return $e}}toGeoJSON($e,We,Ye){return Ae.call(this,$e,We,Ye)}}(this._features[Xe])}}(be.features);let je=dn(Oe);je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),re(null,{vectorTile:Oe,rawData:je.buffer})}ss.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ss.prototype.splitTile=function(ke,re,fe,be,Oe,je,Xe){for(var $e=[ke,re,fe,be],We=this.options,Ye=We.debug;$e.length;){be=$e.pop(),fe=$e.pop(),re=$e.pop(),ke=$e.pop();var oe=1<<re,ve=$r(re,fe,be),Pe=this.tiles[ve];if(!Pe&&(Ye>1&&console.time("creation"),Pe=this.tiles[ve]=Cs(ke,re,fe,be,We),this.tileCoords.push({z:re,x:fe,y:be}),Ye)){Ye>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,fe,be,Pe.numFeatures,Pe.numPoints,Pe.numSimplified),console.timeEnd("creation"));var rt="z"+re;this.stats[rt]=(this.stats[rt]||0)+1,this.total++}if(Pe.source=ke,Oe){if(re===We.maxZoom||re===Oe)continue;var s=1<<Oe-re;if(fe!==Math.floor(je/s)||be!==Math.floor(Xe/s))continue}else if(re===We.indexMaxZoom||Pe.numPoints<=We.indexMaxPoints)continue;if(Pe.source=null,ke.length!==0){Ye>1&&console.time("clipping");var Z,ft,mt,kt,yt,Pt,Qt=.5*We.buffer/We.extent,Vt=.5-Qt,pt=.5+Qt,Dn=1+Qt;Z=ft=mt=kt=null,yt=Jn(ke,oe,fe-Qt,fe+pt,0,Pe.minX,Pe.maxX,We),Pt=Jn(ke,oe,fe+Vt,fe+Dn,0,Pe.minX,Pe.maxX,We),ke=null,yt&&(Z=Jn(yt,oe,be-Qt,be+pt,1,Pe.minY,Pe.maxY,We),ft=Jn(yt,oe,be+Vt,be+Dn,1,Pe.minY,Pe.maxY,We),yt=null),Pt&&(mt=Jn(Pt,oe,be-Qt,be+pt,1,Pe.minY,Pe.maxY,We),kt=Jn(Pt,oe,be+Vt,be+Dn,1,Pe.minY,Pe.maxY,We),Pt=null),Ye>1&&console.timeEnd("clipping"),$e.push(Z||[],re+1,2*fe,2*be),$e.push(ft||[],re+1,2*fe,2*be+1),$e.push(mt||[],re+1,2*fe+1,2*be),$e.push(kt||[],re+1,2*fe+1,2*be+1)}}},ss.prototype.getTile=function(ke,re,fe){var be=this.options,Oe=be.extent,je=be.debug;if(ke<0||ke>24)return null;var Xe=1<<ke,$e=$r(ke,re=(re%Xe+Xe)%Xe,fe);if(this.tiles[$e])return mn(this.tiles[$e],Oe);je>1&&console.log("drilling down to z%d-%d-%d",ke,re,fe);for(var We,Ye=ke,oe=re,ve=fe;!We&&Ye>0;)Ye--,oe=Math.floor(oe/2),ve=Math.floor(ve/2),We=this.tiles[$r(Ye,oe,ve)];return We&&We.source?(je>1&&console.log("found parent tile z%d-%d-%d",Ye,oe,ve),je>1&&console.time("drilling down"),this.splitTile(We.source,Ye,oe,ve,ke,re,fe),je>1&&console.timeEnd("drilling down"),this.tiles[$e]?mn(this.tiles[$e],Oe):null):null};class Je extends X{constructor(re,fe,be,Oe){super(re,fe,be,Xn),this._dataUpdateable=new Map,this.loadGeoJSON=(je,Xe)=>{const{promoteId:$e}=je;if(je.request)return l.getJSON(je.request,(We,Ye,oe,ve)=>{this._dataUpdateable=Or(Ye,$e)?ki(Ye,$e):void 0,Xe(We,Ye,oe,ve)});if(typeof je.data=="string")try{const We=JSON.parse(je.data);this._dataUpdateable=Or(We,$e)?ki(We,$e):void 0,Xe(null,We)}catch{Xe(new Error(`Input data given to '${je.source}' is not a valid GeoJSON object.`))}else je.dataDiff?this._dataUpdateable?(function(We,Ye,oe){var ve,Pe,rt,s;if(Ye.removeAll&&We.clear(),Ye.remove)for(const Z of Ye.remove)We.delete(Z);if(Ye.add)for(const Z of Ye.add){const ft=Rr(Z,oe);ft!=null&&We.set(ft,Z)}if(Ye.update)for(const Z of Ye.update){let ft=We.get(Z.id);if(ft==null)continue;const mt=!Z.removeAllProperties&&(((ve=Z.removeProperties)===null||ve===void 0?void 0:ve.length)>0||((Pe=Z.addOrUpdateProperties)===null||Pe===void 0?void 0:Pe.length)>0);if((Z.newGeometry||Z.removeAllProperties||mt)&&(ft={...ft},We.set(Z.id,ft),mt&&(ft.properties={...ft.properties})),Z.newGeometry&&(ft.geometry=Z.newGeometry),Z.removeAllProperties)ft.properties={};else if(((rt=Z.removeProperties)===null||rt===void 0?void 0:rt.length)>0)for(const kt of Z.removeProperties)Object.prototype.hasOwnProperty.call(ft.properties,kt)&&delete ft.properties[kt];if(((s=Z.addOrUpdateProperties)===null||s===void 0?void 0:s.length)>0)for(const{key:kt,value:yt}of Z.addOrUpdateProperties)ft.properties[kt]=yt}}(this._dataUpdateable,je.dataDiff,$e),Xe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Xe(new Error(`Cannot update existing geojson data in ${je.source}`)):Xe(new Error(`Input data given to '${je.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},Oe&&(this.loadGeoJSON=Oe)}loadData(re,fe){var be;(be=this._pendingRequest)===null||be===void 0||be.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const Oe=!!(re&&re.request&&re.request.collectResourceTiming)&&new l.RequestPerformance(re.request);this._pendingCallback=fe,this._pendingRequest=this.loadGeoJSON(re,(je,Xe)=>{if(delete this._pendingCallback,delete this._pendingRequest,je||!Xe)return fe(je);if(typeof Xe!="object")return fe(new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`));{ie(Xe,!0);try{if(re.filter){const We=l.createExpression(re.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(We.result==="error")throw new Error(We.value.map(oe=>`${oe.key}: ${oe.message}`).join(", "));Xe={type:"FeatureCollection",features:Xe.features.filter(oe=>We.value.evaluate({zoom:0},oe))}}this._geoJSONIndex=re.cluster?new qi(function({superclusterOptions:We,clusterProperties:Ye}){if(!Ye||!We)return We;const oe={},ve={},Pe={accumulated:null,zoom:0},rt={properties:null},s=Object.keys(Ye);for(const Z of s){const[ft,mt]=Ye[Z],kt=l.createExpression(mt),yt=l.createExpression(typeof ft=="string"?[ft,["accumulated"],["get",Z]]:ft);oe[Z]=kt.value,ve[Z]=yt.value}return We.map=Z=>{rt.properties=Z;const ft={};for(const mt of s)ft[mt]=oe[mt].evaluate(Pe,rt);return ft},We.reduce=(Z,ft)=>{rt.properties=ft;for(const mt of s)Pe.accumulated=Z[mt],Z[mt]=ve[mt].evaluate(Pe,rt)},We}(re)).load(Xe.features):function(We,Ye){return new ss(We,Ye)}(Xe,re.geojsonVtOptions)}catch(We){return fe(We)}this.loaded={};const $e={};if(Oe){const We=Oe.finish();We&&($e.resourceTiming={},$e.resourceTiming[re.source]=JSON.parse(JSON.stringify(We)))}fe(null,$e)}})}reloadTile(re,fe){const be=this.loaded;return be&&be[re.uid]?super.reloadTile(re,fe):this.loadTile(re,fe)}removeSource(re,fe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),fe()}getClusterExpansionZoom(re,fe){try{fe(null,this._geoJSONIndex.getClusterExpansionZoom(re.clusterId))}catch(be){fe(be)}}getClusterChildren(re,fe){try{fe(null,this._geoJSONIndex.getChildren(re.clusterId))}catch(be){fe(be)}}getClusterLeaves(re,fe){try{fe(null,this._geoJSONIndex.getLeaves(re.clusterId,re.limit,re.offset))}catch(be){fe(be)}}}class os{constructor(re){this.self=re,this.actor=new l.Actor(re,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:X,geojson:Je},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(fe,be)=>{if(this.workerSourceTypes[fe])throw new Error(`Worker source with name "${fe}" already registered.`);this.workerSourceTypes[fe]=be},this.self.registerRTLTextPlugin=fe=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=fe.applyArabicShaping,l.plugin.processBidirectionalText=fe.processBidirectionalText,l.plugin.processStyledBidirectionalText=fe.processStyledBidirectionalText}}setReferrer(re,fe){this.referrer=fe}setImages(re,fe,be){this.availableImages[re]=fe;for(const Oe in this.workerSources[re]){const je=this.workerSources[re][Oe];for(const Xe in je)je[Xe].availableImages=fe}be()}setLayers(re,fe,be){this.getLayerIndex(re).replace(fe),be()}updateLayers(re,fe,be){this.getLayerIndex(re).update(fe.layers,fe.removedIds),be()}loadTile(re,fe,be){this.getWorkerSource(re,fe.type,fe.source).loadTile(fe,be)}loadDEMTile(re,fe,be){this.getDEMWorkerSource(re,fe.source).loadTile(fe,be)}reloadTile(re,fe,be){this.getWorkerSource(re,fe.type,fe.source).reloadTile(fe,be)}abortTile(re,fe,be){this.getWorkerSource(re,fe.type,fe.source).abortTile(fe,be)}removeTile(re,fe,be){this.getWorkerSource(re,fe.type,fe.source).removeTile(fe,be)}removeDEMTile(re,fe){this.getDEMWorkerSource(re,fe.source).removeTile(fe)}removeSource(re,fe,be){if(!this.workerSources[re]||!this.workerSources[re][fe.type]||!this.workerSources[re][fe.type][fe.source])return;const Oe=this.workerSources[re][fe.type][fe.source];delete this.workerSources[re][fe.type][fe.source],Oe.removeSource!==void 0?Oe.removeSource(fe,be):be()}loadWorkerSource(re,fe,be){try{this.self.importScripts(fe.url),be()}catch(Oe){be(Oe.toString())}}syncRTLPluginState(re,fe,be){try{l.plugin.setState(fe);const Oe=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&Oe!=null){this.self.importScripts(Oe);const je=l.plugin.isParsed();be(je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Oe}`),je)}}catch(Oe){be(Oe.toString())}}getAvailableImages(re){let fe=this.availableImages[re];return fe||(fe=[]),fe}getLayerIndex(re){let fe=this.layerIndexes[re];return fe||(fe=this.layerIndexes[re]=new S),fe}getWorkerSource(re,fe,be){if(this.workerSources[re]||(this.workerSources[re]={}),this.workerSources[re][fe]||(this.workerSources[re][fe]={}),!this.workerSources[re][fe][be]){const Oe={send:(je,Xe,$e)=>{this.actor.send(je,Xe,$e,re)}};this.workerSources[re][fe][be]=new this.workerSourceTypes[fe](Oe,this.getLayerIndex(re),this.getAvailableImages(re))}return this.workerSources[re][fe][be]}getDEMWorkerSource(re,fe){return this.demWorkerSources[re]||(this.demWorkerSources[re]={}),this.demWorkerSources[re][fe]||(this.demWorkerSources[re][fe]=new ee),this.demWorkerSources[re][fe]}}return l.isWorker()&&(self.worker=new os(self)),os}),A(["./shared"],function(l){var S="3.3.1";class k{static testProp(a){if(!k.docStyle)return a[0];for(let m=0;m<a.length;m++)if(a[m]in k.docStyle)return a[m];return a[0]}static create(a,m,w){const T=window.document.createElement(a);return m!==void 0&&(T.className=m),w&&w.appendChild(T),T}static createNS(a,m){return window.document.createElementNS(a,m)}static disableDrag(){k.docStyle&&k.selectProp&&(k.userSelect=k.docStyle[k.selectProp],k.docStyle[k.selectProp]="none")}static enableDrag(){k.docStyle&&k.selectProp&&(k.docStyle[k.selectProp]=k.userSelect)}static setTransform(a,m){a.style[k.transformProp]=m}static addEventListener(a,m,w,T={}){a.addEventListener(m,w,"passive"in T?T:T.capture)}static removeEventListener(a,m,w,T={}){a.removeEventListener(m,w,"passive"in T?T:T.capture)}static suppressClickInternal(a){a.preventDefault(),a.stopPropagation(),window.removeEventListener("click",k.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",k.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",k.suppressClickInternal,!0)},0)}static mousePos(a,m){const w=a.getBoundingClientRect();return new l.Point(m.clientX-w.left-a.clientLeft,m.clientY-w.top-a.clientTop)}static touchPos(a,m){const w=a.getBoundingClientRect(),T=[];for(let I=0;I<m.length;I++)T.push(new l.Point(m[I].clientX-w.left-a.clientLeft,m[I].clientY-w.top-a.clientTop));return T}static mouseButton(a){return a.button}static remove(a){a.parentNode&&a.parentNode.removeChild(a)}}k.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,k.selectProp=k.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),k.transformProp=k.testProp(["transform","WebkitTransform"]);const U={supported:!1,testSupport:function(M){!X&&$&&(ee?ue(M):V=M)}};let V,$,X=!1,ee=!1;function ue(M){const a=M.createTexture();M.bindTexture(M.TEXTURE_2D,a);try{if(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,$),M.isContextLost())return;U.supported=!0}catch{}M.deleteTexture(a),X=!0}var we,ie;typeof document<"u"&&($=document.createElement("img"),$.onload=function(){V&&ue(V),V=null,ee=!0},$.onerror=function(){X=!0,V=null},$.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(M){let a,m,w,T;M.resetRequestQueue=()=>{a=[],m=0,w=0,T={}},M.addThrottleControl=g=>{const y=w++;return T[y]=g,y},M.removeThrottleControl=g=>{delete T[g],c()},M.getImage=(g,y,b=!0)=>{U.supported&&(g.headers||(g.headers={}),g.headers.accept="image/webp,*/*");const P={requestParameters:g,supportImageRefresh:b,callback:y,cancelled:!1,completed:!1,cancel:()=>{P.completed||P.cancelled||(P.cancelled=!0,P.innerRequest&&(P.innerRequest.cancel(),m--),c())}};return a.push(P),c(),P};const I=g=>{const{requestParameters:y,supportImageRefresh:b,callback:P}=g;return l.extend(y,{type:"image"}),(b!==!1||l.isWorker()||l.getProtocolAction(y.url)||y.headers&&!Object.keys(y.headers).reduce((D,N)=>D&&N==="accept",!0)?l.makeRequest:f)(y,(D,N,G,W)=>{u(g,P,D,N,G,W)})},u=(g,y,b,P,D,N)=>{b?y(b):P instanceof HTMLImageElement||l.isImageBitmap(P)?y(null,P):P&&((G,W)=>{typeof createImageBitmap=="function"?l.arrayBufferToImageBitmap(G,W):l.arrayBufferToImage(G,W)})(P,(G,W)=>{G!=null?y(G):W!=null&&y(null,W,{cacheControl:D,expires:N})}),g.cancelled||(g.completed=!0,m--,c())},c=()=>{const g=(()=>{const y=Object.keys(T);let b=!1;if(y.length>0){for(const P of y)if(b=T[P](),b)break}return b})()?l.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let y=m;y<g&&a.length>0;y++){const b=a.shift();if(b.cancelled){y--;continue}const P=I(b);m++,b.innerRequest=P}},f=(g,y)=>{const b=new Image,P=g.url;let D=!1;const N=g.credentials;return N&&N==="include"?b.crossOrigin="use-credentials":(N&&N==="same-origin"||!l.sameOrigin(P))&&(b.crossOrigin="anonymous"),b.fetchPriority="high",b.onload=()=>{y(null,b),b.onerror=b.onload=null},b.onerror=()=>{D||y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),b.onerror=b.onload=null},b.src=P,{cancel:()=>{D=!0,b.src=""}}}}(we||(we={})),we.resetRequestQueue(),function(M){M.Glyphs="Glyphs",M.Image="Image",M.Source="Source",M.SpriteImage="SpriteImage",M.SpriteJSON="SpriteJSON",M.Style="Style",M.Tile="Tile",M.Unknown="Unknown"}(ie||(ie={}));class Ae{constructor(a){this._transformRequestFn=a}transformRequest(a,m){return this._transformRequestFn&&this._transformRequestFn(a,m)||{url:a}}normalizeSpriteURL(a,m,w){const T=function(I){const u=I.match(ce);if(!u)throw new Error(`Unable to parse URL "${I}"`);return{protocol:u[1],authority:u[2],path:u[3]||"/",params:u[4]?u[4].split("&"):[]}}(a);return T.path+=`${m}${w}`,function(I){const u=I.params.length?`?${I.params.join("&")}`:"";return`${I.protocol}://${I.authority}${I.path}${u}`}(T)}setTransformRequest(a){this._transformRequestFn=a}}const ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ce(M){var a=new l.ARRAY_TYPE(3);return a[0]=M[0],a[1]=M[1],a[2]=M[2],a}var Ne,qe=function(M,a,m){return M[0]=a[0]-m[0],M[1]=a[1]-m[1],M[2]=a[2]-m[2],M};Ne=new l.ARRAY_TYPE(3),l.ARRAY_TYPE!=Float32Array&&(Ne[0]=0,Ne[1]=0,Ne[2]=0);var tt=function(M){var a=M[0],m=M[1];return a*a+m*m};function lt(M){const a=[];if(typeof M=="string")a.push({id:"default",url:M});else if(M&&M.length>0){const m=[];for(const{id:w,url:T}of M){const I=`${w}${T}`;m.indexOf(I)===-1&&(m.push(I),a.push({id:w,url:T}))}}return a}function at(M,a,m,w,T){if(w)return void M(w);if(T!==Object.values(a).length||T!==Object.values(m).length)return;const I={};for(const u in a){I[u]={};const c=l.browser.getImageCanvasContext(m[u]),f=a[u];for(const g in f){const{width:y,height:b,x:P,y:D,sdf:N,pixelRatio:G,stretchX:W,stretchY:K,content:de}=f[g];I[u][g]={data:null,pixelRatio:G,sdf:N,stretchX:W,stretchY:K,content:de,spriteData:{width:y,height:b,x:P,y:D,context:c}}}}M(null,I)}(function(){var M=new l.ARRAY_TYPE(2);l.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0)})();class ht{constructor(a,m,w,T){this.context=a,this.format=w,this.texture=a.gl.createTexture(),this.update(m,T)}update(a,m,w){const{width:T,height:I}=a,u=!(this.size&&this.size[0]===T&&this.size[1]===I||w),{context:c}=this,{gl:f}=c;if(this.useMipmap=!!(m&&m.useMipmap),f.bindTexture(f.TEXTURE_2D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(this.format===f.RGBA&&(!m||m.premultiply!==!1)),u)this.size=[T,I],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||l.isImageBitmap(a)?f.texImage2D(f.TEXTURE_2D,0,this.format,this.format,f.UNSIGNED_BYTE,a):f.texImage2D(f.TEXTURE_2D,0,this.format,T,I,0,this.format,f.UNSIGNED_BYTE,a.data);else{const{x:g,y}=w||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||l.isImageBitmap(a)?f.texSubImage2D(f.TEXTURE_2D,0,g,y,f.RGBA,f.UNSIGNED_BYTE,a):f.texSubImage2D(f.TEXTURE_2D,0,g,y,T,I,f.RGBA,f.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&f.generateMipmap(f.TEXTURE_2D)}bind(a,m,w){const{context:T}=this,{gl:I}=T;I.bindTexture(I.TEXTURE_2D,this.texture),w!==I.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(w=I.LINEAR),a!==this.filter&&(I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,a),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,w||a),this.filter=a),m!==this.wrap&&(I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_S,m),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_WRAP_T,m),this.wrap=m)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}function Et(M){const{userImage:a}=M;return!!(a&&a.render&&a.render())&&(M.data.replace(new Uint8Array(a.data.buffer)),!0)}class St extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:m,callback:w}of this.requestors)this._notify(m,w);this.requestors=[]}}getImage(a){const m=this.images[a];if(m&&!m.data&&m.spriteData){const w=m.spriteData;m.data=new l.RGBAImage({width:w.width,height:w.height},w.context.getImageData(w.x,w.y,w.width,w.height).data),m.spriteData=null}return m}addImage(a,m){if(this.images[a])throw new Error(`Image id ${a} already exist, use updateImage instead`);this._validate(a,m)&&(this.images[a]=m)}_validate(a,m){let w=!0;const T=m.data||m.spriteData;return this._validateStretch(m.stretchX,T&&T.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),w=!1),this._validateStretch(m.stretchY,T&&T.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),w=!1),this._validateContent(m.content,m)||(this.fire(new l.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),w=!1),w}_validateStretch(a,m){if(!a)return!0;let w=0;for(const T of a){if(T[0]<w||T[1]<T[0]||m<T[1])return!1;w=T[1]}return!0}_validateContent(a,m){if(!a)return!0;if(a.length!==4)return!1;const w=m.spriteData,T=w&&w.width||m.data.width,I=w&&w.height||m.data.height;return!(a[0]<0||T<a[0]||a[1]<0||I<a[1]||a[2]<0||T<a[2]||a[3]<0||I<a[3]||a[2]<a[0]||a[3]<a[1])}updateImage(a,m,w=!0){const T=this.getImage(a);if(w&&(T.data.width!==m.data.width||T.data.height!==m.data.height))throw new Error(`size mismatch between old image (${T.data.width}x${T.data.height}) and new image (${m.data.width}x${m.data.height}).`);m.version=T.version+1,this.images[a]=m,this.updatedImages[a]=!0}removeImage(a){const m=this.images[a];delete this.images[a],delete this.patterns[a],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,m){let w=!0;if(!this.isLoaded())for(const T of a)this.images[T]||(w=!1);this.isLoaded()||w?this._notify(a,m):this.requestors.push({ids:a,callback:m})}_notify(a,m){const w={};for(const T of a){let I=this.getImage(T);I||(this.fire(new l.Event("styleimagemissing",{id:T})),I=this.getImage(T)),I?w[T]={data:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:!!(I.userImage&&I.userImage.render)}:l.warnOnce(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,w)}getPixelSize(){const{width:a,height:m}=this.atlasImage;return{width:a,height:m}}getPattern(a){const m=this.patterns[a],w=this.getImage(a);if(!w)return null;if(m&&m.position.version===w.version)return m.position;if(m)m.position.version=w.version;else{const T={w:w.data.width+2,h:w.data.height+2,x:0,y:0},I=new l.ImagePosition(T,w);this.patterns[a]={bin:T,position:I}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const m=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ht(a,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const I in this.patterns)a.push(this.patterns[I].bin);const{w:m,h:w}=l.potpack(a),T=this.atlasImage;T.resize({width:m||1,height:w||1});for(const I in this.patterns){const{bin:u}=this.patterns[I],c=u.x+1,f=u.y+1,g=this.getImage(I).data,y=g.width,b=g.height;l.RGBAImage.copy(g,T,{x:0,y:0},{x:c,y:f},{width:y,height:b}),l.RGBAImage.copy(g,T,{x:0,y:b-1},{x:c,y:f-1},{width:y,height:1}),l.RGBAImage.copy(g,T,{x:0,y:0},{x:c,y:f+b},{width:y,height:1}),l.RGBAImage.copy(g,T,{x:y-1,y:0},{x:c-1,y:f},{width:1,height:b}),l.RGBAImage.copy(g,T,{x:0,y:0},{x:c+y,y:f},{width:1,height:b})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const m of a){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const w=this.getImage(m);w||l.warnOnce(`Image with ID: "${m}" was not found`),Et(w)&&this.updateImage(m,w)}}}const Mt=1e20;function Kt(M,a,m,w,T,I,u,c,f){for(let g=a;g<a+w;g++)pn(M,m*I+g,I,T,u,c,f);for(let g=m;g<m+T;g++)pn(M,g*I+a,1,w,u,c,f)}function pn(M,a,m,w,T,I,u){I[0]=0,u[0]=-Mt,u[1]=Mt,T[0]=M[a];for(let c=1,f=0,g=0;c<w;c++){T[c]=M[a+c*m];const y=c*c;do{const b=I[f];g=(T[c]-T[b]+y-b*b)/(c-b)/2}while(g<=u[f]&&--f>-1);f++,I[f]=c,u[f]=g,u[f+1]=Mt}for(let c=0,f=0;c<w;c++){for(;u[f+1]<c;)f++;const g=I[f],y=c-g;M[a+c*m]=T[g]+y*y}}class ei{constructor(a,m){this.requestManager=a,this.localIdeographFontFamily=m,this.entries={}}setURL(a){this.url=a}getGlyphs(a,m){const w=[];for(const T in a)for(const I of a[T])w.push({stack:T,id:I});l.asyncAll(w,({stack:T,id:I},u)=>{let c=this.entries[T];c||(c=this.entries[T]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[I];if(f!==void 0)return void u(null,{stack:T,id:I,glyph:f});if(f=this._tinySDF(c,T,I),f)return c.glyphs[I]=f,void u(null,{stack:T,id:I,glyph:f});const g=Math.floor(I/256);if(256*g>65535)return void u(new Error("glyphs > 65535 not supported"));if(c.ranges[g])return void u(null,{stack:T,id:I,glyph:f});if(!this.url)return void u(new Error("glyphsUrl is not set"));let y=c.requests[g];y||(y=c.requests[g]=[],ei.loadGlyphRange(T,g,this.url,this.requestManager,(b,P)=>{if(P){for(const D in P)this._doesCharSupportLocalGlyph(+D)||(c.glyphs[+D]=P[+D]);c.ranges[g]=!0}for(const D of y)D(b,P);delete c.requests[g]})),y.push((b,P)=>{b?u(b):P&&u(null,{stack:T,id:I,glyph:P[I]||null})})},(T,I)=>{if(T)m(T);else if(I){const u={};for(const{stack:c,id:f,glyph:g}of I)(u[c]||(u[c]={}))[f]=g&&{id:g.id,bitmap:g.bitmap.clone(),metrics:g.metrics};m(null,u)}})}_doesCharSupportLocalGlyph(a){return!!this.localIdeographFontFamily&&(l.unicodeBlockLookup["CJK Unified Ideographs"](a)||l.unicodeBlockLookup["Hangul Syllables"](a)||l.unicodeBlockLookup.Hiragana(a)||l.unicodeBlockLookup.Katakana(a))}_tinySDF(a,m,w){const T=this.localIdeographFontFamily;if(!T||!this._doesCharSupportLocalGlyph(w))return;let I=a.tinySDF;if(!I){let c="400";/bold/i.test(m)?c="900":/medium/i.test(m)?c="500":/light/i.test(m)&&(c="200"),I=a.tinySDF=new ei.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:T,fontWeight:c})}const u=I.draw(String.fromCharCode(w));return{id:w,bitmap:new l.AlphaImage({width:u.width||30,height:u.height||30},u.data),metrics:{width:u.glyphWidth||24,height:u.glyphHeight||24,left:u.glyphLeft||0,top:u.glyphTop-27||-8,advance:u.glyphAdvance||24}}}}ei.loadGlyphRange=function(M,a,m,w,T){const I=256*a,u=I+255,c=w.transformRequest(m.replace("{fontstack}",M).replace("{range}",`${I}-${u}`),ie.Glyphs);l.getArrayBuffer(c,(f,g)=>{if(f)T(f);else if(g){const y={};for(const b of l.parseGlyphPbf(g))y[b.id]=b;T(null,y)}})},ei.TinySDF=class{constructor({fontSize:M=24,buffer:a=3,radius:m=8,cutoff:w=.25,fontFamily:T="sans-serif",fontWeight:I="normal",fontStyle:u="normal"}={}){this.buffer=a,this.cutoff=w,this.radius=m;const c=this.size=M+4*a,f=this._createCanvas(c),g=this.ctx=f.getContext("2d",{willReadFrequently:!0});g.font=`${u} ${I} ${M}px ${T}`,g.textBaseline="alphabetic",g.textAlign="left",g.fillStyle="black",this.gridOuter=new Float64Array(c*c),this.gridInner=new Float64Array(c*c),this.f=new Float64Array(c),this.z=new Float64Array(c+1),this.v=new Uint16Array(c)}_createCanvas(M){const a=document.createElement("canvas");return a.width=a.height=M,a}draw(M){const{width:a,actualBoundingBoxAscent:m,actualBoundingBoxDescent:w,actualBoundingBoxLeft:T,actualBoundingBoxRight:I}=this.ctx.measureText(M),u=Math.ceil(m),c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(I-T))),f=Math.min(this.size-this.buffer,u+Math.ceil(w)),g=c+2*this.buffer,y=f+2*this.buffer,b=Math.max(g*y,0),P=new Uint8ClampedArray(b),D={data:P,width:g,height:y,glyphWidth:c,glyphHeight:f,glyphTop:u,glyphLeft:0,glyphAdvance:a};if(c===0||f===0)return D;const{ctx:N,buffer:G,gridInner:W,gridOuter:K}=this;N.clearRect(G,G,c,f),N.fillText(M,G,G+u);const de=N.getImageData(G,G,c,f);K.fill(Mt,0,b),W.fill(0,0,b);for(let te=0;te<f;te++)for(let se=0;se<c;se++){const xe=de.data[4*(te*c+se)+3]/255;if(xe===0)continue;const Ie=(te+G)*g+se+G;if(xe===1)K[Ie]=0,W[Ie]=Mt;else{const Fe=.5-xe;K[Ie]=Fe>0?Fe*Fe:0,W[Ie]=Fe<0?Fe*Fe:0}}Kt(K,0,0,g,y,g,this.f,this.v,this.z),Kt(W,G,G,c,f,g,this.f,this.v,this.z);for(let te=0;te<b;te++){const se=Math.sqrt(K[te])-Math.sqrt(W[te]);P[te]=Math.round(255-255*(se/this.radius+this.cutoff))}return D}};class li{constructor(){this.specification=l.v8Spec.light.position}possiblyEvaluate(a,m){return l.sphericalToCartesian(a.expression.evaluate(m))}interpolate(a,m,w){return{x:l.interpolate.number(a.x,m.x,w),y:l.interpolate.number(a.y,m.y,w),z:l.interpolate.number(a.z,m.z,w)}}}let Nt,dn;class vn extends l.Evented{constructor(a){super(),Nt=Nt||new l.Properties({anchor:new l.DataConstantProperty(l.v8Spec.light.anchor),position:new li,color:new l.DataConstantProperty(l.v8Spec.light.color),intensity:new l.DataConstantProperty(l.v8Spec.light.intensity)}),this._transitionable=new l.Transitionable(Nt),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,m={}){if(!this._validate(l.validateLight,a,m))for(const w in a){const T=a[w];w.endsWith("-transition")?this._transitionable.setTransition(w.slice(0,-11),T):this._transitionable.setValue(w,T)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,m,w){return(!w||w.validate!==!1)&&l.emitValidationErrors(this,a.call(l.validateStyle,l.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:l.v8Spec})))}}class Bn{constructor(a,m){this.width=a,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(a,m){const w=a.join(",")+String(m);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(a,m)),this.dashEntry[w]}getDashRanges(a,m,w){const T=[];let I=a.length%2==1?-a[a.length-1]*w:0,u=a[0]*w,c=!0;T.push({left:I,right:u,isDash:c,zeroLength:a[0]===0});let f=a[0];for(let g=1;g<a.length;g++){c=!c;const y=a[g];I=f*w,f+=y,u=f*w,T.push({left:I,right:u,isDash:c,zeroLength:y===0})}return T}addRoundDash(a,m,w){const T=m/2;for(let I=-w;I<=w;I++){const u=this.width*(this.nextRow+w+I);let c=0,f=a[c];for(let g=0;g<this.width;g++){g/f.right>1&&(f=a[++c]);const y=Math.abs(g-f.left),b=Math.abs(g-f.right),P=Math.min(y,b);let D;const N=I/w*(T+1);if(f.isDash){const G=T-Math.abs(N);D=Math.sqrt(P*P+G*G)}else D=T-Math.sqrt(P*P+N*N);this.data[u+g]=Math.max(0,Math.min(255,D+128))}}}addRegularDash(a){for(let c=a.length-1;c>=0;--c){const f=a[c],g=a[c+1];f.zeroLength?a.splice(c,1):g&&g.isDash===f.isDash&&(g.left=f.left,a.splice(c,1))}const m=a[0],w=a[a.length-1];m.isDash===w.isDash&&(m.left=w.left-this.width,w.right=m.right+this.width);const T=this.width*this.nextRow;let I=0,u=a[I];for(let c=0;c<this.width;c++){c/u.right>1&&(u=a[++I]);const f=Math.abs(c-u.left),g=Math.abs(c-u.right),y=Math.min(f,g);this.data[T+c]=Math.max(0,Math.min(255,(u.isDash?y:-y)+128))}}addDash(a,m){const w=m?7:0,T=2*w+1;if(this.nextRow+T>this.height)return l.warnOnce("LineAtlas out of space"),null;let I=0;for(let c=0;c<a.length;c++)I+=a[c];if(I!==0){const c=this.width/I,f=this.getDashRanges(a,this.width,c);m?this.addRoundDash(f,c,w):this.addRegularDash(f)}const u={y:(this.nextRow+w+.5)/this.height,height:2*w/this.height,width:I};return this.nextRow+=T,this.dirty=!0,u}bind(a){const m=a.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))}}class Tn{constructor(a,m,w){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=w;const T=this.workerPool.acquire(w);for(let I=0;I<T.length;I++){const u=new Tn.Actor(T[I],m,w);u.name=`Worker ${I}`,this.actors.push(u)}if(!this.actors.length)throw new Error("No actors found")}broadcast(a,m,w){l.asyncAll(this.actors,(T,I)=>{T.send(a,m,I)},w=w||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(a=!0){this.actors.forEach(m=>{m.remove()}),this.actors=[],a&&this.workerPool.release(this.id)}}function wi(M,a,m){const w=function(T,I){if(T)return m(T);if(I){const u=l.pick(l.extend(I,M),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(u.vectorLayers=I.vector_layers,u.vectorLayerIds=u.vectorLayers.map(c=>c.id)),m(null,u)}};return M.url?l.getJSON(a.transformRequest(M.url,ie.Source),w):l.browser.frame(()=>w(null,M))}Tn.Actor=l.Actor;class Un{constructor(a,m){a&&(m?this.setSouthWest(a).setNorthEast(m):Array.isArray(a)&&(a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1])))}setNorthEast(a){return this._ne=a instanceof l.LngLat?new l.LngLat(a.lng,a.lat):l.LngLat.convert(a),this}setSouthWest(a){return this._sw=a instanceof l.LngLat?new l.LngLat(a.lng,a.lat):l.LngLat.convert(a),this}extend(a){const m=this._sw,w=this._ne;let T,I;if(a instanceof l.LngLat)T=a,I=a;else{if(!(a instanceof Un))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Un.convert(a)):this.extend(l.LngLat.convert(a)):a&&("lng"in a||"lon"in a)&&"lat"in a?this.extend(l.LngLat.convert(a)):this;if(T=a._sw,I=a._ne,!T||!I)return this}return m||w?(m.lng=Math.min(T.lng,m.lng),m.lat=Math.min(T.lat,m.lat),w.lng=Math.max(I.lng,w.lng),w.lat=Math.max(I.lat,w.lat)):(this._sw=new l.LngLat(T.lng,T.lat),this._ne=new l.LngLat(I.lng,I.lat)),this}getCenter(){return new l.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new l.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:m,lat:w}=l.LngLat.convert(a);let T=this._sw.lng<=m&&m<=this._ne.lng;return this._sw.lng>this._ne.lng&&(T=this._sw.lng>=m&&m>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&T}static convert(a){return a instanceof Un?a:a&&new Un(a)}static fromLngLat(a,m=0){const w=360*m/40075017,T=w/Math.cos(Math.PI/180*a.lat);return new Un(new l.LngLat(a.lng-T,a.lat-w),new l.LngLat(a.lng+T,a.lat+w))}}class Hr{constructor(a,m,w){this.bounds=Un.convert(this.validateBounds(a)),this.minzoom=m||0,this.maxzoom=w||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const m=Math.pow(2,a.z),w=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*m),T=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*m),I=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*m),u=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*m);return a.x>=w&&a.x<I&&a.y>=T&&a.y<u}}class qi extends l.Evented{constructor(a,m,w,T){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=wi(this._options,this.map._requestManager,(I,u)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),I?this.fire(new l.ErrorEvent(I)):u&&(l.extend(this,u),u.bounds&&(this.tileBounds=new Hr(u.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.extend({},this._options),this.id=a,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(m,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T)}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}setSourceProperty(a){this._tileJSONRequest&&this._tileJSONRequest.cancel(),a(),this.load()}setTiles(a){return this.setSourceProperty(()=>{this._options.tiles=a}),this}setUrl(a){return this.setSourceProperty(()=>{this.url=a,this._options.url=a}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(a,m){const w=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),T={request:this.map._requestManager.transformRequest(w,ie.Tile),uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function I(u,c){return delete a.request,a.aborted?m(null):u&&u.status!==404?m(u):(c&&c.resourceTiming&&(a.resourceTiming=c.resourceTiming),this.map._refreshExpiredTiles&&c&&a.setExpiryData(c),a.loadVectorData(c,this.map.painter),m(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}T.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired"?a.state==="loading"?a.reloadCallback=m:a.request=a.actor.send("reloadTile",T,I.bind(this)):(a.actor=this.dispatcher.getActor(),a.request=a.actor.send("loadTile",T,I.bind(this)))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)}unloadTile(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class ti extends l.Evented{constructor(a,m,w,T){super(),this.id=a,this.dispatcher=w,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},m),l.extend(this,l.pick(m,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=wi(this._options,this.map._requestManager,(a,m)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new l.ErrorEvent(a)):m&&(l.extend(this,m),m.bounds&&(this.tileBounds=new Hr(m.bounds,this.minzoom,this.maxzoom)),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,m){const w=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);a.request=we.getImage(this.map._requestManager.transformRequest(w,ie.Tile),(T,I,u)=>{if(delete a.request,a.aborted)a.state="unloaded",m(null);else if(T)a.state="errored",m(T);else if(I){this.map._refreshExpiredTiles&&u&&a.setExpiryData(u);const c=this.map.painter.context,f=c.gl;a.texture=this.map.painter.getTileTexture(I.width),a.texture?a.texture.update(I,{useMipmap:!0}):(a.texture=new ht(c,I,f.RGBA,{useMipmap:!0}),a.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),c.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax)),a.state="loaded",m(null)}},this.map._refreshExpiredTiles)}abortTile(a,m){a.request&&(a.request.cancel(),delete a.request),m()}unloadTile(a,m){a.texture&&this.map.painter.saveTileTexture(a.texture),m()}hasTransition(){return!1}}class kr extends ti{constructor(a,m,w,T){super(a,m,w,T),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox"}loadTile(a,m){const w=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function T(I,u){I&&(a.state="errored",m(I)),u&&(a.dem=u,a.needsHillshadePrepare=!0,a.needsTerrainPrepare=!0,a.state="loaded",m(null))}a.request=we.getImage(this.map._requestManager.transformRequest(w,ie.Tile),(function(I,u){if(delete a.request,a.aborted)a.state="unloaded",m(null);else if(I)a.state="errored",m(I);else if(u){this.map._refreshExpiredTiles&&a.setExpiryData(u),delete u.cacheControl,delete u.expires;const c=l.isImageBitmap(u)&&(dn==null&&(dn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),dn)?u:l.browser.getImageData(u,1),f={uid:a.uid,coord:a.tileID,source:this.id,rawImageData:c,encoding:this.encoding};a.actor&&a.state!=="expired"||(a.actor=this.dispatcher.getActor(),a.actor.send("loadDEMTile",f,T.bind(this)))}}).bind(this),this.map._refreshExpiredTiles),a.neighboringTiles=this._getNeighboringTiles(a.tileID)}_getNeighboringTiles(a){const m=a.canonical,w=Math.pow(2,m.z),T=(m.x-1+w)%w,I=m.x===0?a.wrap-1:a.wrap,u=(m.x+1+w)%w,c=m.x+1===w?a.wrap+1:a.wrap,f={};return f[new l.OverscaledTileID(a.overscaledZ,I,m.z,T,m.y).key]={backfilled:!1},f[new l.OverscaledTileID(a.overscaledZ,c,m.z,u,m.y).key]={backfilled:!1},m.y>0&&(f[new l.OverscaledTileID(a.overscaledZ,I,m.z,T,m.y-1).key]={backfilled:!1},f[new l.OverscaledTileID(a.overscaledZ,a.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},f[new l.OverscaledTileID(a.overscaledZ,c,m.z,u,m.y-1).key]={backfilled:!1}),m.y+1<w&&(f[new l.OverscaledTileID(a.overscaledZ,I,m.z,T,m.y+1).key]={backfilled:!1},f[new l.OverscaledTileID(a.overscaledZ,a.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},f[new l.OverscaledTileID(a.overscaledZ,c,m.z,u,m.y+1).key]={backfilled:!1}),f}unloadTile(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})}}class Yn extends l.Evented{constructor(a,m,w,T){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.extend({},this._options,{type:this.type,data:this._data}),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=w.getActor(),this.setEventedParent(T),this._data=m.data,this._options=l.extend({},m),this._collectResourceTiming=m.collectResourceTiming,m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;const I=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(m.buffer!==void 0?m.buffer:128)*I,tolerance:(m.tolerance!==void 0?m.tolerance:.375)*I,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:m.clusterMaxZoom!==void 0?m.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:l.EXTENT,radius:(m.clusterRadius||50)*I,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(a){this.map=a,this.load()}setData(a){return this._data=a,this._updateWorkerData(),this}updateData(a){return this._updateWorkerData(a),this}setClusterOptions(a){return this.workerOptions.cluster=a.cluster,a&&(a.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=a.clusterRadius),a.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=a.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(a,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},m),this}getClusterChildren(a,m){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},m),this}getClusterLeaves(a,m,w,T){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:m,offset:w},T),this}_updateWorkerData(a){const m=l.extend({},this.workerOptions);a?m.dataDiff=a:typeof this._data=="string"?(m.request=this.map._requestManager.transformRequest(l.browser.resolveURL(this._data),ie.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,m,(w,T)=>{if(this._pendingLoads--,this._removed||T&&T.abandoned)return void this.fire(new l.Event("dataabort",{dataType:"source"}));let I=null;if(T&&T.resourceTiming&&T.resourceTiming[this.id]&&(I=T.resourceTiming[this.id].slice(0)),w)return void this.fire(new l.ErrorEvent(w));const u={dataType:"source"};this._collectResourceTiming&&I&&I.length>0&&l.extend(u,{resourceTiming:I}),this.fire(new l.Event("data",{...u,sourceDataType:"metadata"})),this.fire(new l.Event("data",{...u,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(a,m){const w=a.actor?"reloadTile":"loadTile";a.actor=this.actor;const T={type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};a.request=this.actor.send(w,T,(I,u)=>(delete a.request,a.unloadVectorData(),a.aborted?m(null):I?m(I):(a.loadVectorData(u,this.map.painter,w==="reloadTile"),m(null))))}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0}unloadTile(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var si=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class vr extends l.Evented{constructor(a,m,w,T){super(),this.load=(I,u)=>{this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=we.getImage(this.map._requestManager.transformRequest(this.url,ie.Image),(c,f)=>{this._request=null,this._loaded=!0,c?this.fire(new l.ErrorEvent(c)):f&&(this.image=f,I&&(this.coordinates=I),u&&u(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const I=this.map.painter.context,u=I.gl;this.boundsBuffer||(this.boundsBuffer=I.createVertexBuffer(this._boundsArray,si.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ht(I,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const g=this.tiles[f];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,c=!0)}c&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=a,this.dispatcher=w,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=m}loaded(){return this._loaded}updateImage(a){return a.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=a.url,this.load(a.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(a){this.coordinates=a;const m=a.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(T){let I=1/0,u=1/0,c=-1/0,f=-1/0;for(const P of T)I=Math.min(I,P.x),u=Math.min(u,P.y),c=Math.max(c,P.x),f=Math.max(f,P.y);const g=Math.max(c-I,f-u),y=Math.max(0,Math.floor(-Math.log(g)/Math.LN2)),b=Math.pow(2,y);return new l.CanonicalTileID(y,Math.floor((I+c)/2*b),Math.floor((u+f)/2*b))}(m),this.minzoom=this.maxzoom=this.tileID.z;const w=m.map(T=>this.tileID.getTilePoint(T)._round());return this._boundsArray=new l.RasterBoundsArray,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(w[2].x,w[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(a,m){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},m(null)):(a.state="errored",m(null))}hasTransition(){return!1}}class Lr extends vr{constructor(a,m,w,T){super(a,m,w,T),this.load=()=>{this._loaded=!1;const I=this.options;this.urls=[];for(const u of I.urls)this.urls.push(this.map._requestManager.transformRequest(u,ie.Source).url);l.getVideo(this.urls,(u,c)=>{this._loaded=!0,u?this.fire(new l.ErrorEvent(u)):c&&(this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const I=this.map.painter.context,u=I.gl;this.boundsBuffer||(this.boundsBuffer=I.createVertexBuffer(this._boundsArray,si.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new ht(I,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const g=this.tiles[f];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,c=!0)}c&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=m}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(a){if(this.video){const m=this.video.seekable;a<m.start(0)||a>m.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${m.start(0)} and ${m.end(0)}-second mark.`))):this.video.currentTime=a}}getVideo(){return this.video}onAdd(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class ut extends vr{constructor(a,m,w,T){super(a,m,w,T),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let I=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,I=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,I=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,c=u.gl;this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,si.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(I||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ht(u,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const g in this.tiles){const y=this.tiles[g];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,f=!0)}f&&this.fire(new l.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(I=>!Array.isArray(I)||I.length!==2||I.some(u=>typeof u!="number"))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${a}`,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}getCanvas(){return this.canvas}onAdd(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const a of[this.canvas.width,this.canvas.height])if(isNaN(a)||a<=0)return!0;return!1}}const xr={},rs=M=>{switch(M){case"geojson":return Yn;case"image":return vr;case"raster":return ti;case"raster-dem":return kr;case"vector":return qi;case"video":return Lr;case"canvas":return ut}return xr[M]};function Ln(M,a){const m=l.create();return l.translate(m,m,[1,1,0]),l.scale(m,m,[.5*M.width,.5*M.height,1]),l.multiply(m,m,M.calculatePosMatrix(a.toUnwrapped()))}function gn(M,a,m,w,T,I){const u=function(b,P,D){if(b)for(const N of b){const G=P[N];if(G&&G.source===D&&G.type==="fill-extrusion")return!0}else for(const N in P){const G=P[N];if(G.source===D&&G.type==="fill-extrusion")return!0}return!1}(T&&T.layers,a,M.id),c=I.maxPitchScaleFactor(),f=M.tilesIn(w,c,u);f.sort(ji);const g=[];for(const b of f)g.push({wrappedTileID:b.tileID.wrapped().key,queryResults:b.tile.queryRenderedFeatures(a,m,M._state,b.queryGeometry,b.cameraQueryGeometry,b.scale,T,I,c,Ln(M.transform,b.tileID))});const y=function(b){const P={},D={};for(const N of b){const G=N.queryResults,W=N.wrappedTileID,K=D[W]=D[W]||{};for(const de in G){const te=G[de],se=K[de]=K[de]||{},xe=P[de]=P[de]||[];for(const Ie of te)se[Ie.featureIndex]||(se[Ie.featureIndex]=!0,xe.push(Ie))}}return P}(g);for(const b in y)y[b].forEach(P=>{const D=P.feature,N=M.getFeatureState(D.layer["source-layer"],D.id);D.source=D.layer.source,D.layer["source-layer"]&&(D.sourceLayer=D.layer["source-layer"]),D.state=N});return y}function ji(M,a){const m=M.tileID,w=a.tileID;return m.overscaledZ-w.overscaledZ||m.canonical.y-w.canonical.y||m.wrap-w.wrap||m.canonical.x-w.canonical.x}class Ns{constructor(a,m){this.timeAdded=0,this.fadeEndTime=0,this.tileID=a,this.uid=l.uniqueId(),this.uses=0,this.tileSize=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(a){const m=a+this.timeAdded;m<this.fadeEndTime||(this.fadeEndTime=m)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(a){this.demTexture&&a.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(a,m,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(T,I){const u={};if(!I)return u;for(const c of T){const f=c.layerIds.map(g=>I.getLayer(g)).filter(Boolean);if(f.length!==0){c.layers=f,c.stateDependentLayerIds&&(c.stateDependentLayers=c.stateDependentLayerIds.map(g=>f.filter(y=>y.id===g)[0]));for(const g of f)u[g.id]=c}}return u}(a.buckets,m.style),this.hasSymbolBuckets=!1;for(const T in this.buckets){const I=this.buckets[T];if(I instanceof l.SymbolBucket){if(this.hasSymbolBuckets=!0,!w)break;I.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const T in this.buckets){const I=this.buckets[T];if(I instanceof l.SymbolBucket&&I.hasRTLText){this.hasRTLText=!0,l.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const T in this.buckets){const I=this.buckets[T];this.queryPadding=Math.max(this.queryPadding,m.style.getLayer(T).queryRadius(I))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new l.CollisionBoxArray}unloadVectorData(){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(a){return this.buckets[a.id]}upload(a){for(const w in this.buckets){const T=this.buckets[w];T.uploadPending()&&T.upload(a)}const m=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ht(a,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ht(a,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,m,w,T,I,u,c,f,g,y){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:T,cameraQueryGeometry:I,scale:u,tileSize:this.tileSize,pixelPosMatrix:y,transform:f,params:c,queryPadding:this.queryPadding*g},a,m,w):{}}querySourceFeatures(a,m){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const T=w.loadVTLayers(),I=m&&m.sourceLayer?m.sourceLayer:"",u=T._geojsonTileLayer||T[I];if(!u)return;const c=l.createFilter(m&&m.filter),{z:f,x:g,y}=this.tileID.canonical,b={z:f,x:g,y};for(let P=0;P<u.length;P++){const D=u.feature(P);if(c.needGeometry){const W=l.toEvaluationFeature(D,!0);if(!c.filter(new l.EvaluationParameters(this.tileID.overscaledZ),W,this.tileID.canonical))continue}else if(!c.filter(new l.EvaluationParameters(this.tileID.overscaledZ),D))continue;const N=w.getId(D,I),G=new l.GeoJSONFeature(D,f,g,y,N);G.tile=b,a.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const m=this.expirationTime;if(a.cacheControl){const w=l.parseCacheControl(a.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const w=Date.now();let T=!1;if(this.expirationTime>w)T=!1;else if(m)if(this.expirationTime<m)T=!0;else{const I=this.expirationTime-m;I?this.expirationTime=w+Math.max(I,3e4):T=!0}else T=!0;T?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,m){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0)return;const w=this.latestFeatureIndex.loadVTLayers();for(const T in this.buckets){if(!m.style.hasLayer(T))continue;const I=this.buckets[T],u=I.layers[0].sourceLayer||"_geojsonTileLayer",c=w[u],f=a[u];if(!c||!f||Object.keys(f).length===0)continue;I.update(f,c,this.imageAtlas&&this.imageAtlas.patternPositions||{});const g=m&&m.style&&m.style.getLayer(T);g&&(this.queryPadding=Math.max(this.queryPadding,g.queryRadius(I)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=l.browser.now()+a}setDependencies(a,m){const w={};for(const T of m)w[T]=!0;this.dependencies[a]=w}hasDependency(a,m){for(const w of a){const T=this.dependencies[w];if(T){for(const I of m)if(T[I])return!0}}return!1}}class ro{constructor(a,m){this.max=a,this.onRemove=m,this.reset()}reset(){for(const a in this.data)for(const m of this.data[a])m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value);return this.data={},this.order=[],this}add(a,m,w){const T=a.wrapped().key;this.data[T]===void 0&&(this.data[T]=[]);const I={value:m,timeout:void 0};if(w!==void 0&&(I.timeout=setTimeout(()=>{this.remove(a,I)},w)),this.data[T].push(I),this.order.push(T),this.order.length>this.max){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const m=this.data[a].shift();return m.timeout&&clearTimeout(m.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),m.value}getByKey(a){const m=this.data[a];return m?m[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,m){if(!this.has(a))return this;const w=a.wrapped().key,T=m===void 0?0:this.data[w].indexOf(m),I=this.data[w][T];return this.data[w].splice(T,1),I.timeout&&clearTimeout(I.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(I.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}filter(a){const m=[];for(const w in this.data)for(const T of this.data[w])a(T.value)||m.push(T);for(const w of m)this.remove(w.value.tileID,w)}}class Qn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,m,w){const T=String(m);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][T]=this.stateChanges[a][T]||{},l.extend(this.stateChanges[a][T],w),this.deletedStates[a]===null){this.deletedStates[a]={};for(const I in this.state[a])I!==T&&(this.deletedStates[a][I]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][T]===null){this.deletedStates[a][T]={};for(const I in this.state[a][T])w[I]||(this.deletedStates[a][T][I]=null)}else for(const I in w)this.deletedStates[a]&&this.deletedStates[a][T]&&this.deletedStates[a][T][I]===null&&delete this.deletedStates[a][T][I]}removeFeatureState(a,m,w){if(this.deletedStates[a]===null)return;const T=String(m);if(this.deletedStates[a]=this.deletedStates[a]||{},w&&m!==void 0)this.deletedStates[a][T]!==null&&(this.deletedStates[a][T]=this.deletedStates[a][T]||{},this.deletedStates[a][T][w]=null);else if(m!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][T])for(w in this.deletedStates[a][T]={},this.stateChanges[a][T])this.deletedStates[a][T][w]=null;else this.deletedStates[a][T]=null;else this.deletedStates[a]=null}getState(a,m){const w=String(m),T=l.extend({},(this.state[a]||{})[w],(this.stateChanges[a]||{})[w]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const I=this.deletedStates[a][m];if(I===null)return{};for(const u in I)delete T[u]}return T}initializeTileState(a,m){a.setFeatureState(this.state,m)}coalesceChanges(a,m){const w={};for(const T in this.stateChanges){this.state[T]=this.state[T]||{};const I={};for(const u in this.stateChanges[T])this.state[T][u]||(this.state[T][u]={}),l.extend(this.state[T][u],this.stateChanges[T][u]),I[u]=this.state[T][u];w[T]=I}for(const T in this.deletedStates){this.state[T]=this.state[T]||{};const I={};if(this.deletedStates[T]===null)for(const u in this.state[T])I[u]={},this.state[T][u]={};else for(const u in this.deletedStates[T]){if(this.deletedStates[T][u]===null)this.state[T][u]={};else for(const c of Object.keys(this.deletedStates[T][u]))delete this.state[T][u][c];I[u]=this.state[T][u]}w[T]=w[T]||{},l.extend(w[T],I)}if(this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0)for(const T in a)a[T].setFeatureState(w,m)}}class Jn extends l.Evented{constructor(a,m,w){super(),this.id=a,this.dispatcher=w,this.on("data",T=>{T.dataType==="source"&&T.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&T.dataType==="source"&&T.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((T,I,u,c)=>{const f=new(rs(I.type))(T,I,u,c);if(f.id!==T)throw new Error(`Expected Source id to be ${T} instead of ${f.id}`);return f})(a,m,w,this),this._tiles={},this._cache=new ro(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Qn,this._didEmitContent=!1,this._updated=!1}onAdd(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._maxTileCacheZoomLevels=a?a._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(a)}onRemove(a){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(a)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const a in this._tiles){const m=this._tiles[a];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(a,m){return this._source.loadTile(a,m)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){this._source.abortTile&&this._source.abortTile(a,()=>{}),this._source.fire(new l.Event("dataabort",{tile:a,coord:a.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const m in this._tiles){const w=this._tiles[m];w.upload(a),w.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(a=>a.tileID).sort(so).map(a=>a.key)}getRenderableIds(a){const m=[];for(const w in this._tiles)this._isIdRenderable(w,a)&&m.push(this._tiles[w]);return a?m.sort((w,T)=>{const I=w.tileID,u=T.tileID,c=new l.Point(I.canonical.x,I.canonical.y)._rotate(this.transform.angle),f=new l.Point(u.canonical.x,u.canonical.y)._rotate(this.transform.angle);return I.overscaledZ-u.overscaledZ||f.y-c.y||f.x-c.x}).map(w=>w.tileID.key):m.map(w=>w.tileID).sort(so).map(w=>w.key)}hasRenderableParent(a){const m=this.findLoadedParent(a,0);return!!m&&this._isIdRenderable(m.tileID.key)}_isIdRenderable(a,m){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(m||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(a,m){const w=this._tiles[a];w&&(w.state!=="loading"&&(w.state=m),this._loadTile(w,this._tileLoaded.bind(this,w,a,m)))}_tileLoaded(a,m,w,T){if(T)return a.state="errored",void(T.status!==404?this._source.fire(new l.ErrorEvent(T,{tile:a})):this.update(this.transform,this.terrain));a.timeAdded=l.browser.now(),w==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(m,a),this.getSource().type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),a.aborted||this._source.fire(new l.Event("data",{dataType:"source",tile:a,coord:a.tileID}))}_backfillDEM(a){const m=this.getRenderableIds();for(let T=0;T<m.length;T++){const I=m[T];if(a.neighboringTiles&&a.neighboringTiles[I]){const u=this.getTileByID(I);w(a,u),w(u,a)}}function w(T,I){T.needsHillshadePrepare=!0,T.needsTerrainPrepare=!0;let u=I.tileID.canonical.x-T.tileID.canonical.x;const c=I.tileID.canonical.y-T.tileID.canonical.y,f=Math.pow(2,T.tileID.canonical.z),g=I.tileID.key;u===0&&c===0||Math.abs(c)>1||(Math.abs(u)>1&&(Math.abs(u+f)===1?u+=f:Math.abs(u-f)===1&&(u-=f)),I.dem&&T.dem&&(T.dem.backfillBorder(I.dem,u,c),T.neighboringTiles&&T.neighboringTiles[g]&&(T.neighboringTiles[g].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,m,w,T){for(const I in this._tiles){let u=this._tiles[I];if(T[I]||!u.hasData()||u.tileID.overscaledZ<=m||u.tileID.overscaledZ>w)continue;let c=u.tileID;for(;u&&u.tileID.overscaledZ>m+1;){const g=u.tileID.scaledTo(u.tileID.overscaledZ-1);u=this._tiles[g.key],u&&u.hasData()&&(c=g)}let f=c;for(;f.overscaledZ>m;)if(f=f.scaledTo(f.overscaledZ-1),a[f.key]){T[c.key]=c;break}}}findLoadedParent(a,m){if(a.key in this._loadedParentTiles){const w=this._loadedParentTiles[a.key];return w&&w.tileID.overscaledZ>=m?w:null}for(let w=a.overscaledZ-1;w>=m;w--){const T=a.scaledTo(w),I=this._getLoadedTile(T);if(I)return I}}_getLoadedTile(a){const m=this._tiles[a.key];return m&&m.hasData()?m:this._cache.getByKey(a.wrapped().key)}updateCacheSize(a){const m=Math.ceil(a.width/this._source.tileSize)+1,w=Math.ceil(a.height/this._source.tileSize)+1,T=Math.floor(m*w*(this._maxTileCacheZoomLevels===null?l.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),I=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,T):T;this._cache.setMaxSize(I)}handleWrapJump(a){const m=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,m){const w={};for(const T in this._tiles){const I=this._tiles[T];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+m),w[I.tileID.key]=I}this._tiles=w;for(const T in this._timers)clearTimeout(this._timers[T]),delete this._timers[T];for(const T in this._tiles)this._setTileReloadTimer(T,this._tiles[T])}}update(a,m){if(this.transform=a,this.terrain=m,!this._sourceLoaded||this._paused)return;let w;this.updateCacheSize(a),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?w=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new l.OverscaledTileID(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(w=a.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:m}),this._source.hasTile&&(w=w.filter(y=>this._source.hasTile(y)))):w=[];const T=a.coveringZoomLevel(this._source),I=Math.max(T-Jn.maxOverzooming,this._source.minzoom),u=Math.max(T+Jn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const y={};for(const b of w)if(b.canonical.z>this._source.minzoom){const P=b.scaledTo(b.canonical.z-1);y[P.key]=P;const D=b.scaledTo(Math.max(this._source.minzoom,Math.min(b.canonical.z,5)));y[D.key]=D}w=w.concat(Object.values(y))}const c=w.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,c&&this.fire(new l.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const f=this._updateRetainedTiles(w,T);if(Gi(this._source.type)){const y={},b={},P=Object.keys(f),D=l.browser.now();for(const N of P){const G=f[N],W=this._tiles[N];if(!W||W.fadeEndTime!==0&&W.fadeEndTime<=D)continue;const K=this.findLoadedParent(G,I);K&&(this._addTile(K.tileID),y[K.tileID.key]=K.tileID),b[N]=G}this._retainLoadedChildren(b,T,u,f);for(const N in y)f[N]||(this._coveredTiles[N]=!0,f[N]=y[N]);if(m){const N={},G={};for(const W of w)this._tiles[W.key].hasData()?N[W.key]=W:G[W.key]=W;for(const W in G){const K=G[W].children(this._source.maxzoom);this._tiles[K[0].key]&&this._tiles[K[1].key]&&this._tiles[K[2].key]&&this._tiles[K[3].key]&&(N[K[0].key]=f[K[0].key]=K[0],N[K[1].key]=f[K[1].key]=K[1],N[K[2].key]=f[K[2].key]=K[2],N[K[3].key]=f[K[3].key]=K[3],delete G[W])}for(const W in G){const K=this.findLoadedParent(G[W],this._source.minzoom);if(K){N[K.tileID.key]=f[K.tileID.key]=K.tileID;for(const de in N)N[de].isChildOf(K.tileID)&&delete N[de]}}for(const W in this._tiles)N[W]||(this._coveredTiles[W]=!0)}}for(const y in f)this._tiles[y].clearFadeHold();const g=l.keysDifference(this._tiles,f);for(const y of g){const b=this._tiles[y];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(y)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)}_updateRetainedTiles(a,m){const w={},T={},I=Math.max(m-Jn.maxOverzooming,this._source.minzoom),u=Math.max(m+Jn.maxUnderzooming,this._source.minzoom),c={};for(const f of a){const g=this._addTile(f);w[f.key]=f,g.hasData()||m<this._source.maxzoom&&(c[f.key]=f)}this._retainLoadedChildren(c,m,u,w);for(const f of a){let g=this._tiles[f.key];if(g.hasData())continue;if(m+1>this._source.maxzoom){const b=f.children(this._source.maxzoom)[0],P=this.getTile(b);if(P&&P.hasData()){w[b.key]=b;continue}}else{const b=f.children(this._source.maxzoom);if(w[b[0].key]&&w[b[1].key]&&w[b[2].key]&&w[b[3].key])continue}let y=g.wasRequested();for(let b=f.overscaledZ-1;b>=I;--b){const P=f.scaledTo(b);if(T[P.key])break;if(T[P.key]=!0,g=this.getTile(P),!g&&y&&(g=this._addTile(P)),g){const D=g.hasData();if((y||D)&&(w[P.key]=P),y=g.wasRequested(),D)break}}}return w}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const m=[];let w,T=this._tiles[a].tileID;for(;T.overscaledZ>0;){if(T.key in this._loadedParentTiles){w=this._loadedParentTiles[T.key];break}m.push(T.key);const I=T.scaledTo(T.overscaledZ-1);if(w=this._getLoadedTile(I),w)break;T=I}for(const I of m)this._loadedParentTiles[I]=w}}_addTile(a){let m=this._tiles[a.key];if(m)return m;m=this._cache.getAndRemove(a),m&&(this._setTileReloadTimer(a.key,m),m.tileID=a,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,m)));const w=m;return m||(m=new Ns(a,this._source.tileSize*a.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,a.key,m.state))),m.uses++,this._tiles[a.key]=m,w||this._source.fire(new l.Event("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m}_setTileReloadTimer(a,m){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const w=m.getExpiryTimeout();w&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},w))}_removeTile(a){const m=this._tiles[a];m&&(m.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(a);this._cache.reset()}tilesIn(a,m,w){const T=[],I=this.transform;if(!I)return T;const u=w?I.getCameraQueryGeometry(a):a,c=a.map(N=>I.pointCoordinate(N,this.terrain)),f=u.map(N=>I.pointCoordinate(N,this.terrain)),g=this.getIds();let y=1/0,b=1/0,P=-1/0,D=-1/0;for(const N of f)y=Math.min(y,N.x),b=Math.min(b,N.y),P=Math.max(P,N.x),D=Math.max(D,N.y);for(let N=0;N<g.length;N++){const G=this._tiles[g[N]];if(G.holdingForFade())continue;const W=G.tileID,K=Math.pow(2,I.zoom-G.tileID.overscaledZ),de=m*G.queryPadding*l.EXTENT/G.tileSize/K,te=[W.getTilePoint(new l.MercatorCoordinate(y,b)),W.getTilePoint(new l.MercatorCoordinate(P,D))];if(te[0].x-de<l.EXTENT&&te[0].y-de<l.EXTENT&&te[1].x+de>=0&&te[1].y+de>=0){const se=c.map(Ie=>W.getTilePoint(Ie)),xe=f.map(Ie=>W.getTilePoint(Ie));T.push({tile:G,tileID:W,queryGeometry:se,cameraQueryGeometry:xe,scale:K})}}return T}getVisibleCoordinates(a){const m=this.getRenderableIds(a).map(w=>this._tiles[w].tileID);for(const w of m)w.posMatrix=this.transform.calculatePosMatrix(w.toUnwrapped());return m}hasTransition(){if(this._source.hasTransition())return!0;if(Gi(this._source.type)){const a=l.browser.now();for(const m in this._tiles)if(this._tiles[m].fadeEndTime>=a)return!0}return!1}setFeatureState(a,m,w){this._state.updateState(a=a||"_geojsonTileLayer",m,w)}removeFeatureState(a,m,w){this._state.removeFeatureState(a=a||"_geojsonTileLayer",m,w)}getFeatureState(a,m){return this._state.getState(a=a||"_geojsonTileLayer",m)}setDependencies(a,m,w){const T=this._tiles[a];T&&T.setDependencies(m,w)}reloadTilesForDependencies(a,m){for(const w in this._tiles)this._tiles[w].hasDependency(a,m)&&this._reloadTile(w,"reloading");this._cache.filter(w=>!w.hasDependency(a,m))}}function so(M,a){const m=Math.abs(2*M.wrap)-+(M.wrap<0),w=Math.abs(2*a.wrap)-+(a.wrap<0);return M.overscaledZ-a.overscaledZ||w-m||a.canonical.y-M.canonical.y||a.canonical.x-M.canonical.x}function Gi(M){return M==="raster"||M==="image"||M==="video"}Jn.maxOverzooming=10,Jn.maxUnderzooming=3;const It="mapboxgl_preloaded_worker_pool";class Yi{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<Yi.workerCount;)this.workers.push(new Worker(l.config.WORKER_URL));return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[It]}numActive(){return Object.keys(this.active).length}}const Xi=Math.floor(l.browser.hardwareConcurrency/2);let Dr;function Wr(){return Dr||(Dr=new Yi),Dr}Yi.workerCount=l.isSafari(globalThis)?Math.max(Math.min(Xi,3),1):1;class Lt{constructor(a,m){this.reset(a,m)}reset(a,m){this.points=a||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=l.clamp(a,0,1);let m=1,w=this._distances[m];const T=a*this.paddedLength+this.padding;for(;w<T&&m<this._distances.length;)w=this._distances[++m];const I=m-1,u=this._distances[I],c=w-u,f=c>0?(T-u)/c:0;return this.points[I].mult(1-f).add(this.points[m].mult(f))}}function yn(M,a){let m=!0;return M==="always"||M!=="never"&&a!=="never"||(m=!1),m}class mn{constructor(a,m,w){const T=this.boxCells=[],I=this.circleCells=[];this.xCellCount=Math.ceil(a/w),this.yCellCount=Math.ceil(m/w);for(let u=0;u<this.xCellCount*this.yCellCount;u++)T.push([]),I.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=m,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,m,w,T,I){this._forEachCell(m,w,T,I,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(T),this.bboxes.push(I)}insertCircle(a,m,w,T){this._forEachCell(m-T,w-T,m+T,w+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(m),this.circles.push(w),this.circles.push(T)}_insertBoxCell(a,m,w,T,I,u){this.boxCells[I].push(u)}_insertCircleCell(a,m,w,T,I,u){this.circleCells[I].push(u)}_query(a,m,w,T,I,u,c){if(w<0||a>this.width||T<0||m>this.height)return[];const f=[];if(a<=0&&m<=0&&this.width<=w&&this.height<=T){if(I)return[{key:null,x1:a,y1:m,x2:w,y2:T}];for(let g=0;g<this.boxKeys.length;g++)f.push({key:this.boxKeys[g],x1:this.bboxes[4*g],y1:this.bboxes[4*g+1],x2:this.bboxes[4*g+2],y2:this.bboxes[4*g+3]});for(let g=0;g<this.circleKeys.length;g++){const y=this.circles[3*g],b=this.circles[3*g+1],P=this.circles[3*g+2];f.push({key:this.circleKeys[g],x1:y-P,y1:b-P,x2:y+P,y2:b+P})}}else this._forEachCell(a,m,w,T,this._queryCell,f,{hitTest:I,overlapMode:u,seenUids:{box:{},circle:{}}},c);return f}query(a,m,w,T){return this._query(a,m,w,T,!1,null)}hitTest(a,m,w,T,I,u){return this._query(a,m,w,T,!0,I,u).length>0}hitTestCircle(a,m,w,T,I){const u=a-w,c=a+w,f=m-w,g=m+w;if(c<0||u>this.width||g<0||f>this.height)return!1;const y=[];return this._forEachCell(u,f,c,g,this._queryCellCircle,y,{hitTest:!0,overlapMode:T,circle:{x:a,y:m,radius:w},seenUids:{box:{},circle:{}}},I),y.length>0}_queryCell(a,m,w,T,I,u,c,f){const{seenUids:g,hitTest:y,overlapMode:b}=c,P=this.boxCells[I];if(P!==null){const N=this.bboxes;for(const G of P)if(!g.box[G]){g.box[G]=!0;const W=4*G,K=this.boxKeys[G];if(a<=N[W+2]&&m<=N[W+3]&&w>=N[W+0]&&T>=N[W+1]&&(!f||f(K))&&(!y||!yn(b,K.overlapMode))&&(u.push({key:K,x1:N[W],y1:N[W+1],x2:N[W+2],y2:N[W+3]}),y))return!0}}const D=this.circleCells[I];if(D!==null){const N=this.circles;for(const G of D)if(!g.circle[G]){g.circle[G]=!0;const W=3*G,K=this.circleKeys[G];if(this._circleAndRectCollide(N[W],N[W+1],N[W+2],a,m,w,T)&&(!f||f(K))&&(!y||!yn(b,K.overlapMode))){const de=N[W],te=N[W+1],se=N[W+2];if(u.push({key:K,x1:de-se,y1:te-se,x2:de+se,y2:te+se}),y)return!0}}}return!1}_queryCellCircle(a,m,w,T,I,u,c,f){const{circle:g,seenUids:y,overlapMode:b}=c,P=this.boxCells[I];if(P!==null){const N=this.bboxes;for(const G of P)if(!y.box[G]){y.box[G]=!0;const W=4*G,K=this.boxKeys[G];if(this._circleAndRectCollide(g.x,g.y,g.radius,N[W+0],N[W+1],N[W+2],N[W+3])&&(!f||f(K))&&!yn(b,K.overlapMode))return u.push(!0),!0}}const D=this.circleCells[I];if(D!==null){const N=this.circles;for(const G of D)if(!y.circle[G]){y.circle[G]=!0;const W=3*G,K=this.circleKeys[G];if(this._circlesCollide(N[W],N[W+1],N[W+2],g.x,g.y,g.radius)&&(!f||f(K))&&!yn(b,K.overlapMode))return u.push(!0),!0}}}_forEachCell(a,m,w,T,I,u,c,f){const g=this._convertToXCellCoord(a),y=this._convertToYCellCoord(m),b=this._convertToXCellCoord(w),P=this._convertToYCellCoord(T);for(let D=g;D<=b;D++)for(let N=y;N<=P;N++)if(I.call(this,a,m,w,T,this.xCellCount*N+D,u,c,f))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,m,w,T,I,u){const c=T-a,f=I-m,g=w+u;return g*g>c*c+f*f}_circleAndRectCollide(a,m,w,T,I,u,c){const f=(u-T)/2,g=Math.abs(a-(T+f));if(g>f+w)return!1;const y=(c-I)/2,b=Math.abs(m-(I+y));if(b>y+w)return!1;if(g<=f||b<=y)return!0;const P=g-f,D=b-y;return P*P+D*D<=w*w}}function Qi(M,a,m,w,T){const I=l.create();return a?(l.scale(I,I,[1/T,1/T,1]),m||l.rotateZ(I,I,w.angle)):l.multiply(I,w.labelPlaneMatrix,M),I}function Cs(M,a,m,w,T){if(a){const I=l.clone(M);return l.scale(I,I,[T,T,1]),m||l.rotateZ(I,I,-w.angle),I}return w.glCoordMatrix}function ln(M,a,m){let w;m?(w=[M.x,M.y,m(M.x,M.y),1],l.transformMat4(w,w,a)):(w=[M.x,M.y,0,1],Oe(w,w,a));const T=w[3];return{point:new l.Point(w[0]/T,w[1]/T),signedDistanceFromCamera:T}}function Br(M,a){return .5+M/a*.5}function ss(M,a){const m=M[0]/M[3],w=M[1]/M[3];return m>=-a[0]&&m<=a[0]&&w>=-a[1]&&w<=a[1]}function $r(M,a,m,w,T,I,u,c,f,g){const y=w?M.textSizeData:M.iconSizeData,b=l.evaluateSizeForZoom(y,m.transform.zoom),P=[256/m.width*2+1,256/m.height*2+1],D=w?M.text.dynamicLayoutVertexArray:M.icon.dynamicLayoutVertexArray;D.clear();const N=M.lineVertexArray,G=w?M.text.placedSymbolArray:M.icon.placedSymbolArray,W=m.transform.width/m.transform.height;let K=!1;for(let de=0;de<G.length;de++){const te=G.get(de);if(te.hidden||te.writingMode===l.WritingMode.vertical&&!K){be(te.numGlyphs,D);continue}let se;if(K=!1,g?(se=[te.anchorX,te.anchorY,g(te.anchorX,te.anchorY),1],l.transformMat4(se,se,a)):(se=[te.anchorX,te.anchorY,0,1],Oe(se,se,a)),!ss(se,P)){be(te.numGlyphs,D);continue}const xe=Br(m.transform.cameraToCenterDistance,se[3]),Ie=l.evaluateSizeForFeature(y,b,te),Fe=u?Ie/xe:Ie*xe,Re=new l.Point(te.anchorX,te.anchorY),Be=ln(Re,T,g).point,Le={projections:{},offsets:{}},At=ki(te,Fe,!1,c,a,T,I,M.glyphOffsetArray,N,D,Be,Re,Le,W,f,g);K=At.useVertical,(At.notEnoughRoom||K||At.needsFlipping&&ki(te,Fe,!0,c,a,T,I,M.glyphOffsetArray,N,D,Be,Re,Le,W,f,g).notEnoughRoom)&&be(te.numGlyphs,D)}w?M.text.dynamicLayoutVertexBuffer.updateData(D):M.icon.dynamicLayoutVertexBuffer.updateData(D)}function Rr(M,a,m,w,T,I,u,c,f,g,y,b,P){const D=c.glyphStartIndex+c.numGlyphs,N=c.lineStartIndex,G=c.lineStartIndex+c.lineLength,W=a.getoffsetX(c.glyphStartIndex),K=a.getoffsetX(D-1),de=re(M*W,m,w,T,I,u,c.segment,N,G,f,g,y,b,P);if(!de)return null;const te=re(M*K,m,w,T,I,u,c.segment,N,G,f,g,y,b,P);return te?{first:de,last:te}:null}function Or(M,a,m,w){return M===l.WritingMode.horizontal&&Math.abs(m.y-a.y)>Math.abs(m.x-a.x)*w?{useVertical:!0}:(M===l.WritingMode.vertical?a.y<m.y:a.x>m.x)?{needsFlipping:!0}:null}function ki(M,a,m,w,T,I,u,c,f,g,y,b,P,D,N,G){const W=a/24,K=M.lineOffsetX*W,de=M.lineOffsetY*W;let te;if(M.numGlyphs>1){const se=M.glyphStartIndex+M.numGlyphs,xe=M.lineStartIndex,Ie=M.lineStartIndex+M.lineLength,Fe=Rr(W,c,K,de,m,y,b,M,f,I,P,N,G);if(!Fe)return{notEnoughRoom:!0};const Re=ln(Fe.first.point,u,G).point,Be=ln(Fe.last.point,u,G).point;if(w&&!m){const Le=Or(M.writingMode,Re,Be,D);if(Le)return Le}te=[Fe.first];for(let Le=M.glyphStartIndex+1;Le<se-1;Le++)te.push(re(W*c.getoffsetX(Le),K,de,m,y,b,M.segment,xe,Ie,f,I,P,N,G));te.push(Fe.last)}else{if(w&&!m){const xe=ln(b,T,G).point,Ie=M.lineStartIndex+M.segment+1,Fe=new l.Point(f.getx(Ie),f.gety(Ie)),Re=ln(Fe,T,G),Be=Re.signedDistanceFromCamera>0?Re.point:Xn(b,Fe,xe,1,T,G),Le=Or(M.writingMode,xe,Be,D);if(Le)return Le}const se=re(W*c.getoffsetX(M.glyphStartIndex),K,de,m,y,b,M.segment,M.lineStartIndex,M.lineStartIndex+M.lineLength,f,I,P,N,G);if(!se)return{notEnoughRoom:!0};te=[se]}for(const se of te)l.addDynamicAttributes(g,se.point,se.angle);return{}}function Xn(M,a,m,w,T,I){const u=ln(M.add(M.sub(a)._unit()),T,I).point,c=m.sub(u);return m.add(c._mult(w/c.mag()))}function Je(M,a){const{projectionCache:m,lineVertexArray:w,labelPlaneMatrix:T,tileAnchorPoint:I,distanceFromAnchor:u,getElevation:c,previousVertex:f,direction:g,absOffsetX:y}=a;if(m.projections[M])return m.projections[M];const b=new l.Point(w.getx(M),w.gety(M)),P=ln(b,T,c);if(P.signedDistanceFromCamera>0)return m.projections[M]=P.point,P.point;const D=M-g;return Xn(u===0?I:new l.Point(w.getx(D),w.gety(D)),b,f,y-u+1,T,c)}function os(M,a,m){return M._unit()._perp()._mult(a*m)}function ke(M,a,m,w,T,I,u,c){const{projectionCache:f,direction:g}=c;if(f.offsets[M])return f.offsets[M];const y=m.add(a);if(M+g<w||M+g>=T)return f.offsets[M]=y,y;const b=Je(M+g,c),P=os(b.sub(m),u,g),D=m.add(P),N=b.add(P);return f.offsets[M]=l.findLineIntersection(I,y,D,N)||y,f.offsets[M]}function re(M,a,m,w,T,I,u,c,f,g,y,b,P,D){const N=w?M-a:M+a;let G=N>0?1:-1,W=0;w&&(G*=-1,W=Math.PI),G<0&&(W+=Math.PI);let K,de,te=G>0?c+u:c+u+1,se=T,xe=T,Ie=0,Fe=0;const Re=Math.abs(N),Be=[];let Le;for(;Ie+Fe<=Re;){if(te+=G,te<c||te>=f)return null;Ie+=Fe,xe=se,de=K;const nt={projectionCache:b,lineVertexArray:g,labelPlaneMatrix:y,tileAnchorPoint:I,distanceFromAnchor:Ie,getElevation:D,previousVertex:xe,direction:G,absOffsetX:Re};if(se=Je(te,nt),m===0)Be.push(xe),Le=se.sub(xe);else{let ct;const Ct=se.sub(xe);ct=Ct.mag()===0?os(Je(te+G,nt).sub(se),m,G):os(Ct,m,G),de||(de=xe.add(ct)),K=ke(te,ct,se,c,f,de,m,nt),Be.push(de),Le=K.sub(de)}Fe=Le.mag()}const At=Le._mult((Re-Ie)/Fe)._add(de||xe),_t=W+Math.atan2(se.y-xe.y,se.x-xe.x);return Be.push(At),{point:At,angle:P?_t:0,path:Be}}const fe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function be(M,a){for(let m=0;m<M;m++){const w=a.length;a.resize(w+4),a.float32.set(fe,3*w)}}function Oe(M,a,m){const w=a[0],T=a[1];return M[0]=m[0]*w+m[4]*T+m[12],M[1]=m[1]*w+m[5]*T+m[13],M[3]=m[3]*w+m[7]*T+m[15],M}const je=100;class Xe{constructor(a,m=new mn(a.width+200,a.height+200,25),w=new mn(a.width+200,a.height+200,25)){this.transform=a,this.grid=m,this.ignoredGrid=w,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+je,this.screenBottomBoundary=a.height+je,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(a,m,w,T,I,u){const c=this.projectAndGetPerspectiveRatio(T,a.anchorPointX,a.anchorPointY,u),f=w*c.perspectiveRatio,g=a.x1*f+c.point.x,y=a.y1*f+c.point.y,b=a.x2*f+c.point.x,P=a.y2*f+c.point.y;return!this.isInsideGrid(g,y,b,P)||m!=="always"&&this.grid.hitTest(g,y,b,P,m,I)||c.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[g,y,b,P],offscreen:this.isOffscreen(g,y,b,P)}}placeCollisionCircles(a,m,w,T,I,u,c,f,g,y,b,P,D,N){const G=[],W=new l.Point(m.anchorX,m.anchorY),K=ln(W,u,N),de=Br(this.transform.cameraToCenterDistance,K.signedDistanceFromCamera),te=(y?I/de:I*de)/l.ONE_EM,se=ln(W,c,N).point,xe=Rr(te,T,m.lineOffsetX*te,m.lineOffsetY*te,!1,se,W,m,w,c,{projections:{},offsets:{}},!1,N);let Ie=!1,Fe=!1,Re=!0;if(xe){const Be=.5*P*de+D,Le=new l.Point(-100,-100),At=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),_t=new Lt,nt=xe.first,ct=xe.last;let Ct=[];for(let wt=nt.path.length-1;wt>=1;wt--)Ct.push(nt.path[wt]);for(let wt=1;wt<ct.path.length;wt++)Ct.push(ct.path[wt]);const un=2.5*Be;if(f){const wt=Ct.map(zt=>ln(zt,f,N));Ct=wt.some(zt=>zt.signedDistanceFromCamera<=0)?[]:wt.map(zt=>zt.point)}let Yt=[];if(Ct.length>0){const wt=Ct[0].clone(),zt=Ct[0].clone();for(let nn=1;nn<Ct.length;nn++)wt.x=Math.min(wt.x,Ct[nn].x),wt.y=Math.min(wt.y,Ct[nn].y),zt.x=Math.max(zt.x,Ct[nn].x),zt.y=Math.max(zt.y,Ct[nn].y);Yt=wt.x>=Le.x&&zt.x<=At.x&&wt.y>=Le.y&&zt.y<=At.y?[Ct]:zt.x<Le.x||wt.x>At.x||zt.y<Le.y||wt.y>At.y?[]:l.clipLine([Ct],Le.x,Le.y,At.x,At.y)}for(const wt of Yt){_t.reset(wt,.25*Be);let zt=0;zt=_t.length<=.5*Be?1:Math.ceil(_t.paddedLength/un)+1;for(let nn=0;nn<zt;nn++){const fn=nn/Math.max(zt-1,1),cn=_t.lerp(fn),Pn=cn.x+je,Gn=cn.y+je;G.push(Pn,Gn,Be,0);const Kr=Pn-Be,$a=Gn-Be,ga=Pn+Be,Za=Gn+Be;if(Re=Re&&this.isOffscreen(Kr,$a,ga,Za),Fe=Fe||this.isInsideGrid(Kr,$a,ga,Za),a!=="always"&&this.grid.hitTestCircle(Pn,Gn,Be,a,b)&&(Ie=!0,!g))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!g&&Ie||!Fe||de<this.perspectiveRatioCutoff?[]:G,offscreen:Re,collisionDetected:Ie}}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let w=1/0,T=1/0,I=-1/0,u=-1/0;for(const y of a){const b=new l.Point(y.x+je,y.y+je);w=Math.min(w,b.x),T=Math.min(T,b.y),I=Math.max(I,b.x),u=Math.max(u,b.y),m.push(b)}const c=this.grid.query(w,T,I,u).concat(this.ignoredGrid.query(w,T,I,u)),f={},g={};for(const y of c){const b=y.key;if(f[b.bucketInstanceId]===void 0&&(f[b.bucketInstanceId]={}),f[b.bucketInstanceId][b.featureIndex])continue;const P=[new l.Point(y.x1,y.y1),new l.Point(y.x2,y.y1),new l.Point(y.x2,y.y2),new l.Point(y.x1,y.y2)];l.polygonIntersectsPolygon(m,P)&&(f[b.bucketInstanceId][b.featureIndex]=!0,g[b.bucketInstanceId]===void 0&&(g[b.bucketInstanceId]=[]),g[b.bucketInstanceId].push(b.featureIndex))}return g}insertCollisionBox(a,m,w,T,I,u){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:T,featureIndex:I,collisionGroupID:u,overlapMode:m},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,m,w,T,I,u){const c=w?this.ignoredGrid:this.grid,f={bucketInstanceId:T,featureIndex:I,collisionGroupID:u,overlapMode:m};for(let g=0;g<a.length;g+=4)c.insertCircle(f,a[g],a[g+1],a[g+2])}projectAndGetPerspectiveRatio(a,m,w,T){let I;return T?(I=[m,w,T(m,w),1],l.transformMat4(I,I,a)):(I=[m,w,0,1],Oe(I,I,a)),{point:new l.Point((I[0]/I[3]+1)/2*this.transform.width+je,(-I[1]/I[3]+1)/2*this.transform.height+je),perspectiveRatio:.5+this.transform.cameraToCenterDistance/I[3]*.5}}isOffscreen(a,m,w,T){return w<je||a>=this.screenRightBoundary||T<je||m>this.screenBottomBoundary}isInsideGrid(a,m,w,T){return w>=0&&a<this.gridRightBoundary&&T>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const a=l.identity([]);return l.translate(a,a,[-100,-100,0]),a}}function $e(M,a,m){return a*(l.EXTENT/(M.tileSize*Math.pow(2,m-M.tileID.overscaledZ)))}class We{constructor(a,m,w,T){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?m:-m))):T&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class Ye{constructor(a,m,w,T,I){this.text=new We(a?a.text:null,m,w,I),this.icon=new We(a?a.icon:null,m,T,I)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class oe{constructor(a,m,w){this.text=a,this.icon=m,this.skipFade=w}}class ve{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class Pe{constructor(a,m,w,T,I){this.bucketInstanceId=a,this.featureIndex=m,this.sourceLayerIndex=w,this.bucketIndex=T,this.tileID=I}}class rt{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const m=++this.maxGroupID;this.collisionGroups[a]={ID:m,predicate:w=>w.collisionGroupID===m}}return this.collisionGroups[a]}}function s(M,a,m,w,T){const{horizontalAlign:I,verticalAlign:u}=l.getAnchorAlignment(M);return new l.Point(-(I-.5)*a+w[0]*T,-(u-.5)*m+w[1]*T)}function Z(M,a,m,w,T,I){const{x1:u,x2:c,y1:f,y2:g,anchorPointX:y,anchorPointY:b}=M,P=new l.Point(a,m);return w&&P._rotate(T?I:-I),{x1:u+P.x,y1:f+P.y,x2:c+P.x,y2:g+P.y,anchorPointX:y,anchorPointY:b}}class ft{constructor(a,m,w,T,I){this.transform=a.clone(),this.terrain=m,this.collisionIndex=new Xe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new rt(T),this.collisionCircleArrays={},this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,m,w,T){const I=w.getBucket(m),u=w.latestFeatureIndex;if(!I||!u||m.id!==I.layerIds[0])return;const c=w.collisionBoxArray,f=I.layers[0].layout,g=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),y=w.tileSize/l.EXTENT,b=this.transform.calculatePosMatrix(w.tileID.toUnwrapped()),P=f.get("text-pitch-alignment")==="map",D=f.get("text-rotation-alignment")==="map",N=$e(w,1,this.transform.zoom),G=Qi(b,P,D,this.transform,N);let W=null;if(P){const de=Cs(b,P,D,this.transform,N);W=l.multiply([],this.transform.labelPlaneMatrix,de)}this.retainedQueryData[I.bucketInstanceId]=new Pe(I.bucketInstanceId,u,I.sourceLayerIndex,I.index,w.tileID);const K={bucket:I,layout:f,posMatrix:b,textLabelPlaneMatrix:G,labelToScreenMatrix:W,scale:g,textPixelRatio:y,holdingForFade:w.holdingForFade(),collisionBoxArray:c,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(I.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(I.sourceID)};if(T)for(const de of I.sortKeyRanges){const{sortKey:te,symbolInstanceStart:se,symbolInstanceEnd:xe}=de;a.push({sortKey:te,symbolInstanceStart:se,symbolInstanceEnd:xe,parameters:K})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:I.symbolInstances.length,parameters:K})}attemptAnchorPlacement(a,m,w,T,I,u,c,f,g,y,b,P,D,N,G,W){const K=l.TextAnchorEnum[a.textAnchor],de=[a.textOffset0,a.textOffset1],te=s(K,w,T,de,I),se=this.collisionIndex.placeCollisionBox(Z(m,te.x,te.y,u,c,this.transform.angle),b,f,g,y.predicate,W);if((!G||this.collisionIndex.placeCollisionBox(Z(G,te.x,te.y,u,c,this.transform.angle),b,f,g,y.predicate,W).box.length!==0)&&se.box.length>0){let xe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[P.crossTileID]&&this.prevPlacement.placements[P.crossTileID]&&this.prevPlacement.placements[P.crossTileID].text&&(xe=this.prevPlacement.variableOffsets[P.crossTileID].anchor),P.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[P.crossTileID]={textOffset:de,width:w,height:T,anchor:K,textBoxScale:I,prevAnchor:xe},this.markUsedJustification(D,K,P,N),D.allowVerticalPlacement&&(this.markUsedOrientation(D,N,P),this.placedOrientations[P.crossTileID]=N),{shift:te,placedGlyphBoxes:se}}}placeLayerBucketPart(a,m,w){const{bucket:T,layout:I,posMatrix:u,textLabelPlaneMatrix:c,labelToScreenMatrix:f,textPixelRatio:g,holdingForFade:y,collisionBoxArray:b,partiallyEvaluatedTextSize:P,collisionGroup:D}=a.parameters,N=I.get("text-optional"),G=I.get("icon-optional"),W=l.getOverlapMode(I,"text-overlap","text-allow-overlap"),K=W==="always",de=l.getOverlapMode(I,"icon-overlap","icon-allow-overlap"),te=de==="always",se=I.get("text-rotation-alignment")==="map",xe=I.get("text-pitch-alignment")==="map",Ie=I.get("icon-text-fit")!=="none",Fe=I.get("symbol-z-order")==="viewport-y",Re=K&&(te||!T.hasIconData()||G),Be=te&&(K||!T.hasTextData()||N);!T.collisionArrays&&b&&T.deserializeCollisionBoxes(b);const Le=this.retainedQueryData[T.bucketInstanceId].tileID,At=this.terrain?(nt,ct)=>this.terrain.getElevation(Le,nt,ct):null,_t=(nt,ct)=>{var Ct,un;if(m[nt.crossTileID])return;if(y)return void(this.placements[nt.crossTileID]=new oe(!1,!1,!1));let Yt=!1,wt=!1,zt=!0,nn=null,fn={box:null,offscreen:null},cn={box:null,offscreen:null},Pn=null,Gn=null,Kr=null,$a=0,ga=0,Za=0;ct.textFeatureIndex?$a=ct.textFeatureIndex:nt.useRuntimeCollisionCircles&&($a=nt.featureIndex),ct.verticalTextFeatureIndex&&(ga=ct.verticalTextFeatureIndex);const Iu=ct.textBox;if(Iu){const nr=Sr=>{let pr=l.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Sr&&this.prevPlacement){const _s=this.prevPlacement.placedOrientations[nt.crossTileID];_s&&(this.placedOrientations[nt.crossTileID]=_s,pr=_s,this.markUsedOrientation(T,pr,nt))}return pr},Tr=(Sr,pr)=>{if(T.allowVerticalPlacement&&nt.numVerticalGlyphVertices>0&&ct.verticalTextBox){for(const _s of T.writingModes)if(_s===l.WritingMode.vertical?(fn=pr(),cn=fn):fn=Sr(),fn&&fn.box&&fn.box.length)break}else fn=Sr()},ms=nt.textAnchorOffsetStartIndex,ku=nt.textAnchorOffsetEndIndex;if(ku===ms){const Sr=(pr,_s)=>{const Ri=this.collisionIndex.placeCollisionBox(pr,W,g,u,D.predicate,At);return Ri&&Ri.box&&Ri.box.length&&(this.markUsedOrientation(T,_s,nt),this.placedOrientations[nt.crossTileID]=_s),Ri};Tr(()=>Sr(Iu,l.WritingMode.horizontal),()=>{const pr=ct.verticalTextBox;return T.allowVerticalPlacement&&nt.numVerticalGlyphVertices>0&&pr?Sr(pr,l.WritingMode.vertical):{box:null,offscreen:null}}),nr(fn&&fn.box&&fn.box.length)}else{let Sr=l.TextAnchorEnum[(un=(Ct=this.prevPlacement)===null||Ct===void 0?void 0:Ct.variableOffsets[nt.crossTileID])===null||un===void 0?void 0:un.anchor];const pr=(Ri,kA,ma)=>{const Al=Ri.x2-Ri.x1,ap=Ri.y2-Ri.y1,Hl=nt.textBoxScale,L_=Ie&&de==="never"?kA:null;let Wl={box:[],offscreen:!1},Fi=W==="never"?1:2,dh="never";Sr&&Fi++;for(let j0=0;j0<Fi;j0++){for(let LA=ms;LA<ku;LA++){const ll=T.textAnchorOffsets.get(LA);if(Sr&&ll.textAnchor!==Sr)continue;const Lu=this.attemptAnchorPlacement(ll,Ri,Al,ap,Hl,se,xe,g,u,D,dh,nt,T,ma,L_,At);if(Lu&&(Wl=Lu.placedGlyphBoxes,Wl&&Wl.box&&Wl.box.length))return Yt=!0,nn=Lu.shift,Wl}Sr?Sr=null:dh=W}return Wl};Tr(()=>pr(Iu,ct.iconBox,l.WritingMode.horizontal),()=>{const Ri=ct.verticalTextBox;return T.allowVerticalPlacement&&!(fn&&fn.box&&fn.box.length)&&nt.numVerticalGlyphVertices>0&&Ri?pr(Ri,ct.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),fn&&(Yt=fn.box,zt=fn.offscreen);const _s=nr(fn&&fn.box);if(!Yt&&this.prevPlacement){const Ri=this.prevPlacement.variableOffsets[nt.crossTileID];Ri&&(this.variableOffsets[nt.crossTileID]=Ri,this.markUsedJustification(T,Ri.anchor,nt,_s))}}}if(Pn=fn,Yt=Pn&&Pn.box&&Pn.box.length>0,zt=Pn&&Pn.offscreen,nt.useRuntimeCollisionCircles){const nr=T.text.placedSymbolArray.get(nt.centerJustifiedTextSymbolIndex),Tr=l.evaluateSizeForFeature(T.textSizeData,P,nr),ms=I.get("text-padding");Gn=this.collisionIndex.placeCollisionCircles(W,nr,T.lineVertexArray,T.glyphOffsetArray,Tr,u,c,f,w,xe,D.predicate,nt.collisionCircleDiameter,ms,At),Gn.circles.length&&Gn.collisionDetected&&!w&&l.warnOnce("Collisions detected, but collision boxes are not shown"),Yt=K||Gn.circles.length>0&&!Gn.collisionDetected,zt=zt&&Gn.offscreen}if(ct.iconFeatureIndex&&(Za=ct.iconFeatureIndex),ct.iconBox){const nr=Tr=>{const ms=Ie&&nn?Z(Tr,nn.x,nn.y,se,xe,this.transform.angle):Tr;return this.collisionIndex.placeCollisionBox(ms,de,g,u,D.predicate,At)};cn&&cn.box&&cn.box.length&&ct.verticalIconBox?(Kr=nr(ct.verticalIconBox),wt=Kr.box.length>0):(Kr=nr(ct.iconBox),wt=Kr.box.length>0),zt=zt&&Kr.offscreen}const al=N||nt.numHorizontalGlyphVertices===0&&nt.numVerticalGlyphVertices===0,IA=G||nt.numIconVertices===0;if(al||IA?IA?al||(wt=wt&&Yt):Yt=wt&&Yt:wt=Yt=wt&&Yt,Yt&&Pn&&Pn.box&&this.collisionIndex.insertCollisionBox(Pn.box,W,I.get("text-ignore-placement"),T.bucketInstanceId,cn&&cn.box&&ga?ga:$a,D.ID),wt&&Kr&&this.collisionIndex.insertCollisionBox(Kr.box,de,I.get("icon-ignore-placement"),T.bucketInstanceId,Za,D.ID),Gn&&(Yt&&this.collisionIndex.insertCollisionCircles(Gn.circles,W,I.get("text-ignore-placement"),T.bucketInstanceId,$a,D.ID),w)){const nr=T.bucketInstanceId;let Tr=this.collisionCircleArrays[nr];Tr===void 0&&(Tr=this.collisionCircleArrays[nr]=new ve);for(let ms=0;ms<Gn.circles.length;ms+=4)Tr.circles.push(Gn.circles[ms+0]),Tr.circles.push(Gn.circles[ms+1]),Tr.circles.push(Gn.circles[ms+2]),Tr.circles.push(Gn.collisionDetected?1:0)}if(nt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(T.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[nt.crossTileID]=new oe(Yt||Re,wt||Be,zt||T.justReloaded),m[nt.crossTileID]=!0};if(Fe){if(a.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const nt=T.getSortedSymbolIndexes(this.transform.angle);for(let ct=nt.length-1;ct>=0;--ct){const Ct=nt[ct];_t(T.symbolInstances.get(Ct),T.collisionArrays[Ct])}}else for(let nt=a.symbolInstanceStart;nt<a.symbolInstanceEnd;nt++)_t(T.symbolInstances.get(nt),T.collisionArrays[nt]);if(w&&T.bucketInstanceId in this.collisionCircleArrays){const nt=this.collisionCircleArrays[T.bucketInstanceId];l.invert(nt.invProjMatrix,u),nt.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(a,m,w,T){let I;I=T===l.WritingMode.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(m)];const u=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(const c of u)c>=0&&(a.text.placedSymbolArray.get(c).crossTileID=I>=0&&c!==I?0:w.crossTileID)}markUsedOrientation(a,m,w){const T=m===l.WritingMode.horizontal||m===l.WritingMode.horizontalOnly?m:0,I=m===l.WritingMode.vertical?m:0,u=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(const c of u)a.text.placedSymbolArray.get(c).placedOrientation=T;w.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=I)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let w=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const T=m?m.symbolFadeChange(a):1,I=m?m.opacities:{},u=m?m.variableOffsets:{},c=m?m.placedOrientations:{};for(const f in this.placements){const g=this.placements[f],y=I[f];y?(this.opacities[f]=new Ye(y,T,g.text,g.icon),w=w||g.text!==y.text.placed||g.icon!==y.icon.placed):(this.opacities[f]=new Ye(null,T,g.text,g.icon,g.skipFade),w=w||g.text||g.icon)}for(const f in I){const g=I[f];if(!this.opacities[f]){const y=new Ye(g,T,!1,!1);y.isHidden()||(this.opacities[f]=y,w=w||g.text.placed||g.icon.placed)}}for(const f in u)this.variableOffsets[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.variableOffsets[f]=u[f]);for(const f in c)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=c[f]);if(m&&m.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:a)}updateLayerOpacities(a,m){const w={};for(const T of m){const I=T.getBucket(a);I&&T.latestFeatureIndex&&a.id===I.layerIds[0]&&this.updateBucketOpacities(I,w,T.collisionBoxArray)}}updateBucketOpacities(a,m,w){a.hasTextData()&&(a.text.opacityVertexArray.clear(),a.text.hasVisibleVertices=!1),a.hasIconData()&&(a.icon.opacityVertexArray.clear(),a.icon.hasVisibleVertices=!1),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const T=a.layers[0],I=T.layout,u=new Ye(null,0,!1,!1,!0),c=I.get("text-allow-overlap"),f=I.get("icon-allow-overlap"),g=T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"),y=I.get("text-rotation-alignment")==="map",b=I.get("text-pitch-alignment")==="map",P=I.get("icon-text-fit")!=="none",D=new Ye(null,0,c&&(f||!a.hasIconData()||I.get("icon-optional")),f&&(c||!a.hasTextData()||I.get("text-optional")),!0);!a.collisionArrays&&w&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(w);const N=(G,W,K)=>{for(let de=0;de<W/4;de++)G.opacityVertexArray.emplaceBack(K);G.hasVisibleVertices=G.hasVisibleVertices||K!==ni};for(let G=0;G<a.symbolInstances.length;G++){const W=a.symbolInstances.get(G),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:de,crossTileID:te}=W;let se=this.opacities[te];m[te]?se=u:se||(se=D,this.opacities[te]=se),m[te]=!0;const xe=W.numIconVertices>0,Ie=this.placedOrientations[W.crossTileID],Fe=Ie===l.WritingMode.vertical,Re=Ie===l.WritingMode.horizontal||Ie===l.WritingMode.horizontalOnly;if(K>0||de>0){const Be=hi(se.text);N(a.text,K,Fe?ni:Be),N(a.text,de,Re?ni:Be);const Le=se.text.isHidden();[W.rightJustifiedTextSymbolIndex,W.centerJustifiedTextSymbolIndex,W.leftJustifiedTextSymbolIndex].forEach(nt=>{nt>=0&&(a.text.placedSymbolArray.get(nt).hidden=Le||Fe?1:0)}),W.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(W.verticalPlacedTextSymbolIndex).hidden=Le||Re?1:0);const At=this.variableOffsets[W.crossTileID];At&&this.markUsedJustification(a,At.anchor,W,Ie);const _t=this.placedOrientations[W.crossTileID];_t&&(this.markUsedJustification(a,"left",W,_t),this.markUsedOrientation(a,_t,W))}if(xe){const Be=hi(se.icon),Le=!(P&&W.verticalPlacedIconSymbolIndex&&Fe);W.placedIconSymbolIndex>=0&&(N(a.icon,W.numIconVertices,Le?Be:ni),a.icon.placedSymbolArray.get(W.placedIconSymbolIndex).hidden=se.icon.isHidden()),W.verticalPlacedIconSymbolIndex>=0&&(N(a.icon,W.numVerticalIconVertices,Le?ni:Be),a.icon.placedSymbolArray.get(W.verticalPlacedIconSymbolIndex).hidden=se.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const Be=a.collisionArrays[G];if(Be){let Le=new l.Point(0,0);if(Be.textBox||Be.verticalTextBox){let _t=!0;if(g){const nt=this.variableOffsets[te];nt?(Le=s(nt.anchor,nt.width,nt.height,nt.textOffset,nt.textBoxScale),y&&Le._rotate(b?this.transform.angle:-this.transform.angle)):_t=!1}Be.textBox&&mt(a.textCollisionBox.collisionVertexArray,se.text.placed,!_t||Fe,Le.x,Le.y),Be.verticalTextBox&&mt(a.textCollisionBox.collisionVertexArray,se.text.placed,!_t||Re,Le.x,Le.y)}const At=!!(!Re&&Be.verticalIconBox);Be.iconBox&&mt(a.iconCollisionBox.collisionVertexArray,se.icon.placed,At,P?Le.x:0,P?Le.y:0),Be.verticalIconBox&&mt(a.iconCollisionBox.collisionVertexArray,se.icon.placed,!At,P?Le.x:0,P?Le.y:0)}}}if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.text.opacityVertexArray.length!==a.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${a.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${a.text.layoutVertexArray.length}) / 4`);if(a.icon.opacityVertexArray.length!==a.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${a.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${a.icon.layoutVertexArray.length}) / 4`);if(a.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=G.invProjMatrix,a.placementViewportMatrix=G.viewportMatrix,a.collisionCircleArray=G.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,m){const w=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*w>a}setStale(){this.stale=!0}}function mt(M,a,m,w,T){M.emplaceBack(a?1:0,m?1:0,w||0,T||0),M.emplaceBack(a?1:0,m?1:0,w||0,T||0),M.emplaceBack(a?1:0,m?1:0,w||0,T||0),M.emplaceBack(a?1:0,m?1:0,w||0,T||0)}const kt=Math.pow(2,25),yt=Math.pow(2,24),Pt=Math.pow(2,17),Qt=Math.pow(2,16),Vt=Math.pow(2,9),pt=Math.pow(2,8),Dn=Math.pow(2,1);function hi(M){if(M.opacity===0&&!M.placed)return 0;if(M.opacity===1&&M.placed)return 4294967295;const a=M.placed?1:0,m=Math.floor(127*M.opacity);return m*kt+a*yt+m*Pt+a*Qt+m*Vt+a*pt+m*Dn+a}const ni=0;class Rn{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&!a.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(a,m,w,T,I){const u=this._bucketParts;for(;this._currentTileIndex<a.length;)if(m.getBucketParts(u,T,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,I())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,u.sort((c,f)=>c.sortKey-f.sortKey));this._currentPartIndex<u.length;)if(m.placeLayerBucketPart(u[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,I())return!0;return!1}}class _i{constructor(a,m,w,T,I,u,c,f){this.placement=new ft(a,m,u,c,f),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=T,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(a,m,w){const T=l.browser.now(),I=()=>!this._forceFullPlacement&&l.browser.now()-T>2;for(;this._currentPlacementIndex>=0;){const u=m[a[this._currentPlacementIndex]],c=this.placement.collisionIndex.transform.zoom;if(u.type==="symbol"&&(!u.minzoom||u.minzoom<=c)&&(!u.maxzoom||u.maxzoom>c)){if(this._inProgressLayer||(this._inProgressLayer=new Rn(u)),this._inProgressLayer.continuePlacement(w[u.source],this.placement,this._showCollisionBoxes,u,I))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const On=512/l.EXTENT/2;class qn{constructor(a,m,w){this.tileID=a,this.bucketInstanceId=w,this._symbolsByKey={};const T=new Map;for(let I=0;I<m.length;I++){const u=m.get(I),c=u.key,f=T.get(c);f?f.push(u):T.set(c,[u])}for(const[I,u]of T){const c={positions:u.map(f=>({x:Math.floor(f.anchorX*On),y:Math.floor(f.anchorY*On)})),crossTileIDs:u.map(f=>f.crossTileID)};if(c.positions.length>128){const f=new l.KDBush(c.positions.length,16,Uint16Array);for(const{x:g,y}of c.positions)f.add(g,y);f.finish(),delete c.positions,c.index=f}this._symbolsByKey[I]=c}}getScaledCoordinates(a,m){const{x:w,y:T,z:I}=this.tileID.canonical,{x:u,y:c,z:f}=m.canonical,g=On/Math.pow(2,f-I),y=(c*l.EXTENT+a.anchorY)*g,b=T*l.EXTENT*On;return{x:Math.floor((u*l.EXTENT+a.anchorX)*g-w*l.EXTENT*On),y:Math.floor(y-b)}}findMatches(a,m,w){const T=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let I=0;I<a.length;I++){const u=a.get(I);if(u.crossTileID)continue;const c=this._symbolsByKey[u.key];if(!c)continue;const f=this.getScaledCoordinates(u,m);if(c.index){const g=c.index.range(f.x-T,f.y-T,f.x+T,f.y+T).sort();for(const y of g){const b=c.crossTileIDs[y];if(!w[b]){w[b]=!0,u.crossTileID=b;break}}}else if(c.positions)for(let g=0;g<c.positions.length;g++){const y=c.positions[g],b=c.crossTileIDs[g];if(Math.abs(y.x-f.x)<=T&&Math.abs(y.y-f.y)<=T&&!w[b]){w[b]=!0,u.crossTileID=b;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:a})=>a)}}class ur{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class an{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const m=Math.round((a-this.lng)/360);if(m!==0)for(const w in this.indexes){const T=this.indexes[w],I={};for(const u in T){const c=T[u];c.tileID=c.tileID.unwrapTo(c.tileID.wrap+m),I[c.tileID.key]=c}this.indexes[w]=I}this.lng=a}addBucket(a,m,w){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let I=0;I<m.symbolInstances.length;I++)m.symbolInstances.get(I).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});const T=this.usedCrossTileIDs[a.overscaledZ];for(const I in this.indexes){const u=this.indexes[I];if(Number(I)>a.overscaledZ)for(const c in u){const f=u[c];f.tileID.isChildOf(a)&&f.findMatches(m.symbolInstances,a,T)}else{const c=u[a.scaledTo(Number(I)).key];c&&c.findMatches(m.symbolInstances,a,T)}}for(let I=0;I<m.symbolInstances.length;I++){const u=m.symbolInstances.get(I);u.crossTileID||(u.crossTileID=w.generate(),T[u.crossTileID]=!0)}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new qn(a,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(a,m){for(const w of m.getCrossTileIDsLists())for(const T of w)delete this.usedCrossTileIDs[a][T]}removeStaleBuckets(a){let m=!1;for(const w in this.indexes){const T=this.indexes[w];for(const I in T)a[T[I].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,T[I]),delete T[I],m=!0)}return m}}class Ve{constructor(){this.layerIndexes={},this.crossTileIDs=new ur,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,m,w){let T=this.layerIndexes[a.id];T===void 0&&(T=this.layerIndexes[a.id]=new an);let I=!1;const u={};T.handleWrapJump(w);for(const c of m){const f=c.getBucket(a);f&&a.id===f.layerIds[0]&&(f.bucketInstanceId||(f.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(c.tileID,f,this.crossTileIDs)&&(I=!0),u[f.bucketInstanceId]=!0)}return T.removeStaleBuckets(u)&&(I=!0),I}pruneUnusedLayers(a){const m={};a.forEach(w=>{m[w]=!0});for(const w in this.layerIndexes)m[w]||delete this.layerIndexes[w]}}const Ut=(M,a)=>l.emitValidationErrors(M,a&&a.filter(m=>m.identifier!=="source.canvas")),Se=l.pick(l.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Ht=l.pick(l.operations,["setCenter","setZoom","setBearing","setPitch"]),Ki=l.emptyStyle();class bi extends l.Evented{constructor(a,m={}){super(),this.map=a,this.dispatcher=new Tn(Wr(),this,a._getMapId()),this.imageManager=new St,this.imageManager.setEventedParent(this),this.glyphManager=new ei(a._requestManager,m.localIdeographFontFamily),this.lineAtlas=new Bn(256,512),this.crossTileSymbolIndex=new Ve,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const w=this;this._rtlTextPluginCallback=bi.registerForPluginStateChange(T=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},(I,u)=>{if(l.triggerPluginCompletionEvent(I),u&&u.every(c=>c))for(const c in w.sourceCaches){const f=w.sourceCaches[c].getSource().type;f!=="vector"&&f!=="geojson"||w.sourceCaches[c].reload()}})}),this.on("data",T=>{if(T.dataType!=="source"||T.sourceDataType!=="metadata")return;const I=this.sourceCaches[T.sourceId];if(!I)return;const u=I.getSource();if(u&&u.vectorLayerIds)for(const c in this._layers){const f=this._layers[c];f.source===u.id&&this._validateLayer(f)}})}loadURL(a,m={},w){this.fire(new l.Event("dataloading",{dataType:"style"})),m.validate=typeof m.validate!="boolean"||m.validate;const T=this.map._requestManager.transformRequest(a,ie.Style);this._request=l.getJSON(T,(I,u)=>{this._request=null,I?this.fire(new l.ErrorEvent(I)):u&&this._load(u,m,w)})}loadJSON(a,m={},w){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(()=>{this._request=null,m.validate=m.validate!==!1,this._load(a,m,w)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(Ki,{validate:!1})}_load(a,m,w){var T;const I=m.transformStyle?m.transformStyle(w,a):a;if(!m.validate||!Ut(this,l.validateStyle(I))){this._loaded=!0,this.stylesheet=I;for(const u in I.sources)this.addSource(u,I.sources[u],{validate:!1});I.sprite?this._loadSprite(I.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(I.glyphs),this._createLayers(),this.light=new vn(this.stylesheet.light),this.map.setTerrain((T=this.stylesheet.terrain)!==null&&T!==void 0?T:null),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}}_createLayers(){const a=l.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",a),this._order=a.map(m=>m.id),this._layers={},this._serializedLayers=null;for(const m of a){const w=l.createStyleLayer(m);w.setEventedParent(this,{layer:{id:m.id}}),this._layers[m.id]=w}}_loadSprite(a,m=!1,w=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(T,I,u,c){const f=lt(T),g=f.length,y=u>1?"@2x":"",b={},P={},D={};for(const{id:N,url:G}of f){const W=I.transformRequest(I.normalizeSpriteURL(G,y,".json"),ie.SpriteJSON),K=`${N}_${W.url}`;b[K]=l.getJSON(W,(se,xe)=>{delete b[K],P[N]=xe,at(c,P,D,se,g)});const de=I.transformRequest(I.normalizeSpriteURL(G,y,".png"),ie.SpriteImage),te=`${N}_${de.url}`;b[te]=we.getImage(de,(se,xe)=>{delete b[te],D[N]=xe,at(c,P,D,se,g)})}return{cancel(){for(const N of Object.values(b))N.cancel()}}}(a,this.map._requestManager,this.map.getPixelRatio(),(T,I)=>{if(this._spriteRequest=null,T)this.fire(new l.ErrorEvent(T));else if(I)for(const u in I){this._spritesImagesIds[u]=[];const c=this._spritesImagesIds[u]?this._spritesImagesIds[u].filter(f=>!(f in I)):[];for(const f of c)this.imageManager.removeImage(f),this._changedImages[f]=!0;for(const f in I[u]){const g=u==="default"?f:`${u}:${f}`;this._spritesImagesIds[u].push(g),g in this.imageManager.images?this.imageManager.updateImage(g,I[u][f],!1):this.imageManager.addImage(g,I[u][f]),m&&(this._changedImages[g]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),m&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"})),w&&w(T)})}_unloadSprite(){for(const a of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(a),this._changedImages[a]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}_validateLayer(a){const m=this.sourceCaches[a.source];if(!m)return;const w=a.sourceLayer;if(!w)return;const T=m.getSource();(T.type==="geojson"||T.vectorLayerIds&&T.vectorLayerIds.indexOf(w)===-1)&&this.fire(new l.ErrorEvent(new Error(`Source layer "${w}" does not exist on source "${T.id}" as specified by style layer "${a.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(a){const m=this._serializedAllLayers();if(!a||a.length===0)return Object.values(m);const w=[];for(const T of a)m[T]&&w.push(m[T]);return w}_serializedAllLayers(){let a=this._serializedLayers;if(a)return a;a=this._serializedLayers={};const m=Object.keys(this._layers);for(const w of m){const T=this._layers[w];T.type!=="custom"&&(a[w]=T.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(a){if(!this._loaded)return;const m=this._changed;if(this._changed){const T=Object.keys(this._updatedLayers),I=Object.keys(this._removedLayers);(T.length||I.length)&&this._updateWorkerLayers(T,I);for(const u in this._updatedSources){const c=this._updatedSources[u];if(c==="reload")this._reloadSource(u);else{if(c!=="clear")throw new Error(`Invalid action ${c}`);this._clearSource(u)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const u in this._updatedPaintProps)this._layers[u].updateTransitions(a);this.light.updateTransitions(a),this._resetUpdates()}const w={};for(const T in this.sourceCaches){const I=this.sourceCaches[T];w[T]=I.used,I.used=!1}for(const T of this._order){const I=this._layers[T];I.recalculate(a,this._availableImages),!I.isHidden(a.zoom)&&I.source&&(this.sourceCaches[I.source].used=!0)}for(const T in w){const I=this.sourceCaches[T];w[T]!==I.used&&I.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T}))}this.light.recalculate(a),this.z=a.zoom,m&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(a,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(a),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(a,m={}){this._checkLoaded();const w=this.serialize();if(a=m.transformStyle?m.transformStyle(w,a):a,Ut(this,l.validateStyle(a)))return!1;(a=l.clone$1(a)).layers=l.derefLayers(a.layers);const T=l.diffStyles(w,a).filter(u=>!(u.command in Ht));if(T.length===0)return!1;const I=T.filter(u=>!(u.command in Se));if(I.length>0)throw new Error(`Unimplemented: ${I.map(u=>u.command).join(", ")}.`);for(const u of T)u.command!=="setTransition"&&this[u.command].apply(this,u.args);return this.stylesheet=a,!0}addImage(a,m){if(this.getImage(a))return this.fire(new l.ErrorEvent(new Error(`An image named "${a}" already exists.`)));this.imageManager.addImage(a,m),this._afterImageUpdated(a)}updateImage(a,m){this.imageManager.updateImage(a,m)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){if(!this.getImage(a))return this.fire(new l.ErrorEvent(new Error(`An image named "${a}" does not exist.`)));this.imageManager.removeImage(a),this._afterImageUpdated(a)}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(a,m,w={}){if(this._checkLoaded(),this.sourceCaches[a]!==void 0)throw new Error(`Source "${a}" already exists.`);if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(l.validateStyle.source,`sources.${a}`,m,null,w))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const T=this.sourceCaches[a]=new Jn(a,m,this.dispatcher);T.style=this,T.setEventedParent(this,()=>({isSourceLoaded:T.loaded(),source:T.serialize(),sourceId:a})),T.onAdd(this.map),this._changed=!0}removeSource(a){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===a)return this.fire(new l.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${w}" is using it.`)));const m=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],m.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:a})),m.setEventedParent(null),m.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(a,m){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error(`There is no source with this ID=${a}`);const w=this.sourceCaches[a].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(m),this._changed=!0}getSource(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()}addLayer(a,m,w={}){this._checkLoaded();const T=a.id;if(this.getLayer(T))return void this.fire(new l.ErrorEvent(new Error(`Layer "${T}" already exists on this map.`)));let I;if(a.type==="custom"){if(Ut(this,l.validateCustomStyleLayer(a)))return;I=l.createStyleLayer(a)}else{if("source"in a&&typeof a.source=="object"&&(this.addSource(T,a.source),a=l.clone$1(a),a=l.extend(a,{source:T})),this._validate(l.validateStyle.layer,`layers.${T}`,a,{arrayIndex:-1},w))return;I=l.createStyleLayer(a),this._validateLayer(I),I.setEventedParent(this,{layer:{id:T}})}const u=m?this._order.indexOf(m):this._order.length;if(m&&u===-1)this.fire(new l.ErrorEvent(new Error(`Cannot add layer "${T}" before non-existing layer "${m}".`)));else{if(this._order.splice(u,0,T),this._layerOrderChanged=!0,this._layers[T]=I,this._removedLayers[T]&&I.source&&I.type!=="custom"){const c=this._removedLayers[T];delete this._removedLayers[T],c.type!==I.type?this._updatedSources[I.source]="clear":(this._updatedSources[I.source]="reload",this.sourceCaches[I.source].pause())}this._updateLayer(I),I.onAdd&&I.onAdd(this.map)}}moveLayer(a,m){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new l.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===m)return;const w=this._order.indexOf(a);this._order.splice(w,1);const T=m?this._order.indexOf(m):this._order.length;m&&T===-1?this.fire(new l.ErrorEvent(new Error(`Cannot move layer "${a}" before non-existing layer "${m}".`))):(this._order.splice(T,0,a),this._layerOrderChanged=!0)}removeLayer(a){this._checkLoaded();const m=this._layers[a];if(!m)return void this.fire(new l.ErrorEvent(new Error(`Cannot remove non-existing layer "${a}".`)));m.setEventedParent(null);const w=this._order.indexOf(a);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=m,delete this._layers[a],this._serializedLayers&&delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],m.onRemove&&m.onRemove(this.map)}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}setLayerZoomRange(a,m,w){this._checkLoaded();const T=this.getLayer(a);T?T.minzoom===m&&T.maxzoom===w||(m!=null&&(T.minzoom=m),w!=null&&(T.maxzoom=w),this._updateLayer(T)):this.fire(new l.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${a}".`)))}setFilter(a,m,w={}){this._checkLoaded();const T=this.getLayer(a);if(T){if(!l.deepEqual(T.filter,m))return m==null?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(l.validateStyle.filter,`layers.${T.id}.filter`,m,null,w)||(T.filter=l.clone$1(m),this._updateLayer(T)))}else this.fire(new l.ErrorEvent(new Error(`Cannot filter non-existing layer "${a}".`)))}getFilter(a){return l.clone$1(this.getLayer(a).filter)}setLayoutProperty(a,m,w,T={}){this._checkLoaded();const I=this.getLayer(a);I?l.deepEqual(I.getLayoutProperty(m),w)||(I.setLayoutProperty(m,w,T),this._updateLayer(I)):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getLayoutProperty(a,m){const w=this.getLayer(a);if(w)return w.getLayoutProperty(m);this.fire(new l.ErrorEvent(new Error(`Cannot get style of non-existing layer "${a}".`)))}setPaintProperty(a,m,w,T={}){this._checkLoaded();const I=this.getLayer(a);I?l.deepEqual(I.getPaintProperty(m),w)||(I.setPaintProperty(m,w,T)&&this._updateLayer(I),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new l.ErrorEvent(new Error(`Cannot style non-existing layer "${a}".`)))}getPaintProperty(a,m){return this.getLayer(a).getPaintProperty(m)}setFeatureState(a,m){this._checkLoaded();const w=a.source,T=a.sourceLayer,I=this.sourceCaches[w];if(I===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const u=I.getSource().type;u==="geojson"&&T?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):u!=="vector"||T?(a.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),I.setFeatureState(T,a.id,m)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(a,m){this._checkLoaded();const w=a.source,T=this.sourceCaches[w];if(T===void 0)return void this.fire(new l.ErrorEvent(new Error(`The source '${w}' does not exist in the map's style.`)));const I=T.getSource().type,u=I==="vector"?a.sourceLayer:void 0;I!=="vector"||u?m&&typeof a.id!="string"&&typeof a.id!="number"?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):T.removeFeatureState(u,a.id,m):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(a){this._checkLoaded();const m=a.source,w=a.sourceLayer,T=this.sourceCaches[m];if(T!==void 0)return T.getSource().type!=="vector"||w?(a.id===void 0&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),T.getFeatureState(w,a.id)):void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const a=l.mapObject(this.sourceCaches,T=>T.serialize()),m=this._serializeByIds(this._order),w=this.stylesheet;return l.filterObject({version:w.version,name:w.name,metadata:w.metadata,light:w.light,center:w.center,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch,sprite:w.sprite,glyphs:w.glyphs,transition:w.transition,sources:a,layers:m},T=>T!==void 0)}_updateLayer(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&this.sourceCaches[a.source].getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(a){const m=u=>this._layers[u].type==="fill-extrusion",w={},T=[];for(let u=this._order.length-1;u>=0;u--){const c=this._order[u];if(m(c)){w[c]=u;for(const f of a){const g=f[c];if(g)for(const y of g)T.push(y)}}}T.sort((u,c)=>c.intersectionZ-u.intersectionZ);const I=[];for(let u=this._order.length-1;u>=0;u--){const c=this._order[u];if(m(c))for(let f=T.length-1;f>=0;f--){const g=T[f].feature;if(w[g.layer.id]<u)break;I.push(g),T.pop()}else for(const f of a){const g=f[c];if(g)for(const y of g)I.push(y.feature)}}return I}queryRenderedFeatures(a,m,w){m&&m.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",m.filter,null,m);const T={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const c of m.layers){const f=this._layers[c];if(!f)return this.fire(new l.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be queried for features.`))),[];T[f.source]=!0}}const I=[];m.availableImages=this._availableImages;const u=this._serializedAllLayers();for(const c in this.sourceCaches)m.layers&&!T[c]||I.push(gn(this.sourceCaches[c],this._layers,u,a,m,w));return this.placement&&I.push(function(c,f,g,y,b,P,D){const N={},G=P.queryRenderedSymbols(y),W=[];for(const K of Object.keys(G).map(Number))W.push(D[K]);W.sort(ji);for(const K of W){const de=K.featureIndex.lookupSymbolFeatures(G[K.bucketInstanceId],f,K.bucketIndex,K.sourceLayerIndex,b.filter,b.layers,b.availableImages,c);for(const te in de){const se=N[te]=N[te]||[],xe=de[te];xe.sort((Ie,Fe)=>{const Re=K.featureSortOrder;if(Re){const Be=Re.indexOf(Ie.featureIndex);return Re.indexOf(Fe.featureIndex)-Be}return Fe.featureIndex-Ie.featureIndex});for(const Ie of xe)se.push(Ie)}}for(const K in N)N[K].forEach(de=>{const te=de.feature,se=g[c[K].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=se});return N}(this._layers,u,this.sourceCaches,a,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(I)}querySourceFeatures(a,m){m&&m.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",m.filter,null,m);const w=this.sourceCaches[a];return w?function(T,I){const u=T.getRenderableIds().map(g=>T.getTileByID(g)),c=[],f={};for(let g=0;g<u.length;g++){const y=u[g],b=y.tileID.canonical.key;f[b]||(f[b]=!0,y.querySourceFeatures(c,I))}return c}(w,m):[]}addSourceType(a,m,w){return rs(a)?w(new Error(`A source type called "${a}" already exists.`)):(((T,I)=>{xr[T]=I})(a,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:m.workerSourceURL},w):w(null,null))}getLight(){return this.light.getLight()}setLight(a,m={}){this._checkLoaded();const w=this.light.getLight();let T=!1;for(const u in a)if(!l.deepEqual(a[u],w[u])){T=!0;break}if(!T)return;const I={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(a,m),this.light.updateTransitions(I)}_validate(a,m,w,T,I={}){return(!I||I.validate!==!1)&&Ut(this,a.call(l.validateStyle,l.extend({key:m,style:this.serialize(),value:w,styleSpec:l.v8Spec},T)))}_remove(a=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const m in this._layers)this._layers[m].setEventedParent(null);for(const m in this.sourceCaches){const w=this.sourceCaches[m];w.setEventedParent(null),w.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(a)}_clearSource(a){this.sourceCaches[a].clearTiles()}_reloadSource(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()}_updateSources(a){for(const m in this.sourceCaches)this.sourceCaches[m].update(a,this.map.terrain)}_generateCollisionBoxes(){for(const a in this.sourceCaches)this._reloadSource(a)}_updatePlacement(a,m,w,T,I=!1){let u=!1,c=!1;const f={};for(const g of this._order){const y=this._layers[g];if(y.type!=="symbol")continue;if(!f[y.source]){const P=this.sourceCaches[y.source];f[y.source]=P.getRenderableIds(!0).map(D=>P.getTileByID(D)).sort((D,N)=>N.tileID.overscaledZ-D.tileID.overscaledZ||(D.tileID.isLessThan(N.tileID)?-1:1))}const b=this.crossTileSymbolIndex.addLayer(y,f[y.source],a.center.lng);u=u||b}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((I=I||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),a.zoom))&&(this.pauseablePlacement=new _i(a,this.map.terrain,this._order,I,m,w,T,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,f),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),c=!0),u&&this.pauseablePlacement.placement.setStale()),c||u)for(const g of this._order){const y=this._layers[g];y.type==="symbol"&&this.placement.updateLayerOpacities(y,f[y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())}_releaseSymbolFadeTiles(){for(const a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,m,w){this.imageManager.getImages(m.icons,w),this._updateTilesForChangedImages();const T=this.sourceCaches[m.source];T&&T.setDependencies(m.tileID.key,m.type,m.icons)}getGlyphs(a,m,w){this.glyphManager.getGlyphs(m.stacks,w);const T=this.sourceCaches[m.source];T&&T.setDependencies(m.tileID.key,m.type,[""])}getResource(a,m,w){return l.makeRequest(m,w)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(a,m={}){this._checkLoaded(),a&&this._validate(l.validateStyle.glyphs,"glyphs",a,null,m)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=a,this.glyphManager.entries={},this.glyphManager.setURL(a))}addSprite(a,m,w={},T){this._checkLoaded();const I=[{id:a,url:m}],u=[...lt(this.stylesheet.sprite),...I];this._validate(l.validateStyle.sprite,"sprite",u,null,w)||(this.stylesheet.sprite=u,this._loadSprite(I,!0,T))}removeSprite(a){this._checkLoaded();const m=lt(this.stylesheet.sprite);if(m.find(w=>w.id===a)){if(this._spritesImagesIds[a])for(const w of this._spritesImagesIds[a])this.imageManager.removeImage(w),this._changedImages[w]=!0;m.splice(m.findIndex(w=>w.id===a),1),this.stylesheet.sprite=m.length>0?m:void 0,delete this._spritesImagesIds[a],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}else this.fire(new l.ErrorEvent(new Error(`Sprite "${a}" doesn't exists on this map.`)))}getSprite(){return lt(this.stylesheet.sprite)}setSprite(a,m={},w){this._checkLoaded(),a&&this._validate(l.validateStyle.sprite,"sprite",a,null,m)||(this.stylesheet.sprite=a,a?this._loadSprite(a,!0,w):(this._unloadSprite(),w&&w(null)))}}bi.registerForPluginStateChange=l.registerForPluginStateChange;var Eo=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),De="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const oo={prelude:_e(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:_e(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:_e(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:_e(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:_e("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:_e(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:_e(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:_e("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:_e("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:_e("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:_e(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:_e(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:_e(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:_e(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:_e(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:_e(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:_e(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:_e(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:_e(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:_e(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:_e(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:_e(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:_e(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:_e(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:_e(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:_e(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:_e("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",De),terrainDepth:_e("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",De),terrainCoords:_e("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",De)};function _e(M,a){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=a.match(/attribute ([\w]+) ([\w]+)/g),T=M.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),I=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),u=I?I.concat(T):T,c={};return{fragmentSource:M=M.replace(m,(f,g,y,b,P)=>(c[P]=!0,g==="define"?`
#ifndef HAS_UNIFORM_u_${P}
varying ${y} ${b} ${P};
#else
uniform ${y} ${b} u_${P};
#endif
`:`
#ifdef HAS_UNIFORM_u_${P}
    ${y} ${b} ${P} = u_${P};
#endif
`)),vertexSource:a=a.replace(m,(f,g,y,b,P)=>{const D=b==="float"?"vec2":"vec4",N=P.match(/color/)?"color":D;return c[P]?g==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${y} ${D} a_${P};
varying ${y} ${b} ${P};
#else
uniform ${y} ${b} u_${P};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = a_${P};
#else
    ${y} ${b} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = unpack_mix_${N}(a_${P}, u_${P}_t);
#else
    ${y} ${b} ${P} = u_${P};
#endif
`:g==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${y} ${D} a_${P};
#else
uniform ${y} ${b} u_${P};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${y} ${b} ${P} = a_${P};
#else
    ${y} ${b} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${y} ${b} ${P} = unpack_mix_${N}(a_${P}, u_${P}_t);
#else
    ${y} ${b} ${P} = u_${P};
#endif
`}),staticAttributes:w,staticUniforms:u}}class ao{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(a,m,w,T,I,u,c,f,g){this.context=a;let y=this.boundPaintVertexBuffers.length!==T.length;for(let b=0;!y&&b<T.length;b++)this.boundPaintVertexBuffers[b]!==T[b]&&(y=!0);!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==w||y||this.boundIndexBuffer!==I||this.boundVertexOffset!==u||this.boundDynamicVertexBuffer!==c||this.boundDynamicVertexBuffer2!==f||this.boundDynamicVertexBuffer3!==g?this.freshBind(m,w,T,I,u,c,f,g):(a.bindVertexArray.set(this.vao),c&&c.bind(),I&&I.dynamicDraw&&I.bind(),f&&f.bind(),g&&g.bind())}freshBind(a,m,w,T,I,u,c,f){const g=a.numAttributes,y=this.context,b=y.gl;this.vao&&this.destroy(),this.vao=y.createVertexArray(),y.bindVertexArray.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=T,this.boundVertexOffset=I,this.boundDynamicVertexBuffer=u,this.boundDynamicVertexBuffer2=c,this.boundDynamicVertexBuffer3=f,m.enableAttributes(b,a);for(const P of w)P.enableAttributes(b,a);u&&u.enableAttributes(b,a),c&&c.enableAttributes(b,a),f&&f.enableAttributes(b,a),m.bind(),m.setVertexAttribPointers(b,a,I);for(const P of w)P.bind(),P.setVertexAttribPointers(b,a,I);u&&(u.bind(),u.setVertexAttribPointers(b,a,I)),T&&T.bind(),c&&(c.bind(),c.setVertexAttribPointers(b,a,I)),f&&(f.bind(),f.setVertexAttribPointers(b,a,I)),y.currentNumAttributes=g}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function cr(M){const a=[];for(let m=0;m<M.length;m++){if(M[m]===null)continue;const w=M[m].split(" ");a.push(w.pop())}return a}class Us{constructor(a,m,w,T,I,u){const c=a.gl;this.program=c.createProgram();const f=cr(m.staticAttributes),g=w?w.getBinderAttributes():[],y=f.concat(g),b=oo.prelude.staticUniforms?cr(oo.prelude.staticUniforms):[],P=m.staticUniforms?cr(m.staticUniforms):[],D=w?w.getBinderUniforms():[],N=b.concat(P).concat(D),G=[];for(const Ie of N)G.indexOf(Ie)<0&&G.push(Ie);const W=w?w.defines():[];I&&W.push("#define OVERDRAW_INSPECTOR;"),u&&W.push("#define TERRAIN3D;");const K=W.concat(oo.prelude.fragmentSource,m.fragmentSource).join(`
`),de=W.concat(oo.prelude.vertexSource,m.vertexSource).join(`
`),te=c.createShader(c.FRAGMENT_SHADER);if(c.isContextLost())return void(this.failedToCreate=!0);if(c.shaderSource(te,K),c.compileShader(te),!c.getShaderParameter(te,c.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${c.getShaderInfoLog(te)}`);c.attachShader(this.program,te);const se=c.createShader(c.VERTEX_SHADER);if(c.isContextLost())return void(this.failedToCreate=!0);if(c.shaderSource(se,de),c.compileShader(se),!c.getShaderParameter(se,c.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${c.getShaderInfoLog(se)}`);c.attachShader(this.program,se),this.attributes={};const xe={};this.numAttributes=y.length;for(let Ie=0;Ie<this.numAttributes;Ie++)y[Ie]&&(c.bindAttribLocation(this.program,Ie,y[Ie]),this.attributes[y[Ie]]=Ie);if(c.linkProgram(this.program),!c.getProgramParameter(this.program,c.LINK_STATUS))throw new Error(`Program failed to link: ${c.getProgramInfoLog(this.program)}`);c.deleteShader(se),c.deleteShader(te);for(let Ie=0;Ie<G.length;Ie++){const Fe=G[Ie];if(Fe&&!xe[Fe]){const Re=c.getUniformLocation(this.program,Fe);Re&&(xe[Fe]=Re)}}this.fixedUniforms=T(a,xe),this.terrainUniforms=((Ie,Fe)=>({u_depth:new l.Uniform1i(Ie,Fe.u_depth),u_terrain:new l.Uniform1i(Ie,Fe.u_terrain),u_terrain_dim:new l.Uniform1f(Ie,Fe.u_terrain_dim),u_terrain_matrix:new l.UniformMatrix4f(Ie,Fe.u_terrain_matrix),u_terrain_unpack:new l.Uniform4f(Ie,Fe.u_terrain_unpack),u_terrain_exaggeration:new l.Uniform1f(Ie,Fe.u_terrain_exaggeration)}))(a,xe),this.binderUniforms=w?w.getUniforms(a,xe):[]}draw(a,m,w,T,I,u,c,f,g,y,b,P,D,N,G,W,K,de){const te=a.gl;if(this.failedToCreate)return;if(a.program.set(this.program),a.setDepthMode(w),a.setStencilMode(T),a.setColorMode(I),a.setCullFace(u),f){a.activeTexture.set(te.TEXTURE2),te.bindTexture(te.TEXTURE_2D,f.depthTexture),a.activeTexture.set(te.TEXTURE3),te.bindTexture(te.TEXTURE_2D,f.texture);for(const xe in this.terrainUniforms)this.terrainUniforms[xe].set(f[xe])}for(const xe in this.fixedUniforms)this.fixedUniforms[xe].set(c[xe]);G&&G.setUniforms(a,this.binderUniforms,D,{zoom:N});let se=0;switch(m){case te.LINES:se=2;break;case te.TRIANGLES:se=3;break;case te.LINE_STRIP:se=1}for(const xe of P.get()){const Ie=xe.vaos||(xe.vaos={});(Ie[g]||(Ie[g]=new ao)).bind(a,this,y,G?G.getPaintVertexBuffers():[],b,xe.vertexOffset,W,K,de),te.drawElements(m,xe.primitiveLength*se,te.UNSIGNED_SHORT,xe.primitiveOffset*se*2)}}}function Xo(M,a,m){const w=1/$e(m,1,a.transform.tileZoom),T=Math.pow(2,m.tileID.overscaledZ),I=m.tileSize*Math.pow(2,a.transform.tileZoom)/T,u=I*(m.tileID.canonical.x+m.tileID.wrap*T),c=I*m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[w,M.fromScale,M.toScale],u_fade:M.t,u_pixel_coord_upper:[u>>16,c>>16],u_pixel_coord_lower:[65535&u,65535&c]}}const Vs=(M,a,m,w)=>{const T=a.style.light,I=T.properties.get("position"),u=[I.x,I.y,I.z],c=function(){var g=new l.ARRAY_TYPE(9);return l.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0,g[3]=0,g[5]=0,g[6]=0,g[7]=0),g[0]=1,g[4]=1,g[8]=1,g}();T.properties.get("anchor")==="viewport"&&function(g,y){var b=Math.sin(y),P=Math.cos(y);g[0]=P,g[1]=b,g[2]=0,g[3]=-b,g[4]=P,g[5]=0,g[6]=0,g[7]=0,g[8]=1}(c,-a.transform.angle),function(g,y,b){var P=y[0],D=y[1],N=y[2];g[0]=P*b[0]+D*b[3]+N*b[6],g[1]=P*b[1]+D*b[4]+N*b[7],g[2]=P*b[2]+D*b[5]+N*b[8]}(u,u,c);const f=T.properties.get("color");return{u_matrix:M,u_lightpos:u,u_lightintensity:T.properties.get("intensity"),u_lightcolor:[f.r,f.g,f.b],u_vertical_gradient:+m,u_opacity:w}},XA=(M,a,m,w,T,I,u)=>l.extend(Vs(M,a,m,w),Xo(I,a,u),{u_height_factor:-Math.pow(2,T.overscaledZ)/u.tileSize/8}),Ko=M=>({u_matrix:M}),hr=(M,a,m,w)=>l.extend(Ko(M),Xo(m,a,w)),ge=(M,a)=>({u_matrix:M,u_world:a}),Ee=(M,a,m,w,T)=>l.extend(hr(M,a,m,w),{u_world:T}),Ge=(M,a,m,w)=>{const T=M.transform;let I,u;if(w.paint.get("circle-pitch-alignment")==="map"){const c=$e(m,1,T.zoom);I=!0,u=[c,c]}else I=!1,u=T.pixelsToGLUnits;return{u_camera_to_center_distance:T.cameraToCenterDistance,u_scale_with_map:+(w.paint.get("circle-pitch-scale")==="map"),u_matrix:M.translatePosMatrix(a.posMatrix,m,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_pitch_with_map:+I,u_device_pixel_ratio:M.pixelRatio,u_extrude_scale:u}},ot=(M,a,m)=>{const w=$e(m,1,a.zoom),T=Math.pow(2,a.zoom-m.tileID.overscaledZ),I=m.tileID.overscaleFactor();return{u_matrix:M,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:w,u_extrude_scale:[a.pixelsToGLUnits[0]/(w*T),a.pixelsToGLUnits[1]/(w*T)],u_overscale_factor:I}},vt=(M,a,m=1)=>({u_matrix:M,u_color:a,u_overlay:0,u_overlay_scale:m}),Zt=M=>({u_matrix:M}),Cn=(M,a,m,w)=>({u_matrix:M,u_extrude_scale:$e(a,1,m),u_intensity:w});function Ei(M,a){const m=Math.pow(2,a.canonical.z),w=a.canonical.y;return[new l.MercatorCoordinate(0,w/m).toLngLat().lat,new l.MercatorCoordinate(0,(w+1)/m).toLngLat().lat]}const wn=(M,a,m,w)=>{const T=M.transform;return{u_matrix:aA(M,a,m,w),u_ratio:1/$e(a,1,T.zoom),u_device_pixel_ratio:M.pixelRatio,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]]}},Li=(M,a,m,w,T)=>l.extend(wn(M,a,m,T),{u_image:0,u_image_height:w}),En=(M,a,m,w,T)=>{const I=M.transform,u=zr(a,I);return{u_matrix:aA(M,a,m,T),u_texsize:a.imageAtlasTexture.size,u_ratio:1/$e(a,1,I.zoom),u_device_pixel_ratio:M.pixelRatio,u_image:0,u_scale:[u,w.fromScale,w.toScale],u_fade:w.t,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]]}},za=(M,a,m,w,T,I)=>{const u=M.lineAtlas,c=zr(a,M.transform),f=m.layout.get("line-cap")==="round",g=u.getDash(w.from,f),y=u.getDash(w.to,f),b=g.width*T.fromScale,P=y.width*T.toScale;return l.extend(wn(M,a,m,I),{u_patternscale_a:[c/b,-g.height/2],u_patternscale_b:[c/P,-y.height/2],u_sdfgamma:u.width/(256*Math.min(b,P)*M.pixelRatio)/2,u_image:0,u_tex_y_a:g.y,u_tex_y_b:y.y,u_mix:T.t})};function zr(M,a){return 1/$e(M,1,a.tileZoom)}function aA(M,a,m,w){return M.translatePosMatrix(w?w.posMatrix:a.tileID.posMatrix,a,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}const AA=(M,a,m,w,T)=>{return{u_matrix:M,u_tl_parent:a,u_scale_parent:m,u_buffer_scale:1,u_fade_t:w.mix,u_opacity:w.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(u=T.paint.get("raster-saturation"),u>0?1-1/(1.001-u):-u),u_contrast_factor:(I=T.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:Jo(T.paint.get("raster-hue-rotate"))};var I,u};function Jo(M){M*=Math.PI/180;const a=Math.sin(M),m=Math.cos(M);return[(2*m+1)/3,(-Math.sqrt(3)*a-m+1)/3,(Math.sqrt(3)*a-m+1)/3]}const To=(M,a,m,w,T,I,u,c,f,g)=>{const y=T.transform;return{u_is_size_zoom_constant:+(M==="constant"||M==="source"),u_is_size_feature_constant:+(M==="constant"||M==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:y.cameraToCenterDistance,u_pitch:y.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:y.width/y.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:u,u_coord_matrix:c,u_is_text:+f,u_pitch_with_map:+w,u_texsize:g,u_texture:0}},ea=(M,a,m,w,T,I,u,c,f,g,y)=>{const b=T.transform;return l.extend(To(M,a,m,w,T,I,u,c,f,g),{u_gamma_scale:w?Math.cos(b._pitch)*b.cameraToCenterDistance:1,u_device_pixel_ratio:T.pixelRatio,u_is_halo:+y})},ta=(M,a,m,w,T,I,u,c,f,g)=>l.extend(ea(M,a,m,w,T,I,u,c,!0,f,!0),{u_texsize_icon:g,u_texture_icon:1}),So=(M,a,m)=>({u_matrix:M,u_opacity:a,u_color:m}),lA=(M,a,m,w,T,I)=>l.extend(function(u,c,f,g){const y=f.imageManager.getPattern(u.from.toString()),b=f.imageManager.getPattern(u.to.toString()),{width:P,height:D}=f.imageManager.getPixelSize(),N=Math.pow(2,g.tileID.overscaledZ),G=g.tileSize*Math.pow(2,f.transform.tileZoom)/N,W=G*(g.tileID.canonical.x+g.tileID.wrap*N),K=G*g.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:y.tl,u_pattern_br_a:y.br,u_pattern_tl_b:b.tl,u_pattern_br_b:b.br,u_texsize:[P,D],u_mix:c.t,u_pattern_size_a:y.displaySize,u_pattern_size_b:b.displaySize,u_scale_a:c.fromScale,u_scale_b:c.toScale,u_tile_units_to_pixels:1/$e(g,1,f.transform.tileZoom),u_pixel_coord_upper:[W>>16,K>>16],u_pixel_coord_lower:[65535&W,65535&K]}}(w,I,m,T),{u_matrix:M,u_opacity:a}),fr={fillExtrusion:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_lightpos:new l.Uniform3f(M,a.u_lightpos),u_lightintensity:new l.Uniform1f(M,a.u_lightintensity),u_lightcolor:new l.Uniform3f(M,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(M,a.u_vertical_gradient),u_opacity:new l.Uniform1f(M,a.u_opacity)}),fillExtrusionPattern:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_lightpos:new l.Uniform3f(M,a.u_lightpos),u_lightintensity:new l.Uniform1f(M,a.u_lightintensity),u_lightcolor:new l.Uniform3f(M,a.u_lightcolor),u_vertical_gradient:new l.Uniform1f(M,a.u_vertical_gradient),u_height_factor:new l.Uniform1f(M,a.u_height_factor),u_image:new l.Uniform1i(M,a.u_image),u_texsize:new l.Uniform2f(M,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(M,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(M,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(M,a.u_scale),u_fade:new l.Uniform1f(M,a.u_fade),u_opacity:new l.Uniform1f(M,a.u_opacity)}),fill:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix)}),fillPattern:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_image:new l.Uniform1i(M,a.u_image),u_texsize:new l.Uniform2f(M,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(M,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(M,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(M,a.u_scale),u_fade:new l.Uniform1f(M,a.u_fade)}),fillOutline:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_world:new l.Uniform2f(M,a.u_world)}),fillOutlinePattern:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_world:new l.Uniform2f(M,a.u_world),u_image:new l.Uniform1i(M,a.u_image),u_texsize:new l.Uniform2f(M,a.u_texsize),u_pixel_coord_upper:new l.Uniform2f(M,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(M,a.u_pixel_coord_lower),u_scale:new l.Uniform3f(M,a.u_scale),u_fade:new l.Uniform1f(M,a.u_fade)}),circle:(M,a)=>({u_camera_to_center_distance:new l.Uniform1f(M,a.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(M,a.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(M,a.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(M,a.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(M,a.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(M,a.u_matrix)}),collisionBox:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_camera_to_center_distance:new l.Uniform1f(M,a.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(M,a.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(M,a.u_extrude_scale),u_overscale_factor:new l.Uniform1f(M,a.u_overscale_factor)}),collisionCircle:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_inv_matrix:new l.UniformMatrix4f(M,a.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(M,a.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(M,a.u_viewport_size)}),debug:(M,a)=>({u_color:new l.UniformColor(M,a.u_color),u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_overlay:new l.Uniform1i(M,a.u_overlay),u_overlay_scale:new l.Uniform1f(M,a.u_overlay_scale)}),clippingMask:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix)}),heatmap:(M,a)=>({u_extrude_scale:new l.Uniform1f(M,a.u_extrude_scale),u_intensity:new l.Uniform1f(M,a.u_intensity),u_matrix:new l.UniformMatrix4f(M,a.u_matrix)}),heatmapTexture:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_world:new l.Uniform2f(M,a.u_world),u_image:new l.Uniform1i(M,a.u_image),u_color_ramp:new l.Uniform1i(M,a.u_color_ramp),u_opacity:new l.Uniform1f(M,a.u_opacity)}),hillshade:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_image:new l.Uniform1i(M,a.u_image),u_latrange:new l.Uniform2f(M,a.u_latrange),u_light:new l.Uniform2f(M,a.u_light),u_shadow:new l.UniformColor(M,a.u_shadow),u_highlight:new l.UniformColor(M,a.u_highlight),u_accent:new l.UniformColor(M,a.u_accent)}),hillshadePrepare:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_image:new l.Uniform1i(M,a.u_image),u_dimension:new l.Uniform2f(M,a.u_dimension),u_zoom:new l.Uniform1f(M,a.u_zoom),u_unpack:new l.Uniform4f(M,a.u_unpack)}),line:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_ratio:new l.Uniform1f(M,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(M,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(M,a.u_units_to_pixels)}),lineGradient:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_ratio:new l.Uniform1f(M,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(M,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(M,a.u_units_to_pixels),u_image:new l.Uniform1i(M,a.u_image),u_image_height:new l.Uniform1f(M,a.u_image_height)}),linePattern:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_texsize:new l.Uniform2f(M,a.u_texsize),u_ratio:new l.Uniform1f(M,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(M,a.u_device_pixel_ratio),u_image:new l.Uniform1i(M,a.u_image),u_units_to_pixels:new l.Uniform2f(M,a.u_units_to_pixels),u_scale:new l.Uniform3f(M,a.u_scale),u_fade:new l.Uniform1f(M,a.u_fade)}),lineSDF:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_ratio:new l.Uniform1f(M,a.u_ratio),u_device_pixel_ratio:new l.Uniform1f(M,a.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(M,a.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(M,a.u_patternscale_a),u_patternscale_b:new l.Uniform2f(M,a.u_patternscale_b),u_sdfgamma:new l.Uniform1f(M,a.u_sdfgamma),u_image:new l.Uniform1i(M,a.u_image),u_tex_y_a:new l.Uniform1f(M,a.u_tex_y_a),u_tex_y_b:new l.Uniform1f(M,a.u_tex_y_b),u_mix:new l.Uniform1f(M,a.u_mix)}),raster:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_tl_parent:new l.Uniform2f(M,a.u_tl_parent),u_scale_parent:new l.Uniform1f(M,a.u_scale_parent),u_buffer_scale:new l.Uniform1f(M,a.u_buffer_scale),u_fade_t:new l.Uniform1f(M,a.u_fade_t),u_opacity:new l.Uniform1f(M,a.u_opacity),u_image0:new l.Uniform1i(M,a.u_image0),u_image1:new l.Uniform1i(M,a.u_image1),u_brightness_low:new l.Uniform1f(M,a.u_brightness_low),u_brightness_high:new l.Uniform1f(M,a.u_brightness_high),u_saturation_factor:new l.Uniform1f(M,a.u_saturation_factor),u_contrast_factor:new l.Uniform1f(M,a.u_contrast_factor),u_spin_weights:new l.Uniform3f(M,a.u_spin_weights)}),symbolIcon:(M,a)=>({u_is_size_zoom_constant:new l.Uniform1i(M,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(M,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(M,a.u_size_t),u_size:new l.Uniform1f(M,a.u_size),u_camera_to_center_distance:new l.Uniform1f(M,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(M,a.u_pitch),u_rotate_symbol:new l.Uniform1i(M,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(M,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(M,a.u_fade_change),u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(M,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(M,a.u_coord_matrix),u_is_text:new l.Uniform1i(M,a.u_is_text),u_pitch_with_map:new l.Uniform1i(M,a.u_pitch_with_map),u_texsize:new l.Uniform2f(M,a.u_texsize),u_texture:new l.Uniform1i(M,a.u_texture)}),symbolSDF:(M,a)=>({u_is_size_zoom_constant:new l.Uniform1i(M,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(M,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(M,a.u_size_t),u_size:new l.Uniform1f(M,a.u_size),u_camera_to_center_distance:new l.Uniform1f(M,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(M,a.u_pitch),u_rotate_symbol:new l.Uniform1i(M,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(M,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(M,a.u_fade_change),u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(M,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(M,a.u_coord_matrix),u_is_text:new l.Uniform1i(M,a.u_is_text),u_pitch_with_map:new l.Uniform1i(M,a.u_pitch_with_map),u_texsize:new l.Uniform2f(M,a.u_texsize),u_texture:new l.Uniform1i(M,a.u_texture),u_gamma_scale:new l.Uniform1f(M,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(M,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(M,a.u_is_halo)}),symbolTextAndIcon:(M,a)=>({u_is_size_zoom_constant:new l.Uniform1i(M,a.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(M,a.u_is_size_feature_constant),u_size_t:new l.Uniform1f(M,a.u_size_t),u_size:new l.Uniform1f(M,a.u_size),u_camera_to_center_distance:new l.Uniform1f(M,a.u_camera_to_center_distance),u_pitch:new l.Uniform1f(M,a.u_pitch),u_rotate_symbol:new l.Uniform1i(M,a.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(M,a.u_aspect_ratio),u_fade_change:new l.Uniform1f(M,a.u_fade_change),u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(M,a.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(M,a.u_coord_matrix),u_is_text:new l.Uniform1i(M,a.u_is_text),u_pitch_with_map:new l.Uniform1i(M,a.u_pitch_with_map),u_texsize:new l.Uniform2f(M,a.u_texsize),u_texsize_icon:new l.Uniform2f(M,a.u_texsize_icon),u_texture:new l.Uniform1i(M,a.u_texture),u_texture_icon:new l.Uniform1i(M,a.u_texture_icon),u_gamma_scale:new l.Uniform1f(M,a.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(M,a.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(M,a.u_is_halo)}),background:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_opacity:new l.Uniform1f(M,a.u_opacity),u_color:new l.UniformColor(M,a.u_color)}),backgroundPattern:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_opacity:new l.Uniform1f(M,a.u_opacity),u_image:new l.Uniform1i(M,a.u_image),u_pattern_tl_a:new l.Uniform2f(M,a.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(M,a.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(M,a.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(M,a.u_pattern_br_b),u_texsize:new l.Uniform2f(M,a.u_texsize),u_mix:new l.Uniform1f(M,a.u_mix),u_pattern_size_a:new l.Uniform2f(M,a.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(M,a.u_pattern_size_b),u_scale_a:new l.Uniform1f(M,a.u_scale_a),u_scale_b:new l.Uniform1f(M,a.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(M,a.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(M,a.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(M,a.u_tile_units_to_pixels)}),terrain:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_texture:new l.Uniform1i(M,a.u_texture),u_ele_delta:new l.Uniform1f(M,a.u_ele_delta)}),terrainDepth:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_ele_delta:new l.Uniform1f(M,a.u_ele_delta)}),terrainCoords:(M,a)=>({u_matrix:new l.UniformMatrix4f(M,a.u_matrix),u_texture:new l.Uniform1i(M,a.u_texture),u_terrain_coords_id:new l.Uniform1f(M,a.u_terrain_coords_id),u_ele_delta:new l.Uniform1f(M,a.u_ele_delta)})};class Fr{constructor(a,m,w){this.context=a;const T=a.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const m=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const KA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class JA{constructor(a,m,w,T){this.length=m.length,this.attributes=w,this.itemSize=m.bytesPerElement,this.dynamicDraw=T,this.context=a;const I=a.gl;this.buffer=I.createBuffer(),a.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){if(a.length!==this.length)throw new Error(`Length of new data is ${a.length}, which doesn't match current length of ${this.length}`);const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,m){for(let w=0;w<this.attributes.length;w++){const T=m.attributes[this.attributes[w].name];T!==void 0&&a.enableVertexAttribArray(T)}}setVertexAttribPointers(a,m,w){for(let T=0;T<this.attributes.length;T++){const I=this.attributes[T],u=m.attributes[I.name];u!==void 0&&a.vertexAttribPointer(u,I.components,a[KA[I.type]],!1,this.itemSize,I.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ti=new WeakMap;function as(M){if(Ti.has(M))return Ti.get(M);{const a=M.getParameter(M.VERSION).startsWith("WebGL 2.0");return Ti.set(M,a),a}}class rn{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class As extends rn{getDefault(){return l.Color.transparent}set(a){const m=this.current;(a.r!==m.r||a.g!==m.g||a.b!==m.b||a.a!==m.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Hi extends rn{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class Co extends rn{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class Fa extends rn{getDefault(){return[!0,!0,!0,!0]}set(a){const m=this.current;(a[0]!==m[0]||a[1]!==m[1]||a[2]!==m[2]||a[3]!==m[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class na extends rn{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class uA extends rn{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class ls extends rn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const m=this.current;(a.func!==m.func||a.ref!==m.ref||a.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Eu extends rn{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const m=this.current;(a[0]!==m[0]||a[1]!==m[1]||a[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class Ml extends rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;a?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=a,this.dirty=!1}}class ia extends rn{getDefault(){return[0,1]}set(a){const m=this.current;(a[0]!==m[0]||a[1]!==m[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Zr extends rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;a?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=a,this.dirty=!1}}class Ao extends rn{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class Il extends rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;a?m.enable(m.BLEND):m.disable(m.BLEND),this.current=a,this.dirty=!1}}class ra extends rn{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const m=this.current;(a[0]!==m[0]||a[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class us extends rn{getDefault(){return l.Color.transparent}set(a){const m=this.current;(a.r!==m.r||a.g!==m.g||a.b!==m.b||a.a!==m.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class js extends rn{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class el extends rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;a?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=a,this.dirty=!1}}class Po extends rn{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class tl extends rn{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}class Tu extends rn{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}}class kl extends rn{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class cs extends rn{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const m=this.current;(a[0]!==m[0]||a[1]!==m[1]||a[2]!==m[2]||a[3]!==m[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Su extends rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class sa extends rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class oa extends rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class aa extends rn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Ll extends rn{getDefault(){return null}set(a){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class Hn extends rn{getDefault(){return null}set(a){var m;if(a===this.current&&!this.dirty)return;const w=this.gl;as(w)?w.bindVertexArray(a):(m=w.getExtension("OES_vertex_array_object"))===null||m===void 0||m.bindVertexArrayOES(a),this.current=a,this.dirty=!1}}class cA extends rn{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class hA extends rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class Gs extends rn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class Aa extends rn{constructor(a,m){super(a),this.context=a,this.parent=m}getDefault(){return null}}class fA extends Aa{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class vc extends Aa{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class Na extends Aa{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class xc{constructor(a,m,w,T,I){this.context=a,this.width=m,this.height=w;const u=a.gl,c=this.framebuffer=u.createFramebuffer();if(this.colorAttachment=new fA(a,c),T)this.depthAttachment=I?new Na(a,c):new vc(a,c);else if(I)throw new Error("Stencil cannot be setted without depth");if(u.checkFramebufferStatus(u.FRAMEBUFFER)!==u.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const a=this.context.gl,m=this.colorAttachment.get();if(m&&a.deleteTexture(m),this.depthAttachment){const w=this.depthAttachment.get();w&&a.deleteRenderbuffer(w)}a.deleteFramebuffer(this.framebuffer)}}class fi{constructor(a,m,w){this.blendFunction=a,this.blendColor=m,this.mask=w}}fi.Replace=[1,0],fi.disabled=new fi(fi.Replace,l.Color.transparent,[!1,!1,!1,!1]),fi.unblended=new fi(fi.Replace,l.Color.transparent,[!0,!0,!0,!0]),fi.alphaBlended=new fi([1,771],l.Color.transparent,[!0,!0,!0,!0]);class dA{constructor(a){var m,w;if(this.gl=a,this.clearColor=new As(this),this.clearDepth=new Hi(this),this.clearStencil=new Co(this),this.colorMask=new Fa(this),this.depthMask=new na(this),this.stencilMask=new uA(this),this.stencilFunc=new ls(this),this.stencilOp=new Eu(this),this.stencilTest=new Ml(this),this.depthRange=new ia(this),this.depthTest=new Zr(this),this.depthFunc=new Ao(this),this.blend=new Il(this),this.blendFunc=new ra(this),this.blendColor=new us(this),this.blendEquation=new js(this),this.cullFace=new el(this),this.cullFaceSide=new Po(this),this.frontFace=new tl(this),this.program=new Tu(this),this.activeTexture=new kl(this),this.viewport=new cs(this),this.bindFramebuffer=new Su(this),this.bindRenderbuffer=new sa(this),this.bindTexture=new oa(this),this.bindVertexBuffer=new aa(this),this.bindElementBuffer=new Ll(this),this.bindVertexArray=new Hn(this),this.pixelStoreUnpack=new cA(this),this.pixelStoreUnpackPremultiplyAlpha=new hA(this),this.pixelStoreUnpackFlipY=new Gs(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),as(a)){this.HALF_FLOAT=a.HALF_FLOAT;const T=a.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(m=a.RGBA16F)!==null&&m!==void 0?m:T==null?void 0:T.RGBA16F_EXT,this.RGB16F=(w=a.RGB16F)!==null&&w!==void 0?w:T==null?void 0:T.RGB16F_EXT,a.getExtension("EXT_color_buffer_float")}else{a.getExtension("EXT_color_buffer_half_float"),a.getExtension("OES_texture_half_float_linear");const T=a.getExtension("OES_texture_half_float");this.HALF_FLOAT=T==null?void 0:T.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,m){return new Fr(this,a,m)}createVertexBuffer(a,m,w){return new JA(this,a,m,w)}createRenderbuffer(a,m,w){const T=this.gl,I=T.createRenderbuffer();return this.bindRenderbuffer.set(I),T.renderbufferStorage(T.RENDERBUFFER,a,m,w),this.bindRenderbuffer.set(null),I}createFramebuffer(a,m,w,T){return new xc(this,a,m,w,T)}clear({color:a,depth:m,stencil:w}){const T=this.gl;let I=0;a&&(I|=T.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(I|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),w!==void 0&&(I|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),T.clear(I)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){l.deepEqual(a.blendFunction,fi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}createVertexArray(){var a;return as(this.gl)?this.gl.createVertexArray():(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.createVertexArrayOES()}deleteVertexArray(a){var m;return as(this.gl)?this.gl.deleteVertexArray(a):(m=this.gl.getExtension("OES_vertex_array_object"))===null||m===void 0?void 0:m.deleteVertexArrayOES(a)}unbindVAO(){this.bindVertexArray.set(null)}}class bn{constructor(a,m,w){this.func=a,this.mask=m,this.range=w}}bn.ReadOnly=!1,bn.ReadWrite=!0,bn.disabled=new bn(519,bn.ReadOnly,[0,1]);const pA=7680;class ii{constructor(a,m,w,T,I,u){this.test=a,this.ref=m,this.mask=w,this.fail=T,this.depthFail=I,this.pass=u}}ii.disabled=new ii({func:519,mask:0},0,0,pA,pA,pA);class Wn{constructor(a,m,w){this.enable=a,this.mode=m,this.frontFace=w}}let la;function Ua(M,a,m,w,T,I,u){const c=M.context,f=c.gl,g=M.useProgram("collisionBox"),y=[];let b=0,P=0;for(let te=0;te<w.length;te++){const se=w[te],xe=a.getTile(se),Ie=xe.getBucket(m);if(!Ie)continue;let Fe=se.posMatrix;T[0]===0&&T[1]===0||(Fe=M.translatePosMatrix(se.posMatrix,xe,T,I));const Re=u?Ie.textCollisionBox:Ie.iconCollisionBox,Be=Ie.collisionCircleArray;if(Be.length>0){const Le=l.create(),At=Fe;l.mul(Le,Ie.placementInvProjMatrix,M.transform.glCoordMatrix),l.mul(Le,Le,Ie.placementViewportMatrix),y.push({circleArray:Be,circleOffset:P,transform:At,invTransform:Le,coord:se}),b+=Be.length/4,P=b}Re&&g.draw(c,f.LINES,bn.disabled,ii.disabled,M.colorModeForRenderPass(),Wn.disabled,ot(Fe,M.transform,xe),M.style.map.terrain&&M.style.map.terrain.getTerrainData(se),m.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,null,M.transform.zoom,null,null,Re.collisionVertexBuffer)}if(!u||!y.length)return;const D=M.useProgram("collisionCircle"),N=new l.CollisionCircleLayoutArray;N.resize(4*b),N._trim();let G=0;for(const te of y)for(let se=0;se<te.circleArray.length/4;se++){const xe=4*se,Ie=te.circleArray[xe+0],Fe=te.circleArray[xe+1],Re=te.circleArray[xe+2],Be=te.circleArray[xe+3];N.emplace(G++,Ie,Fe,Re,Be,0),N.emplace(G++,Ie,Fe,Re,Be,1),N.emplace(G++,Ie,Fe,Re,Be,2),N.emplace(G++,Ie,Fe,Re,Be,3)}(!la||la.length<2*b)&&(la=function(te){const se=2*te,xe=new l.QuadTriangleArray;xe.resize(se),xe._trim();for(let Ie=0;Ie<se;Ie++){const Fe=6*Ie;xe.uint16[Fe+0]=4*Ie+0,xe.uint16[Fe+1]=4*Ie+1,xe.uint16[Fe+2]=4*Ie+2,xe.uint16[Fe+3]=4*Ie+2,xe.uint16[Fe+4]=4*Ie+3,xe.uint16[Fe+5]=4*Ie+0}return xe}(b));const W=c.createIndexBuffer(la,!0),K=c.createVertexBuffer(N,l.collisionCircleLayout.members,!0);for(const te of y){const se={u_matrix:te.transform,u_inv_matrix:te.invTransform,u_camera_to_center_distance:(de=M.transform).cameraToCenterDistance,u_viewport_size:[de.width,de.height]};D.draw(c,f.TRIANGLES,bn.disabled,ii.disabled,M.colorModeForRenderPass(),Wn.disabled,se,M.style.map.terrain&&M.style.map.terrain.getTerrainData(te.coord),m.id,K,W,l.SegmentVector.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,M.transform.zoom,null,null,null)}var de;K.destroy(),W.destroy()}Wn.disabled=new Wn(!1,1029,2305),Wn.backCCW=new Wn(!0,1029,2305);const gA=l.identity(new Float32Array(16));function Dl(M,a,m,w,T,I){const{horizontalAlign:u,verticalAlign:c}=l.getAnchorAlignment(M);return new l.Point((-(u-.5)*a/T+w[0])*I,(-(c-.5)*m/T+w[1])*I)}function Va(M,a,m,w,T,I,u,c,f,g,y){const b=M.text.placedSymbolArray,P=M.text.dynamicLayoutVertexArray,D=M.icon.dynamicLayoutVertexArray,N={};P.clear();for(let G=0;G<b.length;G++){const W=b.get(G),K=W.hidden||!W.crossTileID||M.allowVerticalPlacement&&!W.placedOrientation?null:w[W.crossTileID];if(K){const de=new l.Point(W.anchorX,W.anchorY),te=ln(de,m?u:I,y),se=Br(T.cameraToCenterDistance,te.signedDistanceFromCamera);let xe=l.evaluateSizeForFeature(M.textSizeData,f,W)*se/l.ONE_EM;m&&(xe*=M.tilePixelRatio/c);const{width:Ie,height:Fe,anchor:Re,textOffset:Be,textBoxScale:Le}=K,At=Dl(Re,Ie,Fe,Be,Le,xe),_t=m?ln(de.add(At),I,y).point:te.point.add(a?At.rotate(-T.angle):At),nt=M.allowVerticalPlacement&&W.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let ct=0;ct<W.numGlyphs;ct++)l.addDynamicAttributes(P,_t,nt);g&&W.associatedIconIndex>=0&&(N[W.associatedIconIndex]={shiftedAnchor:_t,angle:nt})}else be(W.numGlyphs,P)}if(g){D.clear();const G=M.icon.placedSymbolArray;for(let W=0;W<G.length;W++){const K=G.get(W);if(K.hidden)be(K.numGlyphs,D);else{const de=N[W];if(de)for(let te=0;te<K.numGlyphs;te++)l.addDynamicAttributes(D,de.shiftedAnchor,de.angle);else be(K.numGlyphs,D)}}M.icon.dynamicLayoutVertexBuffer.updateData(D)}M.text.dynamicLayoutVertexBuffer.updateData(P)}function ui(M,a,m){return m.iconsInText&&a?"symbolTextAndIcon":M?"symbolSDF":"symbolIcon"}function Bl(M,a,m,w,T,I,u,c,f,g,y,b){const P=M.context,D=P.gl,N=M.transform,G=c==="map",W=f==="map",K=c!=="viewport"&&m.layout.get("symbol-placement")!=="point",de=G&&!W&&!K,te=!m.layout.get("symbol-sort-key").isConstant();let se=!1;const xe=M.depthModeForSublayer(0,bn.ReadOnly),Ie=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Fe=[];for(const Re of w){const Be=a.getTile(Re),Le=Be.getBucket(m);if(!Le)continue;const At=T?Le.text:Le.icon;if(!At||!At.segments.get().length||!At.hasVisibleVertices)continue;const _t=At.programConfigurations.get(m.id),nt=T||Le.sdfIcons,ct=T?Le.textSizeData:Le.iconSizeData,Ct=W||N.pitch!==0,un=M.useProgram(ui(nt,T,Le),_t),Yt=l.evaluateSizeForZoom(ct,N.zoom),wt=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Re);let zt,nn,fn,cn,Pn=[0,0],Gn=null;if(T)nn=Be.glyphAtlasTexture,fn=D.LINEAR,zt=Be.glyphAtlasTexture.size,Le.iconsInText&&(Pn=Be.imageAtlasTexture.size,Gn=Be.imageAtlasTexture,cn=Ct||M.options.rotating||M.options.zooming||ct.kind==="composite"||ct.kind==="camera"?D.LINEAR:D.NEAREST);else{const Sr=m.layout.get("icon-size").constantOr(0)!==1||Le.iconsNeedLinear;nn=Be.imageAtlasTexture,fn=nt||M.options.rotating||M.options.zooming||Sr||Ct?D.LINEAR:D.NEAREST,zt=Be.imageAtlasTexture.size}const Kr=$e(Be,1,M.transform.zoom),$a=Qi(Re.posMatrix,W,G,M.transform,Kr),ga=Cs(Re.posMatrix,W,G,M.transform,Kr),Za=Ie&&Le.hasTextData(),Iu=m.layout.get("icon-text-fit")!=="none"&&Za&&Le.hasIconData();if(K){const Sr=M.style.map.terrain?(_s,Ri)=>M.style.map.terrain.getElevation(Re,_s,Ri):null,pr=m.layout.get("text-rotation-alignment")==="map";$r(Le,Re.posMatrix,M,T,$a,ga,W,g,pr,Sr)}const al=M.translatePosMatrix(Re.posMatrix,Be,I,u),IA=K||T&&Ie||Iu?gA:$a,nr=M.translatePosMatrix(ga,Be,I,u,!0),Tr=nt&&m.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ms;ms=nt?Le.iconsInText?ta(ct.kind,Yt,de,W,M,al,IA,nr,zt,Pn):ea(ct.kind,Yt,de,W,M,al,IA,nr,T,zt,!0):To(ct.kind,Yt,de,W,M,al,IA,nr,T,zt);const ku={program:un,buffers:At,uniformValues:ms,atlasTexture:nn,atlasTextureIcon:Gn,atlasInterpolation:fn,atlasInterpolationIcon:cn,isSDF:nt,hasHalo:Tr};if(te&&Le.canOverlap){se=!0;const Sr=At.segments.get();for(const pr of Sr)Fe.push({segments:new l.SegmentVector([pr]),sortKey:pr.sortKey,state:ku,terrainData:wt})}else Fe.push({segments:At.segments,sortKey:0,state:ku,terrainData:wt})}se&&Fe.sort((Re,Be)=>Re.sortKey-Be.sortKey);for(const Re of Fe){const Be=Re.state;if(P.activeTexture.set(D.TEXTURE0),Be.atlasTexture.bind(Be.atlasInterpolation,D.CLAMP_TO_EDGE),Be.atlasTextureIcon&&(P.activeTexture.set(D.TEXTURE1),Be.atlasTextureIcon&&Be.atlasTextureIcon.bind(Be.atlasInterpolationIcon,D.CLAMP_TO_EDGE)),Be.isSDF){const Le=Be.uniformValues;Be.hasHalo&&(Le.u_is_halo=1,ja(Be.buffers,Re.segments,m,M,Be.program,xe,y,b,Le,Re.terrainData)),Le.u_is_halo=0}ja(Be.buffers,Re.segments,m,M,Be.program,xe,y,b,Be.uniformValues,Re.terrainData)}}function ja(M,a,m,w,T,I,u,c,f,g){const y=w.context;T.draw(y,y.gl.TRIANGLES,I,u,c,Wn.disabled,f,g,m.id,M.layoutVertexBuffer,M.indexBuffer,a,m.paint,w.transform.zoom,M.programConfigurations.get(m.id),M.dynamicLayoutVertexBuffer,M.opacityVertexBuffer)}function mA(M,a,m,w,T){if(!m||!w||!w.imageAtlas)return;const I=w.imageAtlas.patternPositions;let u=I[m.to.toString()],c=I[m.from.toString()];if(!u||!c){const f=T.getPaintProperty(a);u=I[f],c=I[f]}u&&c&&M.setConstantPatternPositions(u,c)}function _A(M,a,m,w,T,I,u){const c=M.context.gl,f="fill-pattern",g=m.paint.get(f),y=g&&g.constantOr(1),b=m.getCrossfadeParameters();let P,D,N,G,W;u?(D=y&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",P=c.LINES):(D=y?"fillPattern":"fill",P=c.TRIANGLES);const K=g.constantOr(null);for(const de of w){const te=a.getTile(de);if(y&&!te.patternsLoaded())continue;const se=te.getBucket(m);if(!se)continue;const xe=se.programConfigurations.get(m.id),Ie=M.useProgram(D,xe),Fe=M.style.map.terrain&&M.style.map.terrain.getTerrainData(de);y&&(M.context.activeTexture.set(c.TEXTURE0),te.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),xe.updatePaintBuffers(b)),mA(xe,f,K,te,m);const Re=Fe?de:null,Be=M.translatePosMatrix(Re?Re.posMatrix:de.posMatrix,te,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(u){G=se.indexBuffer2,W=se.segments2;const Le=[c.drawingBufferWidth,c.drawingBufferHeight];N=D==="fillOutlinePattern"&&y?Ee(Be,M,b,te,Le):ge(Be,Le)}else G=se.indexBuffer,W=se.segments,N=y?hr(Be,M,b,te):Ko(Be);Ie.draw(M.context,P,T,M.stencilModeForClipping(de),I,Wn.disabled,N,Fe,m.id,se.layoutVertexBuffer,G,W,m.paint,M.transform.zoom,xe)}}function nl(M,a,m,w,T,I,u){const c=M.context,f=c.gl,g="fill-extrusion-pattern",y=m.paint.get(g),b=y.constantOr(1),P=m.getCrossfadeParameters(),D=m.paint.get("fill-extrusion-opacity"),N=y.constantOr(null);for(const G of w){const W=a.getTile(G),K=W.getBucket(m);if(!K)continue;const de=M.style.map.terrain&&M.style.map.terrain.getTerrainData(G),te=K.programConfigurations.get(m.id),se=M.useProgram(b?"fillExtrusionPattern":"fillExtrusion",te);b&&(M.context.activeTexture.set(f.TEXTURE0),W.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),te.updatePaintBuffers(P)),mA(te,g,N,W,m);const xe=M.translatePosMatrix(G.posMatrix,W,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Ie=m.paint.get("fill-extrusion-vertical-gradient"),Fe=b?XA(xe,M,Ie,D,G,P,W):Vs(xe,M,Ie,D);se.draw(c,c.gl.TRIANGLES,T,I,u,Wn.backCCW,Fe,de,m.id,K.layoutVertexBuffer,K.indexBuffer,K.segments,m.paint,M.transform.zoom,te,M.style.map.terrain&&K.centroidVertexBuffer)}}function Ji(M,a,m,w,T,I,u){const c=M.context,f=c.gl,g=m.fbo;if(!g)return;const y=M.useProgram("hillshade"),b=M.style.map.terrain&&M.style.map.terrain.getTerrainData(a);c.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,g.colorAttachment.get()),y.draw(c,f.TRIANGLES,T,I,u,Wn.disabled,((P,D,N,G)=>{const W=N.paint.get("hillshade-shadow-color"),K=N.paint.get("hillshade-highlight-color"),de=N.paint.get("hillshade-accent-color");let te=N.paint.get("hillshade-illumination-direction")*(Math.PI/180);N.paint.get("hillshade-illumination-anchor")==="viewport"&&(te-=P.transform.angle);const se=!P.options.moving;return{u_matrix:G?G.posMatrix:P.transform.calculatePosMatrix(D.tileID.toUnwrapped(),se),u_image:0,u_latrange:Ei(0,D.tileID),u_light:[N.paint.get("hillshade-exaggeration"),te],u_shadow:W,u_highlight:K,u_accent:de}})(M,m,w,b?a:null),b,w.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments)}function Si(M,a,m,w,T,I){const u=M.context,c=u.gl,f=a.dem;if(f&&f.data){const g=f.dim,y=f.stride,b=f.getPixels();if(u.activeTexture.set(c.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||M.getTileTexture(y),a.demTexture){const D=a.demTexture;D.update(b,{premultiply:!1}),D.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else a.demTexture=new ht(u,b,c.RGBA,{premultiply:!1}),a.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);u.activeTexture.set(c.TEXTURE0);let P=a.fbo;if(!P){const D=new ht(u,{width:g,height:g,data:null},c.RGBA);D.bind(c.LINEAR,c.CLAMP_TO_EDGE),P=a.fbo=u.createFramebuffer(g,g,!0,!1),P.colorAttachment.set(D.texture)}u.bindFramebuffer.set(P.framebuffer),u.viewport.set([0,0,g,g]),M.useProgram("hillshadePrepare").draw(u,c.TRIANGLES,w,T,I,Wn.disabled,((D,N)=>{const G=N.stride,W=l.create();return l.ortho(W,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(W,W,[0,-l.EXTENT,0]),{u_matrix:W,u_image:1,u_dimension:[G,G],u_zoom:D.overscaledZ,u_unpack:N.getUnpackVector()}})(a.tileID,f),null,m.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Nr(M,a,m,w,T,I){const u=w.paint.get("raster-fade-duration");if(!I&&u>0){const c=l.browser.now(),f=(c-M.timeAdded)/u,g=a?(c-a.timeAdded)/u:-1,y=m.getSource(),b=T.coveringZoomLevel({tileSize:y.tileSize,roundZoom:y.roundZoom}),P=!a||Math.abs(a.tileID.overscaledZ-b)>Math.abs(M.tileID.overscaledZ-b),D=P&&M.refreshedUponExpiration?1:l.clamp(P?f:1-g,0,1);return M.refreshedUponExpiration&&f>=1&&(M.refreshedUponExpiration=!1),a?{opacity:1,mix:1-D}:{opacity:D,mix:0}}return{opacity:1,mix:0}}const il=new l.Color(1,0,0,1),oi=new l.Color(0,1,0,1),ua=new l.Color(0,0,1,1),Ur=new l.Color(1,0,1,1),dr=new l.Color(0,1,1,1);function er(M,a,m,w){Ms(M,0,a+m/2,M.transform.width,m,w)}function Ps(M,a,m,w){Ms(M,a-m/2,0,m,M.transform.height,w)}function Ms(M,a,m,w,T,I){const u=M.context,c=u.gl;c.enable(c.SCISSOR_TEST),c.scissor(a*M.pixelRatio,m*M.pixelRatio,w*M.pixelRatio,T*M.pixelRatio),u.clear({color:I}),c.disable(c.SCISSOR_TEST)}function hs(M,a,m){const w=M.context,T=w.gl,I=m.posMatrix,u=M.useProgram("debug"),c=bn.disabled,f=ii.disabled,g=M.colorModeForRenderPass(),y="$debug",b=M.style.map.terrain&&M.style.map.terrain.getTerrainData(m);w.activeTexture.set(T.TEXTURE0);const P=a.getTileByID(m.key).latestRawTileData,D=Math.floor((P&&P.byteLength||0)/1024),N=a.getTile(m).tileSize,G=512/Math.min(N,512)*(m.overscaledZ/M.transform.zoom)*.5;let W=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(W+=` => ${m.overscaledZ}`),function(K,de){K.initDebugOverlayCanvas();const te=K.debugOverlayCanvas,se=K.context.gl,xe=K.debugOverlayCanvas.getContext("2d");xe.clearRect(0,0,te.width,te.height),xe.shadowColor="white",xe.shadowBlur=2,xe.lineWidth=1.5,xe.strokeStyle="white",xe.textBaseline="top",xe.font="bold 36px Open Sans, sans-serif",xe.fillText(de,5,5),xe.strokeText(de,5,5),K.debugOverlayTexture.update(te),K.debugOverlayTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE)}(M,`${W} ${D}kB`),u.draw(w,T.TRIANGLES,c,f,fi.alphaBlended,Wn.disabled,vt(I,l.Color.transparent,G),null,y,M.debugBuffer,M.quadTriangleIndexBuffer,M.debugSegments),u.draw(w,T.LINE_STRIP,c,f,g,Wn.disabled,vt(I,l.Color.red),b,y,M.debugBuffer,M.tileBorderIndexBuffer,M.debugSegments)}function Mo(M,a,m){const w=M.context,T=w.gl,I=M.colorModeForRenderPass(),u=new bn(T.LEQUAL,bn.ReadWrite,M.depthRangeFor3D),c=M.useProgram("terrain"),f=a.getTerrainMesh();w.bindFramebuffer.set(null),w.viewport.set([0,0,M.width,M.height]);for(const g of m){const y=M.renderToTexture.getTexture(g),b=a.getTerrainData(g.tileID);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,y.texture);const P={u_matrix:M.transform.calculatePosMatrix(g.tileID.toUnwrapped()),u_texture:0,u_ele_delta:a.getMeshFrameDelta(M.transform.zoom)};c.draw(w,T.TRIANGLES,u,ii.disabled,I,Wn.backCCW,P,b,"terrain",f.vertexBuffer,f.indexBuffer,f.segments)}}class tr{constructor(a,m){this.context=new dA(a),this.transform=m,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.create(),renderTime:0},this.setup(),this.numSublayers=Jn.maxUnderzooming+Jn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ve}resize(a,m,w){if(this.width=Math.floor(a*w),this.height=Math.floor(m*w),this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const T of this.style._order)this.style._layers[T].resize()}setup(){const a=this.context,m=new l.PosArray;m.emplaceBack(0,0),m.emplaceBack(l.EXTENT,0),m.emplaceBack(0,l.EXTENT),m.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(m,Eo.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const w=new l.PosArray;w.emplaceBack(0,0),w.emplaceBack(l.EXTENT,0),w.emplaceBack(0,l.EXTENT),w.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=a.createVertexBuffer(w,Eo.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const T=new l.RasterBoundsArray;T.emplaceBack(0,0,0,0),T.emplaceBack(l.EXTENT,0,l.EXTENT,0),T.emplaceBack(0,l.EXTENT,0,l.EXTENT),T.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=a.createVertexBuffer(T,si.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const I=new l.PosArray;I.emplaceBack(0,0),I.emplaceBack(1,0),I.emplaceBack(0,1),I.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(I,Eo.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const u=new l.LineStripIndexArray;u.emplaceBack(0),u.emplaceBack(1),u.emplaceBack(3),u.emplaceBack(2),u.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(u);const c=new l.TriangleIndexArray;c.emplaceBack(0,1,2),c.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(c);const f=this.context.gl;this.stencilClearMode=new ii({func:f.ALWAYS,mask:0},0,255,f.ZERO,f.ZERO,f.ZERO)}clearStencil(){const a=this.context,m=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const w=l.create();l.ortho(w,0,this.width,this.height,0,0,1),l.scale(w,w,[m.drawingBufferWidth,m.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,m.TRIANGLES,bn.disabled,this.stencilClearMode,fi.disabled,Wn.disabled,Zt(w),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(a,m){if(this.currentStencilSource===a.source||!a.isTileClipped()||!m||!m.length)return;this.currentStencilSource=a.source;const w=this.context,T=w.gl;this.nextStencilID+m.length>256&&this.clearStencil(),w.setColorMode(fi.disabled),w.setDepthMode(bn.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const u of m){const c=this._tileClippingMaskIDs[u.key]=this.nextStencilID++,f=this.style.map.terrain&&this.style.map.terrain.getTerrainData(u);I.draw(w,T.TRIANGLES,bn.disabled,new ii({func:T.ALWAYS,mask:0},c,255,T.KEEP,T.KEEP,T.REPLACE),fi.disabled,Wn.disabled,Zt(u.posMatrix),f,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,m=this.context.gl;return new ii({func:m.NOTEQUAL,mask:255},a,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(a){const m=this.context.gl;return new ii({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(a){const m=this.context.gl,w=a.sort((u,c)=>c.overscaledZ-u.overscaledZ),T=w[w.length-1].overscaledZ,I=w[0].overscaledZ-T+1;if(I>1){this.currentStencilSource=void 0,this.nextStencilID+I>256&&this.clearStencil();const u={};for(let c=0;c<I;c++)u[c+T]=new ii({func:m.GEQUAL,mask:255},c+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=I,[u,w]}return[{[T]:ii.disabled},w]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new fi([a.CONSTANT_COLOR,a.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fi.unblended:fi.alphaBlended}depthModeForSublayer(a,m,w){if(!this.opaquePassEnabledForLayer())return bn.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new bn(w||this.context.gl.LEQUAL,m,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,m){this.style=a,this.options=m,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();const w=this.style._order,T=this.style.sourceCaches,I={},u={},c={};for(const f in T){const g=T[f];g.used&&g.prepare(this.context),I[f]=g.getVisibleCoordinates(),u[f]=I[f].slice().reverse(),c[f]=g.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let f=0;f<w.length;f++)if(this.style._layers[w[f]].is3D()){this.opaquePassCutoff=f;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const f=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||f.length)&&(l.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(g,y){const b=g.context,P=b.gl,D=fi.unblended,N=new bn(P.LEQUAL,bn.ReadWrite,[0,1]),G=y.getTerrainMesh(),W=y.sourceCache.getRenderableTiles(),K=g.useProgram("terrainDepth");b.bindFramebuffer.set(y.getFramebuffer("depth").framebuffer),b.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),b.clear({color:l.Color.transparent,depth:1});for(const de of W){const te=y.getTerrainData(de.tileID),se={u_matrix:g.transform.calculatePosMatrix(de.tileID.toUnwrapped()),u_ele_delta:y.getMeshFrameDelta(g.transform.zoom)};K.draw(b,P.TRIANGLES,N,ii.disabled,D,Wn.backCCW,se,te,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}b.bindFramebuffer.set(null),b.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain),function(g,y){const b=g.context,P=b.gl,D=fi.unblended,N=new bn(P.LEQUAL,bn.ReadWrite,[0,1]),G=y.getTerrainMesh(),W=y.getCoordsTexture(),K=y.sourceCache.getRenderableTiles(),de=g.useProgram("terrainCoords");b.bindFramebuffer.set(y.getFramebuffer("coords").framebuffer),b.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),b.clear({color:l.Color.transparent,depth:1}),y.coordsIndex=[];for(const te of K){const se=y.getTerrainData(te.tileID);b.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,W.texture);const xe={u_matrix:g.transform.calculatePosMatrix(te.tileID.toUnwrapped()),u_terrain_coords_id:(255-y.coordsIndex.length)/255,u_texture:0,u_ele_delta:y.getMeshFrameDelta(g.transform.zoom)};de.draw(b,P.TRIANGLES,N,ii.disabled,D,Wn.backCCW,xe,se,"terrain",G.vertexBuffer,G.indexBuffer,G.segments),y.coordsIndex.push(te.tileID.key)}b.bindFramebuffer.set(null),b.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const f of w){const g=this.style._layers[f];if(!g.hasOffscreenPass()||g.isHidden(this.transform.zoom))continue;const y=u[g.source];(g.type==="custom"||y.length)&&this.renderLayer(this,T[g.source],g,y)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const f=this.style._layers[w[this.currentLayer]],g=T[f.source],y=I[f.source];this._renderTileClippingMasks(f,y),this.renderLayer(this,g,f,y)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const f=this.style._layers[w[this.currentLayer]],g=T[f.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(f))continue;const y=(f.type==="symbol"?c:u)[f.source];this._renderTileClippingMasks(f,I[f.source]),this.renderLayer(this,g,f,y)}if(this.options.showTileBoundaries){const f=function(g,y){let b=null;const P=Object.values(g._layers).flatMap(W=>W.source&&!W.isHidden(y)?[g.sourceCaches[W.source]]:[]),D=P.filter(W=>W.getSource().type==="vector"),N=P.filter(W=>W.getSource().type!=="vector"),G=W=>{(!b||b.getSource().maxzoom<W.getSource().maxzoom)&&(b=W)};return D.forEach(W=>G(W)),b||N.forEach(W=>G(W)),b}(this.style,this.transform.zoom);f&&function(g,y,b){for(let P=0;P<b.length;P++)hs(g,y,b[P])}(this,f,f.getVisibleCoordinates())}this.options.showPadding&&function(f){const g=f.transform.padding;er(f,f.transform.height-(g.top||0),3,il),er(f,g.bottom||0,3,oi),Ps(f,g.left||0,3,ua),Ps(f,f.transform.width-(g.right||0),3,Ur);const y=f.transform.centerPoint;(function(b,P,D,N){Ms(b,P-1,D-10,2,20,N),Ms(b,P-10,D-1,20,2,N)})(f,y.x,f.transform.height-y.y,dr)}(this),this.context.setDefault()}renderLayer(a,m,w,T){if(!w.isHidden(this.transform.zoom)&&(w.type==="background"||w.type==="custom"||(T||[]).length))switch(this.id=w.id,w.type){case"symbol":(function(I,u,c,f,g){if(I.renderPass!=="translucent")return;const y=ii.disabled,b=I.colorModeForRenderPass();(c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(P,D,N,G,W,K,de){const te=D.transform,se=W==="map",xe=K==="map";for(const Ie of P){const Fe=G.getTile(Ie),Re=Fe.getBucket(N);if(!Re||!Re.text||!Re.text.segments.get().length)continue;const Be=l.evaluateSizeForZoom(Re.textSizeData,te.zoom),Le=$e(Fe,1,D.transform.zoom),At=Qi(Ie.posMatrix,xe,se,D.transform,Le),_t=N.layout.get("icon-text-fit")!=="none"&&Re.hasIconData();if(Be){const nt=Math.pow(2,te.zoom-Fe.tileID.overscaledZ);Va(Re,se,xe,de,te,At,Ie.posMatrix,nt,Be,_t,D.style.map.terrain?(ct,Ct)=>D.style.map.terrain.getElevation(Ie,ct,Ct):null)}}}(f,I,c,u,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),g),c.paint.get("icon-opacity").constantOr(1)!==0&&Bl(I,u,c,f,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),y,b),c.paint.get("text-opacity").constantOr(1)!==0&&Bl(I,u,c,f,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),y,b),u.map.showCollisionBoxes&&(Ua(I,u,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Ua(I,u,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))})(a,m,w,T,this.style.placement.variableOffsets);break;case"circle":(function(I,u,c,f){if(I.renderPass!=="translucent")return;const g=c.paint.get("circle-opacity"),y=c.paint.get("circle-stroke-width"),b=c.paint.get("circle-stroke-opacity"),P=!c.layout.get("circle-sort-key").isConstant();if(g.constantOr(1)===0&&(y.constantOr(1)===0||b.constantOr(1)===0))return;const D=I.context,N=D.gl,G=I.depthModeForSublayer(0,bn.ReadOnly),W=ii.disabled,K=I.colorModeForRenderPass(),de=[];for(let te=0;te<f.length;te++){const se=f[te],xe=u.getTile(se),Ie=xe.getBucket(c);if(!Ie)continue;const Fe=Ie.programConfigurations.get(c.id),Re=I.useProgram("circle",Fe),Be=Ie.layoutVertexBuffer,Le=Ie.indexBuffer,At=I.style.map.terrain&&I.style.map.terrain.getTerrainData(se),_t={programConfiguration:Fe,program:Re,layoutVertexBuffer:Be,indexBuffer:Le,uniformValues:Ge(I,se,xe,c),terrainData:At};if(P){const nt=Ie.segments.get();for(const ct of nt)de.push({segments:new l.SegmentVector([ct]),sortKey:ct.sortKey,state:_t})}else de.push({segments:Ie.segments,sortKey:0,state:_t})}P&&de.sort((te,se)=>te.sortKey-se.sortKey);for(const te of de){const{programConfiguration:se,program:xe,layoutVertexBuffer:Ie,indexBuffer:Fe,uniformValues:Re,terrainData:Be}=te.state;xe.draw(D,N.TRIANGLES,G,W,K,Wn.disabled,Re,Be,c.id,Ie,Fe,te.segments,c.paint,I.transform.zoom,se)}})(a,m,w,T);break;case"heatmap":(function(I,u,c,f){if(c.paint.get("heatmap-opacity")!==0)if(I.renderPass==="offscreen"){const g=I.context,y=g.gl,b=ii.disabled,P=new fi([y.ONE,y.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(D,N,G){const W=D.gl;D.activeTexture.set(W.TEXTURE1),D.viewport.set([0,0,N.width/4,N.height/4]);let K=G.heatmapFbo;if(K)W.bindTexture(W.TEXTURE_2D,K.colorAttachment.get()),D.bindFramebuffer.set(K.framebuffer);else{const de=W.createTexture();W.bindTexture(W.TEXTURE_2D,de),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),K=G.heatmapFbo=D.createFramebuffer(N.width/4,N.height/4,!1,!1),function(te,se,xe,Ie){var Fe,Re;const Be=te.gl,Le=(Fe=te.HALF_FLOAT)!==null&&Fe!==void 0?Fe:Be.UNSIGNED_BYTE,At=(Re=te.RGBA16F)!==null&&Re!==void 0?Re:Be.RGBA;Be.texImage2D(Be.TEXTURE_2D,0,At,se.width/4,se.height/4,0,Be.RGBA,Le,null),Ie.colorAttachment.set(xe)}(D,N,de,K)}})(g,I,c),g.clear({color:l.Color.transparent});for(let D=0;D<f.length;D++){const N=f[D];if(u.hasRenderableParent(N))continue;const G=u.getTile(N),W=G.getBucket(c);if(!W)continue;const K=W.programConfigurations.get(c.id),de=I.useProgram("heatmap",K),{zoom:te}=I.transform;de.draw(g,y.TRIANGLES,bn.disabled,b,P,Wn.disabled,Cn(N.posMatrix,G,te,c.paint.get("heatmap-intensity")),null,c.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,c.paint,I.transform.zoom,K)}g.viewport.set([0,0,I.width,I.height])}else I.renderPass==="translucent"&&(I.context.setColorMode(I.colorModeForRenderPass()),function(g,y){const b=g.context,P=b.gl,D=y.heatmapFbo;if(!D)return;b.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,D.colorAttachment.get()),b.activeTexture.set(P.TEXTURE1);let N=y.colorRampTexture;N||(N=y.colorRampTexture=new ht(b,y.colorRamp,P.RGBA)),N.bind(P.LINEAR,P.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(b,P.TRIANGLES,bn.disabled,ii.disabled,g.colorModeForRenderPass(),Wn.disabled,((G,W,K,de)=>{const te=l.create();l.ortho(te,0,G.width,G.height,0,0,1);const se=G.context.gl;return{u_matrix:te,u_world:[se.drawingBufferWidth,se.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")}})(g,y),null,y.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments,y.paint,g.transform.zoom)}(I,c))})(a,m,w,T);break;case"line":(function(I,u,c,f){if(I.renderPass!=="translucent")return;const g=c.paint.get("line-opacity"),y=c.paint.get("line-width");if(g.constantOr(1)===0||y.constantOr(1)===0)return;const b=I.depthModeForSublayer(0,bn.ReadOnly),P=I.colorModeForRenderPass(),D=c.paint.get("line-dasharray"),N=c.paint.get("line-pattern"),G=N.constantOr(1),W=c.paint.get("line-gradient"),K=c.getCrossfadeParameters(),de=G?"linePattern":D?"lineSDF":W?"lineGradient":"line",te=I.context,se=te.gl;let xe=!0;for(const Ie of f){const Fe=u.getTile(Ie);if(G&&!Fe.patternsLoaded())continue;const Re=Fe.getBucket(c);if(!Re)continue;const Be=Re.programConfigurations.get(c.id),Le=I.context.program.get(),At=I.useProgram(de,Be),_t=xe||At.program!==Le,nt=I.style.map.terrain&&I.style.map.terrain.getTerrainData(Ie),ct=N.constantOr(null);if(ct&&Fe.imageAtlas){const Yt=Fe.imageAtlas,wt=Yt.patternPositions[ct.to.toString()],zt=Yt.patternPositions[ct.from.toString()];wt&&zt&&Be.setConstantPatternPositions(wt,zt)}const Ct=nt?Ie:null,un=G?En(I,Fe,c,K,Ct):D?za(I,Fe,c,D,K,Ct):W?Li(I,Fe,c,Re.lineClipsArray.length,Ct):wn(I,Fe,c,Ct);if(G)te.activeTexture.set(se.TEXTURE0),Fe.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Be.updatePaintBuffers(K);else if(D&&(_t||I.lineAtlas.dirty))te.activeTexture.set(se.TEXTURE0),I.lineAtlas.bind(te);else if(W){const Yt=Re.gradients[c.id];let wt=Yt.texture;if(c.gradientVersion!==Yt.version){let zt=256;if(c.stepInterpolant){const nn=u.getSource().maxzoom,fn=Ie.canonical.z===nn?Math.ceil(1<<I.transform.maxZoom-Ie.canonical.z):1;zt=l.clamp(l.nextPowerOfTwo(Re.maxLineLength/l.EXTENT*1024*fn),256,te.maxTextureSize)}Yt.gradient=l.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:zt,image:Yt.gradient||void 0,clips:Re.lineClipsArray}),Yt.texture?Yt.texture.update(Yt.gradient):Yt.texture=new ht(te,Yt.gradient,se.RGBA),Yt.version=c.gradientVersion,wt=Yt.texture}te.activeTexture.set(se.TEXTURE0),wt.bind(c.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}At.draw(te,se.TRIANGLES,b,I.stencilModeForClipping(Ie),P,Wn.disabled,un,nt,c.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,c.paint,I.transform.zoom,Be,Re.layoutVertexBuffer2),xe=!1}})(a,m,w,T);break;case"fill":(function(I,u,c,f){const g=c.paint.get("fill-color"),y=c.paint.get("fill-opacity");if(y.constantOr(1)===0)return;const b=I.colorModeForRenderPass(),P=c.paint.get("fill-pattern"),D=I.opaquePassEnabledForLayer()&&!P.constantOr(1)&&g.constantOr(l.Color.transparent).a===1&&y.constantOr(0)===1?"opaque":"translucent";if(I.renderPass===D){const N=I.depthModeForSublayer(1,I.renderPass==="opaque"?bn.ReadWrite:bn.ReadOnly);_A(I,u,c,f,N,b,!1)}if(I.renderPass==="translucent"&&c.paint.get("fill-antialias")){const N=I.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,bn.ReadOnly);_A(I,u,c,f,N,b,!0)}})(a,m,w,T);break;case"fill-extrusion":(function(I,u,c,f){const g=c.paint.get("fill-extrusion-opacity");if(g!==0&&I.renderPass==="translucent"){const y=new bn(I.context.gl.LEQUAL,bn.ReadWrite,I.depthRangeFor3D);if(g!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))nl(I,u,c,f,y,ii.disabled,fi.disabled),nl(I,u,c,f,y,I.stencilModeFor3D(),I.colorModeForRenderPass());else{const b=I.colorModeForRenderPass();nl(I,u,c,f,y,ii.disabled,b)}}})(a,m,w,T);break;case"hillshade":(function(I,u,c,f){if(I.renderPass!=="offscreen"&&I.renderPass!=="translucent")return;const g=I.context,y=I.depthModeForSublayer(0,bn.ReadOnly),b=I.colorModeForRenderPass(),[P,D]=I.renderPass==="translucent"?I.stencilConfigForOverlap(f):[{},f];for(const N of D){const G=u.getTile(N);G.needsHillshadePrepare!==void 0&&G.needsHillshadePrepare&&I.renderPass==="offscreen"?Si(I,G,c,y,ii.disabled,b):I.renderPass==="translucent"&&Ji(I,N,G,c,y,P[N.overscaledZ],b)}g.viewport.set([0,0,I.width,I.height])})(a,m,w,T);break;case"raster":(function(I,u,c,f){if(I.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!f.length)return;const g=I.context,y=g.gl,b=u.getSource(),P=I.useProgram("raster"),D=I.colorModeForRenderPass(),[N,G]=b instanceof vr?[{},f]:I.stencilConfigForOverlap(f),W=G[G.length-1].overscaledZ,K=!I.options.moving;for(const de of G){const te=I.depthModeForSublayer(de.overscaledZ-W,c.paint.get("raster-opacity")===1?bn.ReadWrite:bn.ReadOnly,y.LESS),se=u.getTile(de);se.registerFadeDuration(c.paint.get("raster-fade-duration"));const xe=u.findLoadedParent(de,0),Ie=Nr(se,xe,u,c,I.transform,I.style.map.terrain);let Fe,Re;const Be=c.paint.get("raster-resampling")==="nearest"?y.NEAREST:y.LINEAR;g.activeTexture.set(y.TEXTURE0),se.texture.bind(Be,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),g.activeTexture.set(y.TEXTURE1),xe?(xe.texture.bind(Be,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),Fe=Math.pow(2,xe.tileID.overscaledZ-se.tileID.overscaledZ),Re=[se.tileID.canonical.x*Fe%1,se.tileID.canonical.y*Fe%1]):se.texture.bind(Be,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST);const Le=I.style.map.terrain&&I.style.map.terrain.getTerrainData(de),At=Le?de:null,_t=At?At.posMatrix:I.transform.calculatePosMatrix(de.toUnwrapped(),K),nt=AA(_t,Re||[0,0],Fe||1,Ie,c);b instanceof vr?P.draw(g,y.TRIANGLES,te,ii.disabled,D,Wn.disabled,nt,Le,c.id,b.boundsBuffer,I.quadTriangleIndexBuffer,b.boundsSegments):P.draw(g,y.TRIANGLES,te,N[de.overscaledZ],D,Wn.disabled,nt,Le,c.id,I.rasterBoundsBuffer,I.quadTriangleIndexBuffer,I.rasterBoundsSegments)}})(a,m,w,T);break;case"background":(function(I,u,c,f){const g=c.paint.get("background-color"),y=c.paint.get("background-opacity");if(y===0)return;const b=I.context,P=b.gl,D=I.transform,N=D.tileSize,G=c.paint.get("background-pattern");if(I.isPatternMissing(G))return;const W=!G&&g.a===1&&y===1&&I.opaquePassEnabledForLayer()?"opaque":"translucent";if(I.renderPass!==W)return;const K=ii.disabled,de=I.depthModeForSublayer(0,W==="opaque"?bn.ReadWrite:bn.ReadOnly),te=I.colorModeForRenderPass(),se=I.useProgram(G?"backgroundPattern":"background"),xe=f||D.coveringTiles({tileSize:N,terrain:I.style.map.terrain});G&&(b.activeTexture.set(P.TEXTURE0),I.imageManager.bind(I.context));const Ie=c.getCrossfadeParameters();for(const Fe of xe){const Re=f?Fe.posMatrix:I.transform.calculatePosMatrix(Fe.toUnwrapped()),Be=G?lA(Re,y,I,G,{tileID:Fe,tileSize:N},Ie):So(Re,y,g),Le=I.style.map.terrain&&I.style.map.terrain.getTerrainData(Fe);se.draw(b,P.TRIANGLES,de,K,te,Wn.disabled,Be,Le,c.id,I.tileExtentBuffer,I.quadTriangleIndexBuffer,I.tileExtentSegments)}})(a,0,w,T);break;case"custom":(function(I,u,c){const f=I.context,g=c.implementation;if(I.renderPass==="offscreen"){const y=g.prerender;y&&(I.setCustomLayerDefaults(),f.setColorMode(I.colorModeForRenderPass()),y.call(g,f.gl,I.transform.customLayerMatrix()),f.setDirty(),I.setBaseState())}else if(I.renderPass==="translucent"){I.setCustomLayerDefaults(),f.setColorMode(I.colorModeForRenderPass()),f.setStencilMode(ii.disabled);const y=g.renderingMode==="3d"?new bn(I.context.gl.LEQUAL,bn.ReadWrite,I.depthRangeFor3D):I.depthModeForSublayer(0,bn.ReadOnly);f.setDepthMode(y),g.render(f.gl,I.transform.customLayerMatrix()),f.setDirty(),I.setBaseState(),f.bindFramebuffer.set(null)}})(a,0,w)}}translatePosMatrix(a,m,w,T,I){if(!w[0]&&!w[1])return a;const u=I?T==="map"?this.transform.angle:0:T==="viewport"?-this.transform.angle:0;if(u){const g=Math.sin(u),y=Math.cos(u);w=[w[0]*y-w[1]*g,w[0]*g+w[1]*y]}const c=[I?w[0]:$e(m,w[0],this.transform.zoom),I?w[1]:$e(m,w[1],this.transform.zoom),0],f=new Float32Array(16);return l.translate(f,a,c),f}saveTileTexture(a){const m=this._tileTextures[a.size[0]];m?m.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const m=this._tileTextures[a];return m&&m.length>0?m.pop():null}isPatternMissing(a){if(!a)return!1;if(!a.from||!a.to)return!0;const m=this.imageManager.getPattern(a.from.toString()),w=this.imageManager.getPattern(a.to.toString());return!m||!w}useProgram(a,m){this.cache=this.cache||{};const w=a+(m?m.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[w]||(this.cache[w]=new Us(this.context,oo[a],m,fr[a],this._showOverdrawInspector,this.style.map.terrain)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ht(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:a,drawingBufferHeight:m}=this.context.gl;return this.width!==a||this.height!==m}}class yA{constructor(a,m){this.points=a,this.planes=m}static fromInvProjectionMatrix(a,m,w){const T=Math.pow(2,w),I=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(c=>{const f=1/(c=l.transformMat4([],c,a))[3]/m*T;return l.mul$1(c,c,[f,f,1/c[3],f])}),u=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(c=>{const f=function(P,D){var N=D[0],G=D[1],W=D[2],K=N*N+G*G+W*W;return K>0&&(K=1/Math.sqrt(K)),P[0]=D[0]*K,P[1]=D[1]*K,P[2]=D[2]*K,P}([],function(P,D,N){var G=D[0],W=D[1],K=D[2],de=N[0],te=N[1],se=N[2];return P[0]=W*se-K*te,P[1]=K*de-G*se,P[2]=G*te-W*de,P}([],qe([],I[c[0]],I[c[1]]),qe([],I[c[2]],I[c[1]]))),g=-((y=f)[0]*(b=I[c[1]])[0]+y[1]*b[1]+y[2]*b[2]);var y,b;return f.concat(g)});return new yA(I,u)}}class Io{constructor(a,m){this.min=a,this.max=m,this.center=function(w,T,I){return w[0]=.5*T[0],w[1]=.5*T[1],w[2]=.5*T[2],w}([],function(w,T,I){return w[0]=T[0]+I[0],w[1]=T[1]+I[1],w[2]=T[2]+I[2],w}([],this.min,this.max))}quadrant(a){const m=[a%2==0,a<2],w=Ce(this.min),T=Ce(this.max);for(let I=0;I<m.length;I++)w[I]=m[I]?this.min[I]:this.center[I],T[I]=m[I]?this.center[I]:this.max[I];return T[2]=this.max[2],new Io(w,T)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}intersects(a){const m=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let w=!0;for(let T=0;T<a.planes.length;T++){const I=a.planes[T];let u=0;for(let c=0;c<m.length;c++)l.dot(I,m[c])>=0&&u++;if(u===0)return 0;u!==m.length&&(w=!1)}if(w)return 2;for(let T=0;T<3;T++){let I=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(let c=0;c<a.points.length;c++){const f=a.points[c][T]-this.min[T];I=Math.min(I,f),u=Math.max(u,f)}if(u<0||I>this.max[T]-this.min[T])return 0}return 1}}class ko{constructor(a=0,m=0,w=0,T=0){if(isNaN(a)||a<0||isNaN(m)||m<0||isNaN(w)||w<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=m,this.left=w,this.right=T}interpolate(a,m,w){return m.top!=null&&a.top!=null&&(this.top=l.interpolate.number(a.top,m.top,w)),m.bottom!=null&&a.bottom!=null&&(this.bottom=l.interpolate.number(a.bottom,m.bottom,w)),m.left!=null&&a.left!=null&&(this.left=l.interpolate.number(a.left,m.left,w)),m.right!=null&&a.right!=null&&(this.right=l.interpolate.number(a.right,m.right,w)),this}getCenter(a,m){const w=l.clamp((this.left+a-this.right)/2,0,a),T=l.clamp((this.top+m-this.bottom)/2,0,m);return new l.Point(w,T)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new ko(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class fs{constructor(a,m,w,T,I){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=I===void 0||!!I,this._minZoom=a||0,this._maxZoom=m||22,this._minPitch=w??0,this._maxPitch=T??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ko,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const a=new fs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.apply(this),a}apply(a){this.tileSize=a.tileSize,this.latRange=a.latRange,this.width=a.width,this.height=a.height,this._center=a._center,this._elevation=a._elevation,this._minEleveationForCurrentTile=a._minEleveationForCurrentTile,this.zoom=a.zoom,this.angle=a.angle,this._fov=a._fov,this._pitch=a._pitch,this._unmodified=a._unmodified,this._edgeInsets=a._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(a){const m=-l.wrap(a,-180,180)*Math.PI/180;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=function(){var w=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}(),function(w,T,I){var u=T[0],c=T[1],f=T[2],g=T[3],y=Math.sin(I),b=Math.cos(I);w[0]=u*b+f*y,w[1]=c*b+g*y,w[2]=u*-y+f*b,w[3]=c*-y+g*b}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const m=l.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(a){const m=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this.tileZoom=Math.max(0,Math.floor(m)),this.scale=this.zoomScale(m),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(a){a!==this._elevation&&(this._elevation=a,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,m,w){this._unmodified=!1,this._edgeInsets.interpolate(a,m,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const m=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(a){const m=[new l.UnwrappedTileID(0,a)];if(this._renderWorldCopies){const w=this.pointCoordinate(new l.Point(0,0)),T=this.pointCoordinate(new l.Point(this.width,0)),I=this.pointCoordinate(new l.Point(this.width,this.height)),u=this.pointCoordinate(new l.Point(0,this.height)),c=Math.floor(Math.min(w.x,T.x,I.x,u.x)),f=Math.floor(Math.max(w.x,T.x,I.x,u.x)),g=1;for(let y=c-g;y<=f+g;y++)y!==0&&m.push(new l.UnwrappedTileID(y,a))}return m}coveringTiles(a){var m,w;let T=this.coveringZoomLevel(a);const I=T;if(a.minzoom!==void 0&&T<a.minzoom)return[];a.maxzoom!==void 0&&T>a.maxzoom&&(T=a.maxzoom);const u=this.pointCoordinate(this.getCameraPoint()),c=l.MercatorCoordinate.fromLngLat(this.center),f=Math.pow(2,T),g=[f*u.x,f*u.y,0],y=[f*c.x,f*c.y,0],b=yA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,T);let P=a.minzoom||0;!a.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(P=T);const D=a.terrain?2/Math.min(this.tileSize,a.tileSize)*this.tileSize:3,N=te=>({aabb:new Io([te*f,0,0],[(te+1)*f,f,0]),zoom:0,x:0,y:0,wrap:te,fullyVisible:!1}),G=[],W=[],K=T,de=a.reparseOverscaled?I:T;if(this._renderWorldCopies)for(let te=1;te<=3;te++)G.push(N(-te)),G.push(N(te));for(G.push(N(0));G.length>0;){const te=G.pop(),se=te.x,xe=te.y;let Ie=te.fullyVisible;if(!Ie){const At=te.aabb.intersects(b);if(At===0)continue;Ie=At===2}const Fe=a.terrain?g:y,Re=te.aabb.distanceX(Fe),Be=te.aabb.distanceY(Fe),Le=Math.max(Math.abs(Re),Math.abs(Be));if(te.zoom===K||Le>D+(1<<K-te.zoom)-2&&te.zoom>=P){const At=K-te.zoom,_t=g[0]-.5-(se<<At),nt=g[1]-.5-(xe<<At);W.push({tileID:new l.OverscaledTileID(te.zoom===K?de:te.zoom,te.wrap,te.zoom,se,xe),distanceSq:tt([y[0]-.5-se,y[1]-.5-xe]),tileDistanceToCamera:Math.sqrt(_t*_t+nt*nt)})}else for(let At=0;At<4;At++){const _t=(se<<1)+At%2,nt=(xe<<1)+(At>>1),ct=te.zoom+1;let Ct=te.aabb.quadrant(At);if(a.terrain){const un=new l.OverscaledTileID(ct,te.wrap,ct,_t,nt),Yt=a.terrain.getMinMaxElevation(un),wt=(m=Yt.minElevation)!==null&&m!==void 0?m:this.elevation,zt=(w=Yt.maxElevation)!==null&&w!==void 0?w:this.elevation;Ct=new Io([Ct.min[0],Ct.min[1],wt],[Ct.max[0],Ct.max[1],zt])}G.push({aabb:Ct,zoom:ct,x:_t,y:nt,wrap:te.wrap,fullyVisible:Ie})}}return W.sort((te,se)=>te.distanceSq-se.distanceSq).map(te=>te.tileID)}resize(a,m){this.width=a,this.height=m,this.pixelsToGLUnits=[2/a,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const m=l.clamp(a.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(a.lng)*this.worldSize,l.mercatorYfromLat(m)*this.worldSize)}unproject(a){return new l.MercatorCoordinate(a.x/this.worldSize,a.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(a){const m=this.pointLocation(this.centerPoint,a),w=a.getElevationForLngLatZoom(m,this.tileZoom);if(!(this.elevation-w))return;const T=this.getCameraPosition(),I=l.MercatorCoordinate.fromLngLat(T.lngLat,T.altitude),u=l.MercatorCoordinate.fromLngLat(m,w),c=I.x-u.x,f=I.y-u.y,g=I.z-u.z,y=Math.sqrt(c*c+f*f+g*g),b=this.scaleZoom(this.cameraToCenterDistance/y/this.tileSize);this._elevation=w,this._center=m,this.zoom=b}setLocationAtPoint(a,m){const w=this.pointCoordinate(m),T=this.pointCoordinate(this.centerPoint),I=this.locationCoordinate(a),u=new l.MercatorCoordinate(I.x-(w.x-T.x),I.y-(w.y-T.y));this.center=this.coordinateLocation(u),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(a,m){return m?this.coordinatePoint(this.locationCoordinate(a),m.getElevationForLngLatZoom(a,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(a))}pointLocation(a,m){return this.coordinateLocation(this.pointCoordinate(a,m))}locationCoordinate(a){return l.MercatorCoordinate.fromLngLat(a)}coordinateLocation(a){return a&&a.toLngLat()}pointCoordinate(a,m){if(m){const P=m.pointCoordinate(a);if(P!=null)return P}const w=[a.x,a.y,0,1],T=[a.x,a.y,1,1];l.transformMat4(w,w,this.pixelMatrixInverse),l.transformMat4(T,T,this.pixelMatrixInverse);const I=w[3],u=T[3],c=w[1]/I,f=T[1]/u,g=w[2]/I,y=T[2]/u,b=g===y?0:(0-g)/(y-g);return new l.MercatorCoordinate(l.interpolate.number(w[0]/I,T[0]/u,b)/this.worldSize,l.interpolate.number(c,f,b)/this.worldSize)}coordinatePoint(a,m=0,w=this.pixelMatrix){const T=[a.x*this.worldSize,a.y*this.worldSize,m,1];return l.transformMat4(T,T,w),new l.Point(T[0]/T[3],T[1]/T[3])}getBounds(){const a=Math.max(0,this.height/2-this.getHorizon());return new Un().extend(this.pointLocation(new l.Point(0,a))).extend(this.pointLocation(new l.Point(this.width,a))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Un([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(a,m=!1){const w=a.key,T=m?this._alignedPosMatrixCache:this._posMatrixCache;if(T[w])return T[w];const I=a.canonical,u=this.worldSize/this.zoomScale(I.z),c=I.x+Math.pow(2,I.z)*a.wrap,f=l.identity(new Float64Array(16));return l.translate(f,f,[c*u,I.y*u,0]),l.scale(f,f,[u/l.EXTENT,u/l.EXTENT,1]),l.multiply(f,m?this.alignedProjMatrix:this.projMatrix,f),T[w]=new Float32Array(f),T[w]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let a,m,w,T,I=-90,u=90,c=-180,f=180;const g=this.size,y=this._unmodified;if(this.latRange){const D=this.latRange;I=l.mercatorYfromLat(D[1])*this.worldSize,u=l.mercatorYfromLat(D[0])*this.worldSize,a=u-I<g.y?g.y/(u-I):0}if(this.lngRange){const D=this.lngRange;c=l.wrap(l.mercatorXfromLng(D[0])*this.worldSize,0,this.worldSize),f=l.wrap(l.mercatorXfromLng(D[1])*this.worldSize,0,this.worldSize),f<c&&(f+=this.worldSize),m=f-c<g.x?g.x/(f-c):0}const b=this.point,P=Math.max(m||0,a||0);if(P)return this.center=this.unproject(new l.Point(m?(f+c)/2:b.x,a?(u+I)/2:b.y)),this.zoom+=this.scaleZoom(P),this._unmodified=y,void(this._constraining=!1);if(this.latRange){const D=b.y,N=g.y/2;D-N<I&&(T=I+N),D+N>u&&(T=u-N)}if(this.lngRange){const D=(c+f)/2,N=l.wrap(b.x,D-this.worldSize/2,D+this.worldSize/2),G=g.x/2;N-G<c&&(w=c+G),N+G>f&&(w=f-G)}w===void 0&&T===void 0||(this.center=this.unproject(new l.Point(w!==void 0?w:b.x,T!==void 0?T:b.y)).wrap()),this._unmodified=y,this._constraining=!1}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,m=this.point.x,w=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let T=l.identity(new Float64Array(16));l.scale(T,T,[this.width/2,-this.height/2,1]),l.translate(T,T,[1,-1,0]),this.labelPlaneMatrix=T,T=l.identity(new Float64Array(16)),l.scale(T,T,[1,-1,1]),l.translate(T,T,[-1,-1,0]),l.scale(T,T,[2/this.width,2/this.height,1]),this.glCoordMatrix=T;const I=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),u=Math.min(this.elevation,this._minEleveationForCurrentTile),c=I-u*this._pixelPerMeter/Math.cos(this._pitch),f=u<0?c:I,g=Math.PI/2+this._pitch,y=this._fov*(.5+a.y/this.height),b=Math.sin(y)*f/Math.sin(l.clamp(Math.PI-g-y,.01,Math.PI-.01)),P=this.getHorizon(),D=2*Math.atan(P/this.cameraToCenterDistance)*(.5+a.y/(2*P)),N=Math.sin(D)*f/Math.sin(l.clamp(Math.PI-g-D,.01,Math.PI-.01)),G=Math.min(b,N),W=1.01*(Math.cos(Math.PI/2-this._pitch)*G+f),K=this.height/50;T=new Float64Array(16),l.perspective(T,this._fov,this.width/this.height,K,W),T[8]=2*-a.x/this.width,T[9]=2*a.y/this.height,l.scale(T,T,[1,-1,1]),l.translate(T,T,[0,0,-this.cameraToCenterDistance]),l.rotateX(T,T,this._pitch),l.rotateZ(T,T,this.angle),l.translate(T,T,[-m,-w,0]),this.mercatorMatrix=l.scale([],T,[this.worldSize,this.worldSize,this.worldSize]),l.scale(T,T,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,T),l.translate(T,T,[0,0,-this.elevation]),this.projMatrix=T,this.invProjMatrix=l.invert([],T),this.pixelMatrix3D=l.multiply(new Float64Array(16),this.labelPlaneMatrix,T);const de=this.width%2/2,te=this.height%2/2,se=Math.cos(this.angle),xe=Math.sin(this.angle),Ie=m-Math.round(m)+se*de+xe*te,Fe=w-Math.round(w)+se*te+xe*de,Re=new Float64Array(T);if(l.translate(Re,Re,[Ie>.5?Ie-1:Ie,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=Re,T=l.invert(new Float64Array(16),this.pixelMatrix),!T)throw new Error("failed to invert matrix");this.pixelMatrixInverse=T,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const a=this.pointCoordinate(new l.Point(0,0)),m=[a.x*this.worldSize,a.y*this.worldSize,0,1];return l.transformMat4(m,m,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,a))}getCameraQueryGeometry(a){const m=this.getCameraPoint();if(a.length===1)return[a[0],m];{let w=m.x,T=m.y,I=m.x,u=m.y;for(const c of a)w=Math.min(w,c.x),T=Math.min(T,c.y),I=Math.max(I,c.x),u=Math.max(u,c.y);return[new l.Point(w,T),new l.Point(I,T),new l.Point(I,u),new l.Point(w,u),new l.Point(w,T)]}}}function Vr(M,a){let m,w=!1,T=null,I=null;const u=()=>{T=null,w&&(M.apply(I,m),T=setTimeout(u,a),w=!1)};return(...c)=>(w=!0,I=this,m=c,T||u(),T)}class Cu{constructor(a){this._getCurrentHash=()=>{const m=window.location.hash.replace("#","");if(this._hashName){let w;return m.split("&").map(T=>T.split("=")).forEach(T=>{T[0]===this._hashName&&(w=T)}),(w&&w[1]||"").split("/")}return m.split("/")},this._onHashChange=()=>{const m=this._getCurrentHash();if(m.length>=3&&!m.some(w=>isNaN(w))){const w=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(m[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:w,pitch:+(m[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const m=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,m)}catch{}},this._updateHash=Vr(this._updateHashUnthrottled,300),this._hashName=a&&encodeURIComponent(a)}addTo(a){return this._map=a,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(a){const m=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,T=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,T),u=Math.round(m.lng*I)/I,c=Math.round(m.lat*I)/I,f=this._map.getBearing(),g=this._map.getPitch();let y="";if(y+=a?`/${u}/${c}/${w}`:`${w}/${c}/${u}`,(f||g)&&(y+="/"+Math.round(10*f)/10),g&&(y+=`/${Math.round(g)}`),this._hashName){const b=this._hashName;let P=!1;const D=window.location.hash.slice(1).split("&").map(N=>{const G=N.split("=")[0];return G===b?(P=!0,`${G}=${y}`):N}).filter(N=>N);return P||D.push(`${b}=${y}`),`#${D.join("&")}`}return`#${y}`}}const ca={linearity:.3,easing:l.bezier(0,0,.3,1)},Rl=l.extend({deceleration:2500,maxSpeed:1400},ca),Lo=l.extend({deceleration:20,maxSpeed:1400},ca),Do=l.extend({deceleration:1e3,maxSpeed:360},ca),Pu=l.extend({deceleration:1e3,maxSpeed:90},ca);class lo{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,m=l.browser.now();for(;a.length>0&&m-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const m={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:I}of this._inertiaBuffer)m.zoom+=I.zoomDelta||0,m.bearing+=I.bearingDelta||0,m.pitch+=I.pitchDelta||0,I.panDelta&&m.pan._add(I.panDelta),I.around&&(m.around=I.around),I.pinchAround&&(m.pinchAround=I.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(m.pan.mag()){const I=qr(m.pan.mag(),w,l.extend({},Rl,a||{}));T.offset=m.pan.mult(I.amount/m.pan.mag()),T.center=this._map.transform.center,vA(T,I)}if(m.zoom){const I=qr(m.zoom,w,Lo);T.zoom=this._map.transform.zoom+I.amount,vA(T,I)}if(m.bearing){const I=qr(m.bearing,w,Do);T.bearing=this._map.transform.bearing+l.clamp(I.amount,-179,179),vA(T,I)}if(m.pitch){const I=qr(m.pitch,w,Pu);T.pitch=this._map.transform.pitch+I.amount,vA(T,I)}if(T.zoom||T.bearing){const I=m.pinchAround===void 0?m.around:m.pinchAround;T.around=I?this._map.unproject(I):this._map.getCenter()}return this.clear(),l.extend(T,{noMoveStart:!0})}}function vA(M,a){(!M.duration||M.duration<a.duration)&&(M.duration=a.duration,M.easing=a.easing)}function qr(M,a,m){const{maxSpeed:w,linearity:T,deceleration:I}=m,u=l.clamp(M*T/(a/1e3),-w,w),c=Math.abs(u)/(I*T);return{easing:m.easing,duration:1e3*c,amount:u*(c/2)}}class Di extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,m,w,T={}){const I=k.mousePos(m.getCanvasContainer(),w),u=m.unproject(I);super(a,l.extend({point:I,lngLat:u,originalEvent:w},T)),this._defaultPrevented=!1,this.target=m}}class xA extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,m,w){const T=a==="touchend"?w.changedTouches:w.touches,I=k.touchPos(m.getCanvasContainer(),T),u=I.map(f=>m.unproject(f)),c=I.reduce((f,g,y,b)=>f.add(g.div(b.length)),new l.Point(0,0));super(a,{points:I,point:c,lngLats:u,lngLat:m.unproject(c),originalEvent:w}),this._defaultPrevented=!1}}class ds extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,m,w){super(a,{originalEvent:w}),this._defaultPrevented=!1}}class wA{constructor(a,m){this._map=a,this._clickTolerance=m.clickTolerance}reset(){delete this._mousedownPos}wheel(a){return this._firePreventable(new ds(a.type,this._map,a))}mousedown(a,m){return this._mousedownPos=m,this._firePreventable(new Di(a.type,this._map,a))}mouseup(a){this._map.fire(new Di(a.type,this._map,a))}click(a,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new Di(a.type,this._map,a))}dblclick(a){return this._firePreventable(new Di(a.type,this._map,a))}mouseover(a){this._map.fire(new Di(a.type,this._map,a))}mouseout(a){this._map.fire(new Di(a.type,this._map,a))}touchstart(a){return this._firePreventable(new xA(a.type,this._map,a))}touchmove(a){this._map.fire(new xA(a.type,this._map,a))}touchend(a){this._map.fire(new xA(a.type,this._map,a))}touchcancel(a){this._map.fire(new xA(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wc{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(a){this._map.fire(new Di(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Di("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._ignoreContextMenu||this._map.fire(new Di(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ha{constructor(a){this._map=a}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(a){return this.transform.pointLocation(l.Point.convert(a),this._map.terrain)}}class Ol{constructor(a,m){this._map=a,this._tr=new ha(a),this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,m){this.isEnabled()&&a.shiftKey&&a.button===0&&(k.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(a,m){if(!this._active)return;const w=m;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;const T=this._startPos;this._lastPos=w,this._box||(this._box=k.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",a));const I=Math.min(T.x,w.x),u=Math.max(T.x,w.x),c=Math.min(T.y,w.y),f=Math.max(T.y,w.y);k.setTransform(this._box,`translate(${I}px,${c}px)`),this._box.style.width=u-I+"px",this._box.style.height=f-c+"px"}mouseupWindow(a,m){if(!this._active||a.button!==0)return;const w=this._startPos,T=m;if(this.reset(),k.suppressClick(),w.x!==T.x||w.y!==T.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:I=>I.fitScreenCoordinates(w,T,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",a)}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(a,m){return this._map.fire(new l.Event(a,{originalEvent:m}))}}function fa(M,a){if(M.length!==a.length)throw new Error(`The number of touches and points are not equal - touches ${M.length}, points ${a.length}`);const m={};for(let w=0;w<M.length;w++)m[M[w].identifier]=a[w];return m}class Yr{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(a,m,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=a.timeStamp),w.length===this.numTouches&&(this.centroid=function(T){const I=new l.Point(0,0);for(const u of T)I._add(u);return I.div(T.length)}(m),this.touches=fa(w,m)))}touchmove(a,m,w){if(this.aborted||!this.centroid)return;const T=fa(w,m);for(const I in this.touches){const u=T[I];(!u||u.dist(this.touches[I])>30)&&(this.aborted=!0)}}touchend(a,m,w){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class Is{constructor(a){this.singleTap=new Yr(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(a,m,w){this.singleTap.touchstart(a,m,w)}touchmove(a,m,w){this.singleTap.touchmove(a,m,w)}touchend(a,m,w){const T=this.singleTap.touchend(a,m,w);if(T){const I=a.timeStamp-this.lastTime<500,u=!this.lastTap||this.lastTap.dist(T)<30;if(I&&u||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class Wt{constructor(a){this._tr=new ha(a),this._zoomIn=new Is({numTouches:1,numTaps:2}),this._zoomOut=new Is({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,m,w){this._zoomIn.touchstart(a,m,w),this._zoomOut.touchstart(a,m,w)}touchmove(a,m,w){this._zoomIn.touchmove(a,m,w),this._zoomOut.touchmove(a,m,w)}touchend(a,m,w){const T=this._zoomIn.touchend(a,m,w),I=this._zoomOut.touchend(a,m,w),u=this._tr;return T?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:c=>c.easeTo({duration:300,zoom:u.zoom+1,around:u.unproject(T)},{originalEvent:a})}):I?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:c=>c.easeTo({duration:300,zoom:u.zoom-1,around:u.unproject(I)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ga{constructor(a){this._enabled=!!a.enable,this._moveStateManager=a.moveStateManager,this._clickTolerance=a.clickTolerance||1,this._moveFunction=a.move,this._activateOnStart=!!a.activateOnStart,a.assignEvents(this),this.reset()}reset(a){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(a)}_move(...a){const m=this._moveFunction(...a);if(m.bearingDelta||m.pitchDelta||m.around||m.panDelta)return this._active=!0,m}dragStart(a,m){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(a)&&(this._moveStateManager.startMove(a),this._lastPoint=m.length?m[0]:m,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(a,m){if(!this.isEnabled())return;const w=this._lastPoint;if(!w)return;if(a.preventDefault(),!this._moveStateManager.isValidMoveEvent(a))return void this.reset(a);const T=m.length?m[0]:m;return!this._moved&&T.dist(w)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=T,this._move(w,T))}dragEnd(a){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(a)&&(this._moved&&k.suppressClick(),this.reset(a))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const bA={0:1,2:2};class da{constructor(a){this._correctEvent=a.checkCorrectEvent}startMove(a){const m=k.mouseButton(a);this._eventButton=m}endMove(a){delete this._eventButton}isValidStartEvent(a){return this._correctEvent(a)}isValidMoveEvent(a){return!function(m,w){const T=bA[w];return m.buttons===void 0||(m.buttons&T)!==T}(a,this._eventButton)}isValidEndEvent(a){return k.mouseButton(a)===this._eventButton}}class zl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(a){return a.targetTouches.length===1}_isSameTouchEvent(a){return a.targetTouches[0].identifier===this._firstTouch}startMove(a){this._firstTouch=a.targetTouches[0].identifier}endMove(a){delete this._firstTouch}isValidStartEvent(a){return this._isOneFingerTouch(a)}isValidMoveEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}isValidEndEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}}const Bt=M=>{M.mousedown=M.dragStart,M.mousemoveWindow=M.dragMove,M.mouseup=M.dragEnd,M.contextmenu=function(a){a.preventDefault()}},EA=({enable:M,clickTolerance:a,bearingDegreesPerPixelMoved:m=.8})=>{const w=new da({checkCorrectEvent:T=>k.mouseButton(T)===0&&T.ctrlKey||k.mouseButton(T)===2});return new Ga({clickTolerance:a,move:(T,I)=>({bearingDelta:(I.x-T.x)*m}),moveStateManager:w,enable:M,assignEvents:Bt})},TA=({enable:M,clickTolerance:a,pitchDegreesPerPixelMoved:m=-.5})=>{const w=new da({checkCorrectEvent:T=>k.mouseButton(T)===0&&T.ctrlKey||k.mouseButton(T)===2});return new Ga({clickTolerance:a,move:(T,I)=>({pitchDelta:(I.y-T.y)*m}),moveStateManager:w,enable:M,assignEvents:Bt})};class uo{constructor(a,m){this._minTouches=a.cooperativeGestures?2:1,this._clickTolerance=a.clickTolerance||1,this._map=m,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(a,m,w){return this._calculateTransform(a,m,w)}touchmove(a,m,w){if(this._map._cooperativeGestures&&(this._minTouches===2&&w.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(a,!1,w.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(w.length<this._minTouches))return a.preventDefault(),this._calculateTransform(a,m,w)}touchend(a,m,w){this._calculateTransform(a,m,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,m,w){w.length>0&&(this._active=!0);const T=fa(w,m),I=new l.Point(0,0),u=new l.Point(0,0);let c=0;for(const g in T){const y=T[g],b=this._touches[g];b&&(I._add(y),u._add(y.sub(b)),c++,T[g]=y)}if(this._touches=T,c<this._minTouches||!u.mag())return;const f=u.div(c);return this._sum._add(f),this._sum.mag()<this._clickTolerance?void 0:{around:I.div(c),panDelta:f}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(a,m,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([m[0],m[1]]))}touchmove(a,m,w){if(!this._firstTwoTouches)return;a.preventDefault();const[T,I]=this._firstTwoTouches,u=SA(w,m,T),c=SA(w,m,I);if(!u||!c)return;const f=this._aroundCenter?null:u.add(c).div(2);return this._move([u,c],f,a)}touchend(a,m,w){if(!this._firstTwoTouches)return;const[T,I]=this._firstTwoTouches,u=SA(w,m,T),c=SA(w,m,I);u&&c||(this._active&&k.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function SA(M,a,m){for(let w=0;w<M.length;w++)if(M[w].identifier===m)return a[w]}function Fl(M,a){return Math.log(M/a)/Math.LN2}class bc extends Qa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,m){const w=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Fl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fl(this._distance,w),pinchAround:m}}}function Mu(M,a){return 180*M.angleWith(a)/Math.PI}class Nl extends Qa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,m){const w=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Mu(this._vector,w),pinchAround:m}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const m=25/(Math.PI*this._minDiameter)*360,w=Mu(a,this._startVector);return Math.abs(w)<m}}function ps(M){return Math.abs(M.y)>Math.abs(M.x)}class rl extends Qa{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(a,m,w){super.touchstart(a,m,w),this._currentTouchCount=w.length}_start(a){this._lastPoints=a,ps(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,m,w){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const T=a[0].sub(this._lastPoints[0]),I=a[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(T,I,w.timeStamp),this._valid?(this._lastPoints=a,this._active=!0,{pitchDelta:(T.y+I.y)/2*-.5}):void 0}gestureBeginsVertically(a,m,w){if(this._valid!==void 0)return this._valid;const T=a.mag()>=2,I=m.mag()>=2;if(!T&&!I)return;if(!T||!I)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;const u=a.y>0==m.y>0;return ps(a)&&ps(m)&&u}}const sl={panStep:100,bearingStep:15,pitchStep:10};class wr{constructor(a){this._tr=new ha(a);const m=sl;this._panStep=m.panStep,this._bearingStep=m.bearingStep,this._pitchStep=m.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let m=0,w=0,T=0,I=0,u=0;switch(a.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:a.shiftKey?w=-1:(a.preventDefault(),I=-1);break;case 39:a.shiftKey?w=1:(a.preventDefault(),I=1);break;case 38:a.shiftKey?T=1:(a.preventDefault(),u=-1);break;case 40:a.shiftKey?T=-1:(a.preventDefault(),u=1);break;default:return}return this._rotationDisabled&&(w=0,T=0),{cameraAnimation:c=>{const f=this._tr;c.easeTo({duration:300,easeId:"keyboardHandler",easing:co,zoom:m?Math.round(f.zoom)+m*(a.shiftKey?2:1):f.zoom,bearing:f.bearing+w*this._bearingStep,pitch:f.pitch+T*this._pitchStep,offset:[-I*this._panStep,-u*this._panStep],center:f.center},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function co(M){return M*(2-M)}const yi=4.000244140625;class Ul{constructor(a,m){this._onTimeout=w=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(w)},this._map=a,this._tr=new ha(a),this._el=a.getCanvasContainer(),this._triggerRenderFrame=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!a[this._map._metaKey])return;a.preventDefault()}let m=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const w=l.browser.now(),T=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,m!==0&&m%yi==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(T*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),a.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=a,this._delta-=m,this._active||this._start(a)),a.preventDefault()}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=k.mousePos(this._el,a),w=this._tr;this._around=l.LngLat.convert(this._aroundCenter?w.center:w.unproject(m)),this._aroundPoint=w.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._tr.transform;if(this._delta!==0){const c=this._type==="wheel"&&Math.abs(this._delta)>yi?this._wheelZoomRate:this._defaultZoomRate;let f=2/(1+Math.exp(-Math.abs(this._delta*c)));this._delta<0&&f!==0&&(f=1/f);const g=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(g*f))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,w=this._startZoom,T=this._easing;let I,u=!1;if(this._type==="wheel"&&w&&T){const c=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),f=T(c);I=l.interpolate.number(w,m,f),c<1?this._frameId||(this._frameId=!0):u=!0}else I=m,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:I-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let m=l.defaultEasing;if(this._prevEase){const w=this._prevEase,T=(l.browser.now()-w.start)/w.duration,I=w.easing(T+.01)-w.easing(T),u=.27/Math.sqrt(I*I+1e-4)*.01,c=Math.sqrt(.0729-u*u);m=l.bezier(u,c,.25,1)}return this._prevEase={start:l.browser.now(),duration:a,easing:m},m}reset(){this._active=!1}}class Vl{constructor(a,m){this._clickZoom=a,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class jl{constructor(a){this._tr=new ha(a),this.reset()}reset(){this._active=!1}dblclick(a,m){return a.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:this._tr.zoom+(a.shiftKey?-1:1),around:this._tr.unproject(m)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gl{constructor(){this._tap=new Is({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(a,m,w){if(!this._swipePoint)if(this._tapTime){const T=m[0],I=a.timeStamp-this._tapTime<500,u=this._tapPoint.dist(T)<30;I&&u?w.length>0&&(this._swipePoint=T,this._swipeTouch=w[0].identifier):this.reset()}else this._tap.touchstart(a,m,w)}touchmove(a,m,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const T=m[0],I=T.y-this._swipePoint.y;return this._swipePoint=T,a.preventDefault(),this._active=!0,{zoomDelta:I/128}}}else this._tap.touchmove(a,m,w)}touchend(a,m,w){if(this._tapTime)this._swipePoint&&w.length===0&&this.reset();else{const T=this._tap.touchend(a,m,w);T&&(this._tapTime=a.timeStamp,this._tapPoint=T)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xr{constructor(a,m,w){this._el=a,this._mousePan=m,this._touchPan=w}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ci{constructor(a,m,w){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=m,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class CA{constructor(a,m,w,T){this._el=a,this._touchZoom=m,this._touchRotate=w,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ha=M=>M.zoom||M.drag||M.pitch||M.rotate;class Ql extends l.Event{}function PA(M){return M.panDelta&&M.panDelta.mag()||M.zoomDelta||M.bearingDelta||M.pitchDelta}class Ci{constructor(a,m){this.handleWindowEvent=T=>{this.handleEvent(T,`${T.type}Window`)},this.handleEvent=(T,I)=>{if(T.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const u=T.type==="renderFrame"?void 0:T,c={needsRenderFrame:!1},f={},g={},y=T.touches,b=y?this._getMapTouches(y):void 0,P=b?k.touchPos(this._el,b):k.mousePos(this._el,T);for(const{handlerName:G,handler:W,allowed:K}of this._handlers){if(!W.isEnabled())continue;let de;this._blockedByActive(g,K,G)?W.reset():W[I||T.type]&&(de=W[I||T.type](T,P,b),this.mergeHandlerResult(c,f,de,G,u),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||W.isActive())&&(g[G]=W)}const D={};for(const G in this._previousActiveHandlers)g[G]||(D[G]=u);this._previousActiveHandlers=g,(Object.keys(D).length||PA(c))&&(this._changes.push([c,f,D]),this._triggerRenderFrame()),(Object.keys(g).length||PA(c))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=c;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))},this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new lo(a),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[T,I,u]of this._listeners)k.addEventListener(T,I,T===document?this.handleWindowEvent:this.handleEvent,u)}destroy(){for(const[a,m,w]of this._listeners)k.removeEventListener(a,m,a===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(a){const m=this._map,w=m.getCanvasContainer();this._add("mapEvent",new wA(m,a));const T=m.boxZoom=new Ol(m,a);this._add("boxZoom",T),a.interactive&&a.boxZoom&&T.enable();const I=new Wt(m),u=new jl(m);m.doubleClickZoom=new Vl(u,I),this._add("tapZoom",I),this._add("clickZoom",u),a.interactive&&a.doubleClickZoom&&m.doubleClickZoom.enable();const c=new Gl;this._add("tapDragZoom",c);const f=m.touchPitch=new rl(m);this._add("touchPitch",f),a.interactive&&a.touchPitch&&m.touchPitch.enable(a.touchPitch);const g=EA(a),y=TA(a);m.dragRotate=new ci(a,g,y),this._add("mouseRotate",g,["mousePitch"]),this._add("mousePitch",y,["mouseRotate"]),a.interactive&&a.dragRotate&&m.dragRotate.enable();const b=(({enable:K,clickTolerance:de})=>{const te=new da({checkCorrectEvent:se=>k.mouseButton(se)===0&&!se.ctrlKey});return new Ga({clickTolerance:de,move:(se,xe)=>({around:xe,panDelta:xe.sub(se)}),activateOnStart:!0,moveStateManager:te,enable:K,assignEvents:Bt})})(a),P=new uo(a,m);m.dragPan=new Xr(w,b,P),this._add("mousePan",b),this._add("touchPan",P,["touchZoom","touchRotate"]),a.interactive&&a.dragPan&&m.dragPan.enable(a.dragPan);const D=new Nl,N=new bc;m.touchZoomRotate=new CA(w,N,D,c),this._add("touchRotate",D,["touchPan","touchZoom"]),this._add("touchZoom",N,["touchPan","touchRotate"]),a.interactive&&a.touchZoomRotate&&m.touchZoomRotate.enable(a.touchZoomRotate);const G=m.scrollZoom=new Ul(m,()=>this._triggerRenderFrame());this._add("scrollZoom",G,["mousePan"]),a.interactive&&a.scrollZoom&&m.scrollZoom.enable(a.scrollZoom);const W=m.keyboard=new wr(m);this._add("keyboard",W),a.interactive&&a.keyboard&&m.keyboard.enable(),this._add("blockableMapEvent",new wc(m))}_add(a,m,w){this._handlers.push({handlerName:a,handler:m,allowed:w}),this._handlersById[a]=m}stop(a){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ha(this._eventsInProgress)||this.isZooming()}_blockedByActive(a,m,w){for(const T in a)if(T!==w&&(!m||m.indexOf(T)<0))return!0;return!1}_getMapTouches(a){const m=[];for(const w of a)this._el.contains(w.target)&&m.push(w);return m}mergeHandlerResult(a,m,w,T,I){if(!w)return;l.extend(a,w);const u={handlerName:T,originalEvent:w.originalEvent||I};w.zoomDelta!==void 0&&(m.zoom=u),w.panDelta!==void 0&&(m.drag=u),w.pitchDelta!==void 0&&(m.pitch=u),w.bearingDelta!==void 0&&(m.rotate=u)}_applyChanges(){const a={},m={},w={};for(const[T,I,u]of this._changes)T.panDelta&&(a.panDelta=(a.panDelta||new l.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+T.pitchDelta),T.around!==void 0&&(a.around=T.around),T.pinchAround!==void 0&&(a.pinchAround=T.pinchAround),T.noInertia&&(a.noInertia=T.noInertia),l.extend(m,I),l.extend(w,u);this._updateMapTransform(a,m,w),this._changes=[]}_updateMapTransform(a,m,w){const T=this._map,I=T._getTransformForUpdate(),u=T.terrain;if(!(PA(a)||u&&this._terrainMovement))return this._fireEvents(m,w,!0);let{panDelta:c,zoomDelta:f,bearingDelta:g,pitchDelta:y,around:b,pinchAround:P}=a;P!==void 0&&(b=P),T._stop(!0),b=b||T.transform.centerPoint;const D=I.pointLocation(c?b.sub(c):b);g&&(I.bearing+=g),y&&(I.pitch+=y),f&&(I.zoom+=f),u?this._terrainMovement||!m.drag&&!m.zoom?m.drag&&this._terrainMovement?I.center=I.pointLocation(I.centerPoint.sub(c)):I.setLocationAtPoint(D,b):(this._terrainMovement=!0,this._map._elevationFreeze=!0,I.setLocationAtPoint(D,b),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,I.recalculateZoom(T.terrain)})):I.setLocationAtPoint(D,b),T._applyUpdatedTransform(I),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(m,w,!0)}_fireEvents(a,m,w){const T=Ha(this._eventsInProgress),I=Ha(a),u={};for(const y in a){const{originalEvent:b}=a[y];this._eventsInProgress[y]||(u[`${y}start`]=b),this._eventsInProgress[y]=a[y]}!T&&I&&this._fireEvent("movestart",I.originalEvent);for(const y in u)this._fireEvent(y,u[y]);I&&this._fireEvent("move",I.originalEvent);for(const y in a){const{originalEvent:b}=a[y];this._fireEvent(y,b)}const c={};let f;for(const y in this._eventsInProgress){const{handlerName:b,originalEvent:P}=this._eventsInProgress[y];this._handlersById[b].isActive()||(delete this._eventsInProgress[y],f=m[b]||P,c[`${y}end`]=f)}for(const y in c)this._fireEvent(y,c[y]);const g=Ha(this._eventsInProgress);if(w&&(T||I)&&!g){this._updatingCamera=!0;const y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),b=P=>P!==0&&-this._bearingSnap<P&&P<this._bearingSnap;y?(b(y.bearing||this._map.getBearing())&&(y.bearing=0),y.freezeElevation=!0,this._map.easeTo(y,{originalEvent:f})):(this._map.fire(new l.Event("moveend",{originalEvent:f})),b(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,m){this._map.fire(new l.Event(a,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{delete this._frameId,this.handleEvent(new Ql("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ec extends l.Evented{constructor(a,m){super(),this._renderFrameCallback=()=>{const w=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(w)),w<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=m.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,m){return this.jumpTo({center:a},m)}panBy(a,m,w){return a=l.Point.convert(a).mult(-1),this.panTo(this.transform.center,l.extend({offset:a},m),w)}panTo(a,m,w){return this.easeTo(l.extend({center:a},m),w)}getZoom(){return this.transform.zoom}setZoom(a,m){return this.jumpTo({zoom:a},m),this}zoomTo(a,m,w){return this.easeTo(l.extend({zoom:a},m),w)}zoomIn(a,m){return this.zoomTo(this.getZoom()+1,a,m),this}zoomOut(a,m){return this.zoomTo(this.getZoom()-1,a,m),this}getBearing(){return this.transform.bearing}setBearing(a,m){return this.jumpTo({bearing:a},m),this}getPadding(){return this.transform.padding}setPadding(a,m){return this.jumpTo({padding:a},m),this}rotateTo(a,m,w){return this.easeTo(l.extend({bearing:a},m),w)}resetNorth(a,m){return this.rotateTo(0,l.extend({duration:1e3},a),m),this}resetNorthPitch(a,m){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},a),m),this}snapToNorth(a,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,m):this}getPitch(){return this.transform.pitch}setPitch(a,m){return this.jumpTo({pitch:a},m),this}cameraForBounds(a,m){a=Un.convert(a);const w=m&&m.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),w,m)}_cameraForBoxAndBearing(a,m,w,T){const I={top:0,bottom:0,right:0,left:0};if(typeof(T=l.extend({padding:I,offset:[0,0],maxZoom:this.transform.maxZoom},T)).padding=="number"){const xe=T.padding;T.padding={top:xe,bottom:xe,right:xe,left:xe}}T.padding=l.extend(I,T.padding);const u=this.transform,c=u.padding,f=u.project(l.LngLat.convert(a)),g=u.project(l.LngLat.convert(m)),y=f.rotate(-w*Math.PI/180),b=g.rotate(-w*Math.PI/180),P=new l.Point(Math.max(y.x,b.x),Math.max(y.y,b.y)),D=new l.Point(Math.min(y.x,b.x),Math.min(y.y,b.y)),N=P.sub(D),G=(u.width-(c.left+c.right+T.padding.left+T.padding.right))/N.x,W=(u.height-(c.top+c.bottom+T.padding.top+T.padding.bottom))/N.y;if(W<0||G<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const K=Math.min(u.scaleZoom(u.scale*Math.min(G,W)),T.maxZoom),de=l.Point.convert(T.offset),te=new l.Point((T.padding.left-T.padding.right)/2,(T.padding.top-T.padding.bottom)/2).rotate(w*Math.PI/180),se=de.add(te).mult(u.scale/u.zoomScale(K));return{center:u.unproject(f.add(g).div(2).sub(se)),zoom:K,bearing:w}}fitBounds(a,m,w){return this._fitInternal(this.cameraForBounds(a,m),m,w)}fitScreenCoordinates(a,m,w,T,I){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(a)),this.transform.pointLocation(l.Point.convert(m)),w,T),T,I)}_fitInternal(a,m,w){return a?(delete(m=l.extend(a,m)).padding,m.linear?this.easeTo(m,w):this.flyTo(m,w)):this}jumpTo(a,m){this.stop();const w=this._getTransformForUpdate();let T=!1,I=!1,u=!1;return"zoom"in a&&w.zoom!==+a.zoom&&(T=!0,w.zoom=+a.zoom),a.center!==void 0&&(w.center=l.LngLat.convert(a.center)),"bearing"in a&&w.bearing!==+a.bearing&&(I=!0,w.bearing=+a.bearing),"pitch"in a&&w.pitch!==+a.pitch&&(u=!0,w.pitch=+a.pitch),a.padding==null||w.isPaddingEqual(a.padding)||(w.padding=a.padding),this._applyUpdatedTransform(w),this.fire(new l.Event("movestart",m)).fire(new l.Event("move",m)),T&&this.fire(new l.Event("zoomstart",m)).fire(new l.Event("zoom",m)).fire(new l.Event("zoomend",m)),I&&this.fire(new l.Event("rotatestart",m)).fire(new l.Event("rotate",m)).fire(new l.Event("rotateend",m)),u&&this.fire(new l.Event("pitchstart",m)).fire(new l.Event("pitch",m)).fire(new l.Event("pitchend",m)),this.fire(new l.Event("moveend",m))}calculateCameraOptionsFromTo(a,m,w,T=0){const I=l.MercatorCoordinate.fromLngLat(a,m),u=l.MercatorCoordinate.fromLngLat(w,T),c=u.x-I.x,f=u.y-I.y,g=u.z-I.z,y=Math.hypot(c,f,g);if(y===0)throw new Error("Can't calculate camera options with same From and To");const b=Math.hypot(c,f),P=this.transform.scaleZoom(this.transform.cameraToCenterDistance/y/this.transform.tileSize),D=180*Math.atan2(c,-f)/Math.PI;let N=180*Math.acos(b/y)/Math.PI;return N=g<0?90-N:90+N,{center:u.toLngLat(),zoom:P,pitch:N,bearing:D}}easeTo(a,m){this._stop(!1,a.easeId),((a=l.extend({offset:[0,0],duration:500,easing:l.defaultEasing},a)).animate===!1||!a.essential&&l.browser.prefersReducedMotion)&&(a.duration=0);const w=this._getTransformForUpdate(),T=this.getZoom(),I=this.getBearing(),u=this.getPitch(),c=this.getPadding(),f="zoom"in a?+a.zoom:T,g="bearing"in a?this._normalizeBearing(a.bearing,I):I,y="pitch"in a?+a.pitch:u,b="padding"in a?a.padding:w.padding,P=l.Point.convert(a.offset);let D=w.centerPoint.add(P);const N=w.pointLocation(D),G=l.LngLat.convert(a.center||N);this._normalizeCenter(G);const W=w.project(N),K=w.project(G).sub(W),de=w.zoomScale(f-T);let te,se;a.around&&(te=l.LngLat.convert(a.around),se=w.locationPoint(te));const xe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||f!==T,this._rotating=this._rotating||I!==g,this._pitching=this._pitching||y!==u,this._padding=!w.isPaddingEqual(b),this._easeId=a.easeId,this._prepareEase(m,a.noMoveStart,xe),this.terrain&&this._prepareElevation(G),this._ease(Ie=>{if(this._zooming&&(w.zoom=l.interpolate.number(T,f,Ie)),this._rotating&&(w.bearing=l.interpolate.number(I,g,Ie)),this._pitching&&(w.pitch=l.interpolate.number(u,y,Ie)),this._padding&&(w.interpolatePadding(c,b,Ie),D=w.centerPoint.add(P)),this.terrain&&!a.freezeElevation&&this._updateElevation(Ie),te)w.setLocationAtPoint(te,se);else{const Fe=w.zoomScale(w.zoom-T),Re=f>T?Math.min(2,de):Math.max(.5,de),Be=Math.pow(Re,1-Ie),Le=w.unproject(W.add(K.mult(Ie*Be)).mult(Fe));w.setLocationAtPoint(w.renderWorldCopies?Le.wrap():Le,D)}this._applyUpdatedTransform(w),this._fireMoveEvents(m)},Ie=>{this.terrain&&this._finalizeElevation(),this._afterEase(m,Ie)},a),this}_prepareEase(a,m,w={}){this._moving=!0,m||w.moving||this.fire(new l.Event("movestart",a)),this._zooming&&!w.zooming&&this.fire(new l.Event("zoomstart",a)),this._rotating&&!w.rotating&&this.fire(new l.Event("rotatestart",a)),this._pitching&&!w.pitching&&this.fire(new l.Event("pitchstart",a))}_prepareElevation(a){this._elevationCenter=a,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(a){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const m=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(a<1&&m!==this._elevationTarget){const w=this._elevationTarget-this._elevationStart;this._elevationStart+=a*(w-(m-(w*a+this._elevationStart))/(1-a)),this._elevationTarget=m}this.transform.elevation=l.interpolate.number(this._elevationStart,this._elevationTarget,a)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(a){if(!this.transformCameraUpdate)return;const m=a.clone(),{center:w,zoom:T,pitch:I,bearing:u,elevation:c}=this.transformCameraUpdate(m);w&&(m.center=w),T!==void 0&&(m.zoom=T),I!==void 0&&(m.pitch=I),u!==void 0&&(m.bearing=u),c!==void 0&&(m.elevation=c),this.transform.apply(m)}_fireMoveEvents(a){this.fire(new l.Event("move",a)),this._zooming&&this.fire(new l.Event("zoom",a)),this._rotating&&this.fire(new l.Event("rotate",a)),this._pitching&&this.fire(new l.Event("pitch",a))}_afterEase(a,m){if(this._easeId&&m&&this._easeId===m)return;delete this._easeId;const w=this._zooming,T=this._rotating,I=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new l.Event("zoomend",a)),T&&this.fire(new l.Event("rotateend",a)),I&&this.fire(new l.Event("pitchend",a)),this.fire(new l.Event("moveend",a))}flyTo(a,m){if(!a.essential&&l.browser.prefersReducedMotion){const Ct=l.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ct,m)}this.stop(),a=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.defaultEasing},a);const w=this._getTransformForUpdate(),T=this.getZoom(),I=this.getBearing(),u=this.getPitch(),c=this.getPadding(),f="zoom"in a?l.clamp(+a.zoom,w.minZoom,w.maxZoom):T,g="bearing"in a?this._normalizeBearing(a.bearing,I):I,y="pitch"in a?+a.pitch:u,b="padding"in a?a.padding:w.padding,P=w.zoomScale(f-T),D=l.Point.convert(a.offset);let N=w.centerPoint.add(D);const G=w.pointLocation(N),W=l.LngLat.convert(a.center||G);this._normalizeCenter(W);const K=w.project(G),de=w.project(W).sub(K);let te=a.curve;const se=Math.max(w.width,w.height),xe=se/P,Ie=de.mag();if("minZoom"in a){const Ct=l.clamp(Math.min(a.minZoom,T,f),w.minZoom,w.maxZoom),un=se/w.zoomScale(Ct-T);te=Math.sqrt(un/Ie*2)}const Fe=te*te;function Re(Ct){const un=(xe*xe-se*se+(Ct?-1:1)*Fe*Fe*Ie*Ie)/(2*(Ct?xe:se)*Fe*Ie);return Math.log(Math.sqrt(un*un+1)-un)}function Be(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function Le(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const At=Re(!1);let _t=function(Ct){return Le(At)/Le(At+te*Ct)},nt=function(Ct){return se*((Le(At)*(Be(un=At+te*Ct)/Le(un))-Be(At))/Fe)/Ie;var un},ct=(Re(!0)-At)/te;if(Math.abs(Ie)<1e-6||!isFinite(ct)){if(Math.abs(se-xe)<1e-6)return this.easeTo(a,m);const Ct=xe<se?-1:1;ct=Math.abs(Math.log(xe/se))/te,nt=function(){return 0},_t=function(un){return Math.exp(Ct*te*un)}}return a.duration="duration"in a?+a.duration:1e3*ct/("screenSpeed"in a?+a.screenSpeed/te:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this._zooming=!0,this._rotating=I!==g,this._pitching=y!==u,this._padding=!w.isPaddingEqual(b),this._prepareEase(m,!1),this.terrain&&this._prepareElevation(W),this._ease(Ct=>{const un=Ct*ct,Yt=1/_t(un);w.zoom=Ct===1?f:T+w.scaleZoom(Yt),this._rotating&&(w.bearing=l.interpolate.number(I,g,Ct)),this._pitching&&(w.pitch=l.interpolate.number(u,y,Ct)),this._padding&&(w.interpolatePadding(c,b,Ct),N=w.centerPoint.add(D)),this.terrain&&!a.freezeElevation&&this._updateElevation(Ct);const wt=Ct===1?W:w.unproject(K.add(de.mult(nt(un))).mult(Yt));w.setLocationAtPoint(w.renderWorldCopies?wt.wrap():wt,N),this._applyUpdatedTransform(w),this._fireMoveEvents(m)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(m)},a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,m)}if(!a){const w=this.handlers;w&&w.stop(!1)}return this}_ease(a,m,w){w.animate===!1||w.duration===0?(a(1),m()):(this._easeStart=l.browser.now(),this._easeOptions=w,this._onEaseFrame=a,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(a,m){a=l.wrap(a,-180,180);const w=Math.abs(a-m);return Math.abs(a-360-m)<w&&(a-=360),Math.abs(a+360-m)<w&&(a+=360),a}_normalizeCenter(a){const m=this.transform;if(!m.renderWorldCopies||m.lngRange)return;const w=a.lng-m.center.lng;a.lng+=w>180?-360:w<-180?360:0}queryTerrainElevation(a){return this.terrain?this.terrain.getElevationForLngLatZoom(l.LngLat.convert(a),this.transform.tileZoom)-this.transform.elevation:null}}class jr{constructor(a={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=m=>{!m||m.sourceDataType!=="metadata"&&m.sourceDataType!=="visibility"&&m.dataType!=="style"&&m.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=a}getDefaultPosition(){return"bottom-right"}onAdd(a){return this._map=a,this._compact=this.options&&this.options.compact,this._container=k.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=k.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(a,m){const w=this._map._getUIString(`AttributionControl.${m}`);a.title=w,a.setAttribute("aria-label",w)}_updateAttributions(){if(!this._map.style)return;let a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(T=>typeof T!="string"?"":T)):typeof this.options.customAttribution=="string"&&a.push(this.options.customAttribution)),this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const m=this._map.style.sourceCaches;for(const T in m){const I=m[T];if(I.used||I.usedForTerrain){const u=I.getSource();u.attribution&&a.indexOf(u.attribution)<0&&a.push(u.attribution)}}a=a.filter(T=>String(T).trim()),a.sort((T,I)=>T.length-I.length),a=a.filter((T,I)=>{for(let u=I+1;u<a.length;u++)if(a[u].indexOf(T)>=0)return!1;return!0});const w=a.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,a.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Wi{constructor(a={}){this._updateCompact=()=>{const m=this._container.children;if(m.length){const w=m[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&w.classList.add("maplibregl-compact"):w.classList.remove("maplibregl-compact")}},this.options=a}getDefaultPosition(){return"bottom-left"}onAdd(a){this._map=a,this._compact=this.options&&this.options.compact,this._container=k.create("div","maplibregl-ctrl");const m=k.create("a","maplibregl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://maplibre.org/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){k.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class gt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const m=++this._id;return this._queue.push({callback:a,id:m,cancelled:!1}),m}remove(a){const m=this._currentlyRunning,w=m?this._queue.concat(m):this._queue;for(const T of w)if(T.id===a)return void(T.cancelled=!0)}run(a=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const m=this._currentlyRunning=this._queue;this._queue=[];for(const w of m)if(!w.cancelled&&(w.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Jt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var ol=l.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class pa extends l.Evented{constructor(a){super(),this.sourceCache=a,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,a.usedForTerrain=!0,a.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(a,m){this.sourceCache.update(a,m),this._renderableTilesKeys=[];const w={};for(const T of a.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:m}))w[T.key]=!0,this._renderableTilesKeys.push(T.key),this._tiles[T.key]||(T.posMatrix=new Float64Array(16),l.ortho(T.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),this._tiles[T.key]=new Ns(T,this.tileSize));for(const T in this._tiles)w[T]||delete this._tiles[T]}freeRtt(a){for(const m in this._tiles){const w=this._tiles[m];(!a||w.tileID.equals(a)||w.tileID.isChildOf(a)||a.isChildOf(w.tileID))&&(w.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(a=>this.getTileByID(a))}getTileByID(a){return this._tiles[a]}getTerrainCoords(a){const m={};for(const w of this._renderableTilesKeys){const T=this._tiles[w].tileID;if(T.canonical.equals(a.canonical)){const I=a.clone();I.posMatrix=new Float64Array(16),l.ortho(I.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),m[w]=I}else if(T.canonical.isChildOf(a.canonical)){const I=a.clone();I.posMatrix=new Float64Array(16);const u=T.canonical.z-a.canonical.z,c=T.canonical.x-(T.canonical.x>>u<<u),f=T.canonical.y-(T.canonical.y>>u<<u),g=l.EXTENT>>u;l.ortho(I.posMatrix,0,g,0,g,0,1),l.translate(I.posMatrix,I.posMatrix,[-c*g,-f*g,0]),m[w]=I}else if(a.canonical.isChildOf(T.canonical)){const I=a.clone();I.posMatrix=new Float64Array(16);const u=a.canonical.z-T.canonical.z,c=a.canonical.x-(a.canonical.x>>u<<u),f=a.canonical.y-(a.canonical.y>>u<<u),g=l.EXTENT>>u;l.ortho(I.posMatrix,0,l.EXTENT,0,l.EXTENT,0,1),l.translate(I.posMatrix,I.posMatrix,[c*g,f*g,0]),l.scale(I.posMatrix,I.posMatrix,[1/2**u,1/2**u,0]),m[w]=I}}return m}getSourceTile(a,m){const w=this.sourceCache._source;let T=a.overscaledZ-this.deltaZoom;if(T>w.maxzoom&&(T=w.maxzoom),T<w.minzoom)return null;this._sourceTileCache[a.key]||(this._sourceTileCache[a.key]=a.scaledTo(T).key);let I=this.sourceCache.getTileByID(this._sourceTileCache[a.key]);if((!I||!I.dem)&&m)for(;T>=w.minzoom&&(!I||!I.dem);)I=this.sourceCache.getTileByID(a.scaledTo(T--).key);return I}tilesAfterTime(a=Date.now()){return Object.values(this._tiles).filter(m=>m.timeAdded>=a)}}class MA{constructor(a,m,w){this.painter=a,this.sourceCache=new pa(m),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(a,m,w,T=l.EXTENT){var I;if(!(m>=0&&m<T&&w>=0&&w<T))return 0;const u=this.getTerrainData(a),c=(I=u.tile)===null||I===void 0?void 0:I.dem;if(!c)return 0;const f=function(N,G,W){var K=G[0],de=G[1];return N[0]=W[0]*K+W[4]*de+W[12],N[1]=W[1]*K+W[5]*de+W[13],N}([],[m/T*l.EXTENT,w/T*l.EXTENT],u.u_terrain_matrix),g=[f[0]*c.dim,f[1]*c.dim],y=Math.floor(g[0]),b=Math.floor(g[1]),P=g[0]-y,D=g[1]-b;return c.get(y,b)*(1-P)*(1-D)+c.get(y+1,b)*P*(1-D)+c.get(y,b+1)*(1-P)*D+c.get(y+1,b+1)*P*D}getElevationForLngLatZoom(a,m){const{tileID:w,mercatorX:T,mercatorY:I}=this._getOverscaledTileIDFromLngLatZoom(a,m);return this.getElevation(w,T%l.EXTENT,I%l.EXTENT,l.EXTENT)}getElevation(a,m,w,T=l.EXTENT){return this.getDEMElevation(a,m,w,T)*this.exaggeration}getTerrainData(a){if(!this._emptyDemTexture){const T=this.painter.context,I=new l.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ht(T,I,T.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ht(T,new l.RGBAImage({width:1,height:1}),T.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(T.gl.NEAREST,T.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.identity([])}const m=this.sourceCache.getSourceTile(a,!0);if(m&&m.dem&&(!m.demTexture||m.needsTerrainPrepare)){const T=this.painter.context;m.demTexture=this.painter.getTileTexture(m.dem.stride),m.demTexture?m.demTexture.update(m.dem.getPixels(),{premultiply:!1}):m.demTexture=new ht(T,m.dem.getPixels(),T.gl.RGBA,{premultiply:!1}),m.demTexture.bind(T.gl.NEAREST,T.gl.CLAMP_TO_EDGE),m.needsTerrainPrepare=!1}const w=m&&m+m.tileID.key+a.key;if(w&&!this._demMatrixCache[w]){const T=this.sourceCache.sourceCache._source.maxzoom;let I=a.canonical.z-m.tileID.canonical.z;a.overscaledZ>a.canonical.z&&(a.canonical.z>=T?I=a.canonical.z-T:l.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const u=a.canonical.x-(a.canonical.x>>I<<I),c=a.canonical.y-(a.canonical.y>>I<<I),f=l.fromScaling(new Float64Array(16),[1/(l.EXTENT<<I),1/(l.EXTENT<<I),0]);l.translate(f,f,[u*l.EXTENT,c*l.EXTENT,0]),this._demMatrixCache[a.key]={matrix:f,coord:a}}return{u_depth:2,u_terrain:3,u_terrain_dim:m&&m.dem&&m.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[a.key].matrix:this._emptyDemMatrix,u_terrain_unpack:m&&m.dem&&m.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(m&&m.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:m}}getFramebuffer(a){const m=this.painter,w=m.width/devicePixelRatio,T=m.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===T||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ht(m.context,{width:w,height:T,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ht(m.context,{width:w,height:T,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=m.context.createFramebuffer(w,T,!0,!1),this._fbo.depthAttachment.set(m.context.createRenderbuffer(m.context.gl.DEPTH_COMPONENT16,w,T))),this._fbo.colorAttachment.set(a==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const a=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const m=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let I=0,u=0;I<this._coordsTextureSize;I++)for(let c=0;c<this._coordsTextureSize;c++,u+=4)m[u+0]=255&c,m[u+1]=255&I,m[u+2]=c>>8<<4|I>>8,m[u+3]=0;const w=new l.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(m.buffer)),T=new ht(a,w,a.gl.RGBA,{premultiply:!1});return T.bind(a.gl.NEAREST,a.gl.CLAMP_TO_EDGE),this._coordsTexture=T,T}pointCoordinate(a){const m=new Uint8Array(4),w=this.painter.context,T=w.gl;w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),T.readPixels(a.x,this.painter.height/devicePixelRatio-a.y-1,1,1,T.RGBA,T.UNSIGNED_BYTE,m),w.bindFramebuffer.set(null);const I=m[0]+(m[2]>>4<<8),u=m[1]+((15&m[2])<<8),c=this.coordsIndex[255-m[3]],f=c&&this.sourceCache.getTileByID(c);if(!f)return null;const g=this._coordsTextureSize,y=(1<<f.tileID.canonical.z)*g;return new l.MercatorCoordinate((f.tileID.canonical.x*g+I)/y,(f.tileID.canonical.y*g+u)/y,this.getElevation(f.tileID,I,u,g))}getTerrainMesh(){if(this._mesh)return this._mesh;const a=this.painter.context,m=new l.Pos3dArray,w=new l.TriangleIndexArray,T=this.meshSize,I=l.EXTENT/T,u=T*T;for(let b=0;b<=T;b++)for(let P=0;P<=T;P++)m.emplaceBack(P*I,b*I,0);for(let b=0;b<u;b+=T+1)for(let P=0;P<T;P++)w.emplaceBack(P+b,T+P+b+1,T+P+b+2),w.emplaceBack(P+b,T+P+b+2,P+b+1);const c=m.length,f=c+2*(T+1);for(const b of[0,1])for(let P=0;P<=T;P++)for(const D of[0,1])m.emplaceBack(P*I,b*l.EXTENT,D);for(let b=0;b<2*T;b+=2)w.emplaceBack(f+b,f+b+1,f+b+3),w.emplaceBack(f+b,f+b+3,f+b+2),w.emplaceBack(c+b,c+b+3,c+b+1),w.emplaceBack(c+b,c+b+2,c+b+3);const g=m.length,y=g+2*(T+1);for(const b of[0,1])for(let P=0;P<=T;P++)for(const D of[0,1])m.emplaceBack(b*l.EXTENT,P*I,D);for(let b=0;b<2*T;b+=2)w.emplaceBack(g+b,g+b+1,g+b+3),w.emplaceBack(g+b,g+b+3,g+b+2),w.emplaceBack(y+b,y+b+3,y+b+1),w.emplaceBack(y+b,y+b+2,y+b+3);return this._mesh={indexBuffer:a.createIndexBuffer(w),vertexBuffer:a.createVertexBuffer(m,ol.members),segments:l.SegmentVector.simpleSegment(0,0,m.length,w.length)},this._mesh}getMeshFrameDelta(a){return 2*Math.PI*l.earthRadius/Math.pow(2,a)/5}getMinTileElevationForLngLatZoom(a,m){var w;const{tileID:T}=this._getOverscaledTileIDFromLngLatZoom(a,m);return(w=this.getMinMaxElevation(T).minElevation)!==null&&w!==void 0?w:0}getMinMaxElevation(a){const m=this.getTerrainData(a).tile,w={minElevation:null,maxElevation:null};return m&&m.dem&&(w.minElevation=m.dem.min*this.exaggeration,w.maxElevation=m.dem.max*this.exaggeration),w}_getOverscaledTileIDFromLngLatZoom(a,m){const w=l.MercatorCoordinate.fromLngLat(a.wrap()),T=(1<<m)*l.EXTENT,I=w.x*T,u=w.y*T,c=Math.floor(I/l.EXTENT),f=Math.floor(u/l.EXTENT);return{tileID:new l.OverscaledTileID(m,0,m,c,f),mercatorX:I,mercatorY:u}}}class br{constructor(a,m,w){this._context=a,this._size=m,this._tileSize=w,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const a of this._objects)a.texture.destroy(),a.fbo.destroy()}_createObject(a){const m=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),w=new ht(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return w.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),m.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),m.colorAttachment.set(w.texture),{id:a,fbo:m,texture:w,stamp:-1,inUse:!1}}getObjectForId(a){return this._objects[a]}useObject(a){a.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(m=>a.id!==m),this._recentlyUsed.push(a.id)}stampObject(a){a.stamp=++this._stamp}getOrCreateFreeObject(){for(const m of this._recentlyUsed)if(!this._objects[m].inUse)return this._objects[m];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const a=this._createObject(this._objects.length);return this._objects.push(a),a}freeObject(a){a.inUse=!1}freeAllObjects(){for(const a of this._objects)this.freeObject(a)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(a=>!a.inUse)===!1}}const Er={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class xt{constructor(a,m){this.painter=a,this.terrain=m,this.pool=new br(a.context,30,m.sourceCache.tileSize*m.qualityFactor)}destruct(){this.pool.destruct()}getTexture(a){return this.pool.getObjectForId(a.rtt[this._stacks.length-1].id).texture}prepareForRender(a,m){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=a._order.filter(w=>!a._layers[w].isHidden(m)),this._coordsDescendingInv={};for(const w in a.sourceCaches){this._coordsDescendingInv[w]={};const T=a.sourceCaches[w].getVisibleCoordinates();for(const I of T){const u=this.terrain.sourceCache.getTerrainCoords(I);for(const c in u)this._coordsDescendingInv[w][c]||(this._coordsDescendingInv[w][c]=[]),this._coordsDescendingInv[w][c].push(u[c])}}this._coordsDescendingInvStr={};for(const w of a._order){const T=a._layers[w],I=T.source;if(Er[T.type]&&!this._coordsDescendingInvStr[I]){this._coordsDescendingInvStr[I]={};for(const u in this._coordsDescendingInv[I])this._coordsDescendingInvStr[I][u]=this._coordsDescendingInv[I][u].map(c=>c.key).sort().join()}}for(const w of this._renderableTiles)for(const T in this._coordsDescendingInvStr){const I=this._coordsDescendingInvStr[T][w.tileID.key];I&&I!==w.rttCoords[T]&&(w.rtt=[])}}renderLayer(a){if(a.isHidden(this.painter.transform.zoom))return!1;const m=a.type,w=this.painter,T=this._renderableLayerIds[this._renderableLayerIds.length-1]===a.id;if(Er[m]&&(this._prevType&&Er[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(a.id),!T))return!0;if(Er[this._prevType]||Er[m]&&T){this._prevType=m;const I=this._stacks.length-1,u=this._stacks[I]||[];for(const c of this._renderableTiles){if(this.pool.isFull()&&(Mo(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(c),c.rtt[I]){const g=this.pool.getObjectForId(c.rtt[I].id);if(g.stamp===c.rtt[I].stamp){this.pool.useObject(g);continue}}const f=this.pool.getOrCreateFreeObject();this.pool.useObject(f),this.pool.stampObject(f),c.rtt[I]={id:f.id,stamp:f.stamp},w.context.bindFramebuffer.set(f.fbo.framebuffer),w.context.clear({color:l.Color.transparent,stencil:0}),w.currentStencilSource=void 0;for(let g=0;g<u.length;g++){const y=w.style._layers[u[g]],b=y.source?this._coordsDescendingInv[y.source][c.tileID.key]:[c.tileID];w.context.viewport.set([0,0,f.fbo.width,f.fbo.height]),w._renderTileClippingMasks(y,b),w.renderLayer(w,w.style.sourceCaches[y.source],y,b),y.source&&(c.rttCoords[y.source]=this._coordsDescendingInvStr[y.source][c.tileID.key])}}return Mo(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Er[m]}return!1}}const qt=S,Wa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},ai=M=>{M.touchstart=M.dragStart,M.touchmoveWindow=M.dragMove,M.touchend=M.dragEnd},pi={showCompass:!0,showZoom:!0,visualizePitch:!1};class gs{constructor(a,m,w=!1){this.mousedown=u=>{this.startMouse(l.extend({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),k.mousePos(this.element,u)),k.addEventListener(window,"mousemove",this.mousemove),k.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=u=>{this.moveMouse(u,k.mousePos(this.element,u))},this.mouseup=u=>{this.mouseRotate.dragEnd(u),this.mousePitch&&this.mousePitch.dragEnd(u),this.offTemp()},this.touchstart=u=>{u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,u.targetTouches)[0],this.startTouch(u,this._startPos),k.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.addEventListener(window,"touchend",this.touchend))},this.touchmove=u=>{u.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,u.targetTouches)[0],this.moveTouch(u,this._lastPos))},this.touchend=u=>{u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const T=a.dragRotate._mouseRotate.getClickTolerance(),I=a.dragRotate._mousePitch.getClickTolerance();this.element=m,this.mouseRotate=EA({clickTolerance:T,enable:!0}),this.touchRotate=(({enable:u,clickTolerance:c,bearingDegreesPerPixelMoved:f=.8})=>{const g=new zl;return new Ga({clickTolerance:c,move:(y,b)=>({bearingDelta:(b.x-y.x)*f}),moveStateManager:g,enable:u,assignEvents:ai})})({clickTolerance:T,enable:!0}),this.map=a,w&&(this.mousePitch=TA({clickTolerance:I,enable:!0}),this.touchPitch=(({enable:u,clickTolerance:c,pitchDegreesPerPixelMoved:f=-.5})=>{const g=new zl;return new Ga({clickTolerance:c,move:(y,b)=>({pitchDelta:(b.y-y.y)*f}),moveStateManager:g,enable:u,assignEvents:ai})})({clickTolerance:I,enable:!0})),k.addEventListener(m,"mousedown",this.mousedown),k.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(m,"touchcancel",this.reset)}startMouse(a,m){this.mouseRotate.dragStart(a,m),this.mousePitch&&this.mousePitch.dragStart(a,m),k.disableDrag()}startTouch(a,m){this.touchRotate.dragStart(a,m),this.touchPitch&&this.touchPitch.dragStart(a,m),k.disableDrag()}moveMouse(a,m){const w=this.map,{bearingDelta:T}=this.mouseRotate.dragMove(a,m)||{};if(T&&w.setBearing(w.getBearing()+T),this.mousePitch){const{pitchDelta:I}=this.mousePitch.dragMove(a,m)||{};I&&w.setPitch(w.getPitch()+I)}}moveTouch(a,m){const w=this.map,{bearingDelta:T}=this.touchRotate.dragMove(a,m)||{};if(T&&w.setBearing(w.getBearing()+T),this.touchPitch){const{pitchDelta:I}=this.touchPitch.dragMove(a,m)||{};I&&w.setPitch(w.getPitch()+I)}}off(){const a=this.element;k.removeEventListener(a,"mousedown",this.mousedown),k.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend),k.removeEventListener(a,"touchcancel",this.reset),this.offTemp()}offTemp(){k.enableDrag(),k.removeEventListener(window,"mousemove",this.mousemove),k.removeEventListener(window,"mouseup",this.mouseup),k.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),k.removeEventListener(window,"touchend",this.touchend)}}let Bi;function Pi(M,a,m){if(M=new l.LngLat(M.lng,M.lat),a){const w=new l.LngLat(M.lng-360,M.lat),T=new l.LngLat(M.lng+360,M.lat),I=m.locationPoint(M).distSqr(a);m.locationPoint(w).distSqr(a)<I?M=w:m.locationPoint(T).distSqr(a)<I&&(M=T)}for(;Math.abs(M.lng-m.center.lng)>180;){const w=m.locationPoint(M);if(w.x>=0&&w.y>=0&&w.x<=m.width&&w.y<=m.height)break;M.lng>m.center.lng?M.lng-=360:M.lng+=360}return M}const _={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function v(M,a,m){const w=M.classList;for(const T in _)w.remove(`maplibregl-${m}-anchor-${T}`);w.add(`maplibregl-${m}-anchor-${a}`)}class E extends l.Evented{constructor(a){if(super(),this._onKeyPress=m=>{const w=m.code,T=m.charCode||m.keyCode;w!=="Space"&&w!=="Enter"&&T!==32&&T!==13||this.togglePopup()},this._onMapClick=m=>{const w=m.originalEvent.target,T=this._element;this._popup&&(w===T||T.contains(w))&&this.togglePopup()},this._update=m=>{if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Pi(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let w="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?w=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(w=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),m&&m.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,`${_[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${w}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const I=this._map.unproject(this._pos),u=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=I.distanceTo(this._lngLat)>20*u?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=m=>{if(!this._isDragging){const w=this._clickTolerance||this._map._clickTolerance;this._isDragging=m.point.dist(this._pointerdownPos)>=w}this._isDragging&&(this._pos=m.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.Event("dragend")),this._state="inactive"},this._addDragHandler=m=>{this._element.contains(m.originalEvent.target)&&(m.preventDefault(),this._positionDelta=m.point.sub(this._pos).add(this._offset),this._pointerdownPos=m.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment!=="auto"?a.pitchAlignment:this._rotationAlignment,a&&a.element)this._element=a.element,this._offset=l.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div"),this._element.setAttribute("aria-label","Map marker");const m=k.createNS("http://www.w3.org/2000/svg","svg"),w=41,T=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${w}px`),m.setAttributeNS(null,"width",`${T}px`),m.setAttributeNS(null,"viewBox",`0 0 ${T} ${w}`);const I=k.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"stroke","none"),I.setAttributeNS(null,"stroke-width","1"),I.setAttributeNS(null,"fill","none"),I.setAttributeNS(null,"fill-rule","evenodd");const u=k.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill-rule","nonzero");const c=k.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"transform","translate(3.0, 29.0)"),c.setAttributeNS(null,"fill","#000000");const f=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const K of f){const de=k.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",K.rx),de.setAttributeNS(null,"ry",K.ry),c.appendChild(de)}const g=k.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill",this._color);const y=k.createNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),g.appendChild(y);const b=k.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"opacity","0.25"),b.setAttributeNS(null,"fill","#000000");const P=k.createNS("http://www.w3.org/2000/svg","path");P.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),b.appendChild(P);const D=k.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"transform","translate(6.0, 7.0)"),D.setAttributeNS(null,"fill","#FFFFFF");const N=k.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(8.0, 8.0)");const G=k.createNS("http://www.w3.org/2000/svg","circle");G.setAttributeNS(null,"fill","#000000"),G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"cx","5.5"),G.setAttributeNS(null,"cy","5.5"),G.setAttributeNS(null,"r","5.4999962");const W=k.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#FFFFFF"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962"),N.appendChild(G),N.appendChild(W),u.appendChild(c),u.appendChild(g),u.appendChild(b),u.appendChild(D),u.appendChild(N),m.appendChild(u),m.setAttributeNS(null,"height",w*this._scale+"px"),m.setAttributeNS(null,"width",T*this._scale+"px"),this._element.appendChild(m),this._offset=l.Point.convert(a&&a.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()}),v(this._element,this._anchor,"marker"),a&&a.className)for(const m of a.className.split(" "))this._element.classList.add(m);this._popup=null}addTo(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=l.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const T=Math.abs(13.5)/Math.SQRT2;a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(38.1-13.5+T)],"bottom-right":[-T,-1*(38.1-13.5+T)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(a){return this._offset=l.Point.convert(a),this._update(),this}addClassName(a){this._element.classList.add(a)}removeClassName(a){this._element.classList.remove(a)}toggleClassName(a){return this._element.classList.toggle(a)}setDraggable(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a&&a!=="auto"?a:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const L={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let O=0,F=!1;const z={maxWidth:100,unit:"metric"};function Q(M,a,m){const w=m&&m.maxWidth||100,T=M._container.clientHeight/2,I=M.unproject([0,T]),u=M.unproject([w,T]),c=I.distanceTo(u);if(m&&m.unit==="imperial"){const f=3.2808*c;f>5280?Y(a,w,f/5280,M._getUIString("ScaleControl.Miles")):Y(a,w,f,M._getUIString("ScaleControl.Feet"))}else m&&m.unit==="nautical"?Y(a,w,c/1852,M._getUIString("ScaleControl.NauticalMiles")):c>=1e3?Y(a,w,c/1e3,M._getUIString("ScaleControl.Kilometers")):Y(a,w,c,M._getUIString("ScaleControl.Meters"))}function Y(M,a,m,w){const T=function(I){const u=Math.pow(10,`${Math.floor(I)}`.length-1);let c=I/u;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:c>=1?1:function(f){const g=Math.pow(10,Math.ceil(-Math.log(f)/Math.LN10));return Math.round(f*g)/g}(c),u*c}(m);M.style.width=a*(T/m)+"px",M.innerHTML=`${T}&nbsp;${w}`}const le={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pe=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Qe(M){if(M){if(typeof M=="number"){const a=Math.round(Math.abs(M)/Math.SQRT2);return{center:new l.Point(0,0),top:new l.Point(0,M),"top-left":new l.Point(a,a),"top-right":new l.Point(-a,a),bottom:new l.Point(0,-M),"bottom-left":new l.Point(a,-a),"bottom-right":new l.Point(-a,-a),left:new l.Point(M,0),right:new l.Point(-M,0)}}if(M instanceof l.Point||Array.isArray(M)){const a=l.Point.convert(M);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:l.Point.convert(M.center||[0,0]),top:l.Point.convert(M.top||[0,0]),"top-left":l.Point.convert(M["top-left"]||[0,0]),"top-right":l.Point.convert(M["top-right"]||[0,0]),bottom:l.Point.convert(M.bottom||[0,0]),"bottom-left":l.Point.convert(M["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(M["bottom-right"]||[0,0]),left:l.Point.convert(M.left||[0,0]),right:l.Point.convert(M.right||[0,0])}}return Qe(new l.Point(0,0))}const Te={extend:(M,...a)=>l.extend(M,...a),run(M){M()},logToElement(M,a=!1,m="log"){const w=window.document.getElementById(m);w&&(a&&(w.innerHTML=""),w.innerHTML+=`<br>${M}`)}},ze=S;class it{static get version(){return ze}static get workerCount(){return Yi.workerCount}static set workerCount(a){Yi.workerCount=a}static get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(a){l.config.MAX_PARALLEL_IMAGE_REQUESTS=a}static get workerUrl(){return l.config.WORKER_URL}static set workerUrl(a){l.config.WORKER_URL=a}static addProtocol(a,m){l.config.REGISTERED_PROTOCOLS[a]=m}static removeProtocol(a){delete l.config.REGISTERED_PROTOCOLS[a]}}return it.Map=class extends Ec{constructor(M){if(l.PerformanceUtils.mark(l.PerformanceMarkers.create),(M=l.extend({},Wa,M)).minZoom!=null&&M.maxZoom!=null&&M.minZoom>M.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(M.minPitch!=null&&M.maxPitch!=null&&M.minPitch>M.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(M.minPitch!=null&&M.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(M.maxPitch!=null&&M.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new fs(M.minZoom,M.maxZoom,M.minPitch,M.maxPitch,M.renderWorldCopies),{bearingSnap:M.bearingSnap}),this._cooperativeGesturesOnWheel=a=>{this._onCooperativeGesture(a,a[this._metaKey],1)},this._contextLost=a=>{a.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=M.interactive,this._cooperativeGestures=M.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=M.maxTileCacheSize,this._maxTileCacheZoomLevels=M.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=M.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=M.preserveDrawingBuffer,this._antialias=M.antialias,this._trackResize=M.trackResize,this._bearingSnap=M.bearingSnap,this._refreshExpiredTiles=M.refreshExpiredTiles,this._fadeDuration=M.fadeDuration,this._crossSourceCollisions=M.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=M.collectResourceTiming,this._renderTaskQueue=new gt,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Jt,M.locale),this._clickTolerance=M.clickTolerance,this._overridePixelRatio=M.pixelRatio,this._maxCanvasSize=M.maxCanvasSize,this.transformCameraUpdate=M.transformCameraUpdate,this._imageQueueHandle=we.addThrottleControl(()=>this.isMoving()),this._requestManager=new Ae(M.transformRequest),typeof M.container=="string"){if(this._container=document.getElementById(M.container),!this._container)throw new Error(`Container '${M.container}' not found.`)}else{if(!(M.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=M.container}if(M.maxBounds&&this.setMaxBounds(M.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const m=Vr(w=>{this._trackResize&&!this._removed&&this.resize(w)._update()},50);this._resizeObserver=new ResizeObserver(w=>{a?m(w):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ci(this,M),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=M.hash&&new Cu(typeof M.hash=="string"&&M.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:M.center,zoom:M.zoom,bearing:M.bearing,pitch:M.pitch}),M.bounds&&(this.resize(),this.fitBounds(M.bounds,l.extend({},M.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=M.localIdeographFontFamily,this._validateStyle=M.validateStyle,M.style&&this.setStyle(M.style,{localIdeographFontFamily:M.localIdeographFontFamily}),M.attributionControl&&this.addControl(new jr({customAttribution:M.customAttribution})),M.maplibreLogo&&this.addControl(new Wi,M.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new l.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new l.Event(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new l.Event("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(M,a){if(a===void 0&&(a=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=M.onAdd(this);this._controls.push(M);const w=this._controlPositions[a];return a.indexOf("bottom")!==-1?w.insertBefore(m,w.firstChild):w.appendChild(m),this}removeControl(M){if(!M||!M.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(M);return a>-1&&this._controls.splice(a,1),M.onRemove(this),this}hasControl(M){return this._controls.indexOf(M)>-1}calculateCameraOptionsFromTo(M,a,m,w){return w==null&&this.terrain&&(w=this.terrain.getElevationForLngLatZoom(m,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(M,a,m,w)}resize(M){var a;const m=this._containerDimensions(),w=m[0],T=m[1],I=this._getClampedPixelRatio(w,T);if(this._resizeCanvas(w,T,I),this.painter.resize(w,T,I),this.painter.overLimit()){const c=this.painter.context.gl;this._maxCanvasSize=[c.drawingBufferWidth,c.drawingBufferHeight];const f=this._getClampedPixelRatio(w,T);this._resizeCanvas(w,T,f),this.painter.resize(w,T,f)}this.transform.resize(w,T),(a=this._requestedCameraState)===null||a===void 0||a.resize(w,T);const u=!this._moving;return u&&(this.stop(),this.fire(new l.Event("movestart",M)).fire(new l.Event("move",M))),this.fire(new l.Event("resize",M)),u&&this.fire(new l.Event("moveend",M)),this}_getClampedPixelRatio(M,a){const{0:m,1:w}=this._maxCanvasSize,T=this.getPixelRatio(),I=M*T,u=a*T;return Math.min(I>m?m/I:1,u>w?w/u:1)*T}getPixelRatio(){var M;return(M=this._overridePixelRatio)!==null&&M!==void 0?M:devicePixelRatio}setPixelRatio(M){this._overridePixelRatio=M,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(M){return this.transform.setMaxBounds(Un.convert(M)),this._update()}setMinZoom(M){if((M=M??-2)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(M){if((M=M??22)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(M){if((M=M??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(M){if((M=M??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(M){return this.transform.renderWorldCopies=M,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(M){return this._cooperativeGestures=M,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(M){return this.transform.locationPoint(l.LngLat.convert(M),this.style&&this.terrain)}unproject(M){return this.transform.pointLocation(l.Point.convert(M),this.terrain)}isMoving(){var M;return this._moving||((M=this.handlers)===null||M===void 0?void 0:M.isMoving())}isZooming(){var M;return this._zooming||((M=this.handlers)===null||M===void 0?void 0:M.isZooming())}isRotating(){var M;return this._rotating||((M=this.handlers)===null||M===void 0?void 0:M.isRotating())}_createDelegatedListener(M,a,m){if(M==="mouseenter"||M==="mouseover"){let w=!1;return{layer:a,listener:m,delegates:{mousemove:I=>{const u=this.getLayer(a)?this.queryRenderedFeatures(I.point,{layers:[a]}):[];u.length?w||(w=!0,m.call(this,new Di(M,this,I.originalEvent,{features:u}))):w=!1},mouseout:()=>{w=!1}}}}if(M==="mouseleave"||M==="mouseout"){let w=!1;return{layer:a,listener:m,delegates:{mousemove:u=>{(this.getLayer(a)?this.queryRenderedFeatures(u.point,{layers:[a]}):[]).length?w=!0:w&&(w=!1,m.call(this,new Di(M,this,u.originalEvent)))},mouseout:u=>{w&&(w=!1,m.call(this,new Di(M,this,u.originalEvent)))}}}}{const w=T=>{const I=this.getLayer(a)?this.queryRenderedFeatures(T.point,{layers:[a]}):[];I.length&&(T.features=I,m.call(this,T),delete T.features)};return{layer:a,listener:m,delegates:{[M]:w}}}}on(M,a,m){if(m===void 0)return super.on(M,a);const w=this._createDelegatedListener(M,a,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push(w);for(const T in w.delegates)this.on(T,w.delegates[T]);return this}once(M,a,m){if(m===void 0)return super.once(M,a);const w=this._createDelegatedListener(M,a,m);for(const T in w.delegates)this.once(T,w.delegates[T]);return this}off(M,a,m){return m===void 0?super.off(M,a):(this._delegatedListeners&&this._delegatedListeners[M]&&(w=>{const T=this._delegatedListeners[M];for(let I=0;I<T.length;I++){const u=T[I];if(u.layer===a&&u.listener===m){for(const c in u.delegates)this.off(c,u.delegates[c]);return T.splice(I,1),this}}})(),this)}queryRenderedFeatures(M,a){if(!this.style)return[];let m;const w=M instanceof l.Point||Array.isArray(M),T=w?M:[[0,0],[this.transform.width,this.transform.height]];if(a=a||(w?{}:M)||{},T instanceof l.Point||typeof T[0]=="number")m=[l.Point.convert(T)];else{const I=l.Point.convert(T[0]),u=l.Point.convert(T[1]);m=[I,new l.Point(u.x,I.y),u,new l.Point(I.x,u.y),I]}return this.style.queryRenderedFeatures(m,a,this.transform)}querySourceFeatures(M,a){return this.style.querySourceFeatures(M,a)}setStyle(M,a){return(a=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},a)).diff!==!1&&a.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._updateStyle(M,a))}setTransformRequest(M){return this._requestManager.setTransformRequest(M),this}_getUIString(M){const a=this._locale[M];if(a==null)throw new Error(`Missing UI string '${M}'`);return a}_updateStyle(M,a){if(a.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(M,a));const m=this.style&&a.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!M)),M?(this.style=new bi(this,a||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M,a,m):this.style.loadJSON(M,a,m),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new bi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(M,a){if(typeof M=="string"){const m=this._requestManager.transformRequest(M,ie.Style);l.getJSON(m,(w,T)=>{w?this.fire(new l.ErrorEvent(w)):T&&this._updateDiff(T,a)})}else typeof M=="object"&&this._updateDiff(M,a)}_updateDiff(M,a){try{this.style.setState(M,a)&&this._update(!0)}catch(m){l.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(M,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(M,a){return this._lazyInitEmptyStyle(),this.style.addSource(M,a),this._update(!0)}isSourceLoaded(M){const a=this.style&&this.style.sourceCaches[M];if(a!==void 0)return a.loaded();this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${M}'`)))}setTerrain(M){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),M){const a=this.style.sourceCaches[M.source];if(!a)throw new Error(`cannot load terrain, because there exists no source with ID: ${M.source}`);for(const m in this.style._layers){const w=this.style._layers[m];w.type==="hillshade"&&w.source===M.source&&l.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new MA(this.painter,a,M),this.painter.renderToTexture=new xt(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=m=>{m.dataType==="style"?this.terrain.sourceCache.freeRtt():m.dataType==="source"&&m.tile&&(m.sourceId!==M.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(m.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.Event("terrain",{terrain:M})),this}getTerrain(){var M,a;return(a=(M=this.terrain)===null||M===void 0?void 0:M.options)!==null&&a!==void 0?a:null}areTilesLoaded(){const M=this.style&&this.style.sourceCaches;for(const a in M){const m=M[a]._tiles;for(const w in m){const T=m[w];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}addSourceType(M,a,m){return this._lazyInitEmptyStyle(),this.style.addSourceType(M,a,m)}removeSource(M){return this.style.removeSource(M),this._update(!0)}getSource(M){return this.style.getSource(M)}addImage(M,a,m={}){const{pixelRatio:w=1,sdf:T=!1,stretchX:I,stretchY:u,content:c}=m;if(this._lazyInitEmptyStyle(),!(a instanceof HTMLImageElement||l.isImageBitmap(a))){if(a.width===void 0||a.height===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:f,height:g,data:y}=a,b=a;return this.style.addImage(M,{data:new l.RGBAImage({width:f,height:g},new Uint8Array(y)),pixelRatio:w,stretchX:I,stretchY:u,content:c,sdf:T,version:0,userImage:b}),b.onAdd&&b.onAdd(this,M),this}}{const{width:f,height:g,data:y}=l.browser.getImageData(a);this.style.addImage(M,{data:new l.RGBAImage({width:f,height:g},y),pixelRatio:w,stretchX:I,stretchY:u,content:c,sdf:T,version:0})}}updateImage(M,a){const m=this.style.getImage(M);if(!m)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=a instanceof HTMLImageElement||l.isImageBitmap(a)?l.browser.getImageData(a):a,{width:T,height:I,data:u}=w;if(T===void 0||I===void 0)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(T!==m.data.width||I!==m.data.height)return this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const c=!(a instanceof HTMLImageElement||l.isImageBitmap(a));return m.data.replace(u,c),this.style.updateImage(M,m),this}getImage(M){return this.style.getImage(M)}hasImage(M){return M?!!this.style.getImage(M):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(M){this.style.removeImage(M)}loadImage(M,a){we.getImage(this._requestManager.transformRequest(M,ie.Image),a)}listImages(){return this.style.listImages()}addLayer(M,a){return this._lazyInitEmptyStyle(),this.style.addLayer(M,a),this._update(!0)}moveLayer(M,a){return this.style.moveLayer(M,a),this._update(!0)}removeLayer(M){return this.style.removeLayer(M),this._update(!0)}getLayer(M){return this.style.getLayer(M)}setLayerZoomRange(M,a,m){return this.style.setLayerZoomRange(M,a,m),this._update(!0)}setFilter(M,a,m={}){return this.style.setFilter(M,a,m),this._update(!0)}getFilter(M){return this.style.getFilter(M)}setPaintProperty(M,a,m,w={}){return this.style.setPaintProperty(M,a,m,w),this._update(!0)}getPaintProperty(M,a){return this.style.getPaintProperty(M,a)}setLayoutProperty(M,a,m,w={}){return this.style.setLayoutProperty(M,a,m,w),this._update(!0)}getLayoutProperty(M,a){return this.style.getLayoutProperty(M,a)}setGlyphs(M,a={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(M,a),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(M,a,m={}){return this._lazyInitEmptyStyle(),this.style.addSprite(M,a,m,w=>{w||this._update(!0)}),this}removeSprite(M){return this._lazyInitEmptyStyle(),this.style.removeSprite(M),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(M,a={}){return this._lazyInitEmptyStyle(),this.style.setSprite(M,a,m=>{m||this._update(!0)}),this}setLight(M,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(M,a),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(M,a){return this.style.setFeatureState(M,a),this._update()}removeFeatureState(M,a){return this.style.removeFeatureState(M,a),this._update()}getFeatureState(M){return this.style.getFeatureState(M)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let M=0,a=0;return this._container&&(M=this._container.clientWidth||400,a=this._container.clientHeight||300),[M,a]}_setupContainer(){const M=this._container;M.classList.add("maplibregl-map");const a=this._canvasContainer=k.create("div","maplibregl-canvas-container",M);this._interactive&&a.classList.add("maplibregl-interactive"),this._canvas=k.create("canvas","maplibregl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const m=this._containerDimensions(),w=this._getClampedPixelRatio(m[0],m[1]);this._resizeCanvas(m[0],m[1],w);const T=this._controlContainer=k.create("div","maplibregl-control-container",M),I=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(u=>{I[u]=k.create("div",`maplibregl-ctrl-${u} `,T)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=k.create("div","maplibregl-cooperative-gesture-screen",this._container);let M=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(M=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${M}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){k.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(M,a,m){this._canvas.width=Math.floor(m*M),this._canvas.height=Math.floor(m*a),this._canvas.style.width=`${M}px`,this._canvas.style.height=`${a}px`}_setupPainter(){const M={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let a=null;this._canvas.addEventListener("webglcontextcreationerror",w=>{a={requestedAttributes:M},w&&(a.statusMessage=w.statusMessage,a.type=w.type)},{once:!0});const m=this._canvas.getContext("webgl2",M)||this._canvas.getContext("webgl",M);if(!m){const w="Failed to initialize WebGL";throw a?(a.message=w,new Error(JSON.stringify(a))):new Error(w)}this.painter=new tr(m,this.transform),U.testSupport(m)}_onCooperativeGesture(M,a,m){return!a&&m<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(M){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(M){return this._update(),this._renderTaskQueue.add(M)}_cancelRenderFrame(M){this._renderTaskQueue.remove(M)}_render(M){const a=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),this._removed)return;let m=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const T=this.transform.zoom,I=l.browser.now();this.style.zoomHistory.update(T,I);const u=new l.EvaluationParameters(T,{now:I,fadeDuration:a,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),c=u.crossFadingFactor();c===1&&c===this._crossFadingFactor||(m=!0,this._crossFadingFactor=c),this.style.update(u)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,showPadding:this.showPadding}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.load),this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||m)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const w=this._sourcesDirty||this._styleDirty||this._placementDirty;return w||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||w||(this._fullyLoaded=!0,l.PerformanceUtils.mark(l.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var M;this._hash&&this._hash.remove();for(const m of this._controls)m.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),we.removeThrottleControl(this._imageQueueHandle),(M=this._resizeObserver)===null||M===void 0||M.disconnect();const a=this.painter.context.gl.getExtension("WEBGL_lose_context");a&&a.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),k.remove(this._canvasContainer),k.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.browser.frame(M=>{l.PerformanceUtils.frame(M),this._frame=null,this._render(M)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())}get showPadding(){return!!this._showPadding}set showPadding(M){this._showPadding!==M&&(this._showPadding=M,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())}get repaint(){return!!this._repaint}set repaint(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(M){this._vertices=M,this._update()}get version(){return qt}getCameraTargetElevation(){return this.transform.elevation}},it.NavigationControl=class{constructor(M){this._updateZoomButtons=()=>{const a=this._map.getZoom(),m=a===this._map.getMaxZoom(),w=a===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},this._rotateCompassArrow=()=>{const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=a},this._setButtonTitle=(a,m)=>{const w=this._map._getUIString(`NavigationControl.${m}`);a.title=w,a.setAttribute("aria-label",w)},this.options=l.extend({},pi,M),this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",a=>this._map.zoomIn({},{originalEvent:a})),k.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",a=>this._map.zoomOut({},{originalEvent:a})),k.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",a=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:a}):this._map.resetNorth({},{originalEvent:a})}),this._compassIcon=k.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(M){return this._map=M,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gs(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(M,a){const m=k.create("button",M,this._container);return m.type="button",m.addEventListener("click",a),m}},it.GeolocateControl=class extends l.Evented{constructor(M){super(),this._onSuccess=a=>{if(this._map){if(this._isOutOfMapMaxBounds(a))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",a)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(a),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(a),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.Event("geolocate",a)),this._finish()}},this._updateCamera=a=>{const m=new l.LngLat(a.coords.longitude,a.coords.latitude),w=a.coords.accuracy,T=this._map.getBearing(),I=l.extend({bearing:T},this.options.fitBoundsOptions),u=Un.fromLngLat(m,w);this._map.fitBounds(u,I,{geolocateSource:!0})},this._updateMarker=a=>{if(a){const m=new l.LngLat(a.coords.longitude,a.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=a.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=a=>{if(this._map){if(this.options.trackUserLocation)if(a.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(a.code===3&&F)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.Event("error",a)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=a=>{if(this._map){if(this._container.addEventListener("contextmenu",m=>m.preventDefault()),this._geolocateButton=k.create("button","maplibregl-ctrl-geolocate",this._container),k.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",a===!1){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{const m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new E({element:this._dotElement}),this._circleElement=k.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new E({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",m=>{m.geolocateSource||this._watchState!=="ACTIVE_LOCK"||m.originalEvent&&m.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}},this.options=l.extend({},L,M)}onAdd(M){return this._map=M,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(a,m=!1){Bi===void 0||m?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(w=>{Bi=w.state!=="denied",a(Bi)}).catch(()=>{Bi=!!window.navigator.geolocation,a(Bi)}):(Bi=!!window.navigator.geolocation,a(Bi)):a(Bi)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,O=0,F=!1}_isOutOfMapMaxBounds(M){const a=this._map.getMaxBounds(),m=M.coords;return a&&(m.longitude<a.getWest()||m.longitude>a.getEast()||m.latitude<a.getSouth()||m.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const M=this._map.getBounds(),a=M.getSouthEast(),m=M.getNorthEast(),w=a.distanceTo(m),T=Math.ceil(this._accuracy/(w/this._map._container.clientHeight)*2);this._circleElement.style.width=`${T}px`,this._circleElement.style.height=`${T}px`}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":O--,F=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let M;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),O++,O>1?(M={maximumAge:6e5,timeout:0},F=!0):(M=this.options.positionOptions,F=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,M)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},it.AttributionControl=jr,it.LogoControl=Wi,it.ScaleControl=class{constructor(M){this._onMove=()=>{Q(this._map,this._container,this.options)},this.setUnit=a=>{this.options.unit=a,Q(this._map,this._container,this.options)},this.options=l.extend({},z,M)}getDefaultPosition(){return"bottom-left"}onAdd(M){return this._map=M,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-scale",M.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},it.FullscreenControl=class extends l.Evented{constructor(M={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,M&&M.container&&(M.container instanceof HTMLElement?this._container=M.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(M){return this._map=M,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){k.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const M=this._fullscreenButton=k.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);k.create("span","maplibregl-ctrl-icon",M).setAttribute("aria-hidden","true"),M.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const M=this._getTitle();this._fullscreenButton.setAttribute("aria-label",M),this._fullscreenButton.title=M}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},it.TerrainControl=class{constructor(M){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=M}onAdd(M){return this._map=M,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=k.create("button","maplibregl-ctrl-terrain",this._container),k.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){k.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},it.Popup=class extends l.Evented{constructor(M){super(),this.remove=()=>(this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this),this._onMouseUp=a=>{this._update(a.point)},this._onMouseMove=a=>{this._update(a.point)},this._onDrag=a=>{this._update(a.point)},this._update=a=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=k.create("div","maplibregl-popup",this._map.getContainer()),this._tip=k.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const u of this.options.className.split(" "))this._container.classList.add(u);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Pi(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!a)return;const m=this._pos=this._trackPointer&&a?a:this._map.project(this._lngLat);let w=this.options.anchor;const T=Qe(this.options.offset);if(!w){const u=this._container.offsetWidth,c=this._container.offsetHeight;let f;f=m.y+T.bottom.y<c?["top"]:m.y>this._map.transform.height-c?["bottom"]:[],m.x<u/2?f.push("left"):m.x>this._map.transform.width-u/2&&f.push("right"),w=f.length===0?"bottom":f.join("-")}const I=m.add(T[w]).round();k.setTransform(this._container,`${_[w]} translate(${I.x}px,${I.y}px)`),v(this._container,w,"popup")},this._onClose=()=>{this.remove()},this.options=l.extend(Object.create(le),M)}addTo(M){return this._map&&this.remove(),this._map=M,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(M){return this._lngLat=l.LngLat.convert(M),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(M){return this.setDOMContent(document.createTextNode(M))}setHTML(M){const a=document.createDocumentFragment(),m=document.createElement("body");let w;for(m.innerHTML=M;w=m.firstChild,w;)a.appendChild(w);return this.setDOMContent(a)}getMaxWidth(){var M;return(M=this._container)===null||M===void 0?void 0:M.style.maxWidth}setMaxWidth(M){return this.options.maxWidth=M,this._update(),this}setDOMContent(M){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=k.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(M),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(M){this._container&&this._container.classList.add(M)}removeClassName(M){this._container&&this._container.classList.remove(M)}setOffset(M){return this.options.offset=M,this._update(),this}toggleClassName(M){if(this._container)return this._container.classList.toggle(M)}_createCloseButton(){this.options.closeButton&&(this._closeButton=k.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const M=this._container.querySelector(pe);M&&M.focus()}},it.Marker=E,it.Style=bi,it.LngLat=l.LngLat,it.LngLatBounds=Un,it.Point=l.Point,it.MercatorCoordinate=l.MercatorCoordinate,it.Evented=l.Evented,it.AJAXError=l.AJAXError,it.config=l.config,it.CanvasSource=ut,it.GeoJSONSource=Yn,it.ImageSource=vr,it.RasterDEMTileSource=kr,it.RasterTileSource=ti,it.VectorTileSource=qi,it.VideoSource=Lr,it.setRTLTextPlugin=l.setRTLTextPlugin,it.getRTLTextPluginStatus=l.getRTLTextPluginStatus,it.prewarm=function(){Wr().acquire(It)},it.clearPrewarmedResources=function(){const M=Dr;M&&(M.isPreloaded()&&M.numActive()===1?(M.release(It),Dr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Te.extend(it,{isSafari:l.isSafari,getPerformanceMetrics:l.PerformanceUtils.getPerformanceMetrics}),it});var d=r;return d})})(EI);var wU=EI.exports;const bU=$m(wU);function md(t){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},md(t)}function EU(t,e){if(md(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(md(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TU(t){var e=EU(t,"string");return md(e)==="symbol"?e:String(e)}function ae(t,e,n){return e=TU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ym(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Hx=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),vT=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);vT&&parseFloat(vT[1]);const SU="3.4.14";function pu(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Pg=typeof process!="object"||String(process)!=="[object process]"||process.browser,CU=typeof window<"u"&&typeof window.orientation<"u",xT=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);xT&&parseFloat(xT[1]);class PU{constructor(e,n){ae(this,"name",void 0),ae(this,"workerThread",void 0),ae(this,"isRunning",!0),ae(this,"result",void 0),ae(this,"_resolve",()=>{}),ae(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){pu(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){pu(this.isRunning),this.isRunning=!1,this._reject(e)}}let iy=class{terminate(){}};const ry=new Map;function MU(t){pu(t.source&&!t.url||!t.source&&t.url);let e=ry.get(t.source||t.url);return e||(t.url&&(e=IU(t.url),ry.set(t.url,e)),t.source&&(e=SI(t.source),ry.set(t.source,e))),pu(e),e}function IU(t){if(!t.startsWith("http"))return t;const e=kU(t);return SI(e)}function SI(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function kU(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function CI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(wT(t))i.add(t);else if(wT(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const r in t)CI(t[r],e,i)}}return n===void 0?Array.from(i):[]}function wT(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const sy=()=>{};class q2{static isSupported(){return typeof Worker<"u"&&Pg||typeof iy<"u"&&!Pg}constructor(e){ae(this,"name",void 0),ae(this,"source",void 0),ae(this,"url",void 0),ae(this,"terminated",!1),ae(this,"worker",void 0),ae(this,"onMessage",void 0),ae(this,"onError",void 0),ae(this,"_loadableURL","");const{name:n,source:i,url:r}=e;pu(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=sy,this.onError=A=>console.log(A),this.worker=Pg?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=sy,this.onError=sy,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||CI(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=MU({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new iy(i,{eval:!1})}else if(this.source)e=new iy(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class LU{static isSupported(){return q2.isSupported()}constructor(e){ae(this,"name","unnamed"),ae(this,"source",void 0),ae(this,"url",void 0),ae(this,"maxConcurrency",1),ae(this,"maxMobileConcurrency",1),ae(this,"onDebug",()=>{}),ae(this,"reuseWorkers",!0),ae(this,"props",{}),ae(this,"jobQueue",[]),ae(this,"idleQueue",[]),ae(this,"count",0),ae(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(A,d,l)=>A.done(l),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(A,d)=>A.error(d);const r=new Promise(A=>(this.jobQueue.push({name:e,onMessage:n,onError:i,onStart:A}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const i=new PU(n.name,e);e.onMessage=r=>n.onMessage(i,r.type,r.payload),e.onError=r=>n.onError(i,r),n.onStart(i);try{await i.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new q2({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return CU?this.maxMobileConcurrency:this.maxConcurrency}}const DU={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class nu{static isSupported(){return q2.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nu._workerFarm=nu._workerFarm||new nu({}),nu._workerFarm.setProps(e),nu._workerFarm}constructor(e){ae(this,"props",void 0),ae(this,"workerPools",new Map),this.props={...DU},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let A=this.workerPools.get(n);return A||(A=new LU({name:n,source:i,url:r}),A.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,A)),A}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}ae(nu,"_workerFarm",void 0);const BU="latest";function RU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&t.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let A=t.version;A==="latest"&&(A=BU);const d=A?"@".concat(A):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(d,"/dist/").concat(i)}return pu(r),r}function OU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:SU;pu(t,"no worker provided");const n=t.version;return!(!e||!n)}function zU(t,e){return!nu.isSupported()||!Pg&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function FU(t,e,n,i,r){const A=t.id,d=RU(t,n),S=nu.getWorkerFarm(n).getWorkerPool({name:A,url:d});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const k=await S.startJob("process-on-worker",NU.bind(null,r));return k.postMessage("process",{input:e,options:n,context:i}),await(await k.result).result}async function NU(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:A,options:d}=i;try{const l=await t(A,d);e.postMessage("done",{id:r,result:l})}catch(l){const S=l instanceof Error?l.message:"unknown error";e.postMessage("error",{id:r,error:S})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function UU(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let A=0;A<i.length;++A)if(i[A]!==r[A])return!1;return!0}function VU(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(l=>l instanceof ArrayBuffer?new Uint8Array(l):l),r=i.reduce((l,S)=>l+S.byteLength,0),A=new Uint8Array(r);let d=0;for(const l of i)A.set(l,d),d+=l.byteLength;return A.buffer}async function jU(t){const e=[];for await(const n of t)e.push(n);return VU(...e)}let GU="";const bT={};function QU(t){for(const e in bT)if(t.startsWith(e)){const n=bT[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(GU).concat(t)),t}function HU(t){return t&&typeof t=="object"&&t.isBuffer}function PI(t){if(HU(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function MI(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function WU(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const $U=t=>typeof t=="boolean",$f=t=>typeof t=="function",Wd=t=>t!==null&&typeof t=="object",ET=t=>Wd(t)&&t.constructor==={}.constructor,ZU=t=>t&&typeof t[Symbol.iterator]=="function",qU=t=>t&&typeof t[Symbol.asyncIterator]=="function",rh=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,sh=t=>typeof Blob<"u"&&t instanceof Blob,YU=t=>t&&typeof t=="object"&&t.isBuffer,XU=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Wd(t)&&$f(t.tee)&&$f(t.cancel)&&$f(t.getReader),KU=t=>Wd(t)&&$f(t.read)&&$f(t.pipe)&&$U(t.readable),II=t=>XU(t)||KU(t),JU=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,e7=/^([-\w.]+\/[-\w.+]+)/;function t7(t){const e=e7.exec(t);return e?e[1]:t}function TT(t){const e=JU.exec(t);return e?e[1]:""}const kI=/\?.*/;function n7(t){const e=t.match(kI);return e&&e[0]}function Wx(t){return t.replace(kI,"")}function d_(t){return rh(t)?t.url:sh(t)?t.name||"":typeof t=="string"?t:""}function $x(t){if(rh(t)){const e=t,n=e.headers.get("content-type")||"",i=Wx(e.url);return t7(n)||TT(i)}return sh(t)?t.type||"":typeof t=="string"?TT(t):""}function i7(t){return rh(t)?t.headers["content-length"]||-1:sh(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function LI(t){if(rh(t))return t;const e={},n=i7(t);n>=0&&(e["content-length"]=String(n));const i=d_(t),r=$x(t);r&&(e["content-type"]=r);const A=await o7(t);A&&(e["x-first-bytes"]=A),typeof t=="string"&&(t=new TextEncoder().encode(t));const d=new Response(t,{headers:e});return Object.defineProperty(d,"url",{value:i}),d}async function r7(t){if(!t.ok){const e=await s7(t);throw new Error(e)}}async function s7(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function o7(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=A=>{var d;return i(A==null||(d=A.target)===null||d===void 0?void 0:d.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),i=a7(n);return"data:base64,".concat(i)}return null}function a7(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}async function ST(t,e){if(typeof t=="string"){t=QU(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await LI(t)}function A7(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function $d(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||A7()}const $p=globalThis.window||globalThis.self||globalThis.global,_f=globalThis.process||{},DI=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";$d();function l7(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let u7=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=l7(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function c7(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function h7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function oy(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const A=t.width*n,d=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(d/2),"px ").concat(Math.floor(A/2),"px;"),"line-height:".concat(d,"px;"),"background:url(".concat(r,");"),"background-size:".concat(A,"px ").concat(d,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let vm;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(vm||(vm={}));const f7=10;function CT(t){return typeof t!="string"?t:(t=t.toUpperCase(),vm[t]||vm.WHITE)}function d7(t,e,n){if(!$d&&typeof t=="string"){if(e){const i=CT(e);t="\x1B[".concat(i,"m").concat(t,"\x1B[39m")}if(n){const i=CT(n);t="\x1B[".concat(i+f7,"m").concat(t,"\x1B[49m")}}return t}function p7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const A of i){const d=r[A];typeof d=="function"&&(e.find(l=>A===l)||(r[A]=d.bind(t)))}}function xm(t,e){if(!t)throw new Error(e||"Assertion failed")}function Ch(){let t;if($d()&&$p.performance){var e,n;t=$p==null||(e=$p.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in _f){var i;const r=_f==null||(i=_f.hrtime)===null||i===void 0?void 0:i.call(_f);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const Ph={debug:$d()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},g7={enabled:!0,level:0};function Xa(){}const PT={},MT={once:!0};let Zx=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=DI,this._startTs=Ch(),this._deltaTs=Ch(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new u7("__probe-".concat(this.id,"__"),g7),this.timeStamp("".concat(this.id," started")),p7(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ch()-this._startTs).toPrecision(10))}getDelta(){return Number((Ch()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){xm(e,n)}warn(e){return this._getLogFunction(0,e,Ph.warn,arguments,MT)}error(e){return this._getLogFunction(0,e,Ph.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Ph.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Ph.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,Ph.debug||Ph.info,arguments,MT)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Xa,i&&[i],{tag:v7(n)}):Xa}image(e){let{logLevel:n,priority:i,image:r,message:A="",scale:d=1}=e;return this._shouldLog(n||i)?$d()?y7({image:r,message:A,scale:d}):_7():Xa}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Xa)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=IT({logLevel:e,message:n,opts:i}),{collapsed:A}=i;return r.method=(A?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Xa)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=BI(e)}_getLogFunction(e,n,i,r,A){if(this._shouldLog(e)){A=IT({logLevel:e,message:n,args:r,opts:A}),i=i||A.method,xm(i),A.total=this.getTotal(),A.delta=this.getDelta(),this._deltaTs=Ch();const d=A.tag||A.message;if(A.once&&d)if(!PT[d])PT[d]=Ch();else return Xa;return n=m7(this.id,A.message,A),i.bind(console,n,...A.args)}return Xa}};Zx.VERSION=DI;function BI(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return xm(Number.isFinite(e)&&e>=0),e}function IT(t){const{logLevel:e,message:n}=t;t.logLevel=BI(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return xm(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function m7(t,e,n){if(typeof e=="string"){const i=n.time?h7(c7(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=d7(e,n.color,n.background)}return e}function _7(t){return console.warn("removed"),Xa}function y7(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const A=new Image;return A.onload=()=>{const d=oy(A,n,i);console.log(...d)},A.src=e,Xa}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...oy(e,n,i)),Xa;if(r.toLowerCase()==="canvas"){const A=new Image;return A.onload=()=>console.log(...oy(A,n,i)),A.src=e.toDataURL(),Xa}return Xa}function v7(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const kT=new Zx({id:"loaders.gl"});class x7{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class w7{constructor(){ae(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.error.bind(this.console,...n)}}const RI={fetch:null,mimeType:void 0,nothrow:!1,log:new w7,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Hx,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},b7={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function OI(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const zI=()=>{const t=OI();return t.globalOptions=t.globalOptions||{...RI},t.globalOptions};function E7(t,e,n,i){return n=n||[],n=Array.isArray(n)?n:[n],T7(t,n),C7(e,t,i)}function T7(t,e){LT(t,null,RI,b7,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},A=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};LT(i,n.id,r,A,e)}}function LT(t,e,n,i,r){const A=e||"Top level",d=e?"".concat(e,"."):"";for(const l in t){const S=!e&&Wd(t[l]),k=l==="baseUri"&&!e,U=l==="workerUrl"&&e;if(!(l in n)&&!k&&!U){if(l in i)kT.warn("".concat(A," loader option '").concat(d).concat(l,"' no longer supported, use '").concat(i[l],"'"))();else if(!S){const V=S7(l,r);kT.warn("".concat(A," loader option '").concat(d).concat(l,"' not recognized. ").concat(V))()}}}}function S7(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const A in r.options){if(t===A)return"Did you mean '".concat(r.id,".").concat(A,"'?");const d=A.toLowerCase();(n.startsWith(d)||d.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(A,"'?"))}return i}function C7(t,e,n){const r={...t.options||{}};return P7(r,n),r.log===null&&(r.log=new x7),DT(r,zI()),DT(r,e),r}function DT(t,e){for(const n in e)if(n in e){const i=e[n];ET(i)&&ET(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function P7(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function qx(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function Yx(t){var e,n;ym(t,"null loader"),ym(qx(t),"invalid loader");let i;return Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const FI=()=>{const t=OI();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function M7(t){const e=FI();t=Array.isArray(t)?t:[t];for(const n of t){const i=Yx(n);e.find(r=>i===r)||e.unshift(i)}}function I7(){return FI()}const k7=new Zx({id:"loaders.gl"}),L7=/\.([^.]+)$/;async function D7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!NI(t))return null;let r=BT(t,e,{...n,nothrow:!0},i);if(r)return r;if(sh(t)&&(t=await t.slice(0,10).arrayBuffer(),r=BT(t,e,n,i)),!r&&!(n!=null&&n.nothrow))throw new Error(UI(t));return r}function BT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!NI(t))return null;if(e&&!Array.isArray(e))return Yx(e);let r=[];e&&(r=r.concat(e)),n!=null&&n.ignoreRegisteredLoaders||r.push(...I7()),R7(r);const A=B7(t,r,n,i);if(!A&&!(n!=null&&n.nothrow))throw new Error(UI(t));return A}function B7(t,e,n,i){const r=d_(t),A=$x(t),d=Wx(r)||(i==null?void 0:i.url);let l=null,S="";if(n!=null&&n.mimeType&&(l=ay(e,n==null?void 0:n.mimeType),S="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),l=l||O7(e,d),S=S||(l?"matched url ".concat(d):""),l=l||ay(e,A),S=S||(l?"matched MIME type ".concat(A):""),l=l||F7(e,t),S=S||(l?"matched initial data ".concat(VI(t)):""),l=l||ay(e,n==null?void 0:n.fallbackMimeType),S=S||(l?"matched fallback MIME type ".concat(A):""),S){var k;k7.log(1,"selectLoader selected ".concat((k=l)===null||k===void 0?void 0:k.name,": ").concat(S,"."))}return l}function NI(t){return!(t instanceof Response&&t.status===204)}function UI(t){const e=d_(t),n=$x(t);let i="No valid loader found (";i+=e?"".concat(MI(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?VI(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function R7(t){for(const e of t)Yx(e)}function O7(t,e){const n=e&&L7.exec(e),i=n&&n[1];return i?z7(t,i):null}function z7(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}function ay(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function F7(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(N7(e,n))return n}else if(ArrayBuffer.isView(e)){if(RT(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&RT(e,0,n))return n;return null}function N7(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function RT(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>U7(t,e,n,r))}function U7(t,e,n,i){if(i instanceof ArrayBuffer)return UU(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":const r=Y2(t,e,i.length);return i===r;default:return!1}}function VI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Y2(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Y2(t,0,e):""}function Y2(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let A=0;A<n;A++)r+=String.fromCharCode(i.getUint8(e+A));return r}const V7=256*1024;function*j7(t,e){const n=(e==null?void 0:e.chunkSize)||V7;let i=0;const r=new TextEncoder;for(;i<t.length;){const A=Math.min(t.length-i,n),d=t.slice(i,i+A);i+=A,yield r.encode(d)}}const G7=256*1024;function Q7(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=G7}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),A=new ArrayBuffer(r),d=new Uint8Array(t,i,r);new Uint8Array(A).set(d),i+=r,yield A}}()}const H7=1024*1024;async function*W7(t,e){const n=(e==null?void 0:e.chunkSize)||H7;let i=0;for(;i<t.size;){const r=i+n,A=await t.slice(i,r).arrayBuffer();i=r,yield A}}function OT(t,e){return Hx?$7(t,e):Z7(t)}async function*$7(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();e!=null&&e._streamReadAhead&&(i=n.read());const{done:A,value:d}=await r;if(A)return;yield PI(d)}}catch{n.releaseLock()}}async function*Z7(t,e){for await(const n of t)yield PI(n)}function q7(t,e){if(typeof t=="string")return j7(t,e);if(t instanceof ArrayBuffer)return Q7(t,e);if(sh(t))return W7(t,e);if(II(t))return OT(t,e);if(rh(t))return OT(t.body,e);throw new Error("makeIterator")}const jI="Cannot convert supplied data type";function Y7(t,e,n){if(e.text&&typeof t=="string")return t;if(YU(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(t.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(jI)}async function X7(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return Y7(t,e);if(sh(t)&&(t=await LI(t)),rh(t)){const r=t;return await r7(r),e.binary?await r.arrayBuffer():await r.text()}if(II(t)&&(t=q7(t,n)),ZU(t)||qU(t))return jU(t);throw new Error(jI)}function GI(t,e){const n=zI(),i=t||n;return typeof i.fetch=="function"?i.fetch:Wd(i.fetch)?r=>ST(r,i):e!=null&&e.fetch?e==null?void 0:e.fetch:ST}function K7(t,e,n){if(n)return n;const i={fetch:GI(e,t),...t};if(i.url){const r=Wx(i.url);i.baseUrl=r,i.queryString=n7(i.url),i.filename=MI(r),i.baseUrl=WU(r)}return Array.isArray(i.loaders)||(i.loaders=null),i}function J7(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}async function Xx(t,e,n,i){pu(!i||typeof i=="object"),e&&!Array.isArray(e)&&!qx(e)&&(i=void 0,n=e,e=void 0),t=await t,n=n||{};const r=d_(t),d=J7(e,i),l=await D7(t,d,n);return l?(n=E7(n,l,d,r),i=K7({url:r,parse:Xx,loaders:d},n,i||null),await e9(l,t,n,i)):null}async function e9(t,e,n,i){if(OU(t),rh(e)){const r=e,{ok:A,redirected:d,status:l,statusText:S,type:k,url:U}=r,V=Object.fromEntries(r.headers.entries());i.response={headers:V,ok:A,redirected:d,status:l,statusText:S,type:k,url:U}}if(e=await X7(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,i,t);if(zU(t,n))return await FU(t,e,n,i,Xx);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw pu(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function wm(t,e,n,i){!Array.isArray(e)&&!qx(e)&&(n=e,e=void 0);const r=GI(n);let A=t;return typeof t=="string"&&(A=await r(t)),sh(t)&&(A=await r(t)),await Xx(A,e,n)}const t9="3.4.14",{_parseImageNode:n9}=globalThis,X2=typeof Image<"u",K2=typeof ImageBitmap<"u",i9=!!n9,J2=Hx?!0:i9;function r9(t){switch(t){case"auto":return K2||X2||J2;case"imagebitmap":return K2;case"image":return X2;case"data":return J2;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function s9(){if(K2)return"imagebitmap";if(X2)return"image";if(J2)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function o9(t){const e=A9(t);if(!e)throw new Error("Not an image");return e}function a9(t){switch(o9(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function A9(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const l9=/^data:image\/svg\+xml/,u9=/\.svg((\?|#).*)?$/;function Kx(t){return t&&(l9.test(t)||u9.test(t))}function c9(t,e){if(Kx(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(A){throw new Error(A.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return QI(t,e)}function QI(t,e){if(Kx(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function HI(t,e,n){const i=c9(t,n),r=self.URL||self.webkitURL,A=typeof i!="string"&&r.createObjectURL(i);try{return await h9(A||i,e)}finally{A&&r.revokeObjectURL(A)}}async function h9(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=A=>r(new Error("Could not load image ".concat(t,": ").concat(A)))}catch(A){r(A)}})}const f9={};let zT=!0;async function d9(t,e,n){let i;Kx(n)?i=await HI(t,e,n):i=QI(t,n);const r=e&&e.imagebitmap;return await p9(i,r)}async function p9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((g9(e)||!zT)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),zT=!1}return await createImageBitmap(t)}function g9(t){for(const e in t||f9)return!1;return!0}function m9(t){return!x9(t,"ftyp",4)||!(t[8]&96)?null:_9(t)}function _9(t){switch(y9(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function y9(t,e,n){return String.fromCharCode(...t.slice(e,n))}function v9(t){return[...t].map(e=>e.charCodeAt(0))}function x9(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=v9(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}const _l=!1,Zf=!0;function WI(t){const e=Zd(t);return b9(e)||S9(e)||E9(e)||T9(e)||w9(e)}function w9(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=m9(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function b9(t){const e=Zd(t);return e.byteLength>=24&&e.getUint32(0,_l)===2303741511?{mimeType:"image/png",width:e.getUint32(16,_l),height:e.getUint32(20,_l)}:null}function E9(t){const e=Zd(t);return e.byteLength>=10&&e.getUint32(0,_l)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Zf),height:e.getUint16(8,Zf)}:null}function T9(t){const e=Zd(t);return e.byteLength>=14&&e.getUint16(0,_l)===16973&&e.getUint32(2,Zf)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Zf),height:e.getUint32(22,Zf)}:null}function S9(t){const e=Zd(t);if(!(e.byteLength>=3&&e.getUint16(0,_l)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=C9();let A=2;for(;A+9<e.byteLength;){const d=e.getUint16(A,_l);if(r.has(d))return{mimeType:"image/jpeg",height:e.getUint16(A+5,_l),width:e.getUint16(A+7,_l)};if(!i.has(d))return null;A+=2,A+=e.getUint16(A,_l)}return null}function C9(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Zd(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function P9(t,e){const{mimeType:n}=WI(t)||{},i=globalThis._parseImageNode;return ym(i),await i(t,n)}async function M9(t,e,n){e=e||{};const r=(e.image||{}).type||"auto",{url:A}=n||{},d=I9(r);let l;switch(d){case"imagebitmap":l=await d9(t,e,A);break;case"image":l=await HI(t,e,A);break;case"data":l=await P9(t);break;default:ym(!1)}return r==="data"&&(l=a9(l)),l}function I9(t){switch(t){case"auto":case"data":return s9();default:return r9(t),t}}const k9=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],L9=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],D9={image:{type:"auto",decode:!0}},B9={id:"image",module:"images",name:"Images",version:t9,mimeTypes:L9,extensions:k9,parse:M9,tests:[t=>!!WI(new DataView(t))],options:D9};function $I(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function wu(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||$I()}const Mg={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Zp=Mg.window||Mg.self||Mg.global,yf=Mg.process||{},ZI=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";wu();const Ay=globalThis;function qI(t){if(!t&&!wu())return"Node";if($I(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":Ay.chrome?"Chrome":Ay.safari?"Safari":Ay.mozInnerScreenX?"Firefox":"Unknown"}function R9(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class O9{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";ae(this,"storage",void 0),ae(this,"id",void 0),ae(this,"config",void 0),this.storage=R9(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function z9(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function F9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function ly(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const A=t.width*n,d=t.height*n,l=["font-size:1px;","padding:".concat(Math.floor(d/2),"px ").concat(Math.floor(A/2),"px;"),"line-height:".concat(d,"px;"),"background:url(".concat(r,");"),"background-size:".concat(A,"px ").concat(d,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),l]}let bm;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(bm||(bm={}));function FT(t){return typeof t=="string"?bm[t.toUpperCase()]||bm.WHITE:t}function N9(t,e,n){return!wu&&typeof t=="string"&&(e&&(e=FT(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=FT(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function U9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(A=>r===A)||(t[r]=t[r].bind(t)))}function Em(t,e){if(!t)throw new Error(e||"Assertion failed")}function Mh(){let t;if(wu&&"performance"in Zp){var e,n;t=Zp==null||(e=Zp.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in yf){var i;const r=yf==null||(i=yf.hrtime)===null||i===void 0?void 0:i.call(yf);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const Ih={debug:wu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},V9={enabled:!0,level:0};function Ka(){}const NT={},UT={once:!0};class Jx{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};ae(this,"id",void 0),ae(this,"VERSION",ZI),ae(this,"_startTs",Mh()),ae(this,"_deltaTs",Mh()),ae(this,"_storage",void 0),ae(this,"userData",{}),ae(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new O9("__probe-".concat(this.id,"__"),V9),this.timeStamp("".concat(this.id," started")),U9(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Mh()-this._startTs).toPrecision(10))}getDelta(){return Number((Mh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Em(e,n)}warn(e){return this._getLogFunction(0,e,Ih.warn,arguments,UT)}error(e){return this._getLogFunction(0,e,Ih.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Ih.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Ih.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),A=2;A<i;A++)r[A-2]=arguments[A];return this._getLogFunction(e,n,Ih.debug||Ih.info,arguments,UT)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Ka,i&&[i],{tag:H9(n)}):Ka}image(e){let{logLevel:n,priority:i,image:r,message:A="",scale:d=1}=e;return this._shouldLog(n||i)?wu?Q9({image:r,message:A,scale:d}):G9():Ka}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ka)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=VT({logLevel:e,message:n,opts:i}),{collapsed:A}=i;return r.method=(A?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ka)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=YI(e)}_getLogFunction(e,n,i,r,A){if(this._shouldLog(e)){A=VT({logLevel:e,message:n,args:r,opts:A}),i=i||A.method,Em(i),A.total=this.getTotal(),A.delta=this.getDelta(),this._deltaTs=Mh();const d=A.tag||A.message;if(A.once)if(!NT[d])NT[d]=Mh();else return Ka;return n=j9(this.id,A.message,A),i.bind(console,n,...A.args)}return Ka}}ae(Jx,"VERSION",ZI);function YI(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Em(Number.isFinite(e)&&e>=0),e}function VT(t){const{logLevel:e,message:n}=t;t.logLevel=YI(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return Em(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function j9(t,e,n){if(typeof e=="string"){const i=n.time?F9(z9(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=N9(e,n.color,n.background)}return e}function G9(t){return console.warn("removed"),Ka}function Q9(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const A=new Image;return A.onload=()=>{const d=ly(A,n,i);console.log(...d)},A.src=e,Ka}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...ly(e,n,i)),Ka;if(r.toLowerCase()==="canvas"){const A=new Image;return A.onload=()=>console.log(...ly(A,n,i)),A.src=e.toDataURL(),Ka}return Ka}function H9(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Nn=new Jx({id:"deck"});let ev={};function W9(t){ev=t}function Js(t,e,n,i){Nn.level>0&&ev[t]&&ev[t].call(null,e,n,i)}function $9(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const Z9={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:$9,parseTextSync:JSON.parse};function q9(){const t="8.9.27",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Nn.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Nn,_registerLoggers:W9},M7([Z9,[B9,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const Y9=q9(),$n={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty($n,"IDENTITY",{get:()=>(Nn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const jA={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},gu={common:0,meters:1,pixels:2},jT={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},_n=new Jx({id:"luma.gl"});function yo(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const X9="Invalid WebGLRenderingContext",K9="Requires WebGL2";function p_(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Zn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function J9(t){return Zn(t)?t:null}function g_(t){return yo(p_(t),X9),t}function to(t){return yo(Zn(t),K9),t}const Lf={};function eV(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function tV(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function nV(t,e){Lf[t]=!0,e!==void 0&&eV(e)}function iV(t){const e=t.getError;t.getError=function(){let i;do i=e.apply(t),i!==0&&(Lf[i]=!0);while(i!==0);for(i in Lf)if(Lf[i])return delete Lf[i],parseInt(i,10);return 0}}const qd=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};qd.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};qd.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const oh=function(e){const n=this;this.gl=e,iV(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(A){return A===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(A){const d=n.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,A);const l=d.attribs[A];return l.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(A){const d=n.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,A);const l=d.attribs[A];return l.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(A,d){switch(A){case 34962:n.currentArrayBuffer=d;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=d;break}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(A,d){const S=n.currentVertexArrayObject.attribs[A];switch(d){case 34975:return S.buffer;case 34338:return S.enabled;case 34339:return S.size;case 34340:return S.stride;case 34341:return S.type;case 34922:return S.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(A,d,l,S,k,U){const V=n.currentVertexArrayObject;V.maxAttrib=Math.max(V.maxAttrib,A);const $=V.attribs[A];return $.buffer=n.currentArrayBuffer,$.size=d,$.type=l,$.normalized=S,$.stride=k,$.offset=U,$.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{tV("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};oh.prototype.VERTEX_ARRAY_BINDING_OES=34229;oh.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new qd(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};oh.prototype.createVertexArrayOES=function(){const e=new qd(this);return this.vertexArrayObjects.push(e),e};oh.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};oh.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof qd&&e.hasBeenBound&&e.ext===this)};oh.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){nV(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const A=this.currentVertexArrayObject;if(r===A)return;(!r||A.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,A.elementArrayBuffer);let d=this.currentArrayBuffer;const l=Math.max(r?r.maxAttrib:0,A.maxAttrib);for(let S=0;S<=l;S++){const k=A.attribs[S],U=r?r.attribs[S]:null;if((!r||k.enabled!==U.enabled)&&(k.enabled?i.enableVertexAttribArray.call(n,S):i.disableVertexAttribArray.call(n,S)),k.enabled){let V=!1;(!r||k.buffer!==U.buffer)&&(d!==k.buffer&&(i.bindBuffer.call(n,34962,k.buffer),d=k.buffer),V=!0),(V||k.cached!==U.cached)&&i.vertexAttribPointer.call(n,S,k.size,k.type,k.normalized,k.stride,k.offset)}}this.currentArrayBuffer!==d&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};function rV(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){const A=n.call(this,r);return A||(r!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new oh(this)),this.__OESVertexArrayObject))}}const GT="OES_element_index",QT="WEBGL_draw_buffers",sV="EXT_disjoint_timer_query",oV="EXT_disjoint_timer_query_webgl2",aV="EXT_texture_filter_anisotropic",HT="WEBGL_debug_renderer_info",AV=35723,lV=4352,uV=36795,cV=34047,hV=37445,fV=37446,Oi=t=>Zn(t)?void 0:0,dV={3074:t=>Zn(t)?void 0:36064,[AV]:t=>Zn(t)?void 0:lV,35977:Oi,32937:Oi,[uV]:(t,e)=>{const n=Zn(t)?t.getExtension(oV):t.getExtension(sV);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[hV]:(t,e)=>{const n=t.getExtension(HT);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[fV]:(t,e)=>{const n=t.getExtension(HT);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[cV]:(t,e)=>{const n=t.luma.extensions[aV];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Oi,35071:Oi,37447:Oi,36063:(t,e)=>{if(!Zn(t)){const n=t.getExtension(QT);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Oi,35374:Oi,35377:Oi,34852:t=>{if(!Zn(t)){const e=t.getExtension(QT);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(GT)?2147483647:65535,33001:t=>t.getExtension(GT)?16777216:65535,33e3:t=>16777216,37157:Oi,35373:Oi,35657:Oi,36183:Oi,37137:Oi,34045:Oi,35978:Oi,35979:Oi,35968:Oi,35376:Oi,35375:Oi,35659:Oi,37154:Oi,35371:Oi,35658:Oi,35076:Oi,35077:Oi,35380:Oi};function pV(t,e,n){const i=dV[n],r=typeof i=="function"?i(t,e,n):i;return r!==void 0?r:e(n)}const gV="OES_vertex_array_object",XI="ANGLE_instanced_arrays",mV="WEBGL_draw_buffers",_V="EXT_disjoint_timer_query",yV="EXT_texture_filter_anisotropic",vV="VertexArray requires WebGL2 or OES_vertex_array_object extension";function xV(t,e){return{webgl2:Zn(t),ext:t.getExtension(e)}}const KI={[gV]:{meta:{suffix:"OES"},createVertexArray:()=>{yo(!1,vV)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[XI]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){yo(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[mV]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{yo(!1)}},[_V]:{meta:{suffix:"EXT"},createQuery:()=>{yo(!1)},deleteQuery:()=>{yo(!1)},beginQuery:()=>{yo(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},uy={readBuffer:(t,e,n)=>{Zn(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:A}=xV(t,XI);let d;switch(i){case 35069:d=r?void 0:!1;break;case 35070:d=!r&&!A?0:void 0;break}return d!==void 0?d:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!Zn(t))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>{if(!Zn(t))switch(r){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,i,r)},getTexParameter(t,e,n,i){switch(i){case 34046:const{extensions:r}=t.luma,A=r[yV];i=A&&A.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,i)},getParameter:pV,hint(t,e,n,i){return e(n,i)}};function wV(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(rV(t),bV(t),TV(t,KI),EV(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=wV;function bV(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function EV(t,e){let{target:n,target2:i}=e;Object.keys(uy).forEach(r=>{if(typeof uy[r]=="function"){const A=t[r]?t[r].bind(t):()=>{},d=uy[r].bind(null,t,A);n[r]=d,i[r]=d}})}function TV(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&SV(t,{extension:n,target:t.luma,target2:t})}function SV(t,e){let{extension:n,target:i,target2:r}=e;const A=KI[n];yo(A);const{meta:d={}}=A,{suffix:l=""}=d,S=t.getExtension(n);for(const k of Object.keys(A)){const U="".concat(k).concat(l);let V=null;k==="meta"||typeof t[k]=="function"||(S&&typeof S[U]=="function"?V=function(){return S[U](...arguments)}:typeof A[k]=="function"&&(V=A[k].bind(i))),V&&(i[k]=V,r[k]=V)}}const ew={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Vu=(t,e,n)=>e?t.enable(n):t.disable(n),WT=(t,e,n)=>t.hint(n,e),wa=(t,e,n)=>t.pixelStorei(n,e),CV=(t,e)=>{const n=Zn(t)?36009:36160;return t.bindFramebuffer(n,e)},PV=(t,e)=>t.bindFramebuffer(36008,e);function vf(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const MV={3042:Vu,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Vu,2885:(t,e)=>t.cullFace(e),2929:Vu,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Vu,35723:WT,36006:CV,2886:(t,e)=>t.frontFace(e),33170:WT,2849:(t,e)=>t.lineWidth(e),32823:Vu,32824:"polygonOffset",10752:"polygonOffset",35977:Vu,32938:"sampleCoverage",32939:"sampleCoverage",3089:Vu,3088:(t,e)=>t.scissor(...e),2960:Vu,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:wa,3317:wa,37440:wa,37441:wa,37443:wa,3330:wa,3332:wa,3331:wa,36010:PV,3314:wa,32878:wa,3316:wa,3315:wa,32877:wa,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=vf(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=vf(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=vf(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=vf(e)&&e.length===3?[...e,...e]:e;const[n,i,r,A,d,l]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,A,d,l)},stencilOp:(t,e)=>{e=vf(e)&&e.length===3?[...e,...e]:e;const[n,i,r,A,d,l]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,A,d,l)},viewport:(t,e)=>t.viewport(...e)};function _r(t,e,n){return e[t]!==void 0?e[t]:n[t]}const IV={blendEquation:(t,e,n)=>t.blendEquationSeparate(_r(32777,e,n),_r(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(_r(32969,e,n),_r(32968,e,n),_r(32971,e,n),_r(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(_r(32824,e,n),_r(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(_r(32938,e,n),_r(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,_r(2962,e,n),_r(2967,e,n),_r(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,_r(34816,e,n),_r(36003,e,n),_r(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,_r(2964,e,n),_r(2965,e,n),_r(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,_r(34817,e,n),_r(34818,e,n),_r(34819,e,n))},$T={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},fl=(t,e)=>t.isEnabled(e),ZT={3042:fl,2884:fl,2929:fl,3024:fl,32823:fl,32926:fl,32928:fl,3089:fl,2960:fl,35977:fl};function JI(t){for(const e in t)return!1;return!0}function kV(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function qT(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache?t.state.enable?t.state.cache[r]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function LV(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var A=arguments.length,d=new Array(A),l=0;l<A;l++)d[l]=arguments[l];const{valueChanged:S,oldValue:k}=n(t.state._updateCache,...d);return S&&i(...d),k},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function DV(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}class BV{constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?OV(e):Object.assign({},ew),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){yo(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];mu(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,i;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const A in e){yo(A!==void 0);const d=e[A],l=this.cache[A];kV(d,l)||(n=!0,i=l,r&&!(A in r)&&(r[A]=l),this.cache[A]=d)}return{valueChanged:n,oldValue:i}}}function ek(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(yo(i!==void 0),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new BV(t,{copyState:i}),DV(t);for(const A in $T){const d=$T[A];LV(t,A,d)}qT(t,"getParameter"),qT(t,"isEnabled")}return t.state.enable=n,t}function RV(t){t.state||ek(t,{copyState:!1}),t.state.push()}function YT(t){yo(t.state),t.state.pop()}function mu(t,e){if(yo(p_(t),"setParameters requires a WebGL context"),JI(e))return;const n={};for(const r in e){const A=Number(r),d=MV[r];d&&(typeof d=="string"?n[d]=!0:d(t,e[r],A))}const i=t.state&&t.state.cache;if(i)for(const r in n){const A=IV[r];A(t,e,i)}}function OV(t,e){if(e=e||ew,typeof e=="number"){const r=e,A=ZT[r];return A?A(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const A=ZT[r];i[r]=A?A(t,Number(r)):t.getParameter(Number(r))}return i}function zV(t){mu(t,ew)}function $A(t,e,n){if(JI(e))return n(t);const{nocatch:i=!0}=e;RV(t),mu(t,e);let r;if(i)r=n(t),YT(t);else try{r=n(t)}finally{YT(t)}return r}function Zc(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function cy(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=Zc(t),r=t.drawingBufferWidth,A=t.drawingBufferHeight;return NV(e,i,r,A,n)}function FV(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function NV(t,e,n,i,r){const A=XT(t[0],e,n);let d=KT(t[1],e,i,r),l=XT(t[0]+1,e,n);const S=l===n-1?l:l-1;l=KT(t[1]+1,e,i,r);let k;return r?(l=l===0?l:l+1,k=d,d=l):k=l===i-1?l:l-1,{x:A,y:d,width:Math.max(S-A+1,1),height:Math.max(k-d+1,1)}}function XT(t,e,n){return Math.min(Math.round(t*e),n-1)}function KT(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const tw=wu(),UV=tw&&typeof document<"u",tk={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function nk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yo(tw,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},tk,t);const{width:e,height:n}=t;function i(l){if(t.throwOnError)throw new Error(l);return console.error(l),null}t.onError=i;let r;const{canvas:A}=t,d=QV({canvas:A,width:e,height:n,onError:i});return r=GV(d,t),r?(r=nw(r,t),HV(r),r):null}function nw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||WV(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},tk,e);const{manageState:n,debug:i}=e;return n&&ek(t,{copyState:!1,log:function(){for(var r=arguments.length,A=new Array(r),d=0;d<r;d++)A[d]=arguments[d];return _n.log(1,...A)()}}),tw&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),_n.level=Math.max(_n.level,1)):_n.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function VV(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),A=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:A||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function jV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const i=FV(e.useDevicePixels);$V(t,i,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function GV(t,e){const{onError:n}=e;let i=null;const r=S=>i=S.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:A=!0,webgl2:d=!0}=e;let l=null;return d&&(l=l||t.getContext("webgl2",e),l=l||t.getContext("experimental-webgl2",e)),A&&(l=l||t.getContext("webgl",e),l=l||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),l?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),l):n("Failed to create ".concat(d&&!A?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function QV(t){let{canvas:e,width:n=800,height:i=600,onError:r}=t,A;return typeof e=="string"?(UV&&document.readyState==="complete"||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),A=document.getElementById(e)):e?A=e:(A=document.createElement("canvas"),A.id="lumagl-canvas",A.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",A.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(A,document.body.firstChild)),A}function HV(t){const e=Zn(t)?"WebGL2":"WebGL1",n=VV(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";_n.info(1,"".concat(e).concat(r," context ").concat(i))()}function WV(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function $V(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(_n.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const A=t.luma.canvasSizeInfo;if(A.clientWidth!==i||A.clientHeight!==r||A.devicePixelRatio!==e){let d=e;const l=Math.floor(i*d),S=Math.floor(r*d);t.canvas.width=l,t.canvas.height=S,(t.drawingBufferWidth!==l||t.drawingBufferHeight!==S)&&(_n.warn("Device pixel ratio clamped")(),d=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*d),t.canvas.height=Math.floor(r*d)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}function JT(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class eS{constructor(e,n){ae(this,"name",void 0),ae(this,"type",void 0),ae(this,"sampleSize",1),ae(this,"time",void 0),ae(this,"count",void 0),ae(this,"samples",void 0),ae(this,"lastTiming",void 0),ae(this,"lastSampleTime",void 0),ae(this,"lastSampleCount",void 0),ae(this,"_count",0),ae(this,"_time",0),ae(this,"_samples",0),ae(this,"_startTime",0),ae(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=JT(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(JT()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class iw{constructor(e){ae(this,"id",void 0),ae(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof eS?this.stats[n]=e:this.stats[n]=new eS(n,i)),this.stats[n]}}const qf="8.5.20",ZV="set luma.log.level=1 (or higher) to trace rendering";class qV{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new iw({id:e})),this.stats.get(e)}}const zc=new qV;if(globalThis.luma&&globalThis.luma.VERSION!==qf)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(qf));globalThis.luma||(wu()&&_n.log(1,"luma.gl ".concat(qf," - ").concat(ZV))(),globalThis.luma=globalThis.luma||{VERSION:qf,version:qf,log:_n,stats:zc,globals:{modules:{},nodeIO:{}}});function YV(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function XV(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function en(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function hy(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const i=t[e];return en(i!==void 0,"Accessing undefined constant GL.".concat(e)),i}function uc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const fy={};function Sl(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";fy[t]=fy[t]||1;const e=fy[t]++;return"".concat(t,"-").concat(e)}function tS(t){return en(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function w0(t){let e=!0;for(const n in t){e=!1;break}return e}function ik(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),A=Object.getPrototypeOf(t);i.forEach(d=>{A.methodName||(A[d]=()=>{throw _n.removed("Calling removed method ".concat(e,".").concat(d,": "),r)(),new Error(d)})})}const kh="Resource subclass must define virtual methods";let bu=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};g_(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||Sl(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=hy(this.gl,e),en(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const A=Zn(this.gl);if(!((!("webgl2"in r)||A)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const l=r.webgl1,S="webgl2"in r?r.webgl2:r.webgl1;return A?S:l}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},A=Zn(this.gl),d={},l=n||Object.keys(r);for(const S of l){const k=r[S];if(k&&(!("webgl2"in k)||A)&&(!("extension"in k)||this.gl.getExtension(k.extension))){const V=i?uc(this.gl,S):S;d[V]=this.getParameter(S,e),i&&k.type==="GLenum"&&(d[V]=uc(this.gl,d[V]))}}return d}setParameter(e,n){e=hy(this.gl,e),en(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const A=Zn(this.gl);if(!((!("webgl2"in r)||A)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");r.type==="GLenum"&&(n=hy(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return ik(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(kh)}_deleteHandle(){throw new Error(kh)}_bindHandle(e){throw new Error(kh)}_getOptsFromHandle(){throw new Error(kh)}_getParameter(e,n){throw new Error(kh)}_setParameter(e,n){throw new Error(kh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=zc.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];zc.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const r=zc.get("Memory Usage".concat(i));r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=zc.get("Memory Usage".concat(n));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const KV="Failed to deduce GL constant from typed array";function tv(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(KV)}}function _d(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function JV(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:A}=t;const d=n*r;A=A||new Uint8Array(d);for(let l=0;l<i/2;++l){const S=l*d,k=(i-l-1)*d;A.set(e.subarray(S,S+d)),e.copyWithin(S,k,k+d),e.set(A,k)}}function ej(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),A=Math.round(i/2),d=new Uint8Array(r*A*4);for(let l=0;l<A;l++)for(let S=0;S<r;S++)for(let k=0;k<4;k++)d[(l*r+S)*4+k]=e[(l*2*n+S*2)*4+k];return{data:d,width:r,height:A}}function nv(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:A={}}=n;for(const l in i)if(l in e){const k=i[l]?"".concat(t,".").concat(i[l]):"N/A";_n.removed("".concat(t,".").concat(l),k)()}for(const l in r)if(l in e){const S=r[l];_n.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(S))()}let d=null;for(const l in A)if(l in e){const S=A[l];_n.deprecated("".concat(t,".").concat(l),"".concat(t,".").concat(S))(),d=d||Object.assign({},e),d[S]=e[l],delete d[l]}return d||e}const tj={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},nj={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Ca{static getBytesPerElement(e){return _d(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return en(e.size),_d(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new Ca(tj,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Ca.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Ca.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=nv("Accessor",e,nj),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const nS=10,rk={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},ij={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:rk},rj={removedProps:rk};class xi extends bu{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ca.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ca.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=nv("Buffer",e,ij),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=nv("Buffer",e,rj),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Ca(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,A=e.byteLength||e.length;en(n);const d=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(d,this.handle),r!==0||A!==void 0?(to(this.gl),this.gl.bufferSubData(this.target,i,n,r,A)):this.gl.bufferSubData(d,i,n),this.gl.bindBuffer(d,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:A}=e;const{gl:d}=this;return to(d),d.bindBuffer(36662,n.handle),d.bindBuffer(36663,this.handle),d.copyBufferSubData(36662,36663,i,r,A),d.bindBuffer(36662,null),d.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};to(this.gl);const A=_d(this.accessor.type||5126,{clamped:!1}),d=this._getAvailableElementCount(n),l=i;let S,k;e?(k=e.length,S=k-l):(S=Math.min(d,r||d),k=l+S);const U=Math.min(d,S);return r=r||U,en(r<=U),e=e||new A(k),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?r!==void 0?this.gl.bindBufferRange(e,n,this.handle,i,r):(en(i===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(nS,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;en(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,nS),this.bytesUsed=i,this._trackAllocatedMemory(i);const A=tv(e);return en(A),this.setAccessor(new Ca(this.accessor,{type:A})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;en(e>=0),this._trackDeallocatedMemory();let i=e;e===0&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=_d(this.accessor.type||5126,{clamped:!1}),i=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new Ca(this.accessor,{type:tv(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return _n.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return _n.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return _n.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return _n.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Ca(this.accessor,e),this}}const rw={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},sk={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},ok={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function sj(t,e){const n=rw[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const i=Zn(t)&&n.gl2||n.gl1;return typeof i=="string"?t.getExtension(i):i}function oj(t,e){const n=rw[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const aj=[9729,9728],iS=globalThis.WebGLBuffer||function(){};class qc extends bu{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:i,linearFiltering:r}=n;let A=!0;return i&&(A=A&&sj(e,i),A=A&&(!r||oj(e,i))),A}constructor(e,n){const{id:i=Sl("texture"),handle:r,target:A}=n;super(e,{id:i,handle:r}),this.target=A,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(Ae=>this.initialize(Object.assign({},e,{pixels:Ae,data:Ae}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:A=6408,border:d=0,recreate:l=!1,parameters:S={},pixelStore:k={},textureUnit:U=void 0}=e;n||(n=r);let{width:V,height:$,dataFormat:X,type:ee,compressed:ue=!1,mipmaps:we=!0}=e;const{depth:ie=0}=e;return{width:V,height:$,compressed:ue,dataFormat:X,type:ee}=this._deduceParameters({format:A,type:ee,dataFormat:X,compressed:ue,data:n,width:V,height:$}),this.width=V,this.height=$,this.depth=ie,this.format=A,this.type=ee,this.dataFormat=X,this.border=d,this.textureUnit=U,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),we&&this._isNPOT()&&(_n.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),we=!1,this._updateForNPOT(S)),this.mipmaps=we,this.setImageData({data:n,width:V,height:$,depth:ie,format:A,type:ee,dataFormat:X,border:d,mipmaps:we,parameters:k,compressed:ue}),we&&this.generateMipmap(),this.setParameters(S),l&&(this.data=n),i&&(this._video={video:n,parameters:S,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(_n.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),$A(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:A=this.format,border:d=this.border,offset:l=0,parameters:S={}}=e;let{data:k=null,type:U=this.type,width:V=this.width,height:$=this.height,dataFormat:X=this.dataFormat,compressed:ee=!1}=e;k||(k=i),{type:U,dataFormat:X,compressed:ee,width:V,height:$}=this._deduceParameters({format:A,type:U,dataFormat:X,compressed:ee,data:k,width:V,height:$});const{gl:ue}=this;ue.bindTexture(this.target,this.handle);let we=null;({data:k,dataType:we}=this._getDataType({data:k,compressed:ee}));let ie,Ae=0;if($A(this.gl,S,()=>{switch(we){case"null":ue.texImage2D(n,r,A,V,$,d,X,U,k);break;case"typed-array":ue.texImage2D(n,r,A,V,$,d,X,U,k,l);break;case"buffer":ie=to(ue),ie.bindBuffer(35052,k.handle||k),ie.texImage2D(n,r,A,V,$,d,X,U,l),ie.bindBuffer(35052,null);break;case"browser-object":Zn(ue)?ue.texImage2D(n,r,A,V,$,d,X,U,k):ue.texImage2D(n,r,A,X,U,k);break;case"compressed":for(const[ce,Ce]of k.entries())ue.compressedTexImage2D(n,ce,Ce.format,Ce.width,Ce.height,d,Ce.data),Ae+=Ce.levelSize;break;default:en(!1,"Unknown image data type")}}),we==="compressed")this._trackAllocatedMemory(Ae,"Texture");else if(k&&k.byteLength)this._trackAllocatedMemory(k.byteLength,"Texture");else{const ce=sk[this.dataFormat]||4,Ce=ok[this.type]||1;this._trackAllocatedMemory(this.width*this.height*ce*Ce,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:A=0,y:d=0,width:l=this.width,height:S=this.height,level:k=0,format:U=this.format,type:V=this.type,dataFormat:$=this.dataFormat,compressed:X=!1,offset:ee=0,border:ue=this.border,parameters:we={}}=e;if({type:V,dataFormat:$,compressed:X,width:l,height:S}=this._deduceParameters({format:U,type:V,dataFormat:$,compressed:X,data:r,width:l,height:S}),en(this.depth===0,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const ie=r;r=ie.data,l=ie.shape[0],S=ie.shape[1]}r instanceof xi&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),$A(this.gl,we,()=>{if(X)this.gl.compressedTexSubImage2D(n,k,A,d,l,S,U,r);else if(r===null)this.gl.texSubImage2D(n,k,A,d,l,S,$,V,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,k,A,d,l,S,$,V,r,ee);else if(r instanceof iS){const ie=to(this.gl);ie.bindBuffer(35052,r),ie.texSubImage2D(n,k,A,d,l,S,$,V,ee),ie.bindBuffer(35052,null)}else Zn(this.gl)?to(this.gl).texSubImage2D(n,k,A,d,l,S,$,V,r):this.gl.texSubImage2D(n,k,A,d,$,V,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return _n.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof xi?{data:n.handle,dataType:"buffer"}:n instanceof iS?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:A,dataFormat:d,type:l,compressed:S}=e;const k=rw[n];return d=d||k&&k.dataFormat,l=l||k&&k.types[0],S=S||k&&k.compressed,{width:r,height:A}=this._deduceImageSize(i,r,A),{dataFormat:d,type:l,compressed:S,width:r,height:A,format:n,data:i}}_deduceImageSize(e,n,i){let r;return typeof ImageData<"u"&&e instanceof ImageData?r={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?r={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?r={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?r={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?r={width:e.videoWidth,height:e.videoHeight}:e?r={width:n,height:i}:r={width:n>=0?n:1,height:i>=0?i:1},en(r,"Could not deduced texture size"),en(n===void 0||r.width===n,"Deduced texture width does not match supplied width"),en(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:en(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Zn(this.gl)||!this.width||!this.height?!1:!tS(this.width)||!tS(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:aj.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let Aj="";function lj(t,e){return en(typeof t=="string"),t=Aj+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class $o extends qc{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return qc.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};g_(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:lj(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const iv=[34069,34070,34071,34072,34073,34074];class ak extends qc{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};g_(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:i={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(i)}),this}subImage(e){let{face:n,data:i,x:r=0,y:A=0,mipmapLevel:d=0}=e;return this._subImage({target:n,data:i,x:r,y:A,mipmapLevel:d})}async setCubeMapImageData(e){let{width:n,height:i,pixels:r,data:A,border:d=0,format:l=6408,type:S=5121}=e;const{gl:k}=this,U=r||A,V=await Promise.all(iv.map($=>{const X=U[$];return Promise.all(Array.isArray(X)?X:[X])}));this.bind(),iv.forEach(($,X)=>{V[X].length>1&&this.opts.mipmaps!==!1&&_n.warn("".concat(this.id," has mipmap and multiple LODs."))(),V[X].forEach((ee,ue)=>{n&&i?k.texImage2D($,ue,l,n,i,d,l,S,ee):k.texImage2D($,ue,l,l,S,ee)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:i,height:r,pixels:A,data:d,border:l=0,format:S=6408,type:k=5121}=e,{gl:U}=this,V=A||d;return this.bind(),V instanceof Promise?V.then($=>this.setImageDataForFace(Object.assign({},e,{face:n,data:$,pixels:$}))):this.width||this.height?U.texImage2D(n,0,S,i,r,l,S,k,V):U.texImage2D(n,0,S,S,k,V),this}}ak.FACES=iv;class uj extends qc{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Zn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};to(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:A,depth:d=1,border:l=0,format:S,type:k=5121,offset:U=0,data:V,parameters:$={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),$A(this.gl,$,()=>{ArrayBuffer.isView(V)&&this.gl.texImage3D(this.target,n,i,r,A,d,l,S,k,V),V instanceof xi&&(this.gl.bindBuffer(35052,V.handle),this.gl.texImage3D(this.target,n,i,r,A,d,l,S,k,U))}),V&&V.byteLength)this._trackAllocatedMemory(V.byteLength,"Texture");else{const X=sk[this.dataFormat]||4,ee=ok[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*X*ee,"Texture")}return this.loaded=!0,this}}const Pc="EXT_color_buffer_float",rS={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Pc,bpp:2},33327:{gl2:Pc,bpp:4},34842:{gl2:Pc,bpp:8},33326:{gl2:Pc,bpp:4},33328:{gl2:Pc,bpp:8},34836:{gl2:Pc,bpp:16},35898:{gl2:Pc,bpp:4}};function cj(t,e,n){const i=n[e];if(!i)return!1;const r=Zn(t)&&i.gl2||i.gl1;return typeof r=="string"?t.getExtension(r):r}class Xh extends bu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||cj(e,n,rS)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:A=0}=e;return en(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),A!==0&&Zn(this.gl)?this.gl.renderbufferStorageMultisample(36161,A,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=A,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*rS[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const hj=256,fj=1024,dj=16384,sS=6144,oS=6145,aS=6146,AS=34041,Ak="clear: bad arguments";function sw(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const A={};e&&(A.framebuffer=e);let d=0;n&&(d|=dj,n!==!0&&(A.clearColor=n)),i&&(d|=hj,i!==!0&&(A.clearDepth=i)),r&&(d|=fj,i!==!0&&(A.clearStencil=i)),en(d!==0,Ak),$A(t,A,()=>{t.clear(d)})}function pj(t){let{framebuffer:e=null,buffer:n=sS,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};to(t),$A(t,{framebuffer:e},()=>{switch(n){case sS:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case oS:t.clearBufferfv(oS,0,[r]);break;case aS:t.clearBufferiv(aS,0,[r]);break;case AS:const[A,d]=r;t.clearBufferfi(AS,0,A,d);break;default:en(!1,Ak)}})}function gj(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return en(!1),0}}function m_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:A=36064,target:d=null,sourceWidth:l,sourceHeight:S,sourceType:k}=e;const{framebuffer:U,deleteFramebuffer:V}=lk(t);en(U);const{gl:$,handle:X,attachments:ee}=U;l=l||U.width,S=S||U.height,A===36064&&X===null&&(A=1028),en(ee[A]),k=k||ee[A].type,d=_j(d,k,r,l,S),k=k||tv(d);const ue=$.bindFramebuffer(36160,X);return $.readPixels(n,i,l,S,r,k,d),$.bindFramebuffer(36160,ue||null),V&&U.delete(),d}function lS(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=m_(t,{sourceAttachment:e}),{width:r,height:A}=t;for(;A>n;)({data:i,width:r,height:A}=ej({data:i,width:r,height:A}));JV({data:i,width:r,height:A});const d=document.createElement("canvas");d.width=r,d.height=A;const l=d.getContext("2d"),S=l.createImageData(r,A);return S.data.set(i),l.putImageData(S,0,0),d.toDataURL()}function mj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:A=0,targetInternalFormat:d=6408}=n;let{targetX:l,targetY:S,targetZ:k,width:U,height:V}=n;const{framebuffer:$,deleteFramebuffer:X}=lk(t);en($);const{gl:ee,handle:ue}=$,we=typeof l<"u"||typeof S<"u"||typeof k<"u";l=l||0,S=S||0,k=k||0;const ie=ee.bindFramebuffer(36160,ue);en(e);let Ae=null;if(e instanceof qc&&(Ae=e,U=Number.isFinite(U)?U:Ae.width,V=Number.isFinite(V)?V:Ae.height,Ae.bind(0),e=Ae.target),!we)ee.copyTexImage2D(e,A,d,i,r,U,V,0);else switch(e){case 3553:case 34067:ee.copyTexSubImage2D(e,A,l,S,i,r,U,V);break;case 35866:case 32879:to(ee).copyTexSubImage3D(e,A,l,S,k,i,r,U,V);break}return Ae&&Ae.unbind(),ee.bindFramebuffer(36160,ie||null),X&&$.delete(),Ae}function lk(t){return t instanceof is?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Cj(t),deleteFramebuffer:!0}}function _j(t,e,n,i,r){if(t)return t;e=e||5121;const A=_d(e,{clamped:!1}),d=gj(n);return new A(i*r*d)}const Ii={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function yj(t){const e=new $o(t,{format:6408,type:5126,dataFormat:6408}),n=new is(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),i===36053}const uk={[Ii.WEBGL2]:[!1,!0],[Ii.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Ii.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Ii.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Ii.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Ii.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Ii.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Ii.FLOAT_BLEND]:["EXT_float_blend"],[Ii.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Ii.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Ii.TEXTURE_FLOAT]:["OES_texture_float",!0],[Ii.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Ii.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Ii.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Ii.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Ii.COLOR_ATTACHMENT_RGBA32F]:[yj,"EXT_color_buffer_float"],[Ii.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Ii.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Ii.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Ii.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Ii.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Ii.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},vj=2;function ow(t,e){return aw(t,e)}function aw(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>ck(t,n))}function xj(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in uk)t.luma.caps[e]===void 0&&(t.luma.caps[e]=ck(t,e));return t.luma.caps}function ck(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=wj(t,e)),t.luma.caps[e]||_n.log(vj,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function wj(t,e){const n=uk[e];en(n,e);let i;const r=Zn(t)&&n[1]||n[0];if(typeof r=="function")i=r(t);else if(Array.isArray(r)){i=!0;for(const A of r)i=i&&!!t.getExtension(A)}else typeof r=="string"?i=!!t.getExtension(r):typeof r=="boolean"?i=r:en(!1);return i}const uS="Multiple render targets not supported";class is extends bu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let A=!0;return i&&(A=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(A=A&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),A}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new is(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=to(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=to(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:A=!0,depth:d=!0,stencil:l=!1,check:S=!0,readBuffer:k=void 0,drawBuffers:U=void 0}=e;if(en(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const V in r){const $=r[V];(Array.isArray($)?$[0]:$).resize({width:n,height:i})}else r=this._createDefaultAttachments(A,d,l,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:k,drawBuffers:U}),r&&S&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:A=!1,resizeAttachments:d=!0}=e;this.attach(n,{clearAttachments:A,resizeAttachments:d});const{gl:l}=this,S=l.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),l.bindFramebuffer(36160,S||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:i}=e;if(this.handle===null)return en(n===void 0&&i===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),i===void 0&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&_n.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(d=>{r[d]=null}),Object.assign(r,e);const A=this.gl.bindFramebuffer(36160,this.handle);for(const d in r){en(d!==void 0,"Misspelled framebuffer binding point?");const l=Number(d),S=r[l];let k=S;if(!k)this._unattach(l);else if(k instanceof Xh)this._attachRenderbuffer({attachment:l,renderbuffer:k});else if(Array.isArray(S)){const[U,V=0,$=0]=S;k=U,this._attachTexture({attachment:l,texture:U,layer:V,level:$})}else this._attachTexture({attachment:l,texture:k,layer:0,level:0});i&&k&&k.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,A||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(d=>!this.attachments[d]).forEach(d=>{delete this.attachments[d]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(Ej(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:A=[]}=e,d=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&sw(this.gl,{color:n,depth:i,stencil:r}),A.forEach((l,S)=>{pj(this.gl,{drawBuffer:S,value:l})}),this.gl.bindFramebuffer(36160,d||null),this}readPixels(){return _n.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return _n.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return _n.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return _n.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return _n.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return _n.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:A,height:d}=e;const l=to(this.gl),S=l.bindFramebuffer(36008,this.handle);return i===0&&r===0&&A===void 0&&d===void 0?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,i,r,A,d),l.bindFramebuffer(36008,S),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return r===null&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=uc(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const A of i){const d=n?uc(this.gl,A):A;r[d]=this.getAttachmentParameter(e,A,n)}return r}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),i={};for(const r of n){const A=Number(r),d=e?uc(this.gl,A):A;i[d]=this.getAttachmentParameters(A,e)}return i}show(){return typeof window<"u"&&window.open(lS(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>_n.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=lS(this,{targetMaxHeight:100});return _n.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,A){let d=null;return e&&(d=d||{},d[36064]=new $o(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:A,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(d[36064])),n&&i?(d=d||{},d[33306]=new Xh(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(d[33306])):n?(d=d||{},d[36096]=new Xh(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:A}),this.ownResources.push(d[36096])):i&&en(!1),d}_unattach(e){const n=this.attachments[e];n&&(n instanceof Xh?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:A}=e;const{gl:d}=this;switch(d.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:to(d).framebufferTextureLayer(36160,n,i.target,A,r);break;case 34067:const S=bj(r);d.framebufferTexture2D(36160,n,S,i.handle,A);break;case 3553:d.framebufferTexture2D(36160,n,3553,i.handle,A);break;default:en(!1,"Illegal texture type")}d.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=J9(this.gl);n?n.readBuffer(e):en(e===36064||e===1029,uS),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=to(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):en(e.length===1&&(e[0]===36064||e[0]===1029),uS)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=xj(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function bj(t){return t<34069?t+34069:t}function Ej(t){return(is.STATUS||{})[t]||"Framebuffer error ".concat(t)}const Tj=[36049,36048,33296,33298,33299,33300,33301,33302,33303];is.ATTACHMENT_PARAMETERS=Tj;function Sj(t,e){en(t instanceof $o||t instanceof ak||t instanceof uj);const n=t.constructor,{gl:i,width:r,height:A,format:d,type:l,dataFormat:S,border:k,mipmaps:U}=t,V=Object.assign({width:r,height:A,format:d,type:l,dataFormat:S,border:k,mipmaps:U},e);return new n(i,V)}function Cj(t,e){const{gl:n,width:i,height:r,id:A}=t;return new is(n,Object.assign({},e,{id:"framebuffer-for-".concat(A),width:i,height:r,attachments:{36064:t}}))}function Ig(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}const Pj=35632,Mj=35633;function Ij(t){switch(t){case Pj:return"fragment";case Mj:return"vertex";default:return"unknown type"}}function kj(t,e,n,i){const r=t.split(/\r?\n/),A={},d={},l=i||Ig(e)||"(unnamed)",S="".concat(Ij(n)," shader ").concat(l);for(let U=0;U<r.length;U++){const V=r[U];if(V.length<=1)continue;const $=V.split(":"),X=$[0],ee=parseInt($[2],10);if(isNaN(ee))throw new Error("GLSL compilation error in ".concat(S,": ").concat(t));X!=="WARNING"?A[ee]=V:d[ee]=V}const k=Lj(e);return{shaderName:S,errors:cS(A,k),warnings:cS(d,k)}}function cS(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if(!(!t[i+3]&&!t[i+2]&&!t[i+1])&&(n+="".concat(r,`
`),t[i+1])){const A=t[i+1],d=A.split(":",3),l=d[0],S=parseInt(d[1],10)||0,k=A.substring(d.join(":").length+1).trim();n+=hk("^^^ ".concat(l,": ").concat(k,`

`),S)}}return n}function Lj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((A,d)=>{const l=String(d+e),S=l.length;return hk(l,r-S)+n+A})}function hk(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}function fk(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const Dj="Shader: GLSL source code must be a JavaScript string";class yd extends bu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return en(!1),"unknown"}}constructor(e,n){g_(e),en(typeof n.source=="string",Dj);const i=Ig(n.source,null)||n.id||Sl("unnamed ".concat(yd.getTypeName(n.shaderType)));super(e,{id:i}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=Ig(n,null);i&&(this.id=Sl(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(yd.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Ig(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:A,warnings:d}=kj(i,this.source,this.shaderType,this.id);throw _n.error("GLSL compilation errors in ".concat(r,`
`).concat(A))(),_n.warn("GLSL compilation warnings in ".concat(r,`
`).concat(d))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class dy extends yd{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class py extends yd{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Bj={5126:Ni.bind(null,"uniform1fv",ba,1,Xs),35664:Ni.bind(null,"uniform2fv",ba,2,Xs),35665:Ni.bind(null,"uniform3fv",ba,3,Xs),35666:Ni.bind(null,"uniform4fv",ba,4,Xs),5124:Ni.bind(null,"uniform1iv",ju,1,Xs),35667:Ni.bind(null,"uniform2iv",ju,2,Xs),35668:Ni.bind(null,"uniform3iv",ju,3,Xs),35669:Ni.bind(null,"uniform4iv",ju,4,Xs),35670:Ni.bind(null,"uniform1iv",ju,1,Xs),35671:Ni.bind(null,"uniform2iv",ju,2,Xs),35672:Ni.bind(null,"uniform3iv",ju,3,Xs),35673:Ni.bind(null,"uniform4iv",ju,4,Xs),35674:Ni.bind(null,"uniformMatrix2fv",ba,4,Kl),35675:Ni.bind(null,"uniformMatrix3fv",ba,9,Kl),35676:Ni.bind(null,"uniformMatrix4fv",ba,16,Kl),35678:Ds,35680:Ds,5125:Ni.bind(null,"uniform1uiv",qp,1,Xs),36294:Ni.bind(null,"uniform2uiv",qp,2,Xs),36295:Ni.bind(null,"uniform3uiv",qp,3,Xs),36296:Ni.bind(null,"uniform4uiv",qp,4,Xs),35685:Ni.bind(null,"uniformMatrix2x3fv",ba,6,Kl),35686:Ni.bind(null,"uniformMatrix2x4fv",ba,8,Kl),35687:Ni.bind(null,"uniformMatrix3x2fv",ba,6,Kl),35688:Ni.bind(null,"uniformMatrix3x4fv",ba,12,Kl),35689:Ni.bind(null,"uniformMatrix4x2fv",ba,8,Kl),35690:Ni.bind(null,"uniformMatrix4x3fv",ba,12,Kl),35678:Ds,35680:Ds,35679:Ds,35682:Ds,36289:Ds,36292:Ds,36293:Ds,36298:Ds,36299:Ds,36300:Ds,36303:Ds,36306:Ds,36307:Ds,36308:Ds,36311:Ds},Rj={},Oj={},zj={},hS=[0];function Aw(t,e,n,i){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(hS[0]=t,t=hS);const r=t.length;if(r%e&&_n.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let A=i[r];A||(A=new n(r),i[r]=A);for(let d=0;d<r;d++)A[d]=t[d];return A}function ba(t,e){return Aw(t,e,Float32Array,Rj)}function ju(t,e){return Aw(t,e,Int32Array,Oj)}function qp(t,e){return Aw(t,e,Uint32Array,zj)}function fS(t,e,n){const i=Bj[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function Fj(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function Nj(t,e,n){for(const i in t){const r=t[i];if((!n||!!n[i])&&!Uj(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}return!0}function Uj(t){return Array.isArray(t)||ArrayBuffer.isView(t)?jj(t):isFinite(t)||t===!0||t===!1||t instanceof qc||t instanceof Xh?!0:t instanceof is?!!t.texture:!1}function Vj(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,A=n.length;r<A;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function jj(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ds(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function Ni(t,e,n,i){let r=null,A=null;return(d,l,S)=>{const k=e(S,n),U=k.length;let V=!1;if(r===null)r=new Float32Array(U),A=U,V=!0;else{en(A===U,"Uniform length cannot change.");for(let $=0;$<U;++$)if(k[$]!==r[$]){V=!0;break}}return V&&(i(d,t,l,k),r.set(k)),V}}function Xs(t,e,n,i){t[e](n,i)}function Kl(t,e,n,i){t[e](n,!1,i)}const Gj=5120,Qj=5121,Hj=5122,Wj=5123,dS=0,Yp=1,$j=2,Zj=3,Xp=4,qj=5,Yj=6,Jr=5126,Xj=35664,Kj=35665,Jj=35666,xf=5124,eG=35667,tG=35668,nG=35669,wf=5125,iG=36294,rG=36295,sG=36296,oG=35670,aG=35671,AG=35672,lG=35673,uG=35674,cG=35675,hG=35676,fG=35685,dG=35686,pG=35687,gG=35688,mG=35689,_G=35690,rv={[Jr]:[Jr,1,"float"],[Xj]:[Jr,2,"vec2"],[Kj]:[Jr,3,"vec3"],[Jj]:[Jr,4,"vec4"],[xf]:[xf,1,"int"],[eG]:[xf,2,"ivec2"],[tG]:[xf,3,"ivec3"],[nG]:[xf,4,"ivec4"],[wf]:[wf,1,"uint"],[iG]:[wf,2,"uvec2"],[rG]:[wf,3,"uvec3"],[sG]:[wf,4,"uvec4"],[oG]:[Jr,1,"bool"],[aG]:[Jr,2,"bvec2"],[AG]:[Jr,3,"bvec3"],[lG]:[Jr,4,"bvec4"],[uG]:[Jr,8,"mat2"],[fG]:[Jr,8,"mat2x3"],[dG]:[Jr,8,"mat2x4"],[cG]:[Jr,12,"mat3"],[pG]:[Jr,12,"mat3x2"],[gG]:[Jr,12,"mat3x4"],[hG]:[Jr,16,"mat4"],[mG]:[Jr,16,"mat4x2"],[_G]:[Jr,16,"mat4x3"]};function yG(t){switch(t){case dS:return dS;case Yp:return Yp;case Zj:return Yp;case $j:return Yp;case Xp:return Xp;case qj:return Xp;case Yj:return Xp;default:return en(!1),0}}function pS(t){const e=rv[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function dk(t,e){switch(t){case Gj:case Qj:case Hj:case Wj:t=Jr;break}for(const n in rv){const[i,r,A]=rv[n];if(i===t&&r===e)return{glType:n,name:A}}return null}class vG{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:A,type:d,size:l}=n.getActiveAttrib(e.handle,r),S=n.getAttribLocation(e.handle,A);S>=0&&this._addAttribute(S,A,d,l)}this.attributeInfos.sort((r,A)=>r.location-A.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Zn(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:A,type:d,size:l}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,A,d,l)}this.varyingInfos.sort((r,A)=>r.location-A.location)}_addAttribute(e,n,i,r){const{type:A,components:d}=pS(i),l={type:A,size:r*d};this._inferProperties(e,n,l);const S={location:e,name:n,accessor:new Ca(l)};this.attributeInfos.push(S),this.attributeInfosByLocation[e]=S,this.attributeInfosByName[S.name]=S}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:A,components:d}=pS(i),l=new Ca({type:A,size:r*d}),S={location:e,name:n,accessor:l};this.varyingInfos.push(S),this.varyingInfosByName[S.name]=S}}const gS=4,xG=35981,wG=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class pk extends bu{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",wG),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:A,bufferMode:d=xG}=e;return this.hash=n||"",this.vs=typeof i=="string"?new dy(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs=typeof r=="string"?new py(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,en(this.vs instanceof dy),en(this.fs instanceof py),this.uniforms={},this._textureUniforms={},A&&A.length>0&&(to(this.gl),this.varyings=A,this.gl2.transformFeedbackVaryings(this.handle,A,d)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new vG(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:A=0,start:d,end:l,isIndexed:S=!1,indexType:k=5123,instanceCount:U=0,isInstanced:V=U>0,vertexArray:$=null,transformFeedback:X,framebuffer:ee,parameters:ue={},uniforms:we,samplers:ie}=e;if((we||ie)&&(_n.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(we||{})),_n.priority>=n){const Ae=ee?ee.id:"default",ce="mode=".concat(uc(this.gl,i)," verts=").concat(r," ")+"instances=".concat(U," indexType=").concat(uc(this.gl,k)," ")+"isInstanced=".concat(V," isIndexed=").concat(S," ")+"Framebuffer=".concat(Ae);_n.log(n,ce)()}return en($),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||r===0||V&&U===0?!1:($.bindForDraw(r,U,()=>{if(ee!==void 0&&(ue=Object.assign({},ue,{framebuffer:ee})),X){const Ae=yG(i);X.begin(Ae)}this._bindTextures(),$A(this.gl,ue,()=>{S&&V?this.gl2.drawElementsInstanced(i,r,k,A,U):S&&Zn(this.gl)&&!isNaN(d)&&!isNaN(l)?this.gl2.drawRangeElements(i,d,l,r,k,A):S?this.gl.drawElements(i,r,k,A):V?this.gl2.drawArraysInstanced(i,A,r,U):this.gl.drawArrays(i,A,r)}),X&&X.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_n.priority>=2&&Nj(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let A=i,d=!1;if(A instanceof is&&(A=A.texture),A instanceof qc)if(d=this.uniforms[n]!==i,d){r.textureIndex===void 0&&(r.textureIndex=this._textureIndexCounter++);const l=A,{textureIndex:S}=r;l.bind(S),A=S,this._textureUniforms[n]=l}else A=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(A)||d)&&Vj(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new dy({handle:r});break;case 35632:i.fs=new py({handle:r});break}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Sl(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),_n.time(gS,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),_n.timeEnd(gS,"linkProgram for ".concat(this._getName()))(),e.debug||_n.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=Fj(i.name);let A=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=fS(e,A,i),i.size>1)for(let d=0;d<i.size;d++)A=e.getUniformLocation(this.handle,"".concat(r,"[").concat(d,"]")),this._uniformSetters["".concat(r,"[").concat(d,"]")]=fS(e,A,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const bG=34918,EG=34919,TG=35007,SG=36795,CG=35976,PG=35887,MG=36202;class Tm extends bu{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=Zn(e),r=aw(e,Ii.TIMER_QUERY);let A=i||r;for(const d of n)switch(d){case"queries":A=A&&i;break;case"timers":A=A&&r;break;default:en(!1)}return A}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(TG)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?MG:PG)}beginTransformFeedbackQuery(){return this.begin(CG)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,EG);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(SG)}getResult(){return this.gl2.getQueryParameter(this.handle,bG)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const A=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(A)};requestAnimationFrame(A)}),this._pollingPromise}_createHandle(){return Tm.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class gk extends bu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Zn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};to(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,w0(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:A,byteOffset:d}=this._getBufferParams(n);return i<0?(this.unused[e]=r,_n.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,d,A),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof xi?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(n!==void 0||i!==void 0)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const A=n&&n.handle;return!A||r===void 0?this.gl.bindBufferBase(35982,e,A):this.gl.bindBufferRange(35982,e,A,i,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Kp=null;function IG(t){return(!Kp||Kp.byteLength<t)&&(Kp=new ArrayBuffer(t)),Kp}function kG(t,e){const n=IG(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function LG(t){let{target:e,source:n,start:i=0,count:r=1}=t;const A=n.length,d=r*A;let l=0;for(let S=i;l<A;l++)e[S++]=n[l];for(;l<d;)l<d-l?(e.copyWithin(i+l,i,i+l),l*=2):(e.copyWithin(i+l,i,i+d-l),l=d);return e}const DG="elements must be GL.ELEMENT_ARRAY_BUFFER";class Ea extends bu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Zn(e)||qI()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ea(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ea.MAX_ATTRIBUTES=Ea.MAX_ATTRIBUTES||e.getParameter(34921),Ea.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:Ea._setConstantFloatArray(e,n,i);break;case Int32Array:Ea._setConstantIntArray(e,n,i);break;case Uint32Array:Ea._setConstantUintArray(e,n,i);break;default:en(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:i})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ea.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return en(!e||e.target===34963,DG),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(n.target===34963)return this.setElementBuffer(n,i);const{size:r,type:A,stride:d,offset:l,normalized:S,integer:k,divisor:U}=i,{gl:V,gl2:$}=this;return e=Number(e),this.bind(()=>{V.bindBuffer(34962,n.handle),k?(en(Zn(V)),$.vertexAttribIPointer(e,r,A,d,l)):V.vertexAttribPointer(e,r,A,S,d,l),V.enableVertexAttribArray(e),$.vertexAttribDivisor(e,U||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ea.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,A=i.length*e;let d=!this.buffer;if(this.buffer=this.buffer||new xi(this.gl,r),d=d||this.buffer.reallocate(r),d=d||!this._compareConstantArrayValues(i,this.bufferValue),d){const l=kG(n.constructor,A);LG({target:l,source:i,start:0,count:A}),this.buffer.subData(l),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:en(!1)}}static _setConstantIntArray(e,n,i){switch(en(Zn(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:en(!1)}}static _setConstantUintArray(e,n,i){switch(en(Zn(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:en(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return en(Number.isFinite(i)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(i,e);default:return this.gl.getVertexAttrib(i,e)}})}}const BG="VertexArray: attributes must be Buffers or constants (i.e. typed array)",RG=/^(.+)__LOCATION_([0-9]+)$/,OG=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class zG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;this.id=i,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ea(e),ik(this,"VertexArray","v6.0",OG),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const i=e[n];this._setAttribute(n,i)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,i);const{location:r,accessor:A}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=A,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,A)),this}setConstant(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:r,accessor:A}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=A,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new xi(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof xi&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof xi&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const A={location:-1,accessor:null},{location:d,name:l}=this._getAttributeIndex(e);if(!Number.isFinite(d)||d<0)return this.unused[e]=n,_n.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),A;const S=this._getAttributeInfo(l||d);if(!S)return A;const k=this.accessors[d]||{},U=Ca.resolve(S.accessor,k,i,r),{size:V,type:$}=U;return en(Number.isFinite(V)&&Number.isFinite($)),{location:d,accessor:U}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=RG.exec(e),r=i?i[1]:e,A=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+A,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof xi)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof xi){const i=n[0],r=n[1];this.setBuffer(e,i,r)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const i=n;this.setConstant(e,i)}else if(n.buffer instanceof xi){const i=n;this.setBuffer(e,i.buffer,i)}else throw new Error(BG)}_setConstantAttributes(e,n){const i=Math.max(e|0,n|0);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let A=1;A<this.vertexArrayObject.MAX_ATTRIBUTES;A++)r=this.values[A],ArrayBuffer.isView(r)&&this._setConstantAttribute(A,r)}_setConstantAttributeZero(e,n){if(Ea.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){Ea.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:A}=r,d=A>0;if(e.isInstanced=e.isInstanced||d,i instanceof xi){const l=i;if(d){const S=l.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,S)}else{const S=l.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,S)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _n.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function FG(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let d=0;d<t.length&&d<n;++d)d>0&&(r+=",".concat(d%i===0?" ":"")),r+=vd(t[d],e);const A=t.length>n?"...":"]";return"".concat(r).concat(A)}function vd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return FG(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function mS(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;en(n);const A=".*_.*",d=".*Matrix",l=n._uniformSetters,S={},k=Object.keys(l).sort();let U=0;for(const X of k)!X.match(A)&&!X.match(d)&&gy({table:S,header:e,uniforms:i,uniformName:X,undefinedOnly:r})&&U++;for(const X of k)X.match(d)&&gy({table:S,header:e,uniforms:i,uniformName:X,undefinedOnly:r})&&U++;for(const X of k)S[X]||gy({table:S,header:e,uniforms:i,uniformName:X,undefinedOnly:r})&&U++;let V=0;const $={};if(!r)for(const X in i){const ee=i[X];S[X]||(V++,$[X]={Type:"NOT USED: ".concat(ee),[e]:vd(ee)})}return{table:S,count:U,unusedTable:$,unusedCount:V}}function gy(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:A}=t;const d=i[r],l=NG(d);return!A||!l?(e[r]={[n]:l?vd(d):"N/A","Uniform Type":l?d:"NOT PROVIDED"},!0):!1}function NG(t){return t!=null}function UG(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=_S(e,e.elements,null,n));const r=e.values;for(const A in r){const d=e._getAttributeInfo(A);if(d){let l="".concat(A,": ").concat(d.name);const S=e.accessors[d.location];S&&(l="".concat(A,": ").concat(VG(d.name,S))),i[l]=_S(e,r[A],S,n)}}return i}function _S(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let A="NOT PROVIDED",d=1,l=0,S=0,k,U,V;if(n&&(A=n.type,d=n.size,A=String(A).replace("Array",""),k=A.indexOf("nt")!==-1),e instanceof xi){const $=e,{data:X,changed:ee}=$.getDebugData();U=ee?"*":"",V=X,S=$.byteLength,l=S/X.BYTES_PER_ELEMENT/d;let ue;if(n){const we=n.divisor>0;ue="".concat(we?"I ":"P "," ").concat(l," (x").concat(d,"=").concat(S," bytes ").concat(uc(r,A),")")}else k=!0,ue="".concat(S," bytes");return{[i]:"".concat(U).concat(vd(V,{size:d,isInteger:k})),"Format ":ue}}return V=e,d=e.length,A=String(e.constructor.name).replace("Array",""),k=A.indexOf("nt")!==-1,{[i]:"".concat(vd(V,{size:d,isInteger:k})," (constant)"),"Format ":"".concat(d,"x").concat(A," (constant)")}}function VG(t,e){const{type:n,size:i}=e,r=dk(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function jG(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=yS(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=yS(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}function yS(t){const{type:e,size:n}=t.accessor,i=dk(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const vS=wu()&&typeof document<"u";let GG=0;class QG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=we=>nk(we),onAddHTML:i=null,onInitialize:r=()=>{},onRender:A=()=>{},onFinalize:d=()=>{},onError:l,gl:S=null,glOptions:k={},debug:U=!1,createFramebuffer:V=!1,autoResizeViewport:$=!0,autoResizeDrawingBuffer:X=!0,stats:ee=zc.get("animation-loop-".concat(GG++))}=e;let{useDevicePixels:ue=!0}=e;"useDevicePixelRatio"in e&&(_n.deprecated("useDevicePixelRatio","useDevicePixels")(),ue=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:A,onFinalize:d,onError:l,gl:S,glOptions:k,debug:U,createFramebuffer:V},this.gl=S,this.needsRedraw=null,this.timeline=null,this.stats=ee,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:$,autoResizeDrawingBuffer:X,useDevicePixels:ue}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return en(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Tm.isSupported(this.gl,["timers"])?new Tm(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),i!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return _n.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=vS?new Promise((e,n)=>{if(vS&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):XV(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):YV(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?nw(this.props.gl,e):this.onCreateContext(e),!p_(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");zV(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&jV(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new is(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Yd="vs",lw="fs";function La(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const my={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function HG(t){const e={};for(const n in t){const i=t[n],r=WG(i);e[n]=r}return e}function WG(t){let e=xS(t);return e==="object"?t?"type"in t?Object.assign({},t,my[t.type]):"value"in t?(e=xS(t.value),Object.assign({type:e},t,my[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},my[e])}function xS(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const $G="vs",ZG="fs";class wS{constructor(e){let{name:n,vs:i,fs:r,dependencies:A=[],uniforms:d,getUniforms:l,deprecations:S=[],defines:k={},inject:U={},vertexShader:V,fragmentShader:$}=e;La(typeof n=="string"),this.name=n,this.vs=i||V,this.fs=r||$,this.getModuleUniforms=l,this.dependencies=A,this.deprecations=this._parseDeprecationDefinitions(S),this.defines=k,this.injections=qG(U),d&&(this.uniforms=HG(d))}getModuleSource(e){let n;switch(e){case $G:n=this.vs||"";break;case ZG:n=this.fs||"";break;default:La(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const A=i[r];r in e&&!A.private?(A.validate&&La(A.validate(e[r],A),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=A.value}return n}}function qG(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);typeof i=="string"&&(i={order:0,injection:i}),e[r][n]=i}return e}function YG(t){return XG(_k(t))}function XG(t){const e={},n={};return mk({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}function mk(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const A of e)i[A.name]=A,(r[A.name]===void 0||r[A.name]<n)&&(r[A.name]=n);for(const A of e)A.dependencies&&mk({modules:A.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function _k(t,e){return t.map(n=>(n instanceof wS||(La(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),La(n.name,"shader module has no name"),n=new wS(n),n.dependencies=_k(n.dependencies)),n))}function KG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r}const JG=7936,eQ=7937,tQ=7938,nQ=35724,uw={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Dc={};Object.keys(uw).forEach(t=>{Dc[t]=t});function iQ(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function rQ(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||JG),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||eQ);return{gpuVendor:sQ(n,i),vendor:n,renderer:i,version:t.getParameter(tQ),shadingLanguageVersion:t.getParameter(nQ)}}function sQ(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const _y={};function bS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=uw[e];if(La(i,e),!KG(n))return!0;if(e in _y)return _y[e];const r=i[0],A=n.behavior||"enable",d="#extension GL_".concat(r," : ").concat(A,`
void main(void) {}`),l=t.createShader(35633);t.shaderSource(l,d),t.compileShader(l);const S=t.getShaderParameter(l,35713);return t.deleteShader(l),_y[e]=S,S}function oQ(t,e){const n=uw[e];La(n,e);const i=iQ(t)&&n[1]||n[0],r=typeof i=="string"?!!t.getExtension(i):i;return La(r===!1||r===!0),r}function Jp(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>oQ(t,n))}function aQ(t){switch(rQ(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function AQ(t,e,n){let i=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Jp(t,Dc.GLSL_FRAG_DEPTH)&&(i+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Jp(t,Dc.GLSL_DERIVATIVES)&&bS(t,Dc.GLSL_DERIVATIVES)&&(i+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Jp(t,Dc.GLSL_FRAG_DATA)&&bS(t,Dc.GLSL_FRAG_DATA,{behavior:"require"})&&(i+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Jp(t,Dc.GLSL_TEXTURE_LOD)&&(i+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),i}const lQ=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,uQ=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,cQ={[Yd]:lQ,[lw]:uQ},kg="__LUMA_INJECT_DECLARATIONS__",ES=/void\s+main\s*\([^)]*\)\s*\{\n?/,TS=/}\n?[^{}]*$/,yy=[];function SS(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=e===Yd;for(const A in n){const d=n[A];d.sort((S,k)=>S.order-k.order),yy.length=d.length;for(let S=0,k=d.length;S<k;++S)yy[S]=d[S].injection;const l="".concat(yy.join(`
`),`
`);switch(A){case"vs:#decl":r&&(t=t.replace(kg,l));break;case"vs:#main-start":r&&(t=t.replace(ES,S=>S+l));break;case"vs:#main-end":r&&(t=t.replace(TS,S=>l+S));break;case"fs:#decl":r||(t=t.replace(kg,l));break;case"fs:#main-start":r||(t=t.replace(ES,S=>S+l));break;case"fs:#main-end":r||(t=t.replace(TS,S=>l+S));break;default:t=t.replace(A,S=>S+l)}}return t=t.replace(kg,""),i&&(t=t.replace(/\}\s*$/,A=>A+cQ[e])),t}function sv(t){const e={};return La(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],`
`).concat(n[i]):n[i]}),e}function b0(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const yk=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],hQ=[...yk,[b0("attribute"),"in $1"],[b0("varying"),"out $1"]],fQ=[...yk,[b0("varying"),"in $1"]],vk=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],dQ=[...vk,[b0("in"),"attribute $1"],[b0("out"),"varying $1"]],pQ=[...vk,[b0("in"),"varying $1"]],ov="gl_FragColor",av=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,gQ=/void\s+main\s*\([^)]*\)\s*\{\n?/;function mQ(t,e,n){switch(e){case 300:return n?Sm(t,hQ):_Q(t);case 100:return n?Sm(t,dQ):yQ(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Sm(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function _Q(t){t=Sm(t,fQ);const e=t.match(av);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(ov,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(gQ,i=>"out vec4 ".concat(n,`;
`).concat(i)).replace(new RegExp("\\b".concat(ov,"\\b"),"g"),n)}return t}function yQ(t){t=Sm(t,pQ);const e=t.match(av);if(e){const n=e[1];t=t.replace(av,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),ov)}return t}const vQ=`

`.concat(kg,`

`),xk={[Yd]:"vertex",[lw]:"fragment"},xQ=`precision highp float;

`;function wQ(t,e){const{vs:n,fs:i}=e,r=YG(e.modules||[]);return{gl:t,vs:CS(t,Object.assign({},e,{source:n,type:Yd,modules:r})),fs:CS(t,Object.assign({},e,{source:i,type:lw,modules:r})),getUniforms:bQ(r)}}function CS(t,e){let{id:n,source:i,type:r,modules:A,defines:d={},hookFunctions:l=[],inject:S={},transpileToGLSL100:k=!1,prologue:U=!0,log:V}=e;La(typeof i=="string","shader source must be a string");const $=r===Yd,X=i.split(`
`);let ee=100,ue="",we=i;X[0].indexOf("#version ")===0?(ee=300,ue=X[0],we=X.slice(1).join(`
`)):ue="#version ".concat(ee);const ie={};A.forEach(tt=>{Object.assign(ie,tt.getDefines())}),Object.assign(ie,d);let Ae=U?"".concat(ue,`
`).concat(TQ({id:n,source:i,type:r}),`
`).concat(EQ({type:r}),`
`).concat(aQ(t),`
`).concat(AQ(t),`
`).concat(SQ(ie),`
`).concat($?"":xQ,`
`):"".concat(ue,`
`);const ce=PQ(l),Ce={},Ne={},qe={};for(const tt in S){const lt=typeof S[tt]=="string"?{injection:S[tt],order:0}:S[tt],at=tt.match(/^(v|f)s:(#)?([\w-]+)$/);if(at){const ht=at[2],Et=at[3];ht?Et==="decl"?Ne[tt]=[lt]:qe[tt]=[lt]:Ce[tt]=[lt]}else qe[tt]=[lt]}for(const tt of A){V&&tt.checkDeprecations(we,V);const lt=tt.getModuleSource(r,ee);Ae+=lt;const at=tt.injections[r];for(const ht in at){const Et=ht.match(/^(v|f)s:#([\w-]+)$/);if(Et){const Mt=Et[2]==="decl"?Ne:qe;Mt[ht]=Mt[ht]||[],Mt[ht].push(at[ht])}else Ce[ht]=Ce[ht]||[],Ce[ht].push(at[ht])}}return Ae+=vQ,Ae=SS(Ae,r,Ne),Ae+=CQ(ce[r],Ce),Ae+=we,Ae=SS(Ae,r,qe),Ae=mQ(Ae,k?100:ee,$),Ae}function bQ(t){return function(n){const i={};for(const r of t){const A=r.getUniforms(n,i);Object.assign(i,A)}return i}}function EQ(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(xk[e].toUpperCase(),`
`)}function TQ(t){let{id:e,source:n,type:i}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(xk[i],`

`):""}function SQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const i in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],`
`))}return e===0&&(n+=`
`),n}function CQ(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature,` {
`),r.header&&(n+="  ".concat(r.header)),e[i]){const A=e[i];A.sort((d,l)=>d.order-l.order);for(const d of A)n+="  ".concat(d.injection,`
`)}r.footer&&(n+="  ".concat(r.footer)),n+=`}
`}return n}function PQ(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;typeof n!="string"?(i=n,n=i.hook):i={},n=n.trim();const[r,A]=n.split(":"),d=n.replace(/\(.+/,"");e[r][d]=Object.assign(i,{signature:A})}),e}const MQ="void main() {gl_FragColor = vec4(0);}",wk=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,IQ=`#version 300 es
`.concat(wk);function bk(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,A]=n;if(!e.includes(i)||!r||!A)return null;const d=A.split(";")[0];return{qualifier:i,type:r,name:d}}function Ek(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return e===300?IQ:e>300?"#version ".concat(e,`
`).concat(wk):MQ;const A=DQ(n,i);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(i," ").concat(n,`;
out vec4 `).concat(r,`;
void main() {
  `).concat(r," = ").concat(A,`;
}`):"varying ".concat(i," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(A,`;
}`)}function kQ(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return La(!1),null}}function LQ(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return La(!1),null}}function DQ(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return La(!1),null}}const BQ=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,RQ={name:"fp32",vs:BQ,fs:null};function PS(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Ia={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function OQ(t,{precision:e=Ia.precision}={}){return t=zQ(t),"".concat(parseFloat(t.toPrecision(e)))}function E0(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function vl(t,e,n){return NQ(t,i=>Math.max(e,Math.min(n,i)))}function T0(t,e,n){return E0(t)?t.map((i,r)=>T0(i,e[r],n)):n*e+(1-n)*t}function xd(t,e,n){const i=Ia.EPSILON;n&&(Ia.EPSILON=n);try{if(t===e)return!0;if(E0(t)&&E0(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!xd(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Ia.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Ia.EPSILON=i}}function zQ(t){return Math.round(t/Ia.EPSILON)*Ia.EPSILON}function FQ(t){return t.clone?t.clone():new Array(t.length)}function NQ(t,e,n){if(E0(t)){const i=t;n=n||FQ(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function UQ(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class Tk extends UQ(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:E0(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ia)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+OQ(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!xd(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(i===void 0)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const A=e[r];this[r]=A+i*(n[r]-A)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Ia.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function VQ(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Sa(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function vy(t,e,n=""){if(Ia.debug&&!VQ(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class jQ extends Tk{get x(){return this[0]}set x(e){this[0]=Sa(e)}get y(){return this[1]}set y(e){this[1]=Sa(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return Sa(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return Sa(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return PS(e>=0&&e<this.ELEMENTS,"index is out of range"),Sa(this[e])}setComponent(e,n){return PS(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Lg=1e-6,S0=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function GQ(){var t=new S0(2);return S0!=Float32Array&&(t[0]=0,t[1]=0),t}function MS(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function QQ(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Sk(t,e,n,i){var r=e[0],A=e[1];return t[0]=r+i*(n[0]-r),t[1]=A+i*(n[1]-A),t}function HQ(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(function(){var t=GQ();return function(e,n,i,r,A,d){var l,S;for(n||(n=2),i||(i=0),r?S=Math.min(r*n+i,e.length):S=e.length,l=i;l<S;l+=n)t[0]=e[l],t[1]=e[l+1],A(t,t,d),e[l]=t[0],e[l+1]=t[1];return e}})();function WQ(t,e,n){const i=e[0],r=e[1],A=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/A,t[1]=(n[1]*i+n[5]*r)/A,t}function Ck(t,e,n){const i=e[0],r=e[1],A=e[2],d=n[3]*i+n[7]*r+n[11]*A||1;return t[0]=(n[0]*i+n[4]*r+n[8]*A)/d,t[1]=(n[1]*i+n[5]*r+n[9]*A)/d,t[2]=(n[2]*i+n[6]*r+n[10]*A)/d,t}function $Q(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function ZQ(){var t=new S0(3);return S0!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function qQ(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function YQ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function XQ(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function KQ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function JQ(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function eH(t,e,n){var i=e[0],r=e[1],A=e[2],d=n[0],l=n[1],S=n[2];return t[0]=r*S-A*l,t[1]=A*d-i*S,t[2]=i*l-r*d,t}function tH(t,e,n,i){var r=e[0],A=e[1],d=e[2];return t[0]=r+i*(n[0]-r),t[1]=A+i*(n[1]-A),t[2]=d+i*(n[2]-d),t}function Pk(t,e,n){var i=e[0],r=e[1],A=e[2],d=n[3]*i+n[7]*r+n[11]*A+n[15];return d=d||1,t[0]=(n[0]*i+n[4]*r+n[8]*A+n[12])/d,t[1]=(n[1]*i+n[5]*r+n[9]*A+n[13])/d,t[2]=(n[2]*i+n[6]*r+n[10]*A+n[14])/d,t}function nH(t,e,n){var i=e[0],r=e[1],A=e[2];return t[0]=i*n[0]+r*n[3]+A*n[6],t[1]=i*n[1]+r*n[4]+A*n[7],t[2]=i*n[2]+r*n[5]+A*n[8],t}function iH(t,e,n){var i=n[0],r=n[1],A=n[2],d=n[3],l=e[0],S=e[1],k=e[2],U=r*k-A*S,V=A*l-i*k,$=i*S-r*l,X=r*$-A*V,ee=A*U-i*$,ue=i*V-r*U,we=d*2;return U*=we,V*=we,$*=we,X*=2,ee*=2,ue*=2,t[0]=l+U+X,t[1]=S+V+ee,t[2]=k+$+ue,t}function rH(t,e,n,i){var r=[],A=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],A[0]=r[0],A[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),A[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=A[0]+n[0],t[1]=A[1]+n[1],t[2]=A[2]+n[2],t}function sH(t,e,n,i){var r=[],A=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],A[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),A[1]=r[1],A[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=A[0]+n[0],t[1]=A[1]+n[1],t[2]=A[2]+n[2],t}function oH(t,e,n,i){var r=[],A=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],A[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),A[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),A[2]=r[2],t[0]=A[0]+n[0],t[1]=A[1]+n[1],t[2]=A[2]+n[2],t}function aH(t,e){var n=t[0],i=t[1],r=t[2],A=e[0],d=e[1],l=e[2],S=Math.sqrt(n*n+i*i+r*r),k=Math.sqrt(A*A+d*d+l*l),U=S*k,V=U&&JQ(t,e)/U;return Math.acos(Math.min(Math.max(V,-1),1))}var Mk=YQ,AH=qQ,xy=XQ;(function(){var t=ZQ();return function(e,n,i,r,A,d){var l,S;for(n||(n=3),i||(i=0),r?S=Math.min(r*n+i,e.length):S=e.length,l=i;l<S;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],A(t,t,d),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2];return e}})();const wy=[0,0,0];let eg;class Cl extends jQ{static get ZERO(){return eg||(eg=new Cl(0,0,0),Object.freeze(eg)),eg}constructor(e=0,n=0,i=0){super(-0,-0,-0),arguments.length===1&&E0(e)?this.copy(e):(Ia.debug&&(Sa(e),Sa(n),Sa(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ia.debug&&(Sa(e.x),Sa(e.y),Sa(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Sa(e)}angle(e){return aH(this,e)}cross(e){return eH(this,this,e),this.check()}rotateX({radians:e,origin:n=wy}){return rH(this,this,n,e),this.check()}rotateY({radians:e,origin:n=wy}){return sH(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=wy}){return oH(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Pk(this,this,e),this.check()}transformAsVector(e){return Ck(this,this,e),this.check()}transformByMatrix3(e){return nH(this,this,e),this.check()}transformByMatrix2(e){return $Q(this,this,e),this.check()}transformByQuaternion(e){return iH(this,this,e),this.check()}}class lH extends Tk{toString(){let e="[";if(Ia.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=Sa(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function uH(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cH(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],A=e[6],d=e[7],l=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=A,t[11]=e[14],t[12]=r,t[13]=d,t[14]=l}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Av(t,e){var n=e[0],i=e[1],r=e[2],A=e[3],d=e[4],l=e[5],S=e[6],k=e[7],U=e[8],V=e[9],$=e[10],X=e[11],ee=e[12],ue=e[13],we=e[14],ie=e[15],Ae=n*l-i*d,ce=n*S-r*d,Ce=n*k-A*d,Ne=i*S-r*l,qe=i*k-A*l,tt=r*k-A*S,lt=U*ue-V*ee,at=U*we-$*ee,ht=U*ie-X*ee,Et=V*we-$*ue,St=V*ie-X*ue,Mt=$*ie-X*we,Kt=Ae*Mt-ce*St+Ce*Et+Ne*ht-qe*at+tt*lt;return Kt?(Kt=1/Kt,t[0]=(l*Mt-S*St+k*Et)*Kt,t[1]=(r*St-i*Mt-A*Et)*Kt,t[2]=(ue*tt-we*qe+ie*Ne)*Kt,t[3]=($*qe-V*tt-X*Ne)*Kt,t[4]=(S*ht-d*Mt-k*at)*Kt,t[5]=(n*Mt-r*ht+A*at)*Kt,t[6]=(we*Ce-ee*tt-ie*ce)*Kt,t[7]=(U*tt-$*Ce+X*ce)*Kt,t[8]=(d*St-l*ht+k*lt)*Kt,t[9]=(i*ht-n*St-A*lt)*Kt,t[10]=(ee*qe-ue*Ce+ie*Ae)*Kt,t[11]=(V*Ce-U*qe-X*Ae)*Kt,t[12]=(l*at-d*Et-S*lt)*Kt,t[13]=(n*Et-i*at+r*lt)*Kt,t[14]=(ue*ce-ee*Ne-we*Ae)*Kt,t[15]=(U*Ne-V*ce+$*Ae)*Kt,t):null}function hH(t){var e=t[0],n=t[1],i=t[2],r=t[3],A=t[4],d=t[5],l=t[6],S=t[7],k=t[8],U=t[9],V=t[10],$=t[11],X=t[12],ee=t[13],ue=t[14],we=t[15],ie=e*d-n*A,Ae=e*l-i*A,ce=e*S-r*A,Ce=n*l-i*d,Ne=n*S-r*d,qe=i*S-r*l,tt=k*ee-U*X,lt=k*ue-V*X,at=k*we-$*X,ht=U*ue-V*ee,Et=U*we-$*ee,St=V*we-$*ue;return ie*St-Ae*Et+ce*ht+Ce*at-Ne*lt+qe*tt}function Vc(t,e,n){var i=e[0],r=e[1],A=e[2],d=e[3],l=e[4],S=e[5],k=e[6],U=e[7],V=e[8],$=e[9],X=e[10],ee=e[11],ue=e[12],we=e[13],ie=e[14],Ae=e[15],ce=n[0],Ce=n[1],Ne=n[2],qe=n[3];return t[0]=ce*i+Ce*l+Ne*V+qe*ue,t[1]=ce*r+Ce*S+Ne*$+qe*we,t[2]=ce*A+Ce*k+Ne*X+qe*ie,t[3]=ce*d+Ce*U+Ne*ee+qe*Ae,ce=n[4],Ce=n[5],Ne=n[6],qe=n[7],t[4]=ce*i+Ce*l+Ne*V+qe*ue,t[5]=ce*r+Ce*S+Ne*$+qe*we,t[6]=ce*A+Ce*k+Ne*X+qe*ie,t[7]=ce*d+Ce*U+Ne*ee+qe*Ae,ce=n[8],Ce=n[9],Ne=n[10],qe=n[11],t[8]=ce*i+Ce*l+Ne*V+qe*ue,t[9]=ce*r+Ce*S+Ne*$+qe*we,t[10]=ce*A+Ce*k+Ne*X+qe*ie,t[11]=ce*d+Ce*U+Ne*ee+qe*Ae,ce=n[12],Ce=n[13],Ne=n[14],qe=n[15],t[12]=ce*i+Ce*l+Ne*V+qe*ue,t[13]=ce*r+Ce*S+Ne*$+qe*we,t[14]=ce*A+Ce*k+Ne*X+qe*ie,t[15]=ce*d+Ce*U+Ne*ee+qe*Ae,t}function Cm(t,e,n){var i=n[0],r=n[1],A=n[2],d,l,S,k,U,V,$,X,ee,ue,we,ie;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*A+e[12],t[13]=e[1]*i+e[5]*r+e[9]*A+e[13],t[14]=e[2]*i+e[6]*r+e[10]*A+e[14],t[15]=e[3]*i+e[7]*r+e[11]*A+e[15]):(d=e[0],l=e[1],S=e[2],k=e[3],U=e[4],V=e[5],$=e[6],X=e[7],ee=e[8],ue=e[9],we=e[10],ie=e[11],t[0]=d,t[1]=l,t[2]=S,t[3]=k,t[4]=U,t[5]=V,t[6]=$,t[7]=X,t[8]=ee,t[9]=ue,t[10]=we,t[11]=ie,t[12]=d*i+U*r+ee*A+e[12],t[13]=l*i+V*r+ue*A+e[13],t[14]=S*i+$*r+we*A+e[14],t[15]=k*i+X*r+ie*A+e[15]),t}function cw(t,e,n){var i=n[0],r=n[1],A=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*A,t[9]=e[9]*A,t[10]=e[10]*A,t[11]=e[11]*A,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function fH(t,e,n,i){var r=i[0],A=i[1],d=i[2],l=Math.hypot(r,A,d),S,k,U,V,$,X,ee,ue,we,ie,Ae,ce,Ce,Ne,qe,tt,lt,at,ht,Et,St,Mt,Kt,pn;return l<Lg?null:(l=1/l,r*=l,A*=l,d*=l,S=Math.sin(n),k=Math.cos(n),U=1-k,V=e[0],$=e[1],X=e[2],ee=e[3],ue=e[4],we=e[5],ie=e[6],Ae=e[7],ce=e[8],Ce=e[9],Ne=e[10],qe=e[11],tt=r*r*U+k,lt=A*r*U+d*S,at=d*r*U-A*S,ht=r*A*U-d*S,Et=A*A*U+k,St=d*A*U+r*S,Mt=r*d*U+A*S,Kt=A*d*U-r*S,pn=d*d*U+k,t[0]=V*tt+ue*lt+ce*at,t[1]=$*tt+we*lt+Ce*at,t[2]=X*tt+ie*lt+Ne*at,t[3]=ee*tt+Ae*lt+qe*at,t[4]=V*ht+ue*Et+ce*St,t[5]=$*ht+we*Et+Ce*St,t[6]=X*ht+ie*Et+Ne*St,t[7]=ee*ht+Ae*Et+qe*St,t[8]=V*Mt+ue*Kt+ce*pn,t[9]=$*Mt+we*Kt+Ce*pn,t[10]=X*Mt+ie*Kt+Ne*pn,t[11]=ee*Mt+Ae*Kt+qe*pn,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Ik(t,e,n){var i=Math.sin(n),r=Math.cos(n),A=e[4],d=e[5],l=e[6],S=e[7],k=e[8],U=e[9],V=e[10],$=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=A*r+k*i,t[5]=d*r+U*i,t[6]=l*r+V*i,t[7]=S*r+$*i,t[8]=k*r-A*i,t[9]=U*r-d*i,t[10]=V*r-l*i,t[11]=$*r-S*i,t}function dH(t,e,n){var i=Math.sin(n),r=Math.cos(n),A=e[0],d=e[1],l=e[2],S=e[3],k=e[8],U=e[9],V=e[10],$=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=A*r-k*i,t[1]=d*r-U*i,t[2]=l*r-V*i,t[3]=S*r-$*i,t[8]=A*i+k*r,t[9]=d*i+U*r,t[10]=l*i+V*r,t[11]=S*i+$*r,t}function kk(t,e,n){var i=Math.sin(n),r=Math.cos(n),A=e[0],d=e[1],l=e[2],S=e[3],k=e[4],U=e[5],V=e[6],$=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=A*r+k*i,t[1]=d*r+U*i,t[2]=l*r+V*i,t[3]=S*r+$*i,t[4]=k*r-A*i,t[5]=U*r-d*i,t[6]=V*r-l*i,t[7]=$*r-S*i,t}function pH(t,e){var n=e[0],i=e[1],r=e[2],A=e[3],d=n+n,l=i+i,S=r+r,k=n*d,U=i*d,V=i*l,$=r*d,X=r*l,ee=r*S,ue=A*d,we=A*l,ie=A*S;return t[0]=1-V-ee,t[1]=U+ie,t[2]=$-we,t[3]=0,t[4]=U-ie,t[5]=1-k-ee,t[6]=X+ue,t[7]=0,t[8]=$+we,t[9]=X-ue,t[10]=1-k-V,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gH(t,e,n,i,r,A,d){var l=1/(n-e),S=1/(r-i),k=1/(A-d);return t[0]=A*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A*2*S,t[6]=0,t[7]=0,t[8]=(n+e)*l,t[9]=(r+i)*S,t[10]=(d+A)*k,t[11]=-1,t[12]=0,t[13]=0,t[14]=d*A*2*k,t[15]=0,t}function mH(t,e,n,i,r){var A=1/Math.tan(e/2),d;return t[0]=A/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(d=1/(i-r),t[10]=(r+i)*d,t[14]=2*r*i*d):(t[10]=-1,t[14]=-2*i),t}var _H=mH;function yH(t,e,n,i,r,A,d){var l=1/(e-n),S=1/(i-r),k=1/(A-d);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*S,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*k,t[11]=0,t[12]=(e+n)*l,t[13]=(r+i)*S,t[14]=(d+A)*k,t[15]=1,t}var vH=yH;function xH(t,e,n,i){var r,A,d,l,S,k,U,V,$,X,ee=e[0],ue=e[1],we=e[2],ie=i[0],Ae=i[1],ce=i[2],Ce=n[0],Ne=n[1],qe=n[2];return Math.abs(ee-Ce)<Lg&&Math.abs(ue-Ne)<Lg&&Math.abs(we-qe)<Lg?uH(t):(U=ee-Ce,V=ue-Ne,$=we-qe,X=1/Math.hypot(U,V,$),U*=X,V*=X,$*=X,r=Ae*$-ce*V,A=ce*U-ie*$,d=ie*V-Ae*U,X=Math.hypot(r,A,d),X?(X=1/X,r*=X,A*=X,d*=X):(r=0,A=0,d=0),l=V*d-$*A,S=$*r-U*d,k=U*A-V*r,X=Math.hypot(l,S,k),X?(X=1/X,l*=X,S*=X,k*=X):(l=0,S=0,k=0),t[0]=r,t[1]=l,t[2]=U,t[3]=0,t[4]=A,t[5]=S,t[6]=V,t[7]=0,t[8]=d,t[9]=k,t[10]=$,t[11]=0,t[12]=-(r*ee+A*ue+d*we),t[13]=-(l*ee+S*ue+k*we),t[14]=-(U*ee+V*ue+$*we),t[15]=1,t)}function wH(){var t=new S0(4);return S0!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Lk(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function F0(t,e,n){var i=e[0],r=e[1],A=e[2],d=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*A+n[12]*d,t[1]=n[1]*i+n[5]*r+n[9]*A+n[13]*d,t[2]=n[2]*i+n[6]*r+n[10]*A+n[14]*d,t[3]=n[3]*i+n[7]*r+n[11]*A+n[15]*d,t}(function(){var t=wH();return function(e,n,i,r,A,d){var l,S;for(n||(n=4),i||(i=0),r?S=Math.min(r*n+i,e.length):S=e.length,l=i;l<S;l+=n)t[0]=e[l],t[1]=e[l+1],t[2]=e[l+2],t[3]=e[l+3],A(t,t,d),e[l]=t[0],e[l+1]=t[1],e[l+2]=t[2],e[l+3]=t[3];return e}})();var lv;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(lv||(lv={}));const bH=45*Math.PI/180,EH=1,by=.1,Ey=500,TH=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class qA extends lH{static get IDENTITY(){return CH()}static get ZERO(){return SH()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return lv}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,A,d,l,S,k,U,V,$,X,ee,ue,we){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=A,this[5]=d,this[6]=l,this[7]=S,this[8]=k,this[9]=U,this[10]=V,this[11]=$,this[12]=X,this[13]=ee,this[14]=ue,this[15]=we,this.check()}setRowMajor(e,n,i,r,A,d,l,S,k,U,V,$,X,ee,ue,we){return this[0]=e,this[1]=A,this[2]=k,this[3]=X,this[4]=n,this[5]=d,this[6]=U,this[7]=ee,this[8]=i,this[9]=l,this[10]=V,this[11]=ue,this[12]=r,this[13]=S,this[14]=$,this[15]=we,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(TH)}fromObject(e){return this.check()}fromQuaternion(e){return pH(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:A,near:d=by,far:l=Ey}=e;return l===1/0?PH(this,n,i,r,A,d):gH(this,n,i,r,A,d,l),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return xH(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:A,near:d=by,far:l=Ey}=e;return vH(this,n,i,r,A,d,l),this.check()}orthographic(e){const{fovy:n=bH,aspect:i=EH,focalDistance:r=1,near:A=by,far:d=Ey}=e;IS(n);const l=n/2,S=r*Math.tan(l),k=S*i;return this.ortho({left:-k,right:k,bottom:-S,top:S,near:A,far:d})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:A=500}=e;return IS(n),_H(this,n,i,r,A),this.check()}determinant(){return hH(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],A=1/i[1],d=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*A,e[2]=this[2]*d,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*A,e[6]=this[6]*d,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*A,e[10]=this[10]*d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],A=1/i[1],d=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*A,e[2]=this[2]*d,e[3]=this[4]*r,e[4]=this[5]*A,e[5]=this[6]*d,e[6]=this[8]*r,e[7]=this[9]*A,e[8]=this[10]*d,e}transpose(){return cH(this,this),this.check()}invert(){return Av(this,this),this.check()}multiplyLeft(e){return Vc(this,e,this),this.check()}multiplyRight(e){return Vc(this,this,e),this.check()}rotateX(e){return Ik(this,this,e),this.check()}rotateY(e){return dH(this,this,e),this.check()}rotateZ(e){return kk(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return fH(this,this,e,n),this.check()}scale(e){return cw(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Cm(this,this,e),this.check()}transform(e,n){return e.length===4?(n=F0(n||[-0,-0,-0,-0],e,this),vy(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=HQ(n||[-0,-0],e,this);break;case 3:r=Pk(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return vy(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=WQ(n||[-0,-0],e,this);break;case 3:i=Ck(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return vy(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let tg,ng;function SH(){return tg||(tg=new qA([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(tg)),tg}function CH(){return ng||(ng=new qA,Object.freeze(ng)),ng}function IS(t){if(t>Math.PI*2)throw Error("expected radians")}function PH(t,e,n,i,r,A){const d=2*A/(n-e),l=2*A/(r-i),S=(n+e)/(n-e),k=(r+i)/(r-i),U=-1,V=-1,$=-2*A;return t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=S,t[9]=k,t[10]=U,t[11]=V,t[12]=0,t[13]=0,t[14]=$,t[15]=0,t}const kS=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,MH={lightSources:{}};function Ty(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function IH(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return e?r["lighting_uAmbientLight.color"]=Ty(e):r["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((A,d)=>{r["lighting_uPointLight[".concat(d,"].color")]=Ty(A),r["lighting_uPointLight[".concat(d,"].position")]=A.position,r["lighting_uPointLight[".concat(d,"].attenuation")]=A.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((A,d)=>{r["lighting_uDirectionalLight[".concat(d,"].color")]=Ty(A),r["lighting_uDirectionalLight[".concat(d,"].direction")]=A.direction}),r.lighting_uDirectionalLightCount=i.length,r}function Dk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:MH;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},IH({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return Dk({lightSources:e})}return{}}const Bk={name:"lights",vs:kS,fs:kS,getUniforms:Dk,defines:{MAX_LIGHTS:3}},kH=new Uint8Array([0,255,255,255]),LH={pickingSelectedColor:null,pickingHighlightColor:kH,pickingActive:!1,pickingAttribute:!1};function DH(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:LH;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const BH=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,RH=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,OH={name:"picking",vs:BH,fs:RH,getUniforms:DH},Rk=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,zH={};function FH(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(A=>A/255)}}function Ok(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zH;if(!("material"in t))return{};const{material:e}=t;return e?FH(e):{lighting_uEnabled:!1}}const zk={name:"gouraud-lighting",dependencies:[Bk],vs:Rk,defines:{LIGHTING_VERTEX:1},getUniforms:Ok},Fk={name:"phong-lighting",dependencies:[Bk],fs:Rk,defines:{LIGHTING_FRAGMENT:1},getUniforms:Ok},NH=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,UH={name:"transform",vs:NH,fs:null};class Xd{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Xd(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:A={},varyings:d=[],bufferMode:l=35981,transpileToGLSL100:S=!1}=e,k=this._getModuleList(e.modules),U=this._getHash(n),V=this._getHash(i),$=k.map(ce=>this._getHash(ce.name)).sort(),X=d.map(ce=>this._getHash(ce)),ee=Object.keys(r).sort(),ue=Object.keys(A).sort(),we=[],ie=[];for(const ce of ee)we.push(this._getHash(ce)),we.push(this._getHash(r[ce]));for(const ce of ue)ie.push(this._getHash(ce)),ie.push(this._getHash(A[ce]));const Ae="".concat(U,"/").concat(V,"D").concat(we.join("/"),"M").concat($.join("/"),"I").concat(ie.join("/"),"V").concat(X.join("/"),"H").concat(this.stateHash,"B").concat(l).concat(S?"T":"");if(!this._programCache[Ae]){const ce=wQ(this.gl,{vs:n,fs:i,modules:k,inject:A,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:S});this._programCache[Ae]=new pk(this.gl,{hash:Ae,vs:ce.vs,fs:ce.fs,varyings:d,bufferMode:l}),this._getUniforms[Ae]=ce.getUniforms||(Ce=>{}),this._useCounts[Ae]=0}return this._useCounts[Ae]++,this._programCache[Ae]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let A=0,d=this._defaultModules.length;A<d;++A){const l=this._defaultModules[A],S=l.name;n[r++]=l,i[S]=!0}for(let A=0,d=e.length;A<d;++A){const l=e[A],S=l.name;i[S]||(n[r++]=l,i[S]=!0)}return n.length=r,n}}const VH={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function jH(t,e,n){const i={};let r=e.indices;for(const A in e.attributes){const d=e.attributes[A],l=GH(A,n);if(A==="indices")r=d;else if(d.constant)i[l]=d.value;else{const S=d.value,k={...d};delete k.value,i[l]=[new xi(t,S),k],QH(A,k)}}if(r){const A=r.value||r;en(A instanceof Uint16Array||A instanceof Uint32Array,'attribute array for "indices" must be of integer type');const d={size:1,isIndexed:r.isIndexed===void 0?!0:r.isIndexed};i.indices=[new xi(t,{data:A,target:34963}),d]}return i}function GH(t,e){const{attributeMap:n=VH}=e||{};return n&&n[t]||t}function QH(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}en(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Lh=2,HH=1e4,WH="Model needs drawMode and vertexCount",LS=()=>{},$H={};class _u{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:i=Sl("model")}=n;en(p_(e)),this.id=i,this.gl=e,this.id=n.id||Sl("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Xd.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:A,defines:d,inject:l,varyings:S,bufferMode:k,transpileToGLSL100:U}=e;this.programProps={program:n,vs:i,fs:r,modules:A,defines:d,inject:l,varyings:S,bufferMode:k,transpileToGLSL100:U},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},en(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),WH)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:A,defines:d,inject:l,varyings:S,bufferMode:k,transpileToGLSL100:U}=e;this.programProps={program:n,vs:i,fs:r,modules:A,defines:d,inject:l,varyings:S,bufferMode:k,transpileToGLSL100:U},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return en(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return en(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=jH(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(w0(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return sw(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:A={},transformFeedback:d=this.transformFeedback,parameters:l={},vertexArray:S=this.vertexArray}=e;this.setAttributes(A),this.updateModuleSettings(n),this.setUniforms(r);let k;_n.priority>=Lh&&(k=this._logDrawCallStart(Lh));const U=this.vertexArray.getDrawParams(),{isIndexed:V=U.isIndexed,indexType:$=U.indexType,indexOffset:X=U.indexOffset,vertexArrayInstanced:ee=U.isInstanced}=this.props;ee&&!this.isInstanced&&_n.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:ue,instanceCount:we}=this,{onBeforeRender:ie=LS,onAfterRender:Ae=LS}=this.props;ie(),this.program.setUniforms(this.uniforms);const ce=this.program.draw(Object.assign($H,e,{logPriority:k,uniforms:null,framebuffer:i,parameters:l,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:S,transformFeedback:d,isIndexed:V,indexType:$,isInstanced:ue,instanceCount:we,offset:V?X:0}));return Ae(),_n.priority>=Lh&&this._logDrawCallEnd(k,S,i),ce}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:A}=e;i&&this._setFeedbackBuffers(i),n&&(A=Object.assign({},A,{35977:n})),r.forEach(d=>d.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:A}))}finally{r.forEach(d=>d.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return _n.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:A,inject:d,defines:l,varyings:S,bufferMode:k,transpileToGLSL100:U}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:A,inject:d,defines:l,varyings:S,bufferMode:k,transpileToGLSL100:U}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}en(n instanceof pk,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new zG(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof xi&&n.delete()}}_setAnimationProps(e){this.animated&&en(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(w0(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new gk(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:HH;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),_n.group(Lh,">>> DRAWING MODEL ".concat(this.id),{collapsed:_n.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(e===void 0)return;const A=UG({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:d,unusedTable:l,unusedCount:S}=mS({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:k,count:U}=mS({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});U>0&&_n.log("MISSING UNIFORMS",Object.keys(k))(),S>0&&_n.log("UNUSED UNIFORMS",Object.keys(l))();const V=jG(this.vertexArray.configuration);_n.table(e,A)(),_n.table(e,d)(),_n.table(e+1,V)(),r&&r.log({logLevel:Lh,message:"Rendered to ".concat(r.id)}),_n.groupEnd(Lh)()}}class ZH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof xi?i:i.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&en(Zn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const A=this.feedbackMap[r];r in n&&(i[A]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const A=i[r];if(typeof A=="string"){const d=n[A],{byteLength:l,usage:S,accessor:k}=d;i[r]=this._createNewBuffer(r,{byteLength:l,usage:S,accessor:k})}}return i}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new gk(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const A=this.feedbackMap[r];n[r]=e.feedbackBuffers[A],i[A]=e.sourceBuffers[r],en(i[A]instanceof xi)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new xi(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}const qH="transform_uSampler_",Pm="transform_uSize_",DS="transform_position";function YH(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,d=Object.keys(n).length,l=null;const S={};let k=e,U={};if(d>0||i){const V=k.split(`
`),$=V.slice();if(V.forEach((X,ee,ue)=>{if(d>0){const we=tW(X,n);if(we){const{updatedLine:ie,inject:Ae}=we;$[ee]=ie,U=sv([U,Ae]),Object.assign(S,we.samplerTextureMap),d--}}i&&!l&&(l=eW(X,i))}),i){en(r);const X="".concat(Pm).concat(i),ee="uniform vec2 ".concat(X,`;
`),ue="     vec2 ".concat(DS," = transform_getPos(").concat(X,`);
     gl_Position = vec4(`).concat(DS,`, 0, 1.);
`);U=sv([U,{"vs:#decl":ee,"vs:#main-start":ue}])}k=$.join(`
`)}return{vs:k,targetTextureType:l,inject:U,samplerTextureMap:S}}function XH(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let A,d;n&&({width:A,height:d}=i,r["".concat(Pm).concat(n)]=[A,d]);for(const l in e)({width:A,height:d}=e[l]),r["".concat(Pm).concat(l)]=[A,d];return r}function KH(t){return bk(t,["attribute","in"])}function JH(t){const e="".concat(qH).concat(t),n="".concat(Pm).concat(t),i="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}function eW(t,e){const n=bk(t,["varying","out"]);return n&&n.name===e?n.type:null}function tW(t,e){const n={},i=KH(t);if(!i)return null;const{type:r,name:A}=i;if(A&&e[A]){const d="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:l,sizeName:S,uniformDeclerations:k}=JH(A),U=kQ(r),V="  ".concat(r," ").concat(A," = transform_getInput(").concat(l,", ").concat(S,").").concat(U,`;
`);return n[l]=A,{updatedLine:d,inject:{"vs:#decl":k,"vs:#main-start":V},samplerTextureMap:n}}return null}const nW={10241:9728,10240:9728,10242:33071,10243:33071},iW="transform_output";class rW{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:A}=this.bindings[this.currentIndex],d=Object.assign({},n,e.attributes),l=Object.assign({},e.uniforms),S=Object.assign({},e.parameters);let k=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){d.transform_elementID=this.elementIDBuffer;for(const V in this.samplerTextureMap){const $=this.samplerTextureMap[V];l[V]=i[$]}this._setSourceTextureParameters();const U=XH({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:A});Object.assign(l,U)}return this.hasTargetTexture&&(k=!1,S.viewport=[0,0,r.width,r.height]),{attributes:d,framebuffer:r,uniforms:l,discard:k,parameters:S}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=m_(n);if(!e)return i;const r=i.constructor,A=LQ(this.targetTextureType),d=new r(i.length*A/4);let l=0;for(let S=0;S<i.length;S+=4)for(let k=0;k<A;k++)d[l++]=i[S+k];return d}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof $o)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,A=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:A}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,A)=>{A[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new xi(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:A}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),A){e.targetTexture=A;const{width:d,height:l}=A,{framebuffer:S}=e;S?(S.update({attachments:{36064:A},resizeAttachments:!1}),S.resize({width:d,height:l})):e.framebuffer=new is(this.gl,{id:"transform-framebuffer",width:d,height:l,attachments:{36064:A}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(nW)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const i=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:i}}_createNewTexture(e){const n=Sj(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:A,targetTextureType:d,inject:l,samplerTextureMap:S}=YH({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),k=sv([e.inject||{},l]);this.targetTextureType=d,this.samplerTextureMap=S;const U=e._fs||Ek({version:fk(r),input:this.targetTextureVarying,inputType:d,output:iW}),V=this.hasSourceTextures||this.targetTextureVarying?[UH].concat(e.modules||[]):e.modules;return{vs:r,fs:U,modules:V,uniforms:A,inject:k}}}let hw=class{static isSupported(e){return Zn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();en(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new _u(n,Object.assign({},e,{fs:e.fs||Ek({version:fk(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){sW(n)&&(this.bufferTransform=new ZH(e,n)),oW(n)&&(this.textureTransform=new rW(e,n)),en(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}};function sW(t){return!!(!w0(t.feedbackBuffers)||!w0(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function oW(t){return!!(!w0(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const BS={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class El{static get DRAW_MODE(){return BS}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Sl("geometry"),drawMode:i=BS.TRIANGLES,attributes:r={},indices:A=null,vertexCount:d=null}=e;this.id=n,this.drawMode=i|0,this.attributes={},this.userData={},this._setAttributes(r,A),this.vertexCount=d||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,en(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),(i==="POSITION"||i==="positions")&&!r.size&&(r.size=3),i==="indices"?(en(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const A=e[r],{value:d,size:l,constant:S}=A;!S&&d&&l>=1&&(i=Math.min(i,d.length/l))}return en(Number.isFinite(i)),i}}class aW extends El{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Sl("sphere-geometry")}=e,{indices:i,attributes:r}=AW(e);super({...e,id:n,indices:i,attributes:{...r,...e.attributes}})}}function AW(t){const{nlat:e=10,nlong:n=10}=t;let{radius:i=1}=t;const d=Math.PI-0,l=0,k=2*Math.PI-l,U=(e+1)*(n+1);if(typeof i=="number"){const ie=i;i=(Ae,ce,Ce,Ne,qe)=>ie}const V=new Float32Array(U*3),$=new Float32Array(U*3),X=new Float32Array(U*2),ee=U>65535?Uint32Array:Uint16Array,ue=new ee(e*n*6);for(let ie=0;ie<=e;ie++)for(let Ae=0;Ae<=n;Ae++){const ce=Ae/n,Ce=ie/e,Ne=Ae+ie*(n+1),qe=Ne*2,tt=Ne*3,lt=k*ce,at=d*Ce,ht=Math.sin(lt),Et=Math.cos(lt),St=Math.sin(at),Mt=Math.cos(at),Kt=Et*St,pn=Mt,ei=ht*St,li=i(Kt,pn,ei,ce,Ce);V[tt+0]=li*Kt,V[tt+1]=li*pn,V[tt+2]=li*ei,$[tt+0]=Kt,$[tt+1]=pn,$[tt+2]=ei,X[qe+0]=ce,X[qe+1]=1-Ce}const we=n+1;for(let ie=0;ie<n;ie++)for(let Ae=0;Ae<e;Ae++){const ce=(ie*e+Ae)*6;ue[ce+0]=Ae*we+ie,ue[ce+1]=Ae*we+ie+1,ue[ce+2]=(Ae+1)*we+ie,ue[ce+3]=(Ae+1)*we+ie,ue[ce+4]=Ae*we+ie+1,ue[ce+5]=(Ae+1)*we+ie+1}return{indices:{size:1,value:ue},attributes:{POSITION:{size:3,value:V},NORMAL:{size:3,value:$},TEXCOORD_0:{size:2,value:X}}}}let lW=1,uW=1;class Nk{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:A=1}=e,d=lW++,l={time:0,delay:n,duration:i,rate:r,repeat:A};return this._setChannelTime(l,this.time),this.channels.set(d,l),d}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:A,channel:d}=r;A.setTime(this.getTime(d))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=uW++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const cW=[255,255,255],hW=1;let fW=0;class fw{constructor(e={}){ae(this,"id",void 0),ae(this,"color",void 0),ae(this,"intensity",void 0),ae(this,"type","ambient");const{color:n=cW}=e,{intensity:i=hW}=e;this.id=e.id||"ambient-".concat(fW++),this.color=n,this.intensity=i}}const dW=[255,255,255],pW=1,gW=[0,0,-1];let mW=0;class uv{constructor(e={}){ae(this,"id",void 0),ae(this,"color",void 0),ae(this,"intensity",void 0),ae(this,"type","directional"),ae(this,"direction",void 0),ae(this,"shadow",void 0);const{color:n=dW}=e,{intensity:i=pW}=e,{direction:r=gW}=e,{_shadow:A=!1}=e;this.id=e.id||"directional-".concat(mW++),this.color=n,this.intensity=i,this.type="directional",this.direction=new Cl(r).normalize().toArray(),this.shadow=A}getProjectedLight(e){return this}}class _W{constructor(e,n={id:"pass"}){ae(this,"id",void 0),ae(this,"gl",void 0),ae(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class dw extends _W{constructor(...e){super(...e),ae(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return mu(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:A,onViewportActive:d,clearStack:l=!0,clearCanvas:S=!0}=e;e.pass=e.pass||"unknown";const k=this.gl;S&&vW(k,n),l&&(this._lastRenderIndex=-1);const U=[];for(const V of r){const $=A&&A[V.id];d==null||d(V);const X=this._getDrawLayerParams(V,e),ee=V.subViewports||[V];for(const ue of ee){const we=this._drawLayersInViewport(k,{target:n,moduleParameters:i,viewport:ue,view:$,pass:e.pass,layers:e.layers},X);U.push(we)}}return U}_getDrawLayerParams(e,{layers:n,pass:i,isPicking:r=!1,layerFilter:A,cullRect:d,effects:l,moduleParameters:S},k=!1){const U=[],V=Uk(this._lastRenderIndex+1),$={layer:n[0],viewport:e,isPicking:r,renderPass:i,cullRect:d},X={};for(let ee=0;ee<n.length;ee++){const ue=n[ee],we=this._shouldDrawLayer(ue,$,A,X),ie={shouldDrawLayer:we};we&&!k&&(ie.layerRenderIndex=V(ue,we),ie.moduleParameters=this._getModuleParameters(ue,l,i,S),ie.layerParameters=this.getLayerParameters(ue,ee,e)),U[ee]=ie}return U}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:A,viewport:d,view:l},S){const k=yW(e,{moduleParameters:i,target:A,viewport:d});if(l&&l.props.clear){const V=l.props.clear===!0?{color:!0,depth:!0}:l.props.clear;$A(e,{scissorTest:!0,scissor:k},()=>sw(e,V))}const U={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};mu(e,{viewport:k});for(let V=0;V<n.length;V++){const $=n[V],{shouldDrawLayer:X,layerRenderIndex:ee,moduleParameters:ue,layerParameters:we}=S[V];if(X&&$.props.pickable&&U.pickableCount++,$.isComposite)U.compositeCount++;else if(X){U.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,ee),ue.viewport=d;try{$._drawLayer({moduleParameters:ue,uniforms:{layerIndex:ee},parameters:we})}catch(ie){$.raiseError(ie,"drawing ".concat($," to ").concat(r))}}}return U}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let d=e.parent;for(;d;){if(!d.props.visible||!d.filterSubLayer(n))return!1;n.layer=d,d=d.parent}if(i){const l=n.layer.id;if(l in r||(r[l]=i(n)),!r[l])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var A;const d=Object.assign(Object.create(((A=e.internalState)===null||A===void 0?void 0:A.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Zc(this.gl)});if(n)for(const S of n){var l;Object.assign(d,(l=S.getModuleParameters)===null||l===void 0?void 0:l.call(S,e))}return Object.assign(d,this.getModuleParameters(e,n),r)}}function Uk(t=0,e={}){const n={},i=(r,A)=>{const d=r.props._offset,l=r.id,S=r.parent&&r.parent.id;let k;if(S&&!(S in e)&&i(r.parent,!1),S in n){const U=n[S]=n[S]||Uk(e[S],e);k=U(r,A),n[l]=U}else Number.isFinite(d)?(k=d+(e[S]||0),n[l]=null):k=t;return A&&k>=t&&(t=k+1),e[l]=k,k};return i}function yW(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&n.id!=="default-framebuffer",A=e&&e.devicePixelRatio||Zc(t),d=r?n.height:t.drawingBufferHeight,l=i;return[l.x*A,d-(l.y+l.height)*A,l.width*A,l.height*A]}function vW(t,e){const n=e?e.width:t.drawingBufferWidth,i=e?e.height:t.drawingBufferHeight;mu(t,{viewport:[0,0,n,i]}),t.clear(16640)}class xW extends dw{constructor(e,n){super(e,n),ae(this,"shadowMap",void 0),ae(this,"depthBuffer",void 0),ae(this,"fbo",void 0),this.shadowMap=new $o(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Xh(e,{format:33189,width:1,height:1}),this.fbo=new is(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;$A(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=Zc(this.gl),A=i.width*r,d=i.height*r;(A!==n.width||d!==n.height)&&n.resize({width:A,height:d}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Vk="#define SMOOTH_EDGE_RADIUS 0.5",wW=`
`.concat(Vk,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),bW=`
`.concat(Vk,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),EW={name:"geometry",vs:wW,fs:bW},TW=Object.keys($n).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat($n[t],";")).join(""),SW=Object.keys(jA).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(jA[t],";")).join(""),CW=Object.keys(gu).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(gu[t],";")).join(""),PW="".concat(TW,`
`).concat(SW,`
`).concat(CW,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function MW(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function Kd(t){let e={},n;return i=>{for(const r in i)if(!MW(i[r],e[r])){n=t(i),e=i;break}return n}}const RS=[0,0,0,0],IW=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],jk=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],kW=[0,0,0],Gk=[0,0,0],LW=Kd(RW);function Qk(t,e,n=Gk){n.length<3&&(n=[n[0],n[1],0]);let i=n,r,A=!0;switch(e===$n.LNGLAT_OFFSETS||e===$n.METER_OFFSETS?r=n:r=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case jA.WEB_MERCATOR:(e===$n.LNGLAT||e===$n.CARTESIAN)&&(r=[0,0,0],A=!1);break;case jA.WEB_MERCATOR_AUTO_OFFSET:e===$n.LNGLAT?i=r:e===$n.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case jA.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case jA.GLOBE:A=!1,r=null;break;default:A=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:A}}function DW(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:A,viewProjectionMatrix:d}=t,l=RS,S=RS,k=t.cameraPosition;const{geospatialOrigin:U,shaderCoordinateOrigin:V,offsetMode:$}=Qk(t,e,n);return $&&(S=t.projectPosition(U||V),k=[k[0]-S[0],k[1]-S[1],k[2]-S[2]],S[3]=1,l=F0([],S,d),A=i||A,d=Vc([],r,A),d=Vc([],d,IW)),{viewMatrix:A,viewProjectionMatrix:d,projectionCenter:l,originCommon:S,cameraPosCommon:k,shaderCoordinateOrigin:V,geospatialOrigin:U}}function BW({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=$n.DEFAULT,coordinateOrigin:r=Gk,autoWrapLongitude:A=!1}){i===$n.DEFAULT&&(i=t.isGeospatial?$n.LNGLAT:$n.CARTESIAN);const d=LW({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return d.project_uWrapLongitude=A,d.project_uModelMatrix=n||jk,d}function RW({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:A,originCommon:d,cameraPosCommon:l,shaderCoordinateOrigin:S,geospatialOrigin:k}=DW(t,n,i),U=t.getDistanceScales(),V=[t.width*e,t.height*e],$=F0([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,X={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:S,project_uCommonOrigin:d.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:V,project_uDevicePixelRatio:e,project_uFocalDistance:$,project_uCommonUnitsPerMeter:U.unitsPerMeter,project_uCommonUnitsPerWorldUnit:U.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:kW,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:A,project_uModelMatrix:jk,project_uCameraPosition:l};if(k){const ee=t.getDistanceScales(k);switch(n){case $n.METER_OFFSETS:X.project_uCommonUnitsPerWorldUnit=ee.unitsPerMeter,X.project_uCommonUnitsPerWorldUnit2=ee.unitsPerMeter2;break;case $n.LNGLAT:case $n.LNGLAT_OFFSETS:t._pseudoMeters||(X.project_uCommonUnitsPerMeter=ee.unitsPerMeter),X.project_uCommonUnitsPerWorldUnit=ee.unitsPerDegree,X.project_uCommonUnitsPerWorldUnit2=ee.unitsPerDegree2;break;case $n.CARTESIAN:X.project_uCommonUnitsPerWorldUnit=[1,1,ee.unitsPerMeter[2]],X.project_uCommonUnitsPerWorldUnit2=[0,0,ee.unitsPerMeter2[2]];break}}return X}const OW={};function zW(t=OW){return"viewport"in t?BW(t):{}}const pw={name:"project",dependencies:[RQ,EW],vs:PW,getUniforms:zW};function FW(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function l0(t,e){const n=F0([],e,t);return Lk(n,n,1/n[3]),n}function OS(t,e){const n=t%e;return n<0?e+n:n}function cv(t,e,n){return t<e?e:t>n?n:t}function NW(t){return Math.log(t)*Math.LOG2E}const gw=Math.log2||NW;function yu(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const GA=Math.PI,Hk=GA/4,rA=GA/180,hv=180/GA,C0=512,Mm=4003e4,ig=85.051129,UW=1.5;function VW(t){return gw(t)}function Im(t){const[e,n]=t;yu(Number.isFinite(e)),yu(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=e*rA,r=n*rA,A=C0*(i+GA)/(2*GA),d=C0*(GA+Math.log(Math.tan(Hk+r*.5)))/(2*GA);return[A,d]}function P0(t){const[e,n]=t,i=e/C0*(2*GA)-GA,r=2*(Math.atan(Math.exp(n/C0*(2*GA)-GA))-Hk);return[i*hv,r*hv]}function jW(t){const{latitude:e}=t;yu(Number.isFinite(e));const n=Math.cos(e*rA);return VW(Mm*n)-9}function Sy(t){const e=Math.cos(t*rA);return C0/Mm/e}function fv(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;yu(Number.isFinite(e)&&Number.isFinite(n));const r=C0,A=Math.cos(e*rA),d=r/360,l=d/A,S=r/Mm/A,k={unitsPerMeter:[S,S,S],metersPerUnit:[1/S,1/S,1/S],unitsPerDegree:[d,l,S],degreesPerUnit:[1/d,1/l,1/S]};if(i){const U=rA*Math.tan(e*rA)/A,V=d*U/2,$=r/Mm*U,X=$/l*S;k.unitsPerDegree2=[0,V,$],k.unitsPerMeter2=[X,0,X]}return k}function Wk(t,e){const[n,i,r]=t,[A,d,l]=e,{unitsPerMeter:S,unitsPerMeter2:k}=fv({longitude:n,latitude:i,highPrecision:!0}),U=Im(t);U[0]+=A*(S[0]+k[0]*d),U[1]+=d*(S[1]+k[1]*d);const V=P0(U),$=(r||0)+(l||0);return Number.isFinite(r)||Number.isFinite(l)?[V[0],V[1],$]:V}function GW(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:A,center:d}=t,l=FW();Cm(l,l,[0,0,-r]),Ik(l,l,-n*rA),kk(l,l,i*rA);const S=A/e;return cw(l,l,[S,S,S]),d&&Cm(l,l,KQ([],d)),l}function QW(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:A,center:d,scale:l,nearZMultiplier:S=1,farZMultiplier:k=1}=t;let{fovy:U=km(UW)}=t;i!==void 0&&(U=km(i));const V=U*rA,$=r*rA,X=$k(U);let ee=X;d&&(ee+=d[2]*l/Math.cos($)/n);const ue=V*(.5+(A?A[1]:0)/n),we=Math.sin(ue)*ee/Math.sin(cv(Math.PI/2-$-ue,.01,Math.PI-.01)),ie=Math.sin($)*we+ee,Ae=ee*10,ce=Math.min(ie*k,Ae);return{fov:V,aspect:e/n,focalDistance:X,near:S,far:ce}}function km(t){return 2*Math.atan(.5/t)*hv}function $k(t){return .5/Math.tan(.5*t*rA)}function Zk(t,e){const[n,i,r=0]=t;return yu(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),l0(e,[n,i,r,1])}function mw(t,e,n=0){const[i,r,A]=t;if(yu(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(A))return l0(e,[i,r,A,1]);const d=l0(e,[i,r,0,1]),l=l0(e,[i,r,1,1]),S=d[2],k=l[2],U=S===k?0:((n||0)-S)/(k-S);return Sk([],d,l,U)}function HW(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:A=24,offset:d=[0,0]}=t,[[l,S],[k,U]]=i,V=WW(t.padding),$=Im([l,cv(U,-ig,ig)]),X=Im([k,cv(S,-ig,ig)]),ee=[Math.max(Math.abs(X[0]-$[0]),r),Math.max(Math.abs(X[1]-$[1]),r)],ue=[e-V.left-V.right-Math.abs(d[0])*2,n-V.top-V.bottom-Math.abs(d[1])*2];yu(ue[0]>0&&ue[1]>0);const we=ue[0]/ee[0],ie=ue[1]/ee[1],Ae=(V.right-V.left)/2/we,ce=(V.top-V.bottom)/2/ie,Ce=[(X[0]+$[0])/2+Ae,(X[1]+$[1])/2+ce],Ne=P0(Ce),qe=Math.min(A,gw(Math.abs(Math.min(we,ie))));return yu(Number.isFinite(qe)),{longitude:Ne[0],latitude:Ne[1],zoom:qe}}function WW(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(yu(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const zS=Math.PI/180;function $W(t,e=0){const{width:n,height:i,unproject:r}=t,A={targetZ:e},d=r([0,i],A),l=r([n,i],A);let S,k;const U=t.fovy?.5*t.fovy*zS:Math.atan(.5/t.altitude),V=(90-t.pitch)*zS;return U>V-.01?(S=FS(t,0,e),k=FS(t,n,e)):(S=r([0,0],A),k=r([n,0],A)),[d,l,k,S]}function FS(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=l0(i,[e,0,1,1]),A=l0(i,[e,t.height,1,1]),l=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(A[2]-r[2]),S=Sk([],r,A,l),k=P0(S);return k.push(n),k}const NS=512;function ZW(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:A,zoom:d,bearing:l=0}=t;(r<-180||r>180)&&(r=OS(r+180,360)-180),(l<-180||l>180)&&(l=OS(l+180,360)-180);const S=gw(n/NS);if(d<=S)d=S,A=0;else{const k=n/2/Math.pow(2,d),U=P0([0,k])[1];if(A<U)A=U;else{const V=P0([0,NS-k])[1];A>V&&(A=V)}}return{width:e,height:n,longitude:r,latitude:A,zoom:d,pitch:i,bearing:l}}const qW=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,YW=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,XW=Kd(n$),KW=Kd(i$),JW=[0,0,0,1],e$=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function t$(t,e){const[n,i,r]=t,A=mw([n,i,r],e);return Number.isFinite(r)?A:[A[0],A[1],0]}function n$({viewport:t,center:e}){return new qA(t.viewProjectionMatrix).invert().transform(e)}function i$({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,A=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(d=>t$(d,i));for(const d of e){const l=d.clone().translate(new Cl(t.center).negate()),S=A.map(U=>l.transform(U)),k=new qA().ortho({left:Math.min(...S.map(U=>U[0])),right:Math.max(...S.map(U=>U[0])),bottom:Math.min(...S.map(U=>U[1])),top:Math.max(...S.map(U=>U[1])),near:Math.min(...S.map(U=>-U[2])),far:Math.max(...S.map(U=>-U[2]))});n.push(k.multiplyRight(d))}return n}function r$(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||JW,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=XW({viewport:t.viewport,center:e.project_uCenter}),A=[],d=KW({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let l=0;l<t.shadowMatrices.length;l++){const S=d[l],k=S.clone().translate(new Cl(t.viewport.center).negate());e.project_uCoordinateSystem===$n.LNGLAT&&e.project_uProjectionMode===jA.WEB_MERCATOR?(d[l]=k,A[l]=r):(d[l]=S.clone().multiplyRight(e$),A[l]=k.transform(r))}for(let l=0;l<d.length;l++)i["shadow_uViewProjectionMatrices[".concat(l,"]")]=d[l],i["shadow_uProjectCenters[".concat(l,"]")]=A[l],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(l)]=t.shadowMaps[l]:i["shadow_uShadowMap".concat(l)]=t.dummyShadowMap;return i}const Cy={name:"shadow",dependencies:[pw],vs:qW,fs:YW,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?r$(t,e):{}},s$={color:[255,255,255],intensity:1},US=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],o$=[0,0,0,200/255];class __{constructor(e={}){ae(this,"id","lighting-effect"),ae(this,"props",void 0),ae(this,"shadowColor",o$),ae(this,"shadow",void 0),ae(this,"ambientLight",void 0),ae(this,"directionalLights",void 0),ae(this,"pointLights",void 0),ae(this,"shadowPasses",[]),ae(this,"shadowMaps",[]),ae(this,"dummyShadowMap",null),ae(this,"programManager",void 0),ae(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:A,views:d}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Xd.getDefaultProgramManager(e),Cy&&this.programManager.addDefaultModule(Cy)),this.dummyShadowMap||(this.dummyShadowMap=new $o(e,{width:1,height:1}));for(let l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:n,layerFilter:i,viewports:r,onViewportActive:A,views:d,moduleParameters:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Cy),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=new qA().lookAt({eye:new Cl(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new xW(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&n.length===0&&i.length===0&&(this.ambientLight=new fw(s$),this.directionalLights.push(new uv(US[0]),new uv(US[1])))}}class a${constructor(e={}){ae(this,"_pool",[]),ae(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:A=0,copy:d=!1,initialize:l=!1,maxCount:S}){const k=r||e&&e.constructor||Float32Array,U=n*i+A;if(ArrayBuffer.isView(e)){if(U<=e.length)return e;if(U*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new k(e.buffer,0,U)}let V=1/0;S&&(V=S*i+A);const $=this._allocate(k,U,l,V);return e&&d?$.set(e):l||$.fill(0,0,4),this._release(e),$}release(e){this._release(e)}_allocate(e,n,i,r){let A=Math.max(Math.ceil(n*this.opts.overAlloc),1);A>r&&(A=r);const d=this._pool,l=e.BYTES_PER_ELEMENT*A,S=d.findIndex(k=>k.byteLength>=l);if(S>=0){const k=new e(d.splice(S,1)[0],0,A);return i&&k.fill(0),k}return new e(A)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,A=n.findIndex(d=>d.byteLength>=r);A<0?n.push(i):(A>0||n.length<this.opts.poolSize)&&n.splice(A,0,i),n.length>this.opts.poolSize&&n.shift()}}const M0=new a$;function Df(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function A$(t,e){const n=t%e;return n<0?e+n:n}function l$(t){return[t[12],t[13],t[14]]}function u$(t){return{left:Dh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Dh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Dh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Dh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Dh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Dh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const VS=new Cl;function Dh(t,e,n,i){VS.set(t,e,n);const r=VS.len();return{distance:i/r,normal:new Cl(-t/r,-e/r,-n/r)}}function c$(t){return t-Math.fround(t)}let bf;function Py(t,e){const{size:n=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:t.length,A=(r-i)/n;bf=M0.allocate(bf,A,{type:Float32Array,size:n*2});let d=i,l=0;for(;d<r;){for(let S=0;S<n;S++){const k=t[d++];bf[l+S]=k,bf[l+S+n]=c$(k)}l+=n*2}return bf.subarray(0,A*n*2)}function h$(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const f$=Math.PI/180,d$=Df(),jS=[0,0,0],p$={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function g$({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:A,near:d,far:l}){const S=t/e,k=n?new qA().orthographic({fovy:i,aspect:S,focalDistance:r,near:d,far:l}):new qA().perspective({fovy:i,aspect:S,near:d,far:l});if(A){const{left:U=0,right:V=0,top:$=0,bottom:X=0}=A,ee=vl((U+t-V)/2,0,t)-t/2,ue=vl(($+e-X)/2,0,e)-e/2;k[8]-=ee*2/t,k[9]+=ue*2/e}return k}class ah{constructor(e={}){ae(this,"id",void 0),ae(this,"x",void 0),ae(this,"y",void 0),ae(this,"width",void 0),ae(this,"height",void 0),ae(this,"padding",void 0),ae(this,"isGeospatial",void 0),ae(this,"zoom",void 0),ae(this,"focalDistance",void 0),ae(this,"position",void 0),ae(this,"modelMatrix",void 0),ae(this,"distanceScales",void 0),ae(this,"scale",void 0),ae(this,"center",void 0),ae(this,"cameraPosition",void 0),ae(this,"projectionMatrix",void 0),ae(this,"viewMatrix",void 0),ae(this,"viewMatrixUncentered",void 0),ae(this,"viewMatrixInverse",void 0),ae(this,"viewProjectionMatrix",void 0),ae(this,"pixelProjectionMatrix",void 0),ae(this,"pixelUnprojectionMatrix",void 0),ae(this,"resolution",void 0),ae(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||p$,this.focalDistance=e.focalDistance||1,this.position=e.position||jS,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?jA.WEB_MERCATOR:jA.WEB_MERCATOR_AUTO_OFFSET:jA.IDENTITY}equals(e){return e instanceof ah?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&xd(e.projectionMatrix,this.projectionMatrix)&&xd(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const i=this.projectPosition(e),r=Zk(i,this.pixelProjectionMatrix),[A,d]=r,l=n?d:this.height-d;return e.length===2?[A,l]:[A,l,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,A,d]=e,l=n?A:this.height-A,S=i&&i*this.distanceScales.unitsPerMeter[2],k=mw([r,l,d],this.pixelUnprojectionMatrix,S),[U,V,$]=this.unprojectPosition(k);return Number.isFinite(d)?[U,V,$]:Number.isFinite(i)?[U,V,i]:[U,V]}projectPosition(e){const[n,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,i,r]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,i,r]}projectFlat(e){if(this.isGeospatial){const n=Im(e);return n[1]=vl(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?P0(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),A=this.unproject([0,this.height],n),d=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],A[0],d[0]),Math.min(i[1],r[1],A[1],d[1]),Math.max(i[0],r[0],A[0],d[0]),Math.max(i[1],r[1],A[1],d[1])]}getDistanceScales(e){return e?fv({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,u$(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=jW({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||fv({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:A,modelMatrix:d}=e;let l=jS;if(A&&(l=d?new qA(d).transformAsVector(A,[]):A),this.isGeospatial){const S=this.projectPosition([n,i,0]);this.center=new Cl(l).scale(this.distanceScales.unitsPerMeter).add(S)}else this.center=this.projectPosition(l)}_initMatrices(e){const{viewMatrix:n=d$,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:A,fovy:d=75,near:l=.1,far:S=1e3,padding:k=null,focalDistance:U=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new qA().multiplyRight(n).translate(new Cl(this.center).negate()),this.projectionMatrix=i||g$({width:this.width,height:this.height,orthographic:r,fovyRadians:A||d*f$,focalDistance:U,padding:k,near:l,far:S});const V=Df();Vc(V,V,this.projectionMatrix),Vc(V,V,this.viewMatrix),this.viewProjectionMatrix=V,this.viewMatrixInverse=Av([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=l$(this.viewMatrixInverse);const $=Df(),X=Df();cw($,$,[this.width/2,-this.height/2,1]),Cm($,$,[1,-1,0]),Vc(X,$,this.viewProjectionMatrix),this.pixelProjectionMatrix=X,this.pixelUnprojectionMatrix=Av(Df(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Nn.warn("Pixel project matrix not invertible")()}}ae(ah,"displayName","Viewport");class I0 extends ah{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:A=0,bearing:d=0,nearZMultiplier:l=.1,farZMultiplier:S=1.01,orthographic:k=!1,projectionMatrix:U,repeat:V=!1,worldOffset:$=0,position:X,padding:ee,legacyMeterSizes:ue=!1}=e;let{width:we,height:ie,altitude:Ae=1.5}=e;const ce=Math.pow(2,r);we=we||1,ie=ie||1;let Ce,Ne=null;if(U)Ae=U[5]/2,Ce=km(Ae);else{e.fovy?(Ce=e.fovy,Ae=$k(Ce)):Ce=km(Ae);let tt;if(ee){const{top:lt=0,bottom:at=0}=ee;tt=[0,vl((lt+ie-at)/2,0,ie)-ie/2]}Ne=QW({width:we,height:ie,scale:ce,center:X&&[0,0,X[2]*Sy(n)],offset:tt,pitch:A,fovy:Ce,nearZMultiplier:l,farZMultiplier:S})}let qe=GW({height:ie,pitch:A,bearing:d,scale:ce,altitude:Ae});$&&(qe=new qA().translate([512*$,0,0]).multiplyLeft(qe)),super({...e,width:we,height:ie,viewMatrix:qe,longitude:i,latitude:n,zoom:r,...Ne,fovy:Ce,focalDistance:Ae}),ae(this,"longitude",void 0),ae(this,"latitude",void 0),ae(this,"pitch",void 0),ae(this,"bearing",void 0),ae(this,"altitude",void 0),ae(this,"fovy",void 0),ae(this,"orthographic",void 0),ae(this,"_subViewports",void 0),ae(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=A,this.bearing=d,this.altitude=Ae,this.fovy=Ce,this.orthographic=k,this._subViewports=V?[]:null,this._pseudoMeters=ue,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const A=r?new I0({...this,worldOffset:r}):this;this._subViewports.push(A)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e),r=(e[2]||0)*Sy(e[1]);return[n,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e),r=(e[2]||0)/Sy(i);return[n,i,r]}addMetersToLngLat(e,n){return Wk(e,n)}panByPosition(e,n){const i=mw(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),A=MS([],r,QQ([],i)),d=MS([],this.center,A),[l,S]=this.unprojectFlat(d);return{longitude:l,latitude:S}}getBounds(e={}){const n=$W(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:A,latitude:d,zoom:l}=HW({width:i,height:r,bounds:e,...n});return new I0({width:i,height:r,longitude:A,latitude:d,zoom:l})}}ae(I0,"displayName","WebMercatorViewport");const GS=[0,0,0];function My(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof I0){const[r,A,d=0]=t,l=e.getDistanceScales([r,A]);i[2]=d*l.unitsPerMeter[2]}return i}function m$(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:A,fromCoordinateOrigin:d}=t;return r===$n.DEFAULT&&(r=e.isGeospatial?$n.LNGLAT:$n.CARTESIAN),A===void 0&&(A=r),d===void 0&&(d=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:A,fromCoordinateOrigin:d}}function qk(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:A}){let[d,l,S=0]=t;switch(n&&([d,l,S]=F0([],[d,l,S,1],n)),i){case $n.LNGLAT:return My([d,l,S],e,A);case $n.LNGLAT_OFFSETS:return My([d+r[0],l+r[1],S+(r[2]||0)],e,A);case $n.METER_OFFSETS:return My(Wk(r,[d,l,S]),e,A);case $n.CARTESIAN:default:return e.isGeospatial?[d+r[0],l+r[1],S+r[2]]:e.projectPosition([d,l,S])}}function Yk(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:A,fromCoordinateSystem:d,fromCoordinateOrigin:l}=m$(e),{autoOffset:S=!0}=e,{geospatialOrigin:k=GS,shaderCoordinateOrigin:U=GS,offsetMode:V=!1}=S?Qk(n,i,r):{},$=qk(t,{viewport:n,modelMatrix:A,coordinateSystem:d,coordinateOrigin:l,offsetMode:V});if(V){const X=n.projectPosition(k||U);Mk($,$,X)}return $}const _$=[255,255,255],y$=1,v$=[0,0,1],x$=[0,0,1];let w$=0;class Xk{constructor(e={}){ae(this,"id",void 0),ae(this,"color",void 0),ae(this,"intensity",void 0),ae(this,"type","point"),ae(this,"position",void 0),ae(this,"attenuation",void 0),ae(this,"projectedLight",void 0);const{color:n=_$}=e,{intensity:i=y$}=e,{position:r=x$}=e;this.id=e.id||"point-".concat(w$++),this.color=n,this.intensity=i,this.type="point",this.position=r,this.attenuation=b$(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,i=e.context.viewport,{coordinateSystem:r,coordinateOrigin:A}=e.props,d=Yk(this.position,{viewport:i,coordinateSystem:r,coordinateOrigin:A,fromCoordinateSystem:i.isGeospatial?$n.LNGLAT:$n.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=d,n}}function b$(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:v$}const Yc=Math.PI/180,E$=1e3*60*60*24,T$=2440588,S$=2451545,Lm=Yc*23.4397,C$=357.5291,P$=.98560028,M$=280.147,I$=360.9856235;function k$(t,e,n){const i=Yc*-n,r=Yc*e,A=D$(t),d=V$(A),l=F$(A,i)-d.rightAscension;return{azimuth:O$(l,r,d.declination),altitude:z$(l,r,d.declination)}}function QS(t,e,n){const{azimuth:i,altitude:r}=k$(t,e,n);return[Math.sin(i)*Math.cos(r),Math.cos(i)*Math.cos(r),-Math.sin(r)]}function L$(t){return(typeof t=="number"?t:t.getTime())/E$-.5+T$}function D$(t){return L$(t)-S$}function B$(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(Lm)-Math.tan(e)*Math.sin(Lm),Math.cos(n))}function R$(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(Lm)+Math.cos(e)*Math.sin(Lm)*Math.sin(n))}function O$(t,e,n){const i=t,r=e,A=n;return Math.atan2(Math.sin(i),Math.cos(i)*Math.sin(r)-Math.tan(A)*Math.cos(r))}function z$(t,e,n){const i=t,r=e,A=n;return Math.asin(Math.sin(r)*Math.sin(A)+Math.cos(r)*Math.cos(A)*Math.cos(i))}function F$(t,e){return Yc*(M$+I$*t)-e}function N$(t){return Yc*(C$+P$*t)}function U$(t){const e=t,n=Yc*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),i=Yc*102.9372;return e+n+i+Math.PI}function V$(t){const e=N$(t),n=U$(e);return{declination:R$(n,0),rightAscension:B$(n,0)}}class j$ extends uv{constructor(e){super(e),ae(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[r,A,d]=QS(this.timestamp,0,0);this.direction=[r,-d,A]}else{const{latitude:r,longitude:A}=n;this.direction=QS(this.timestamp,r,A)}return this}}const HS={blendFunc:[1,0,32771,0],blendEquation:32774};class Kk extends dw{constructor(...e){super(...e),ae(this,"pickZ",void 0),ae(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:A,pickingFBO:d,deviceRect:{x:l,y:S,width:k,height:U},cullRect:V,effects:$,pass:X="picking",pickZ:ee,moduleParameters:ue}){const we=this.gl;this.pickZ=ee;const ie=this._resetColorEncoder(ee),Ae=$A(we,{scissorTest:!0,scissor:[l,S,k,U],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...HS,blend:!ee},()=>super.render({target:d,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:A,cullRect:V,effects:$==null?void 0:$.filter(Ce=>Ce.useInPicking),pass:X,isPicking:!0,moduleParameters:ue}));return this._colorEncoderState=null,{decodePickingColor:ie&&Q$.bind(null,ie),stats:Ae}}shouldDrawLayer(e){const{pickable:n,operation:i}=e.props;return n&&i.includes("draw")||i.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters},{pickable:A,operation:d}=e.props;return this._colorEncoderState?A&&d.includes("draw")&&(Object.assign(r,HS),r.blend=!0,r.blendColor=G$(this._colorEncoderState,e,i)):r.blend=!1,d.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function G$(t,e,n){const{byLayer:i,byAlpha:r}=t;let A,d=i.get(e);return d?(d.viewports.push(n),A=d.a):(A=i.size+1,A<=255?(d={a:A,layer:e,viewports:[n]},i.set(e,d),r[A]=d):(Nn.warn("Too many pickable layers, only picking the first 255")(),A=0)),[0,0,0,A/255]}function Q$(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Oh={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Dm=Symbol.for("component"),cc=Symbol.for("propTypes"),Iy=Symbol.for("deprecatedProps"),u0=Symbol.for("asyncPropDefaults"),Xc=Symbol.for("asyncPropOriginal"),Ju=Symbol.for("asyncPropResolved");function _w(t,e=()=>!0){return Array.isArray(t)?Jk(t,e,[]):e(t)?[t]:[]}function Jk(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?Jk(r,e,n):e(r)&&n.push(r)}return n}function H$({target:t,source:e,start:n=0,count:i=1}){const r=e.length,A=i*r;let d=0;for(let l=n;d<r;d++)t[l++]=e[d];for(;d<A;)d<A-d?(t.copyWithin(n+d,n,n+d),d*=2):(t.copyWithin(n+d,n,n+A-d),d=A);return t}class W${constructor(e,n,i){ae(this,"id",void 0),ae(this,"context",void 0),ae(this,"isLoaded",void 0),ae(this,"persistent",void 0),ae(this,"_loadCount",0),ae(this,"_subscribers",new Set),ae(this,"_data",void 0),ae(this,"_loader",void 0),ae(this,"_error",void 0),ae(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=wm(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(A=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=A)}).catch(A=>{this._loadCount===i&&(this.isLoaded=!0,this._error=A||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const A of this._subscribers)A.onChange(this.getData())}}class $${constructor({gl:e,protocol:n}){ae(this,"protocol",void 0),ae(this,"_context",void 0),ae(this,"_resources",void 0),ae(this,"_consumers",void 0),ae(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let A=this._resources[e];A?A.setData(n,i):(A=new W$(e,n,this._context),this._resources[e]=A),A.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],A=this._resources[r.resourceId];A&&A.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:A,protocol:d}=this;e.startsWith(d)&&(e=e.replace(d,""),A[e]||this.add({resourceId:e,data:null,persistent:!1}));const l=A[e];if(this._track(i,r,l,n),l)return l.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const A=this._consumers,d=A[e]=A[e]||{},l=d[n]||{},S=l.resourceId&&this._resources[l.resourceId];S&&(S.unsubscribe(l),this.prune()),i&&(d[n]=l,l.onChange=r,l.resourceId=i.id,i.subscribe(l))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const Z$=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Ah={name:"project32",dependencies:[pw],vs:Z$},lh={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...OH},q$=[pw],Y$=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function X$(t){const e=Xd.getDefaultProgramManager(t);for(const n of q$)e.addDefaultModule(n);for(const n of Y$)e.addShaderHook(n);return e}const K$="layerManager.setLayers",J$="layerManager.activateViewport";class eZ{constructor(e,{deck:n,stats:i,viewport:r,timeline:A}={}){ae(this,"layers",void 0),ae(this,"context",void 0),ae(this,"resourceManager",void 0),ae(this,"_lastRenderedLayers",[]),ae(this,"_needsRedraw",!1),ae(this,"_needsUpdate",!1),ae(this,"_nextLayers",null),ae(this,"_debug",!1),ae(this,"activateViewport",d=>{Js(J$,this,d),d&&(this.context.viewport=d)}),this.layers=[],this.resourceManager=new $$({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&X$(e),stats:i||new iw({id:"deck.gl"}),viewport:r||new ah({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:A||new Nk,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>n.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Js(K$,this,n,e),this._lastRenderedLayers=e;const i=_w(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const d of e)i[d.id]?Nn.warn("Multiple old layers with same id ".concat(d.id))():i[d.id]=d;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let A=!1;for(const d of r)if(d.hasUniformTransition()){A="Uniform transition in ".concat(d);break}this._needsUpdate=A,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const A=n[r.id];A===null&&Nn.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let d=null;try{this._debug&&A!==r&&r.validateProps(),A?(this._transferLayerState(A,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),d=r.isComposite?r.getSubLayers():null}catch(l){this._handleError("matching",l,r)}d&&this._updateSublayersRecursively(d,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Oh.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Oh.MATCHED,n!==e&&(e.lifecycle=Oh.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Oh.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Oh.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function xl(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!xl(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const A of i)if(!e.hasOwnProperty(A)||!xl(t[A],e[A],n-1))return!1;return!0}return!1}class tZ{constructor(e){ae(this,"width",void 0),ae(this,"height",void 0),ae(this,"views",void 0),ae(this,"viewState",void 0),ae(this,"controllers",void 0),ae(this,"timeline",void 0),ae(this,"_viewports",void 0),ae(this,"_viewportMap",void 0),ae(this,"_isUpdating",void 0),ae(this,"_needsRedraw",void 0),ae(this,"_needsUpdate",void 0),ae(this,"_eventManager",void 0),ae(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let A=i.length-1;A>=0;--A){const d=i[A];if(d.containsPixel(r)){const l=e.slice();return l[0]-=d.x,l[1]-=d.y,d.unproject(l,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=_w(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!xl(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Nn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const i=n.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:A=>{var d;return(d=this.getView(e.id))===null||d===void 0?void 0:d.makeViewport({viewState:A,width:this.width,height:this.height})}})}_updateController(e,n,i,r){const A=e.controller;if(A&&i){const d={...n,...A,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!r||r.constructor!==A.type)&&(r=this._createController(e,d)),r&&r.setProps(d),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const A=e[r],d=this.getViewState(A),l=A.makeViewport({viewState:d,width:this.width,height:this.height});let S=n[A.id];const k=!!A.controller;k&&!S&&(i=!0),(i||!k)&&S&&(S.finalize(),S=null),this.controllers[A.id]=this._updateController(A,d,l,S),l&&this._viewports.unshift(l)}for(const r in n){const A=n[r];A&&!this.controllers[r]&&A.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((i,r)=>!e[r].equals(n[r]))}}const nZ=/([0-9]+\.?[0-9]*)(%|px)/;function Gu(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=nZ.exec(t);if(e&&e.length>=3){const n=e[2]==="%",i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Qu(t,e){return t.relative?Math.round(t.position*e):t.position}function Es(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Kc{constructor(e){ae(this,"id",void 0),ae(this,"viewportInstance",void 0),ae(this,"_x",void 0),ae(this,"_y",void 0),ae(this,"_width",void 0),ae(this,"_height",void 0),ae(this,"_padding",void 0),ae(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:A="100%",height:d="100%",padding:l=null,viewportInstance:S}=e||{};Es(!S||S instanceof ah),this.viewportInstance=S,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Gu(i),this._y=Gu(r),this._width=Gu(A),this._height=Gu(d),this._padding=l&&{left:Gu(l.left||0),right:Gu(l.right||0),top:Gu(l.top||0),bottom:Gu(l.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&xl(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return!r.height||!r.width?null:new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)i!=="id"&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:Qu(this._x,e),y:Qu(this._y,n),width:Qu(this._width,e),height:Qu(this._height,n)};return this._padding&&(i.padding={left:Qu(this._padding.left,e),top:Qu(this._padding.top,n),right:Qu(this._padding.right,e),bottom:Qu(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Jd{constructor(e){ae(this,"_inProgress",void 0),ae(this,"_handle",void 0),ae(this,"_timeline",void 0),ae(this,"time",void 0),ae(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,(n=(i=this.settings).onStart)===null||n===void 0||n.call(i,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const WS=()=>{},dv={BREAK:1,SNAP_TO_END:2,IGNORE:3},iZ=t=>t,rZ=dv.BREAK;class sZ{constructor(e){ae(this,"getControllerState",void 0),ae(this,"props",void 0),ae(this,"propsInTransition",void 0),ae(this,"transition",void 0),ae(this,"onViewStateChange",void 0),ae(this,"onStateChange",void 0),ae(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:A,endProps:d,duration:l,easing:S}}=n,k=S(i/l),U=r.interpolateProps(A,d,k);this.propsInTransition=this.getControllerState({...this.props,...U}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Jd(e.timeline),this.onViewStateChange=e.onViewStateChange||WS,this.onStateChange=e.onStateChange||WS}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:A,endProps:d}=this.transition.settings;r={...i,...A===dv.SNAP_TO_END?d:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||n==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===dv.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),A=n.transitionInterpolator,d=A.getDuration?A.getDuration(e,n):n.transitionDuration;if(d===0)return;const l=A.initializeProps(e,r);this.propsInTransition={};const S={duration:d,easing:n.transitionEasing||iZ,interpolator:A,interruption:n.transitionInterruption||rZ,startProps:l.start,endProps:l.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(S),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class oZ{constructor(e){ae(this,"_propsToCompare",void 0),ae(this,"_propsToExtract",void 0),ae(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!xd(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const A of this._propsToExtract)(A in e||A in n)&&(i[A]=e[A],r[A]=n[A]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const i=e[n];Es(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const aZ=["longitude","latitude","zoom","bearing","pitch"],AZ=["longitude","latitude","zoom"];class yw extends oZ{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:aZ,required:AZ},super(i.transitionProps),ae(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:A}=this.opts;if(r&&A){const d=r(e),l=r(n),S=d.unproject(A);i.start.around=A,Object.assign(i.end,{around:l.project(S),aroundPosition:S,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const A of this._propsToExtract)r[A]=T0(e[A]||0,n[A]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const A=this.opts.makeViewport({...n,...r});Object.assign(r,A.panByPosition(n.aroundPosition,T0(e.around,n.around,i)))}return r}}const Hu={transitionDuration:0},lZ=300,rg=t=>1-(1-t)*(1-t),Bh={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Mc={};class e5{constructor(e){ae(this,"props",void 0),ae(this,"state",{}),ae(this,"transitionManager",void 0),ae(this,"eventManager",void 0),ae(this,"onViewStateChange",void 0),ae(this,"onStateChange",void 0),ae(this,"makeViewport",void 0),ae(this,"_controllerState",void 0),ae(this,"_events",{}),ae(this,"_interactionState",{isDragging:!1}),ae(this,"_customEvents",[]),ae(this,"_eventStartBlocked",null),ae(this,"_panMove",!1),ae(this,"invertPan",!1),ae(this,"dragMode","rotate"),ae(this,"inertia",0),ae(this,"scrollZoom",!0),ae(this,"dragPan",!0),ae(this,"dragRotate",!0),ae(this,"doubleClickZoom",!0),ae(this,"touchZoom",!0),ae(this,"touchRotate",!1),ae(this,"keyboard",!0),this.transitionManager=new sZ({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const A=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return A&&n&&n.stopPropagation(),A}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?lZ:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:A=!0,doubleClickZoom:d=!0,touchZoom:l=!0,touchRotate:S=!1,keyboard:k=!0}=e,U=!!this.onViewStateChange;this.toggleEvents(Bh.WHEEL,U&&i),this.toggleEvents(Bh.PAN,U),this.toggleEvents(Bh.PINCH,U&&(l||S)),this.toggleEvents(Bh.TRIPLE_PAN,U&&S),this.toggleEvents(Bh.DOUBLE_TAP,U&&d),this.toggleEvents(Bh.KEYBOARD,U&&k),this.scrollZoom=i,this.dragPan=r,this.dragRotate=A,this.doubleClickZoom=d,this.touchZoom=l,this.touchRotate=S,this.keyboard=k}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},A=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),A){const d=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:d})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,Hu,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,Hu,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],A=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(A,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:rg},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Hu,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],A=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(A,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:rg},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:A}=e;let d=2/(1+Math.exp(-Math.abs(A*i)));A<0&&d!==0&&(d=1/d);const l=this.controllerState.zoom({pos:n,scale:d});return this.updateViewport(l,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,Hu,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Hu,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],A=this.controllerState.rotate({pos:r});this.updateViewport(A,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:rg},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Mc._startPinchRotation=e.rotation,Mc._lastPinchEvent=e,this.updateViewport(i,Hu,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:Mc._startPinchRotation-i})}return this.updateViewport(n,Hu,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Mc._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=Mc;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let A=this.controllerState.rotateEnd();const d=Math.log2(e.scale),l=(d-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),S=Math.pow(2,d+l*n/2);A=A.zoom({pos:r,scale:S}).zoomEnd(),this.updateViewport(A,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:rg},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Mc._startPinchRotation=null,Mc._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:A,rotateSpeedY:d}=this.keyboard===!0?{}:this.keyboard,{controllerState:l}=this;let S;const k={};switch(e.srcEvent.code){case"Minus":S=n?l.zoomOut(i).zoomOut(i):l.zoomOut(i),k.isZooming=!0;break;case"Equal":S=n?l.zoomIn(i).zoomIn(i):l.zoomIn(i),k.isZooming=!0;break;case"ArrowLeft":n?(S=l.rotateLeft(A),k.isRotating=!0):(S=l.moveLeft(r),k.isPanning=!0);break;case"ArrowRight":n?(S=l.rotateRight(A),k.isRotating=!0):(S=l.moveRight(r),k.isPanning=!0);break;case"ArrowUp":n?(S=l.rotateUp(d),k.isRotating=!0):(S=l.moveUp(r),k.isPanning=!0);break;case"ArrowDown":n?(S=l.rotateDown(d),k.isRotating=!0):(S=l.moveDown(r),k.isPanning=!0);break;default:return!1}return this.updateViewport(S,this._getTransitionProps(),k),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Hu:e?{...n,transitionInterpolator:new yw({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class uZ{constructor(e,n){ae(this,"_viewportProps",void 0),ae(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const $S=5,cZ=1.2;class t5 extends uZ{constructor(e){const{width:n,height:i,latitude:r,longitude:A,zoom:d,bearing:l=0,pitch:S=0,altitude:k=1.5,position:U=[0,0,0],maxZoom:V=20,minZoom:$=0,maxPitch:X=60,minPitch:ee=0,startPanLngLat:ue,startZoomLngLat:we,startRotatePos:ie,startBearing:Ae,startPitch:ce,startZoom:Ce,normalize:Ne=!0}=e;Es(Number.isFinite(A)),Es(Number.isFinite(r)),Es(Number.isFinite(d)),super({width:n,height:i,latitude:r,longitude:A,zoom:d,bearing:l,pitch:S,altitude:k,maxZoom:V,minZoom:$,maxPitch:X,minPitch:ee,normalize:Ne,position:U},{startPanLngLat:ue,startZoomLngLat:we,startRotatePos:ie,startBearing:Ae,startPitch:ce,startZoom:Ce}),ae(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const A=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(A)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:A,startPitch:d}=this.getState();if(!r||A===void 0||d===void 0)return this;let l;return e?l=this._getNewRotation(e,r,d,A):l={bearing:A+n,pitch:d+i},this._getUpdatedState(l)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:A}=this.getState();if(A||(r=this.getViewportProps().zoom,A=this._unproject(n)||this._unproject(e)),!A)return this;const{maxZoom:d,minZoom:l}=this.getViewportProps();let S=r+Math.log2(i);S=vl(S,l,d);const k=this.makeViewport({...this.getViewportProps(),zoom:S});return this._getUpdatedState({zoom:S,...k.panByPosition(A,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:A}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(A-n.longitude)>180&&(i.longitude=A<0?A+360:A-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=vl(r,i,n);const{maxPitch:A,minPitch:d,pitch:l}=e;e.pitch=vl(l,d,A);const{normalize:S=!0}=e;return S&&Object.assign(e,ZW(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const A=e[0]-n[0],d=e[1]-n[1],l=e[1],S=n[1],{width:k,height:U}=this.getViewportProps(),V=A/k;let $=0;d>0?Math.abs(U-S)>$S&&($=d/(S-U)*cZ):d<0&&S>$S&&($=1-l/S),$=vl($,-1,1);const{minPitch:X,maxPitch:ee}=this.getViewportProps(),ue=r+180*V;let we=i;return $>0?we=i+$*(ee-i):$<0&&(we=i-$*(X-i)),{pitch:we,bearing:ue}}}class hZ extends e5{constructor(...e){super(...e),ae(this,"ControllerState",t5),ae(this,"transition",{transitionDuration:300,transitionInterpolator:new yw({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),ae(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class n5 extends Kc{get ViewportType(){return I0}get ControllerType(){return hZ}}ae(n5,"displayName","MapView");const fZ=new __;function dZ(t,e){var n,i;const r=(n=t.order)!==null&&n!==void 0?n:1/0,A=(i=e.order)!==null&&i!==void 0?i:1/0;return r-A}class pZ{constructor(){ae(this,"effects",void 0),ae(this,"_resolvedEffects",[]),ae(this,"_defaultEffects",[]),ae(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(i=>i.id===e.id)){const i=n.findIndex(r=>dZ(r,e)>0);i<0?n.push(e):n.splice(i,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(xl(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const r of this.effects)n[r.id]=r;const i=[];for(const r of e){const A=n[r.id];A&&A!==r?A.setProps?(A.setProps(r.props),i.push(A)):(A.cleanup(),i.push(r)):i.push(r),delete n[r.id]}for(const r in n)n[r].cleanup();this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(r=>r instanceof __)||this._resolvedEffects.push(fZ),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class gZ extends dw{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const mZ="deckRenderer.renderLayers";class _Z{constructor(e){ae(this,"gl",void 0),ae(this,"layerFilter",void 0),ae(this,"drawPickingColors",void 0),ae(this,"drawLayersPass",void 0),ae(this,"pickLayersPass",void 0),ae(this,"renderCount",void 0),ae(this,"_needsRedraw",void 0),ae(this,"renderBuffers",void 0),ae(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new gZ(e),this.pickLayersPass=new Kk(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||is.getDefaultFramebuffer(this.gl)};i.effects&&this._preRender(i.effects,i);const r=this.lastPostProcessEffect?this.renderBuffers[0]:i.target,A=n.render({...i,target:r});i.effects&&this._postRender(i.effects,i),this.renderCount++,Js(mZ,this,A,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const i of e)n.preRenderStats[i.id]=i.preRender(this.gl,n),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new is(this.gl),new is(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={...n,inputBuffer:i[0],swapBuffer:i[1],target:null};for(const A of e)if(A.postRender){if(A.id===this.lastPostProcessEffect){r.target=n.target,A.postRender(this.gl,r);break}const d=A.postRender(this.gl,r);r.inputBuffer=d,r.swapBuffer=d===i[0]?i[1]:i[0]}}}const yZ={pickedColor:null,pickedObjectIndex:-1};function vZ({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:A}){const{x:d,y:l,width:S,height:k}=A;let U=r*r,V=-1,$=0;for(let X=0;X<k;X++){const ee=X+l-i,ue=ee*ee;if(ue>U)$+=4*S;else for(let we=0;we<S;we++){if(t[$+3]-1>=0){const Ae=we+d-n,ce=Ae*Ae+ue;ce<=U&&(U=ce,V=$)}$+=4}}if(V>=0){const X=t.slice(V,V+4),ee=e(X);if(ee){const ue=Math.floor(V/4/S),we=V/4-ue*S;return{...ee,pickedColor:X,pickedX:d+we,pickedY:l+ue}}Nn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return yZ}function xZ({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const A=t.slice(i,i+4),d=A.join(",");if(!n.has(d)){const l=e(A);l?n.set(d,{...l,color:A}):Nn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function i5({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:A}){let d=e[0];e.length>1&&(d=bZ((t==null?void 0:t.pickedViewports)||e,{x:i,y:r}));let l;if(d){const S=[i-d.x,r-d.y];A!==void 0&&(S[2]=A),l=d.unproject(S)}return{color:null,layer:null,viewport:d,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:l,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function wZ(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:A,pickedLayer:d,pickedObjectIndex:l}=e,S=d?[d]:[];if(i==="hover"){const V=n.index,$=n.layerId,X=d?d.props.id:null;if(X!==$||l!==V){if(X!==$){const ee=r.find(ue=>ue.props.id===$);ee&&S.unshift(ee)}n.layerId=X,n.index=l,n.info=null}}const k=i5(t),U=new Map;return U.set(null,k),S.forEach(V=>{let $={...k};V===d&&($.color=A,$.index=l,$.picked=!0),$=r5({layer:V,info:$,mode:i});const X=$.layer;V===d&&i==="hover"&&(n.info=$),U.set(X.id,$),i==="hover"&&X.updateAutoHighlight($)}),U}function r5({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function bZ(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}class EZ{constructor(e){ae(this,"gl",void 0),ae(this,"pickingFBO",void 0),ae(this,"depthFBO",void 0),ae(this,"pickLayersPass",void 0),ae(this,"layerFilter",void 0),ae(this,"lastPickedInfo",void 0),ae(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new Kk(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},A=this.lastPickedInfo.info){const d=A&&A.layer&&A.layer.id,l=A&&A.viewport&&A.viewport.id,S=d?i.find($=>$.id===d):null,k=l&&r.find($=>$.id===l)||r[0],U=k&&k.unproject([e-k.x,n-k.y]);return{...A,...{x:e,y:n,viewport:k,coordinate:U,layer:S}}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new is(i),is.isSupported(i,{colorBufferFloat:!0}))){const r=new is(i);r.attach({36064:new $o(i,{format:Zn(i)?34836:6408,type:5126})}),this.depthFBO=r}(e=this.pickingFBO)===null||e===void 0||e.resize({width:i.canvas.width,height:i.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:A,radius:d=0,depth:l=1,mode:S="query",unproject3D:k,onViewportActive:U,effects:V}){const $=this._getPickable(e),X=Zc(this.gl);if(!$)return{result:[],emptyInfo:i5({viewports:i,x:r,y:A,pixelRatio:X})};this._resizeBuffer();const ee=cy(this.gl,[r,A],!0),ue=[ee.x+Math.floor(ee.width/2),ee.y+Math.floor(ee.height/2)],we=Math.round(d*X),{width:ie,height:Ae}=this.pickingFBO,ce=this._getPickingRect({deviceX:ue[0],deviceY:ue[1],deviceRadius:we,deviceWidth:ie,deviceHeight:Ae}),Ce={x:r-d,y:A-d,width:d*2+1,height:d*2+1};let Ne;const qe=[],tt=new Set;for(let lt=0;lt<l;lt++){let at;if(ce){const Et=this._drawAndSample({layers:$,views:n,viewports:i,onViewportActive:U,deviceRect:ce,cullRect:Ce,effects:V,pass:"picking:".concat(S)});at=vZ({...Et,deviceX:ue[0],deviceY:ue[1],deviceRadius:we,deviceRect:ce})}else at={pickedColor:null,pickedObjectIndex:-1};let ht;if(at.pickedLayer&&k&&this.depthFBO){const{pickedColors:Et}=this._drawAndSample({layers:[at.pickedLayer],views:n,viewports:i,onViewportActive:U,deviceRect:{x:at.pickedX,y:at.pickedY,width:1,height:1},cullRect:Ce,effects:V,pass:"picking:".concat(S,":z")},!0);Et[3]&&(ht=Et[0])}at.pickedLayer&&lt+1<l&&(tt.add(at.pickedLayer),at.pickedLayer.disablePickingIndex(at.pickedObjectIndex)),Ne=wZ({pickInfo:at,lastPickedInfo:this.lastPickedInfo,mode:S,layers:$,viewports:i,x:r,y:A,z:ht,pixelRatio:X});for(const Et of Ne.values())Et.layer&&qe.push(Et);if(!at.pickedColor)break}for(const lt of tt)lt.restorePickingColors();return{result:qe,emptyInfo:Ne.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:A,width:d=1,height:l=1,mode:S="query",maxObjects:k=null,onViewportActive:U,effects:V}){const $=this._getPickable(e);if(!$)return[];this._resizeBuffer();const X=Zc(this.gl),ee=cy(this.gl,[r,A],!0),ue=ee.x,we=ee.y+ee.height,ie=cy(this.gl,[r+d,A+l],!0),Ae=ie.x+ie.width,ce=ie.y,Ce={x:ue,y:ce,width:Ae-ue,height:we-ce},Ne=this._drawAndSample({layers:$,views:n,viewports:i,onViewportActive:U,deviceRect:Ce,cullRect:{x:r,y:A,width:d,height:l},effects:V,pass:"picking:".concat(S)}),qe=xZ(Ne),tt=new Map,lt=Number.isFinite(k);for(let at=0;at<qe.length&&!(lt&&k&&tt.size>=k);at++){const ht=qe[at];let Et={color:ht.pickedColor,layer:null,index:ht.pickedObjectIndex,picked:!0,x:r,y:A,pixelRatio:X};Et=r5({layer:ht.pickedLayer,info:Et,mode:S}),tt.has(Et.object)||tt.set(Et.object,Et)}return Array.from(tt.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:A,cullRect:d,effects:l,pass:S},k=!1){const U=k?this.depthFBO:this.pickingFBO,V={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:U,deviceRect:A,cullRect:d,effects:l,pass:S,pickZ:k,preRenderStats:{}};for(const Ae of l)Ae.useInPicking&&(V.preRenderStats[Ae.id]=Ae.preRender(this.gl,V));const{decodePickingColor:$}=this.pickLayersPass.render(V),{x:X,y:ee,width:ue,height:we}=A,ie=new(k?Float32Array:Uint8Array)(ue*we*4);return m_(U,{sourceX:X,sourceY:ee,sourceWidth:ue,sourceHeight:we,target:ie}),{pickedColors:ie,decodePickingColor:$}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:A}){const d=Math.max(0,e-i),l=Math.max(0,n-i),S=Math.min(r,e+i+1)-d,k=Math.min(A,n+i+1)-l;return S<=0||k<=0?null:{x:d,y:l,width:S,height:k}}}const TZ={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class SZ{constructor(e){ae(this,"el",null),ae(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,TZ),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(r.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var s5={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var A=["","webkit","Moz","MS","ms","o"],d=n.createElement("div"),l="function",S=Math.round,k=Math.abs,U=Date.now;function V(ge,Ee,Ge){return setTimeout(ce(ge,Ge),Ee)}function $(ge,Ee,Ge){return Array.isArray(ge)?(X(ge,Ge[Ee],Ge),!0):!1}function X(ge,Ee,Ge){var ot;if(ge)if(ge.forEach)ge.forEach(Ee,Ge);else if(ge.length!==r)for(ot=0;ot<ge.length;)Ee.call(Ge,ge[ot],ot,ge),ot++;else for(ot in ge)ge.hasOwnProperty(ot)&&Ee.call(Ge,ge[ot],ot,ge)}function ee(ge,Ee,Ge){var ot="DEPRECATED METHOD: "+Ee+`
`+Ge+` AT 
`;return function(){var vt=new Error("get-stack-trace"),Zt=vt&&vt.stack?vt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Cn=e.console&&(e.console.warn||e.console.log);return Cn&&Cn.call(e.console,ot,Zt),ge.apply(this,arguments)}}var ue;typeof Object.assign!="function"?ue=function(Ee){if(Ee===r||Ee===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ge=Object(Ee),ot=1;ot<arguments.length;ot++){var vt=arguments[ot];if(vt!==r&&vt!==null)for(var Zt in vt)vt.hasOwnProperty(Zt)&&(Ge[Zt]=vt[Zt])}return Ge}:ue=Object.assign;var we=ee(function(Ee,Ge,ot){for(var vt=Object.keys(Ge),Zt=0;Zt<vt.length;)(!ot||ot&&Ee[vt[Zt]]===r)&&(Ee[vt[Zt]]=Ge[vt[Zt]]),Zt++;return Ee},"extend","Use `assign`."),ie=ee(function(Ee,Ge){return we(Ee,Ge,!0)},"merge","Use `assign`.");function Ae(ge,Ee,Ge){var ot=Ee.prototype,vt;vt=ge.prototype=Object.create(ot),vt.constructor=ge,vt._super=ot,Ge&&ue(vt,Ge)}function ce(ge,Ee){return function(){return ge.apply(Ee,arguments)}}function Ce(ge,Ee){return typeof ge==l?ge.apply(Ee&&Ee[0]||r,Ee):ge}function Ne(ge,Ee){return ge===r?Ee:ge}function qe(ge,Ee,Ge){X(ht(Ee),function(ot){ge.addEventListener(ot,Ge,!1)})}function tt(ge,Ee,Ge){X(ht(Ee),function(ot){ge.removeEventListener(ot,Ge,!1)})}function lt(ge,Ee){for(;ge;){if(ge==Ee)return!0;ge=ge.parentNode}return!1}function at(ge,Ee){return ge.indexOf(Ee)>-1}function ht(ge){return ge.trim().split(/\s+/g)}function Et(ge,Ee,Ge){if(ge.indexOf&&!Ge)return ge.indexOf(Ee);for(var ot=0;ot<ge.length;){if(Ge&&ge[ot][Ge]==Ee||!Ge&&ge[ot]===Ee)return ot;ot++}return-1}function St(ge){return Array.prototype.slice.call(ge,0)}function Mt(ge,Ee,Ge){for(var ot=[],vt=[],Zt=0;Zt<ge.length;){var Cn=Ee?ge[Zt][Ee]:ge[Zt];Et(vt,Cn)<0&&ot.push(ge[Zt]),vt[Zt]=Cn,Zt++}return Ge&&(Ee?ot=ot.sort(function(wn,Li){return wn[Ee]>Li[Ee]}):ot=ot.sort()),ot}function Kt(ge,Ee){for(var Ge,ot,vt=Ee[0].toUpperCase()+Ee.slice(1),Zt=0;Zt<A.length;){if(Ge=A[Zt],ot=Ge?Ge+vt:Ee,ot in ge)return ot;Zt++}return r}var pn=1;function ei(){return pn++}function li(ge){var Ee=ge.ownerDocument||ge;return Ee.defaultView||Ee.parentWindow||e}var Nt=/mobile|tablet|ip(ad|hone|od)|android/i,dn="ontouchstart"in e,vn=Kt(e,"PointerEvent")!==r,Bn=dn&&Nt.test(navigator.userAgent),Tn="touch",wi="pen",Un="mouse",Hr="kinect",qi=25,ti=1,kr=2,Yn=4,si=8,vr=1,Lr=2,ut=4,xr=8,rs=16,Ln=Lr|ut,gn=xr|rs,ji=Ln|gn,Ns=["x","y"],ro=["clientX","clientY"];function Qn(ge,Ee){var Ge=this;this.manager=ge,this.callback=Ee,this.element=ge.element,this.target=ge.options.inputTarget,this.domHandler=function(ot){Ce(ge.options.enable,[ge])&&Ge.handler(ot)},this.init()}Qn.prototype={handler:function(){},init:function(){this.evEl&&qe(this.element,this.evEl,this.domHandler),this.evTarget&&qe(this.target,this.evTarget,this.domHandler),this.evWin&&qe(li(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&tt(this.element,this.evEl,this.domHandler),this.evTarget&&tt(this.target,this.evTarget,this.domHandler),this.evWin&&tt(li(this.element),this.evWin,this.domHandler)}};function Jn(ge){var Ee,Ge=ge.options.inputClass;return Ge?Ee=Ge:vn?Ee=Je:Bn?Ee=Xe:dn?Ee=oe:Ee=$r,new Ee(ge,so)}function so(ge,Ee,Ge){var ot=Ge.pointers.length,vt=Ge.changedPointers.length,Zt=Ee&ti&&ot-vt===0,Cn=Ee&(Yn|si)&&ot-vt===0;Ge.isFirst=!!Zt,Ge.isFinal=!!Cn,Zt&&(ge.session={}),Ge.eventType=Ee,Gi(ge,Ge),ge.emit("hammer.input",Ge),ge.recognize(Ge),ge.session.prevInput=Ge}function Gi(ge,Ee){var Ge=ge.session,ot=Ee.pointers,vt=ot.length;Ge.firstInput||(Ge.firstInput=Xi(Ee)),vt>1&&!Ge.firstMultiple?Ge.firstMultiple=Xi(Ee):vt===1&&(Ge.firstMultiple=!1);var Zt=Ge.firstInput,Cn=Ge.firstMultiple,Ei=Cn?Cn.center:Zt.center,wn=Ee.center=Dr(ot);Ee.timeStamp=U(),Ee.deltaTime=Ee.timeStamp-Zt.timeStamp,Ee.angle=mn(Ei,wn),Ee.distance=yn(Ei,wn),It(Ge,Ee),Ee.offsetDirection=Lt(Ee.deltaX,Ee.deltaY);var Li=Wr(Ee.deltaTime,Ee.deltaX,Ee.deltaY);Ee.overallVelocityX=Li.x,Ee.overallVelocityY=Li.y,Ee.overallVelocity=k(Li.x)>k(Li.y)?Li.x:Li.y,Ee.scale=Cn?Cs(Cn.pointers,ot):1,Ee.rotation=Cn?Qi(Cn.pointers,ot):0,Ee.maxPointers=Ge.prevInput?Ee.pointers.length>Ge.prevInput.maxPointers?Ee.pointers.length:Ge.prevInput.maxPointers:Ee.pointers.length,Yi(Ge,Ee);var En=ge.element;lt(Ee.srcEvent.target,En)&&(En=Ee.srcEvent.target),Ee.target=En}function It(ge,Ee){var Ge=Ee.center,ot=ge.offsetDelta||{},vt=ge.prevDelta||{},Zt=ge.prevInput||{};(Ee.eventType===ti||Zt.eventType===Yn)&&(vt=ge.prevDelta={x:Zt.deltaX||0,y:Zt.deltaY||0},ot=ge.offsetDelta={x:Ge.x,y:Ge.y}),Ee.deltaX=vt.x+(Ge.x-ot.x),Ee.deltaY=vt.y+(Ge.y-ot.y)}function Yi(ge,Ee){var Ge=ge.lastInterval||Ee,ot=Ee.timeStamp-Ge.timeStamp,vt,Zt,Cn,Ei;if(Ee.eventType!=si&&(ot>qi||Ge.velocity===r)){var wn=Ee.deltaX-Ge.deltaX,Li=Ee.deltaY-Ge.deltaY,En=Wr(ot,wn,Li);Zt=En.x,Cn=En.y,vt=k(En.x)>k(En.y)?En.x:En.y,Ei=Lt(wn,Li),ge.lastInterval=Ee}else vt=Ge.velocity,Zt=Ge.velocityX,Cn=Ge.velocityY,Ei=Ge.direction;Ee.velocity=vt,Ee.velocityX=Zt,Ee.velocityY=Cn,Ee.direction=Ei}function Xi(ge){for(var Ee=[],Ge=0;Ge<ge.pointers.length;)Ee[Ge]={clientX:S(ge.pointers[Ge].clientX),clientY:S(ge.pointers[Ge].clientY)},Ge++;return{timeStamp:U(),pointers:Ee,center:Dr(Ee),deltaX:ge.deltaX,deltaY:ge.deltaY}}function Dr(ge){var Ee=ge.length;if(Ee===1)return{x:S(ge[0].clientX),y:S(ge[0].clientY)};for(var Ge=0,ot=0,vt=0;vt<Ee;)Ge+=ge[vt].clientX,ot+=ge[vt].clientY,vt++;return{x:S(Ge/Ee),y:S(ot/Ee)}}function Wr(ge,Ee,Ge){return{x:Ee/ge||0,y:Ge/ge||0}}function Lt(ge,Ee){return ge===Ee?vr:k(ge)>=k(Ee)?ge<0?Lr:ut:Ee<0?xr:rs}function yn(ge,Ee,Ge){Ge||(Ge=Ns);var ot=Ee[Ge[0]]-ge[Ge[0]],vt=Ee[Ge[1]]-ge[Ge[1]];return Math.sqrt(ot*ot+vt*vt)}function mn(ge,Ee,Ge){Ge||(Ge=Ns);var ot=Ee[Ge[0]]-ge[Ge[0]],vt=Ee[Ge[1]]-ge[Ge[1]];return Math.atan2(vt,ot)*180/Math.PI}function Qi(ge,Ee){return mn(Ee[1],Ee[0],ro)+mn(ge[1],ge[0],ro)}function Cs(ge,Ee){return yn(Ee[0],Ee[1],ro)/yn(ge[0],ge[1],ro)}var ln={mousedown:ti,mousemove:kr,mouseup:Yn},Br="mousedown",ss="mousemove mouseup";function $r(){this.evEl=Br,this.evWin=ss,this.pressed=!1,Qn.apply(this,arguments)}Ae($r,Qn,{handler:function(Ee){var Ge=ln[Ee.type];Ge&ti&&Ee.button===0&&(this.pressed=!0),Ge&kr&&Ee.which!==1&&(Ge=Yn),this.pressed&&(Ge&Yn&&(this.pressed=!1),this.callback(this.manager,Ge,{pointers:[Ee],changedPointers:[Ee],pointerType:Un,srcEvent:Ee}))}});var Rr={pointerdown:ti,pointermove:kr,pointerup:Yn,pointercancel:si,pointerout:si},Or={2:Tn,3:wi,4:Un,5:Hr},ki="pointerdown",Xn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(ki="MSPointerDown",Xn="MSPointerMove MSPointerUp MSPointerCancel");function Je(){this.evEl=ki,this.evWin=Xn,Qn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Ae(Je,Qn,{handler:function(Ee){var Ge=this.store,ot=!1,vt=Ee.type.toLowerCase().replace("ms",""),Zt=Rr[vt],Cn=Or[Ee.pointerType]||Ee.pointerType,Ei=Cn==Tn,wn=Et(Ge,Ee.pointerId,"pointerId");Zt&ti&&(Ee.button===0||Ei)?wn<0&&(Ge.push(Ee),wn=Ge.length-1):Zt&(Yn|si)&&(ot=!0),!(wn<0)&&(Ge[wn]=Ee,this.callback(this.manager,Zt,{pointers:Ge,changedPointers:[Ee],pointerType:Cn,srcEvent:Ee}),ot&&Ge.splice(wn,1))}});var os={touchstart:ti,touchmove:kr,touchend:Yn,touchcancel:si},ke="touchstart",re="touchstart touchmove touchend touchcancel";function fe(){this.evTarget=ke,this.evWin=re,this.started=!1,Qn.apply(this,arguments)}Ae(fe,Qn,{handler:function(Ee){var Ge=os[Ee.type];if(Ge===ti&&(this.started=!0),!!this.started){var ot=be.call(this,Ee,Ge);Ge&(Yn|si)&&ot[0].length-ot[1].length===0&&(this.started=!1),this.callback(this.manager,Ge,{pointers:ot[0],changedPointers:ot[1],pointerType:Tn,srcEvent:Ee})}}});function be(ge,Ee){var Ge=St(ge.touches),ot=St(ge.changedTouches);return Ee&(Yn|si)&&(Ge=Mt(Ge.concat(ot),"identifier",!0)),[Ge,ot]}var Oe={touchstart:ti,touchmove:kr,touchend:Yn,touchcancel:si},je="touchstart touchmove touchend touchcancel";function Xe(){this.evTarget=je,this.targetIds={},Qn.apply(this,arguments)}Ae(Xe,Qn,{handler:function(Ee){var Ge=Oe[Ee.type],ot=$e.call(this,Ee,Ge);ot&&this.callback(this.manager,Ge,{pointers:ot[0],changedPointers:ot[1],pointerType:Tn,srcEvent:Ee})}});function $e(ge,Ee){var Ge=St(ge.touches),ot=this.targetIds;if(Ee&(ti|kr)&&Ge.length===1)return ot[Ge[0].identifier]=!0,[Ge,Ge];var vt,Zt,Cn=St(ge.changedTouches),Ei=[],wn=this.target;if(Zt=Ge.filter(function(Li){return lt(Li.target,wn)}),Ee===ti)for(vt=0;vt<Zt.length;)ot[Zt[vt].identifier]=!0,vt++;for(vt=0;vt<Cn.length;)ot[Cn[vt].identifier]&&Ei.push(Cn[vt]),Ee&(Yn|si)&&delete ot[Cn[vt].identifier],vt++;if(Ei.length)return[Mt(Zt.concat(Ei),"identifier",!0),Ei]}var We=2500,Ye=25;function oe(){Qn.apply(this,arguments);var ge=ce(this.handler,this);this.touch=new Xe(this.manager,ge),this.mouse=new $r(this.manager,ge),this.primaryTouch=null,this.lastTouches=[]}Ae(oe,Qn,{handler:function(Ee,Ge,ot){var vt=ot.pointerType==Tn,Zt=ot.pointerType==Un;if(!(Zt&&ot.sourceCapabilities&&ot.sourceCapabilities.firesTouchEvents)){if(vt)ve.call(this,Ge,ot);else if(Zt&&rt.call(this,ot))return;this.callback(Ee,Ge,ot)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ve(ge,Ee){ge&ti?(this.primaryTouch=Ee.changedPointers[0].identifier,Pe.call(this,Ee)):ge&(Yn|si)&&Pe.call(this,Ee)}function Pe(ge){var Ee=ge.changedPointers[0];if(Ee.identifier===this.primaryTouch){var Ge={x:Ee.clientX,y:Ee.clientY};this.lastTouches.push(Ge);var ot=this.lastTouches,vt=function(){var Zt=ot.indexOf(Ge);Zt>-1&&ot.splice(Zt,1)};setTimeout(vt,We)}}function rt(ge){for(var Ee=ge.srcEvent.clientX,Ge=ge.srcEvent.clientY,ot=0;ot<this.lastTouches.length;ot++){var vt=this.lastTouches[ot],Zt=Math.abs(Ee-vt.x),Cn=Math.abs(Ge-vt.y);if(Zt<=Ye&&Cn<=Ye)return!0}return!1}var s=Kt(d.style,"touchAction"),Z=s!==r,ft="compute",mt="auto",kt="manipulation",yt="none",Pt="pan-x",Qt="pan-y",Vt=hi();function pt(ge,Ee){this.manager=ge,this.set(Ee)}pt.prototype={set:function(ge){ge==ft&&(ge=this.compute()),Z&&this.manager.element.style&&Vt[ge]&&(this.manager.element.style[s]=ge),this.actions=ge.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ge=[];return X(this.manager.recognizers,function(Ee){Ce(Ee.options.enable,[Ee])&&(ge=ge.concat(Ee.getTouchAction()))}),Dn(ge.join(" "))},preventDefaults:function(ge){var Ee=ge.srcEvent,Ge=ge.offsetDirection;if(this.manager.session.prevented){Ee.preventDefault();return}var ot=this.actions,vt=at(ot,yt)&&!Vt[yt],Zt=at(ot,Qt)&&!Vt[Qt],Cn=at(ot,Pt)&&!Vt[Pt];if(vt){var Ei=ge.pointers.length===1,wn=ge.distance<2,Li=ge.deltaTime<250;if(Ei&&wn&&Li)return}if(!(Cn&&Zt)&&(vt||Zt&&Ge&Ln||Cn&&Ge&gn))return this.preventSrc(Ee)},preventSrc:function(ge){this.manager.session.prevented=!0,ge.preventDefault()}};function Dn(ge){if(at(ge,yt))return yt;var Ee=at(ge,Pt),Ge=at(ge,Qt);return Ee&&Ge?yt:Ee||Ge?Ee?Pt:Qt:at(ge,kt)?kt:mt}function hi(){if(!Z)return!1;var ge={},Ee=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ge){ge[Ge]=Ee?e.CSS.supports("touch-action",Ge):!0}),ge}var ni=1,Rn=2,_i=4,On=8,qn=On,ur=16,an=32;function Ve(ge){this.options=ue({},this.defaults,ge||{}),this.id=ei(),this.manager=null,this.options.enable=Ne(this.options.enable,!0),this.state=ni,this.simultaneous={},this.requireFail=[]}Ve.prototype={defaults:{},set:function(ge){return ue(this.options,ge),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ge){if($(ge,"recognizeWith",this))return this;var Ee=this.simultaneous;return ge=Ht(ge,this),Ee[ge.id]||(Ee[ge.id]=ge,ge.recognizeWith(this)),this},dropRecognizeWith:function(ge){return $(ge,"dropRecognizeWith",this)?this:(ge=Ht(ge,this),delete this.simultaneous[ge.id],this)},requireFailure:function(ge){if($(ge,"requireFailure",this))return this;var Ee=this.requireFail;return ge=Ht(ge,this),Et(Ee,ge)===-1&&(Ee.push(ge),ge.requireFailure(this)),this},dropRequireFailure:function(ge){if($(ge,"dropRequireFailure",this))return this;ge=Ht(ge,this);var Ee=Et(this.requireFail,ge);return Ee>-1&&this.requireFail.splice(Ee,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ge){return!!this.simultaneous[ge.id]},emit:function(ge){var Ee=this,Ge=this.state;function ot(vt){Ee.manager.emit(vt,ge)}Ge<On&&ot(Ee.options.event+Ut(Ge)),ot(Ee.options.event),ge.additionalEvent&&ot(ge.additionalEvent),Ge>=On&&ot(Ee.options.event+Ut(Ge))},tryEmit:function(ge){if(this.canEmit())return this.emit(ge);this.state=an},canEmit:function(){for(var ge=0;ge<this.requireFail.length;){if(!(this.requireFail[ge].state&(an|ni)))return!1;ge++}return!0},recognize:function(ge){var Ee=ue({},ge);if(!Ce(this.options.enable,[this,Ee])){this.reset(),this.state=an;return}this.state&(qn|ur|an)&&(this.state=ni),this.state=this.process(Ee),this.state&(Rn|_i|On|ur)&&this.tryEmit(Ee)},process:function(ge){},getTouchAction:function(){},reset:function(){}};function Ut(ge){return ge&ur?"cancel":ge&On?"end":ge&_i?"move":ge&Rn?"start":""}function Se(ge){return ge==rs?"down":ge==xr?"up":ge==Lr?"left":ge==ut?"right":""}function Ht(ge,Ee){var Ge=Ee.manager;return Ge?Ge.get(ge):ge}function Ki(){Ve.apply(this,arguments)}Ae(Ki,Ve,{defaults:{pointers:1},attrTest:function(ge){var Ee=this.options.pointers;return Ee===0||ge.pointers.length===Ee},process:function(ge){var Ee=this.state,Ge=ge.eventType,ot=Ee&(Rn|_i),vt=this.attrTest(ge);return ot&&(Ge&si||!vt)?Ee|ur:ot||vt?Ge&Yn?Ee|On:Ee&Rn?Ee|_i:Rn:an}});function bi(){Ki.apply(this,arguments),this.pX=null,this.pY=null}Ae(bi,Ki,{defaults:{event:"pan",threshold:10,pointers:1,direction:ji},getTouchAction:function(){var ge=this.options.direction,Ee=[];return ge&Ln&&Ee.push(Qt),ge&gn&&Ee.push(Pt),Ee},directionTest:function(ge){var Ee=this.options,Ge=!0,ot=ge.distance,vt=ge.direction,Zt=ge.deltaX,Cn=ge.deltaY;return vt&Ee.direction||(Ee.direction&Ln?(vt=Zt===0?vr:Zt<0?Lr:ut,Ge=Zt!=this.pX,ot=Math.abs(ge.deltaX)):(vt=Cn===0?vr:Cn<0?xr:rs,Ge=Cn!=this.pY,ot=Math.abs(ge.deltaY))),ge.direction=vt,Ge&&ot>Ee.threshold&&vt&Ee.direction},attrTest:function(ge){return Ki.prototype.attrTest.call(this,ge)&&(this.state&Rn||!(this.state&Rn)&&this.directionTest(ge))},emit:function(ge){this.pX=ge.deltaX,this.pY=ge.deltaY;var Ee=Se(ge.direction);Ee&&(ge.additionalEvent=this.options.event+Ee),this._super.emit.call(this,ge)}});function Eo(){Ki.apply(this,arguments)}Ae(Eo,Ki,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[yt]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.scale-1)>this.options.threshold||this.state&Rn)},emit:function(ge){if(ge.scale!==1){var Ee=ge.scale<1?"in":"out";ge.additionalEvent=this.options.event+Ee}this._super.emit.call(this,ge)}});function De(){Ve.apply(this,arguments),this._timer=null,this._input=null}Ae(De,Ve,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[mt]},process:function(ge){var Ee=this.options,Ge=ge.pointers.length===Ee.pointers,ot=ge.distance<Ee.threshold,vt=ge.deltaTime>Ee.time;if(this._input=ge,!ot||!Ge||ge.eventType&(Yn|si)&&!vt)this.reset();else if(ge.eventType&ti)this.reset(),this._timer=V(function(){this.state=qn,this.tryEmit()},Ee.time,this);else if(ge.eventType&Yn)return qn;return an},reset:function(){clearTimeout(this._timer)},emit:function(ge){this.state===qn&&(ge&&ge.eventType&Yn?this.manager.emit(this.options.event+"up",ge):(this._input.timeStamp=U(),this.manager.emit(this.options.event,this._input)))}});function oo(){Ki.apply(this,arguments)}Ae(oo,Ki,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[yt]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.rotation)>this.options.threshold||this.state&Rn)}});function _e(){Ki.apply(this,arguments)}Ae(_e,Ki,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ln|gn,pointers:1},getTouchAction:function(){return bi.prototype.getTouchAction.call(this)},attrTest:function(ge){var Ee=this.options.direction,Ge;return Ee&(Ln|gn)?Ge=ge.overallVelocity:Ee&Ln?Ge=ge.overallVelocityX:Ee&gn&&(Ge=ge.overallVelocityY),this._super.attrTest.call(this,ge)&&Ee&ge.offsetDirection&&ge.distance>this.options.threshold&&ge.maxPointers==this.options.pointers&&k(Ge)>this.options.velocity&&ge.eventType&Yn},emit:function(ge){var Ee=Se(ge.offsetDirection);Ee&&this.manager.emit(this.options.event+Ee,ge),this.manager.emit(this.options.event,ge)}});function ao(){Ve.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Ae(ao,Ve,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[kt]},process:function(ge){var Ee=this.options,Ge=ge.pointers.length===Ee.pointers,ot=ge.distance<Ee.threshold,vt=ge.deltaTime<Ee.time;if(this.reset(),ge.eventType&ti&&this.count===0)return this.failTimeout();if(ot&&vt&&Ge){if(ge.eventType!=Yn)return this.failTimeout();var Zt=this.pTime?ge.timeStamp-this.pTime<Ee.interval:!0,Cn=!this.pCenter||yn(this.pCenter,ge.center)<Ee.posThreshold;this.pTime=ge.timeStamp,this.pCenter=ge.center,!Cn||!Zt?this.count=1:this.count+=1,this._input=ge;var Ei=this.count%Ee.taps;if(Ei===0)return this.hasRequireFailures()?(this._timer=V(function(){this.state=qn,this.tryEmit()},Ee.interval,this),Rn):qn}return an},failTimeout:function(){return this._timer=V(function(){this.state=an},this.options.interval,this),an},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==qn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function cr(ge,Ee){return Ee=Ee||{},Ee.recognizers=Ne(Ee.recognizers,cr.defaults.preset),new Vs(ge,Ee)}cr.VERSION="2.0.7",cr.defaults={domEvents:!1,touchAction:ft,enable:!0,inputTarget:null,inputClass:null,preset:[[oo,{enable:!1}],[Eo,{enable:!1},["rotate"]],[_e,{direction:Ln}],[bi,{direction:Ln},["swipe"]],[ao],[ao,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Us=1,Xo=2;function Vs(ge,Ee){this.options=ue({},cr.defaults,Ee||{}),this.options.inputTarget=this.options.inputTarget||ge,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ge,this.input=Jn(this),this.touchAction=new pt(this,this.options.touchAction),XA(this,!0),X(this.options.recognizers,function(Ge){var ot=this.add(new Ge[0](Ge[1]));Ge[2]&&ot.recognizeWith(Ge[2]),Ge[3]&&ot.requireFailure(Ge[3])},this)}Vs.prototype={set:function(ge){return ue(this.options,ge),ge.touchAction&&this.touchAction.update(),ge.inputTarget&&(this.input.destroy(),this.input.target=ge.inputTarget,this.input.init()),this},stop:function(ge){this.session.stopped=ge?Xo:Us},recognize:function(ge){var Ee=this.session;if(!Ee.stopped){this.touchAction.preventDefaults(ge);var Ge,ot=this.recognizers,vt=Ee.curRecognizer;(!vt||vt&&vt.state&qn)&&(vt=Ee.curRecognizer=null);for(var Zt=0;Zt<ot.length;)Ge=ot[Zt],Ee.stopped!==Xo&&(!vt||Ge==vt||Ge.canRecognizeWith(vt))?Ge.recognize(ge):Ge.reset(),!vt&&Ge.state&(Rn|_i|On)&&(vt=Ee.curRecognizer=Ge),Zt++}},get:function(ge){if(ge instanceof Ve)return ge;for(var Ee=this.recognizers,Ge=0;Ge<Ee.length;Ge++)if(Ee[Ge].options.event==ge)return Ee[Ge];return null},add:function(ge){if($(ge,"add",this))return this;var Ee=this.get(ge.options.event);return Ee&&this.remove(Ee),this.recognizers.push(ge),ge.manager=this,this.touchAction.update(),ge},remove:function(ge){if($(ge,"remove",this))return this;if(ge=this.get(ge),ge){var Ee=this.recognizers,Ge=Et(Ee,ge);Ge!==-1&&(Ee.splice(Ge,1),this.touchAction.update())}return this},on:function(ge,Ee){if(ge!==r&&Ee!==r){var Ge=this.handlers;return X(ht(ge),function(ot){Ge[ot]=Ge[ot]||[],Ge[ot].push(Ee)}),this}},off:function(ge,Ee){if(ge!==r){var Ge=this.handlers;return X(ht(ge),function(ot){Ee?Ge[ot]&&Ge[ot].splice(Et(Ge[ot],Ee),1):delete Ge[ot]}),this}},emit:function(ge,Ee){this.options.domEvents&&Ko(ge,Ee);var Ge=this.handlers[ge]&&this.handlers[ge].slice();if(!(!Ge||!Ge.length)){Ee.type=ge,Ee.preventDefault=function(){Ee.srcEvent.preventDefault()};for(var ot=0;ot<Ge.length;)Ge[ot](Ee),ot++}},destroy:function(){this.element&&XA(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function XA(ge,Ee){var Ge=ge.element;if(Ge.style){var ot;X(ge.options.cssProps,function(vt,Zt){ot=Kt(Ge.style,Zt),Ee?(ge.oldCssProps[ot]=Ge.style[ot],Ge.style[ot]=vt):Ge.style[ot]=ge.oldCssProps[ot]||""}),Ee||(ge.oldCssProps={})}}function Ko(ge,Ee){var Ge=n.createEvent("Event");Ge.initEvent(ge,!0,!0),Ge.gesture=Ee,Ee.target.dispatchEvent(Ge)}ue(cr,{INPUT_START:ti,INPUT_MOVE:kr,INPUT_END:Yn,INPUT_CANCEL:si,STATE_POSSIBLE:ni,STATE_BEGAN:Rn,STATE_CHANGED:_i,STATE_ENDED:On,STATE_RECOGNIZED:qn,STATE_CANCELLED:ur,STATE_FAILED:an,DIRECTION_NONE:vr,DIRECTION_LEFT:Lr,DIRECTION_RIGHT:ut,DIRECTION_UP:xr,DIRECTION_DOWN:rs,DIRECTION_HORIZONTAL:Ln,DIRECTION_VERTICAL:gn,DIRECTION_ALL:ji,Manager:Vs,Input:Qn,TouchAction:pt,TouchInput:Xe,MouseInput:$r,PointerEventInput:Je,TouchMouseInput:oe,SingleTouchInput:fe,Recognizer:Ve,AttrRecognizer:Ki,Tap:ao,Pan:bi,Swipe:_e,Pinch:Eo,Rotate:oo,Press:De,on:qe,off:tt,each:X,merge:ie,extend:we,assign:ue,inherit:Ae,bindFn:ce,prefixed:Kt});var hr=typeof e<"u"?e:typeof self<"u"?self:{};hr.Hammer=cr,typeof r=="function"&&r.amd?r(function(){return cr}):t.exports?t.exports=cr:e[i]=cr})(window,document,"Hammer")})(s5);var ep=s5.exports;const CZ=$m(ep),dl=aD({__proto__:null,default:CZ},[ep]),o5=1,a5=2,pv=4,PZ={mousedown:o5,mousemove:a5,mouseup:pv};function MZ(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function IZ(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&i.type==="pointerdown"&&(MZ(r,A=>A.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}}function kZ(t){t.prototype.handler=function(n){let i=PZ[n.type];i&o5&&n.button>=0&&(this.pressed=!0),i&a5&&n.which===0&&(i=pv),this.pressed&&(i&pv&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}IZ(ep.PointerEventInput);kZ(ep.MouseInput);const LZ=ep.Manager;class y_{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const DZ=dl?[[dl.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[dl.Rotate,{enable:!1}],[dl.Pinch,{enable:!1}],[dl.Swipe,{enable:!1}],[dl.Pan,{threshold:0,enable:!1}],[dl.Press,{enable:!1}],[dl.Tap,{event:"doubletap",taps:2,enable:!1}],[dl.Tap,{event:"anytap",enable:!1}],[dl.Tap,{enable:!1}]]:null,ZS={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},BZ={doubletap:["tap"]},RZ={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},vw={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},OZ={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},qS={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},zZ=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Kh=typeof window<"u"?window:global;let gv=!1;try{const t={get passive(){return gv=!0,!0}};Kh.addEventListener("test",null,t),Kh.removeEventListener("test",null)}catch{gv=!1}const FZ=zZ.indexOf("firefox")!==-1,{WHEEL_EVENTS:NZ}=vw,YS="wheel",XS=4.000244140625,UZ=40,VZ=.25;class jZ extends y_{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let A=r.deltaY;Kh.WheelEvent&&(FZ&&r.deltaMode===Kh.WheelEvent.DOM_DELTA_PIXEL&&(A/=Kh.devicePixelRatio),r.deltaMode===Kh.WheelEvent.DOM_DELTA_LINE&&(A*=UZ)),A!==0&&A%XS===0&&(A=Math.floor(A/XS)),r.shiftKey&&A&&(A=A*VZ),this.callback({type:YS,center:{x:r.clientX,y:r.clientY},delta:-A,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(NZ),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,gv?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===YS&&(this.options.enable=n)}}const{MOUSE_EVENTS:GZ}=vw,KS="pointermove",JS="pointerover",e4="pointerout",t4="pointerenter",n4="pointerleave";class QZ extends y_{constructor(e,n,i){super(e,n,i),this.handleEvent=A=>{this.handleOverEvent(A),this.handleOutEvent(A),this.handleEnterEvent(A),this.handleLeaveEvent(A),this.handleMoveEvent(A)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(GZ),this.events.forEach(A=>e.addEventListener(A,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===KS&&(this.enableMoveEvent=n),e===JS&&(this.enableOverEvent=n),e===e4&&(this.enableOutEvent=n),e===t4&&(this.enableEnterEvent=n),e===n4&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(JS,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(e4,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(t4,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(n4,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(KS,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:HZ}=vw,i4="keydown",r4="keyup";class WZ extends y_{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const A=r.target||r.srcElement;A.tagName==="INPUT"&&A.type==="text"||A.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:i4,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:r4,srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(HZ),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===i4&&(this.enableDownEvent=n),e===r4&&(this.enableUpEvent=n)}}const s4="contextmenu";class $Z extends y_{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:s4,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===s4&&(this.options.enable=n)}}const mv=1,Bm=2,_v=4,ZZ={pointerdown:mv,pointermove:Bm,pointerup:_v,mousedown:mv,mousemove:Bm,mouseup:_v},qZ=1,YZ=2,XZ=3,KZ=0,JZ=1,eq=2,tq=1,nq=2,iq=4;function rq(t){const e=ZZ[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let A=!1,d=!1,l=!1;return e===_v||e===Bm&&!Number.isFinite(n)?(A=r===qZ,d=r===YZ,l=r===XZ):e===Bm?(A=!!(n&tq),d=!!(n&iq),l=!!(n&nq)):e===mv&&(A=i===KZ,d=i===JZ,l=i===eq),{leftButton:A,middleButton:d,rightButton:l}}function sq(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,A=i.height/e.offsetHeight||1,d={x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/A};return{center:n,offsetCenter:d}}const ky={srcElement:"root",priority:0};class oq{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,A=!1){const{handlers:d,handlersByElement:l}=this;let S=ky;typeof i=="string"||i&&i.addEventListener?S={...ky,srcElement:i}:i&&(S={...ky,...i});let k=l.get(S.srcElement);k||(k=[],l.set(S.srcElement,k));const U={type:e,handler:n,srcElement:S.srcElement,priority:S.priority};r&&(U.once=!0),A&&(U.passive=!0),d.push(U),this._active=this._active||!U.passive;let V=k.length-1;for(;V>=0&&!(k[V].priority>=U.priority);)V--;k.splice(V+1,0,U)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let A=i.length-1;A>=0;A--){const d=i[A];if(d.type===e&&d.handler===n){i.splice(A,1);const l=r.get(d.srcElement);l.splice(l.indexOf(d),1),l.length===0&&r.delete(d.srcElement)}}this._active=i.some(A=>!A.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const A=()=>{e.handled=!0},d=()=>{e.handled=!0,r=!0},l=[];for(let S=0;S<i.length;S++){const{type:k,handler:U,once:V}=i[S];if(U({...e,type:k,stopPropagation:A,stopImmediatePropagation:d}),V&&l.push(i[S]),r)break}for(let S=0;S<l.length;S++){const{type:k,handler:U}=l[S];this.remove(k,U)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...rq(e),...sq(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const aq={events:null,recognizers:null,recognizerOptions:{},Manager:LZ,touchAction:"none",tabIndex:0};class Aq{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:A}=r,d=RZ[A.type];d&&this.manager.emit(d,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...aq,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,i=n.Manager;this.manager=new i(e,{touchAction:n.touchAction,recognizers:n.recognizers||DZ}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(ZS).forEach(r=>{const A=this.manager.get(r);A&&ZS[r].forEach(d=>{A.recognizeWith(d)})});for(const r in n.recognizerOptions){const A=this.manager.get(r);if(A){const d=n.recognizerOptions[r];delete d.enable,A.set(d)}}this.wheelInput=new jZ(e,this._onOtherEvent,{enable:!1}),this.moveInput=new QZ(e,this._onOtherEvent,{enable:!1}),this.keyInput=new WZ(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new $Z(e,this._onOtherEvent,{enable:!1});for(const[r,A]of this.events)A.isEmpty()||(this._toggleRecognizer(A.recognizerName,!0),this.manager.on(r,A.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const A=BZ[e];A&&!this.options.recognizers&&A.forEach(d=>{const l=i.get(d);n?(l.requireFailure(e),r.dropRequireFailure(d)):l.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,A){if(typeof e!="string"){i=n;for(const U in e)this._addEventHandler(U,e[U],i,r,A);return}const{manager:d,events:l}=this,S=qS[e]||e;let k=l.get(S);k||(k=new oq(this),l.set(S,k),k.recognizerName=OZ[S]||S,d&&d.on(S,k.handleEvent)),k.add(e,n,i,r,A),k.isEmpty()||this._toggleRecognizer(k.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const d in e)this._removeEventHandler(d,e[d]);return}const{events:i}=this,r=qS[e]||e,A=i.get(r);if(A&&(A.remove(e,n),A.isEmpty())){const{recognizerName:d}=A;let l=!1;for(const S of i.values())if(S.recognizerName===d&&!S.isEmpty()){l=!0;break}l||this._toggleRecognizer(d,!1)}}}function Ic(){}const lq=({isDragging:t})=>t?"grabbing":"grab",A5={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Ic,onResize:Ic,onViewStateChange:Ic,onInteractionStateChange:Ic,onBeforeRender:Ic,onAfterRender:Ic,onLoad:Ic,onError:t=>Nn.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:lq,getTooltip:null,debug:!1,drawPickingColors:!1};class v_{constructor(e){ae(this,"props",void 0),ae(this,"width",0),ae(this,"height",0),ae(this,"userData",{}),ae(this,"canvas",null),ae(this,"viewManager",null),ae(this,"layerManager",null),ae(this,"effectManager",null),ae(this,"deckRenderer",null),ae(this,"deckPicker",null),ae(this,"eventManager",null),ae(this,"tooltip",null),ae(this,"metrics",void 0),ae(this,"animationLoop",void 0),ae(this,"stats",void 0),ae(this,"viewState",void 0),ae(this,"cursorState",void 0),ae(this,"_needsRedraw",void 0),ae(this,"_pickRequest",void 0),ae(this,"_lastPointerDownInfo",null),ae(this,"_metricsCounter",void 0),ae(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),ae(this,"_onEvent",n=>{const i=jT[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const A=this.layerManager.getLayers(),d=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:A,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:l}=d,S=l&&(l[i.handler]||l.props[i.handler]),k=this.props[i.handler];let U=!1;S&&(U=S.call(l,d,n)),!U&&k&&k(d,n)}),ae(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...A5,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Nn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),qI()==="IE"&&Nn.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new iw({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&M0.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,A,d,l,S;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(i=this.viewManager)===null||i===void 0||i.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(A=this.deckRenderer)===null||A===void 0||A.finalize(),this.deckRenderer=null,(d=this.deckPicker)===null||d===void 0||d.finalize(),this.deckPicker=null,(l=this.eventManager)===null||l===void 0||l.destroy(),this.eventManager=null,(S=this.tooltip)===null||S===void 0||S.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var k;(k=this.canvas.parentElement)===null||k===void 0||k.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Nn.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Nn.removed("onLayerClick","onClick")(),e.initialViewState&&!xl(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),A=this.effectManager.needsRedraw(e),d=this.deckRenderer.needsRedraw(e);return n=n||i||r||A||d,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Es(this.viewManager),this.viewManager.views}getViewports(e){return Es(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,i){Es(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const A=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),A}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Es(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||n===0){const A=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=A}if(i||i===0){var r;const A=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=((r=e.style)===null||r===void 0?void 0:r.position)||"absolute",this.canvas.style.height=A}}_updateCanvasSize(){var e,n;const{canvas:i}=this;if(!i)return;const r=(e=i.clientWidth)!==null&&e!==void 0?e:i.width,A=(n=i.clientHeight)!==null&&n!==void 0?n:i.height;if(r!==this.width||A!==this.height){var d,l;this.width=r,this.height=A,(d=this.viewManager)===null||d===void 0||d.setProps({width:r,height:A}),(l=this.layerManager)===null||l===void 0||l.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:A})}}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:A,debug:d,onError:l,onBeforeRender:S,onAfterRender:k,useDevicePixels:U}=e;return new QG({width:n,height:i,useDevicePixels:U,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:V=>nk({...A,...V,canvas:this.canvas,debug:d,onContextLost:()=>this._onContextLost()}),onInitialize:V=>this._setGLContext(V.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:S,onAfterRender:k,onError:l})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new n5({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let A=r,d=!1;for(const l of i){var n;A=l,d=((n=l.layer)===null||n===void 0?void 0:n.onHover(l,e.event))||d}if(!d&&this.props.onHover&&this.props.onHover(A,e.event),this.props.getTooltip&&this.tooltip){const l=this.props.getTooltip(A);this.tooltip.setTooltip(l,A.x,A.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,nw(e,{enable:!0,copyState:!0})),this.tooltip=new SZ(this.canvas),mu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new Nk;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new Aq(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in jT)this.eventManager.on(r,this._onEvent);this.viewManager=new tZ({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new eZ(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new pZ,this.deckRenderer=new _Z(e),this.deckPicker=new EZ(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;mu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Nn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=zc.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}ae(v_,"defaultProps",A5);ae(v_,"VERSION",Y9);class Ly{constructor(e,n){ae(this,"opts",void 0),ae(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let A=i;if(i&&i.length!==r){A=new Float32Array(r);const d=n.elementOffset||0;for(let l=0;l<r;++l)A[l]=i[d+l]}return A}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function uq(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Dg(t){return t.stride||t.size*t.bytesPerElement}function l5(t,e){e.offset&&Nn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Dg(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,r=e.elementOffset||0,A=i*n+r*t.bytesPerElement+(t.offset||0);return{...e,offset:A,stride:n}}function cq(t,e){const n=l5(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class hq{constructor(e,n,i){ae(this,"gl",void 0),ae(this,"id",void 0),ae(this,"size",void 0),ae(this,"settings",void 0),ae(this,"value",void 0),ae(this,"doublePrecision",void 0),ae(this,"_buffer",void 0),ae(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,A=r===5130;let{defaultValue:d}=n;d=Number.isFinite(d)?[d]:d||new Array(this.size).fill(0);let l;A?l=5126:!r&&n.isIndexed?l=e&&ow(e,Ii.ELEMENT_INDEX_UINT32)?5125:5123:l=r||5126;let S=uq(r||l||5126);this.doublePrecision=A,A&&n.fp64===!1&&(S=Float32Array),this.value=null,this.settings={...n,defaultType:S,defaultValue:d,logicalType:r,type:l,size:this.size,bytesPerElement:S.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new xi(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Dg(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),M0.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,A=cq(this.getAccessor(),n||{});return i[e]=new Ly(this,A.high),i["".concat(e,"64Low")]=r?new Ly(this,A.low):new Float32Array(this.size),i}if(n){const i=l5(this.getAccessor(),n);return{[e]:new Ly(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,A=i*r;if(n&&A&&n.length>=A){const d=new Array(r).fill(1/0),l=new Array(r).fill(-1/0);for(let S=0;S<A;)for(let k=0;k<r;k++){const U=n[S++];U<d[k]&&(d[k]=U),U>l[k]&&(l[k]=U)}e=[d,l]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof xi?i={buffer:e}:i=e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let A=i.value;if(A=this._normalizeValue(A,[],0),this.settings.normalized&&(A=this.normalizeConstant(A)),!(!n.constant||!this._areValuesEqual(A,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=A}else if(i.buffer){const A=i.buffer;n.externalBuffer=A,n.constant=!1,this.value=i.value||null;const d=i.value instanceof Float64Array;r.type=i.type||A.accessor.type,r.bytesPerElement=A.accessor.BYTES_PER_ELEMENT*(d?2:1),r.stride=Dg(r)}else if(i.value){this._checkExternalBuffer(i);let A=i.value;n.externalBuffer=null,n.constant=!1,this.value=A,r.bytesPerElement=A.BYTES_PER_ELEMENT,r.stride=Dg(r);const{buffer:d,byteOffset:l}=this;this.doublePrecision&&A instanceof Float64Array&&(A=Py(A,r));const S=A.byteLength+l+r.stride*2;d.byteLength<S&&d.reallocate(S),d.setAccessor(null),d.subData({data:A,offset:l}),r.type=i.type||d.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Py(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,A=M0.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=A;const{buffer:d,byteOffset:l}=this;return d.byteLength<A.byteLength+l&&(d.reallocate(A.byteLength+l),n&&r&&d.subData({data:r instanceof Float64Array?Py(r,this):r,offset:l})),i.allocatedValue=A,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Nn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:A}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e){let d=A;for(;--d>=0;)n[i+d]=r[d];return n}switch(A){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let d=A;for(;--d>=0;)n[i+d]=Number.isFinite(e[d])?e[d]:r[d]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const o4=[],a4=[];function _c(t,e=0,n=1/0){let i=o4;const r={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(a4.length=t.length,i=a4):i=o4,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function u5(t){return t&&t[Symbol.asyncIterator]}function c5(t,e){const{size:n,stride:i,offset:r,startIndices:A,nested:d}=e,l=t.BYTES_PER_ELEMENT,S=i?i/l:n,k=r?r/l:0,U=Math.floor((t.length-k)/S);return(V,{index:$,target:X})=>{if(!A){const ie=$*S+k;for(let Ae=0;Ae<n;Ae++)X[Ae]=t[ie+Ae];return X}const ee=A[$],ue=A[$+1]||U;let we;if(d){we=new Array(ue-ee);for(let ie=ee;ie<ue;ie++){const Ae=ie*S+k;X=new Array(n);for(let ce=0;ce<n;ce++)X[ce]=t[Ae+ce];we[ie-ee]=X}}else if(S===n)we=t.subarray(ee*n+k,ue*n+k);else{we=new t.constructor((ue-ee)*n);let ie=0;for(let Ae=ee;Ae<ue;Ae++){const ce=Ae*S+k;for(let Ce=0;Ce<n;Ce++)we[ie++]=t[ce+Ce]}}return we}}const fq=[],Bg=[[0,1/0]];function dq(t,e){if(t===Bg||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let A=0;A<i;A++){const d=t[A];d[1]<e[0]?(n.push(d),r=A+1):d[0]>e[1]?n.push(d):e=[Math.min(d[0],e[0]),Math.max(d[1],e[1])]}return n.splice(r,0,e),n}function Dy(t){const{source:e,target:n,start:i=0,size:r,getData:A}=t,d=t.end||n.length,l=e.length,S=d-i;if(l>S){n.set(e.subarray(0,S),i);return}if(n.set(e,i),!A)return;let k=l;for(;k<S;){const U=A(k,e);for(let V=0;V<r;V++)n[i+k]=U[V]||0,k++}}function pq({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:A}){if(!Array.isArray(A))return Dy({source:t,target:e,size:n,getData:i}),e;let d=0,l=0;const S=i&&((U,V)=>i(U+l,V)),k=Math.min(r.length,A.length);for(let U=1;U<k;U++){const V=r[U]*n,$=A[U]*n;Dy({source:t.subarray(d,V),target:e,start:l,end:$,size:n,getData:S}),d=V,l=$}return l<e.length&&Dy({source:[],target:e,start:l,size:n,getData:S}),e}const gq={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function h5(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...gq[n],...e,...t,type:n}}function f5(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function d5(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function p5(t){t.push(t.shift())}function xw(t,e){const{doublePrecision:n,settings:i,value:r,size:A}=t,d=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*A)*d}function g5({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:A=d=>d}){const d=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*d,S=n.byteOffset,k=n.startIndices,U=r&&k,V=xw(n,e),$=n.isConstant;if(!U&&i>=V)return;const X=$?n.value:n.getBuffer().getData({srcByteOffset:S});if(n.settings.normalized&&!$){const ie=A;A=(Ae,ce)=>n.normalizeConstant(ie(Ae,ce))}const ee=$?(ie,Ae)=>A(X,Ae):(ie,Ae)=>A(X.subarray(ie,ie+l),Ae),ue=t.getData({length:i}),we=new Float32Array(V);pq({source:ue,target:we,sourceStartIndices:r,targetStartIndices:k,size:l,getData:ee}),t.byteLength<we.byteLength+S&&t.reallocate(we.byteLength+S),t.subData({data:we,offset:S})}class ww extends hq{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Bg}),ae(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition,r=Array.isArray(n)?e[n.find(A=>e[A])]:e[n];return h5(r,i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=dq(this.state.updateRanges,[i,r])}else this.state.updateRanges=Bg}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=fq}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,n.updateRanges!==Bg),!0):!1}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:A},settings:{update:d,noAlloc:l}}=this;let S=!0;if(d){for(const[k,U]of A)d.call(r,this,{data:n,startRow:k,endRow:U,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[k,U]of A){const V=Number.isFinite(k)?this.getVertexOffset(k):0,$=Number.isFinite(U)?this.getVertexOffset(U):l||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:V,endOffset:$})}this._checkAttributeArray()}else S=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),S}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const d=e;Es(ArrayBuffer.isView(d.value),"invalid ".concat(r.accessor));const l=!!d.size&&d.size!==this.size;return i.binaryAccessor=c5(d.value,{size:d.size||this.size,stride:d.stride,offset:d.offset,startIndices:n,nested:l}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:A,numInstances:d}){if(e.constant)return;const{settings:l,state:S,value:k,size:U,startIndices:V}=e,{accessor:$,transform:X}=l,ee=S.binaryAccessor||(typeof $=="function"?$:A[$]);Es(typeof ee=="function",'accessor "'.concat($,'" is not a function'));let ue=e.getVertexOffset(i);const{iterable:we,objectInfo:ie}=_c(n,i,r);for(const Ae of we){ie.index++;let ce=ee(Ae,ie);if(X&&(ce=X.call(this,ce)),V){const Ce=(ie.index<V.length-1?V[ie.index+1]:d)-V[ie.index];if(ce&&Array.isArray(ce[0])){let Ne=ue;for(const qe of ce)e._normalizeValue(qe,k,Ne),Ne+=U}else ce&&ce.length>U?k.set(ce,ue):(e._normalizeValue(ce,ie.target,0),H$({target:k,source:ie.target,start:ue,count:Ce}));ue+=Ce*U}else e._normalizeValue(ce,k,ue),ue+=U}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class mq{constructor({gl:e,attribute:n,timeline:i}){ae(this,"gl",void 0),ae(this,"type","interpolation"),ae(this,"attributeInTransition",void 0),ae(this,"settings",void 0),ae(this,"attribute",void 0),ae(this,"transition",void 0),ae(this,"currentStartIndices",void 0),ae(this,"currentLength",void 0),ae(this,"transform",void 0),ae(this,"buffers",void 0),this.gl=e,this.transition=new Jd(i),this.attribute=n,this.attributeInTransition=new ww(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=yq(e,n);const r={byteLength:0,usage:35050};this.buffers=[new xi(e,r),new xi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:i,buffers:r,attribute:A}=this;p5(r);const d={numInstances:n,attribute:A,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of r)g5({buffer:l,...d});this.currentStartIndices=A.startIndices,this.currentLength=xw(A,n),this.attributeInTransition.setData({buffer:r[1],value:A.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/A.size),sourceBuffers:{aFrom:r[0],aTo:f5(i,A)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let A=r/n;i&&(A=i(A)),this.transform.run({uniforms:{time:A}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const _q=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function yq(t,e){const n=d5(e.size);return new hw(t,{vs:_q,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class vq{constructor({gl:e,attribute:n,timeline:i}){ae(this,"gl",void 0),ae(this,"type","spring"),ae(this,"attributeInTransition",void 0),ae(this,"settings",void 0),ae(this,"attribute",void 0),ae(this,"transition",void 0),ae(this,"currentStartIndices",void 0),ae(this,"currentLength",void 0),ae(this,"texture",void 0),ae(this,"framebuffer",void 0),ae(this,"transform",void 0),ae(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Jd(i),this.attribute=n,this.attributeInTransition=new ww(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=wq(e),this.framebuffer=bq(e,this.texture),this.transform=xq(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new xi(e,r),new xi(e,r),new xi(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:i,buffers:r,attribute:A}=this,d={numInstances:n,attribute:A,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const l of r)g5({buffer:l,...d});this.settings=e,this.currentStartIndices=A.startIndices,this.currentLength=xw(A,n),this.attributeInTransition.setData({buffer:r[1],value:A.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/A.size),sourceBuffers:{aTo:f5(i,A)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const d=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:d.stiffness,damping:d.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),p5(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),m_(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function xq(t,e,n){const i=d5(e.size);return new hw(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}function wq(t){return new $o(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function bq(t,e){return new is(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const Eq={interpolation:mq,spring:vq};class Tq{constructor(e,{id:n,timeline:i}){ae(this,"id",void 0),ae(this,"isSupported",void 0),ae(this,"gl",void 0),ae(this,"timeline",void 0),ae(this,"transitions",void 0),ae(this,"needsRedraw",void 0),ae(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=hw.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const A=e[r],d=A.getTransitionSetting(n);d&&this._updateAttribute(r,A,d)}for(const r in this.transitions){const A=e[r];(!A||!A.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let A=!r||r.type!==i.type;if(A){if(!this.isSupported){Nn.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}r&&this._removeTransition(e);const d=Eq[i.type];d?this.transitions[e]=new d({attribute:n,timeline:this.timeline,gl:this.gl}):(Nn.error("unsupported transition type '".concat(i.type,"'"))(),A=!1)}(A||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const A4="attributeManager.invalidate",Sq="attributeManager.updateStart",Cq="attributeManager.updateEnd",Pq="attribute.updateStart",Mq="attribute.allocate",Iq="attribute.updateEnd";class m5{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){ae(this,"id",void 0),ae(this,"gl",void 0),ae(this,"attributes",void 0),ae(this,"updateTriggers",void 0),ae(this,"needsRedraw",void 0),ae(this,"userData",void 0),ae(this,"stats",void 0),ae(this,"attributeTransitionManager",void 0),ae(this,"mergeBoundsMemoized",Kd(h$)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Tq(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);Js(A4,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Js(A4,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:A={},buffers:d={},context:l={}}){let S=!1;Js(Sq,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const k in this.attributes){const U=this.attributes[k],V=U.settings.accessor;U.startIndices=i,U.numInstances=n,A[k]&&Nn.removed("props.".concat(k),"data.attributes.".concat(k))(),U.setExternalBuffer(d[k])||U.setBinaryValue(typeof V=="string"?d[V]:void 0,e.startIndices)||typeof V=="string"&&!d[V]&&U.setConstantValue(A[V])||U.needsUpdate()&&(S=!0,this._updateAttribute({attribute:U,numInstances:n,data:e,props:A,context:l})),this.needsRedraw=this.needsRedraw||U.needsRedraw()}S&&Js(Cq,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(i=>{var r;return(r=this.attributes[i])===null||r===void 0?void 0:r.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const A in n){const d=n[A];d.needsRedraw(e)&&!i.hasAttribute(A)&&(r[A]=d)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e){const r=e[i];this.attributes[i]=this._createAttribute(i,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:i.instanced?1:n.divisor||0};return new ww(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,A=r[e];return A&&A.forEach(d=>{const l=i[d];l&&l.setNeedsUpdate(l.id,n)}),A}_updateAttribute(e){const{attribute:n,numInstances:i}=e;if(Js(Pq,n),n.constant){n.setConstantValue(n.value);return}n.allocate(i)&&Js(Mq,n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,Js(Iq,n,i))}}class kq extends Jd{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:A}}=this,d=A(e/r);this._value=T0(n,i,d)}}const l4=1e-5;function u4(t,e,n,i,r){const A=e-t,l=(n-e)*r,S=-A*i;return l+S+A+e}function Lq(t,e,n,i,r){if(Array.isArray(n)){const A=[];for(let d=0;d<n.length;d++)A[d]=u4(t[d],e[d],n[d],i,r);return A}return u4(t,e,n,i,r)}function c4(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class Dq extends Jd{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:A=e,_currValue:d=e}=this;let l=Lq(A,d,n,i,r);const S=c4(l,n),k=c4(l,d);S<l4&&k<l4&&(l=n,this.end()),this._prevValue=d,this._currValue=l}}const Bq={interpolation:kq,spring:Dq};class Rq{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:A}=this;if(A.has(e)){const S=A.get(e),{value:k=S.settings.fromValue}=S;n=k,this.remove(e)}if(r=h5(r),!r)return;const d=Bq[r.type];if(!d){Nn.error("unsupported transition type '".concat(r.type,"'"))();return}const l=new d(this.timeline);l.start({...r,fromValue:n,toValue:i}),A.set(e,l)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Oq(t){const e=t[cc];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function zq(t,e){const n=bw({newProps:t,oldProps:e,propTypes:t[cc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=Nq(t,e);let r=!1;return i||(r=Uq(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:Vq(t,e),transitionsChanged:Fq(t,e)}}function Fq(t,e){if(!t.transitions)return!1;const n={},i=t[cc];let r=!1;for(const A in t.transitions){const d=i[A],l=d&&d.type;(l==="number"||l==="color"||l==="array")&&yv(t[A],e[A],d)&&(n[A]=!0,r=!0)}return r?n:!1}function bw({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(r," changed shallowly");for(const A of Object.keys(t))if(!(A in n)){if(!(A in e))return"".concat(r,".").concat(A," added");const d=yv(t[A],e[A],i[A]);if(d)return"".concat(r,".").concat(A," ").concat(d)}for(const A of Object.keys(e))if(!(A in n)){if(!(A in t))return"".concat(r,".").concat(A," dropped");if(!Object.hasOwnProperty.call(t,A)){const d=yv(t[A],e[A],i[A]);if(d)return"".concat(r,".").concat(A," ").concat(d)}}return!1}function yv(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function Nq(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}function Uq(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&h4(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)r!=="all"&&h4(t,e,r)&&(n[r]=!0,i=!0);return i?n:!1}function Vq(t,e){if(e===null)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function h4(t,e,n){let i=t.updateTriggers[n];i=i??{};let r=e.updateTriggers[n];return r=r??{},bw({oldProps:r,newProps:i,triggerName:n})}const jq="count(): argument not an object",Gq="count(): argument not a container";function Qq(t){if(!Wq(t))throw new Error(jq);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Hq(t))return Object.keys(t).length;throw new Error(Gq)}function Hq(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function Wq(t){return t!==null&&typeof t=="object"}function $q(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=n.modules.findIndex(r=>r.name==="project32");i>=0&&n.modules.splice(i,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}return n}const Zq={10241:9987,10240:9729,10242:33071,10243:33071},vv={};function qq(t,e,n,i){if(n instanceof $o)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const A=new $o(e,{...n,parameters:{...Zq,...r,...i}});return vv[A.id]=t,A}function Yq(t,e){!e||!(e instanceof $o)||vv[e.id]===t&&(e.delete(),delete vv[e.id])}const Xq={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||xv(t)&&(t.length===3||t.length===4)},equal(t,e,n){return xl(t,e,1)}},accessor:{validate(t,e){const n=Rm(t);return n==="function"||n===Rm(e.value)},equal(t,e,n){return typeof e=="function"?!0:xl(t,e,1)}},array:{validate(t,e){return e.optional&&!t||xv(t)},equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?xl(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?xl(t,e,r):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return!i||!i.gl?null:qq(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{Yq(n.id,t)}}};function Kq(t){const e={},n={},i={};for(const[r,A]of Object.entries(t)){const d=A==null?void 0:A.deprecatedFor;if(d)i[r]=Array.isArray(d)?d:[d];else{const l=Jq(r,A);e[r]=l,n[r]=l.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}function Jq(t,e){switch(Rm(e)){case"object":return Ef(t,e);case"array":return Ef(t,{type:"array",value:e,compare:!1});case"boolean":return Ef(t,{type:"boolean",value:e});case"number":return Ef(t,{type:"number",value:e});case"function":return Ef(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ef(t,e){return"type"in e?{name:t,...Xq[e.type],...e}:"value"in e?{name:t,type:Rm(e.value),...e}:{name:t,type:"object",value:e}}function xv(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Rm(t){return xv(t)?"array":t===null?"null":typeof t}function eY(t,e){let n;for(let A=e.length-1;A>=0;A--){const d=e[A];"extensions"in d&&(n=d.extensions)}const i=wv(t.constructor,n),r=Object.create(i);r[Dm]=t,r[Xc]={},r[Ju]={};for(let A=0;A<e.length;++A){const d=e[A];for(const l in d)r[l]=d[l]}return Object.freeze(r),r}const tY="_mergedDefaultProps";function wv(t,e){let n=tY;if(e)for(const r of e){const A=r.constructor;A&&(n+=":".concat(A.extensionName||A.name))}const i=_5(t,n);return i||(t[n]=nY(t,e||[]))}function nY(t,e){if(!t.prototype)return null;const i=Object.getPrototypeOf(t),r=wv(i),A=_5(t,"defaultProps")||{},d=Kq(A),l=Object.assign(Object.create(null),r,d.defaultProps),S=Object.assign(Object.create(null),r==null?void 0:r[cc],d.propTypes),k=Object.assign(Object.create(null),r==null?void 0:r[Iy],d.deprecatedProps);for(const U of e){const V=wv(U.constructor);V&&(Object.assign(l,V),Object.assign(S,V[cc]),Object.assign(k,V[Iy]))}return iY(l,t),sY(l,S),rY(l,k),l[cc]=S,l[Iy]=k,e.length===0&&!Ew(t,"_propTypes")&&(t._propTypes=S),l}function iY(t,e){const n=aY(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function rY(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const A of e[n])Ew(this,A)||(this[A]=i);Nn.deprecated(r,e[n].join("/"))()}})}function sY(t,e){const n={},i={};for(const r in e){const A=e[r],{name:d,value:l}=A;A.async&&(n[d]=l,i[d]=oY(d))}t[u0]=n,t[Xc]={},Object.defineProperties(t,i)}function oY(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||u5(e)?this[Xc][t]=e:this[Ju][t]=e},get(){if(this[Ju]){if(t in this[Ju])return this[Ju][t]||this[u0][t];if(t in this[Xc]){const e=this[Dm]&&this[Dm].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[u0][t]}}return this[u0][t]}}}function Ew(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _5(t,e){return Ew(t,e)&&t[e]}function aY(t){const e=t.componentName;return e||Nn.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let AY=0;class Tw{constructor(...e){ae(this,"id",void 0),ae(this,"props",void 0),ae(this,"count",void 0),this.props=eY(this,e),this.id=this.props.id,this.count=AY++}clone(e){const{props:n}=this,i={};for(const r in n[u0])r in n[Ju]?i[r]=n[Ju][r]:r in n[Xc]&&(i[r]=n[Xc][r]);return new this.constructor({...n,...i,...e})}}ae(Tw,"componentName","Component");ae(Tw,"defaultProps",{});const lY=Object.freeze({});class uY{constructor(e){ae(this,"component",void 0),ae(this,"onAsyncPropUpdated",void 0),ae(this,"asyncProps",void 0),ae(this,"oldProps",void 0),ae(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||lY}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Dm]||this.component;const n=e[Ju]||{},i=e[Xc]||e,r=e[u0]||{};for(const A in n){const d=n[A];this._createAsyncPropData(A,r[A]),this._updateAsyncProp(A,d),n[A]=this.getAsyncProp(A)}for(const A in i){const d=i[A];this._createAsyncPropData(A,r[A]),this._updateAsyncProp(A,d)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(u5(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n===i.resolvedValue||n===i.lastValue?!1:(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(A=>{this.component&&(A=this._postProcessValue(i,A),this._setAsyncPropValue(e,A,r),this._onResolve(e,A))}).catch(A=>{this._onError(e,A)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let A=[],d=0;for await(const l of n){if(!this.component)return;const{dataTransform:S}=this.component.props;S?A=S(l,A):A=A.concat(l),Object.defineProperty(A,"__diff",{enumerable:!1,value:[{startRow:d,endRow:A.length}]}),d=A.length,this._setAsyncPropValue(e,A,r)}this._onResolve(e,A)}_postProcessValue(e,n){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.props[cc];this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class cY extends uY{constructor({attributeManager:e,layer:n}){super(n),ae(this,"attributeManager",void 0),ae(this,"needsRedraw",void 0),ae(this,"needsUpdate",void 0),ae(this,"subLayers",void 0),ae(this,"usesPickingColorCache",void 0),ae(this,"hasPickingBuffer",void 0),ae(this,"changeFlags",void 0),ae(this,"viewport",void 0),ae(this,"uniformTransitions",void 0),ae(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const i=this.layer,r=i==null?void 0:i.props.fetch;return r?r(n,{propName:e,layer:i}):super._fetch(e,n)}_onResolve(e,n){const i=this.layer;if(i){const r=i.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:i})}}_onError(e,n){const i=this.layer;i&&i.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const hY="layer.changeFlag",fY="layer.initialize",dY="layer.update",pY="layer.finalize",gY="layer.matched",f4=2**24-1,mY=Object.freeze([]),_Y=Kd(({oldViewport:t,viewport:e})=>t.equals(e));let pl=new Uint8ClampedArray(0);const yY={data:{type:"data",value:mY,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:A})=>{const{resourceManager:d}=n.context;if(r=r||n.getLoadOptions(),i=i||n.props.loaders,A){var l;r={...r,fetch:{...(l=r)===null||l===void 0?void 0:l.fetch,signal:A}}}let S=d.contains(t);return!S&&!r&&(d.add({resourceId:t,data:wm(t,i),persistent:!1}),S=!0),S?d.subscribe({resourceId:t,onChange:k=>{var U;return(U=n.internalState)===null||U===void 0?void 0:U.reloadAsyncProp(e,k)},consumerId:n.id,requestId:e}):wm(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:$n.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class YA extends Tw{constructor(...e){super(...e),ae(this,"internalState",null),ae(this,"lifecycle",Oh.NO_STATE),ae(this,"context",void 0),ae(this,"state",void 0),ae(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Es(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=qk(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,A,d]=Zk(i,n.pixelProjectionMatrix);return e.length===2?[r,A]:[r,A,d]}unproject(e){return Es(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Es(this.internalState);const i=this.internalState.viewport||this.context.viewport;return Yk(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===$n.DEFAULT||e===$n.LNGLAT||e===$n.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Es(e instanceof Uint8Array);const[n,i,r]=e;return n+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Qq(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=$q(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const r of i)n.invalidateAll(r);else n.invalidateAll();if(n){const{props:r}=e,A=this.internalState.hasPickingBuffer,d=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(l=>l.getNeedsPickingBuffer.call(this,l));if(A!==d){this.internalState.hasPickingBuffer=d;const{pickingColors:l,instancePickingColors:S}=n.attributes,k=l||S;k&&(d&&k.constant&&(k.constant=!1,n.invalidate(k.id)),!k.value&&!d&&(k.constant=!0,k.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((i=(r=this.props).onError)!==null&&i!==void 0&&i.call(r,e))){var A,d;(A=this.context)===null||A===void 0||(d=A.onError)===null||d===void 0||d.call(A,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!_Y({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const A=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(A)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(pl.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>f4&&Nn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),pl=M0.allocate(pl,n,{size:3,copy:!0,maxCount:Math.max(n,f4)});const r=Math.floor(pl.length/3),A=[];for(let d=i;d<r;d++)this.encodePickingColor(d,A),pl[d*3+0]=A[0],pl[d*3+1]=A[1],pl[d*3+2]=A[2]}e.value=pl.subarray(0,n*3)}_setModelAttributes(e,n){const i=this.getAttributeManager(),r=e.userData.excludeAttributes||{},A=i.getShaderAttributes(n,r);e.setAttributes(A)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,A=i||r,d=A&&n.attributes&&n.attributes[A.id];if(d&&d.value){const l=d.value,S=this.encodePickingColor(e);for(let k=0;k<n.length;k++){const U=A.getVertexOffset(k);l[U]===S[0]&&l[U+1]===S[1]&&l[U+2]===S[2]&&this._disablePickingIndex(k)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const A=r.getVertexOffset(e),d=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(d-A),offset:A})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==pl.buffer&&(i.value=pl.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Es(!this.internalState),Es(Number.isFinite(this.props.coordinateSystem)),Js(fY,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new cY({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Nn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Rq(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Js(gY,this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Js(dY,this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,A=i.viewport,d=this._updateUniformTransition();r.propsInTransition=d,i.viewport=r.viewport||A,this.props=d;try{const l=this._getUpdateParams(),S=this.getModels();if(i.gl)this.updateState(l);else try{this.updateState(l)}catch{}for(const U of this.props.extensions)U.updateState.call(this,l,U);const k=this.getModels()[0]!==S[0];this._postUpdate(l,k)}finally{i.viewport=A,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){Js(pY,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,A=this.context;this.props=this.internalState.propsInTransition||r;const d=this.props.opacity;n.opacity=Math.pow(d,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:l}=this.props,S=l&&l(n)||[0,0];mu(A.gl,{polygonOffset:S}),$A(A.gl,i,()=>{const k={moduleParameters:e,uniforms:n,parameters:i,context:A};for(const U of this.props.extensions)U.draw.call(this,k,U);this.draw(k)})}finally{this.props=r}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let A=!1;switch(r){case"dataChanged":const d=e[r],l=n[r];d&&Array.isArray(l)&&(n.dataChanged=Array.isArray(d)?l.concat(d):d,A=!0);default:n[r]||(n[r]=e[r],A=!0)}A&&Js(hY,this,r,e)}const i=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=zq(e,n);if(i.updateTriggersChanged)for(const A in i.updateTriggersChanged)i.updateTriggersChanged[A]&&this.invalidateAttribute(A);if(i.transitionsChanged)for(const A in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(A,n[A],e[A],(r=e.transitions)===null||r===void 0?void 0:r[A])}return this.setChangeFlags(i)}validateProps(){Oq(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new m5(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:A}=this.state;A==null||A.setInstanceCount(this.getNumInstances());const{autoHighlight:d,highlightedObjectIndex:l,highlightColor:S}=i;if(n||r.autoHighlight!==d||r.highlightedObjectIndex!==l||r.highlightColor!==S){const k={};d||(k.pickingSelectedColor=null),Array.isArray(S)&&(k.pickingHighlightColor=S),(n||l!==r.highlightedObjectIndex)&&(k.pickingSelectedColor=Number.isFinite(l)&&l>=0?this.encodePickingColor(l):null),this.setModuleParameters(k)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;if(n=n||r,n)for(const A of this.props.extensions)A.onNeedsRedraw.call(this,A);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}ae(YA,"defaultProps",yY);ae(YA,"layerName","Layer");const vY="compositeLayer.renderLayers";class N0 extends YA{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:A,parameters:d,getPolygonOffset:l,highlightedObjectIndex:S,autoHighlight:k,highlightColor:U,coordinateSystem:V,coordinateOrigin:$,wrapLongitude:X,positionFormat:ee,modelMatrix:ue,extensions:we,fetch:ie,operation:Ae,_subLayerProps:ce}=this.props,Ce={id:"",updateTriggers:{},opacity:i,pickable:r,visible:A,parameters:d,getPolygonOffset:l,highlightedObjectIndex:S,autoHighlight:k,highlightColor:U,coordinateSystem:V,coordinateOrigin:$,wrapLongitude:X,positionFormat:ee,modelMatrix:ue,extensions:we,fetch:ie,operation:Ae},Ne=ce&&e.id&&ce[e.id],qe=Ne&&Ne.updateTriggers,tt=e.id||"sublayer";if(Ne){const lt=this.props[cc],at=e.type?e.type._propTypes:{};for(const ht in Ne){const Et=at[ht]||lt[ht];Et&&Et.type==="accessor"&&(Ne[ht]=this.getSubLayerAccessor(Ne[ht]))}}Object.assign(Ce,e,Ne),Ce.id="".concat(this.props.id,"-").concat(tt),Ce.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...qe};for(const lt of we){const at=lt.getSubLayerProps.call(this,lt);at&&Object.assign(Ce,at,{updateTriggers:Object.assign(Ce.updateTriggers,at.updateTriggers)})}return Ce}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();if(r){const A=this.renderLayers();i=_w(A,Boolean),this.internalState.subLayers=i}Js(vY,this,r,i);for(const A of i)A.parent=this}}ae(N0,"layerName","CompositeLayer");const sg=Math.PI/180,d4=180/Math.PI,Rg=6370972,Jh=256;function xY(){const t=Jh/Rg,e=Math.PI/180*Jh;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class wY extends ah{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,nearZMultiplier:A=.1,farZMultiplier:d=2,resolution:l=10}=e;let{height:S,altitude:k=1.5}=e;S=S||1,k=Math.max(.75,k);const U=new qA().lookAt({eye:[0,-k,0],up:[0,0,1]}),V=Math.pow(2,r);U.rotateX(n*sg),U.rotateZ(-i*sg),U.scale(V/S);const $=Math.atan(.5/k),X=Jh*2*V/S;super({...e,height:S,viewMatrix:U,longitude:i,latitude:n,zoom:r,distanceScales:xY(),fovyRadians:$*2,focalDistance:k,near:A,far:Math.min(2,1/X+1)*k*d}),ae(this,"longitude",void 0),ae(this,"latitude",void 0),ae(this,"resolution",void 0),this.latitude=n,this.longitude=i,this.resolution=l}get projectionMode(){return jA.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,this.height/2],n),r=this.unproject([this.width/2,0],n),A=this.unproject([this.width,this.height/2],n),d=this.unproject([this.width/2,this.height],n);return A[0]<this.longitude&&(A[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],A[0],r[0],d[0]),Math.min(i[1],A[1],r[1],d[1]),Math.max(i[0],A[0],r[0],d[0]),Math.max(i[1],A[1],r[1],d[1])]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,A,d]=e,l=n?A:this.height-A,{pixelUnprojectionMatrix:S}=this;let k;if(Number.isFinite(d))k=By(S,[r,l,d,1]);else{const X=By(S,[r,l,-1,1]),ee=By(S,[r,l,1,1]),ue=((i||0)/Rg+1)*Jh,we=xy(Mk([],X,ee)),ie=xy(X),Ae=xy(ee),Ce=4*((4*ie*Ae-(we-ie-Ae)**2)/16)/we,Ne=Math.sqrt(ie-Ce),qe=Math.sqrt(Math.max(0,ue*ue-Ce)),tt=(Ne-qe)/Math.sqrt(we);k=tH([],X,ee,tt)}const[U,V,$]=this.unprojectPosition(k);return Number.isFinite(d)?[U,V,$]:Number.isFinite(i)?[U,V,i]:[U,V]}projectPosition(e){const[n,i,r=0]=e,A=n*sg,d=i*sg,l=Math.cos(d),S=(r/Rg+1)*Jh;return[Math.sin(A)*l*S,-Math.cos(A)*l*S,Math.sin(d)*S]}unprojectPosition(e){const[n,i,r]=e,A=AH(e),d=Math.asin(r/A),S=Math.atan2(n,-i)*d4,k=d*d4,U=(A/Jh-1)*Rg;return[S,k,U]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const i=this.unproject(n);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function By(t,e){const n=F0([],e,t);return Lk(n,n,1/n[3]),n}class bY extends t5{applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=vl(r,i,n);const{longitude:A,latitude:d}=e;return(A<-180||A>180)&&(e.longitude=A$(A+180,360)-180),e.latitude=vl(d,-89,89),e}}class EY extends e5{constructor(...e){super(...e),ae(this,"ControllerState",bY),ae(this,"transition",{transitionDuration:300,transitionInterpolator:new yw(["longitude","latitude","zoom"])}),ae(this,"dragMode","pan")}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class y5 extends Kc{get ViewportType(){return wY}get ControllerType(){return EY}}ae(y5,"displayName","GlobeView");class v5{constructor(e){ae(this,"opts",void 0),ae(this,"typedArrayManager",void 0),ae(this,"indexStarts",[0]),ae(this,"vertexStarts",[0]),ae(this,"vertexCount",0),ae(this,"instanceCount",0),ae(this,"attributes",void 0),ae(this,"_attributeDefs",void 0),ae(this,"data",void 0),ae(this,"getGeometry",void 0),ae(this,"geometryBuffer",void 0),ae(this,"buffers",void 0),ae(this,"positionSize",void 0),ae(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=M0,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:i={},getGeometry:r,geometryBuffer:A,positionFormat:d,dataChanged:l,normalize:S=!0}=this.opts;if(this.data=n,this.getGeometry=r,this.positionSize=A&&A.size||(d==="XY"?2:3),this.buffers=i,this.normalize=S,A&&(Es(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(A),S||(i.positions=A)),this.geometryBuffer=i.positions,Array.isArray(l))for(const k of l)this._rebuildGeometry(k);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?c5(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:i,buffers:r,_attributeDefs:A,typedArrayManager:d}=this;for(const l in A)if(l in r)d.release(i[l]),i[l]=null;else{const S=A[l];S.copy=n,i[l]=d.allocate(i[l],e,S)}}_forEachGeometry(e,n,i){const{data:r,getGeometry:A}=this,{iterable:d,objectInfo:l}=_c(r,n,i);for(const S of d){l.index++;const k=A?A(S,l):null;e(k,l.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:i,instanceCount:r}=this;const{data:A,geometryBuffer:d}=this,{startRow:l=0,endRow:S=1/0}=e||{},k={};if(e||(n=[0],i=[0]),this.normalize||!d)this._forEachGeometry((V,$)=>{const X=V&&this.normalizeGeometry(V);k[$]=X,i[$+1]=i[$]+(X?this.getGeometrySize(X):0)},l,S),r=i[i.length-1];else if(i=A.startIndices,r=i[A.length]||0,ArrayBuffer.isView(d))r=r||d.length/this.positionSize;else if(d instanceof xi){const V=d.accessor.stride||this.positionSize*4;r=r||d.byteLength/V}else if(d.buffer){const V=d.stride||this.positionSize*4;r=r||d.buffer.byteLength/V}else if(d.value){const V=d.value,$=d.stride/V.BYTES_PER_ELEMENT||this.positionSize;r=r||V.length/$}this._allocate(r,!!e),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;const U={};this._forEachGeometry((V,$)=>{const X=k[$]||V;U.vertexStart=i[$],U.indexStart=n[$];const ee=$<i.length-1?i[$+1]:r;U.geometrySize=ee-i[$],U.geometryIndex=$,this.updateGeometryAttributes(X,U)},l,S),this.vertexCount=n[n.length-1]}}const TY=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,SY=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,CY=1024,PY=4,p4=()=>{},g4={10241:9987,10240:9729,10242:33071,10243:33071};function MY(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function IY(t,e,n,i){const r=Math.min(n/e.width,i/e.height),A=Math.floor(e.width*r),d=Math.floor(e.height*r);return r===1?{data:e,width:A,height:d}:(t.canvas.height=d,t.canvas.width=A,t.clearRect(0,0,A,d),t.drawImage(e,0,0,e.width,e.height,0,0,A,d),{data:t.canvas,width:A,height:d})}function wd(t){return t&&(t.id||t.url)}function kY(t,e,n,i){const r=t.width,A=t.height,d=new $o(t.gl,{width:e,height:n,parameters:i});return mj(t,d,{targetY:0,width:r,height:A}),t.delete(),d}function m4(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:A}=e[i],d=wd(r);t[d]={...r,x:A,y:n}}}function LY({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:A=0,canvasWidth:d}){let l=[];for(let S=0;S<t.length;S++){const k=t[S],U=wd(k);if(!n[U]){const{height:V,width:$}=k;i+$+e>d&&(m4(n,l,r),i=0,r=A+r+e,A=0,l=[]),l.push({icon:k,xOffset:i}),i=i+$+e,A=Math.max(A,V)}}return l.length>0&&m4(n,l,r),{mapping:n,rowHeight:A,xOffset:i,yOffset:r,canvasWidth:d,canvasHeight:MY(A+r+e)}}function DY(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:A}=_c(t);for(const d of r){A.index++;const l=e(d,A),S=wd(l);if(!l)throw new Error("Icon is missing.");if(!l.url)throw new Error("Icon url is missing.");!i[S]&&(!n[S]||l.url!==n[S].url)&&(i[S]={...l,source:d,sourceIndex:A.index})}return i}class BY{constructor(e,{onUpdate:n=p4,onError:i=p4}){ae(this,"gl",void 0),ae(this,"onUpdate",void 0),ae(this,"onError",void 0),ae(this,"_loadOptions",null),ae(this,"_texture",null),ae(this,"_externalTexture",null),ae(this,"_mapping",{}),ae(this,"_textureParameters",null),ae(this,"_pendingCount",0),ae(this,"_autoPacking",!1),ae(this,"_xOffset",0),ae(this,"_yOffset",0),ae(this,"_rowHeight",0),ae(this,"_buffer",PY),ae(this,"_canvasWidth",CY),ae(this,"_canvasHeight",0),ae(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?wd(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:A}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),r&&(this._mapping=r),i){var d;(d=this._texture)===null||d===void 0||d.delete(),this._texture=null,this._externalTexture=i}A&&(this._textureParameters=A)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(DY(e,n,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:A,yOffset:d,rowHeight:l,canvasHeight:S}=LY({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=l,this._mapping=r,this._xOffset=A,this._yOffset=d,this._canvasHeight=S,this._texture||(this._texture=new $o(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||g4})),this._texture.height!==this._canvasHeight&&(this._texture=kY(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||g4)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const i of e)this._pendingCount++,wm(i.url,this._loadOptions).then(r=>{const A=wd(i),d=this._mapping[A],{x:l,y:S,width:k,height:U}=d,{data:V,width:$,height:X}=IY(n,r,k,U);this._texture.setSubImageData({data:V,x:l+(k-$)/2,y:S+(U-X)/2,width:$,height:X}),d.width=$,d.height=X,this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const x5=[0,0,0,255],RY={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:x5},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class tp extends YA{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(){return super.getShaders({vs:TY,fs:SY,modules:[Ah,lh]})}initializeState(){this.state={iconManager:new BY(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:x5},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,A=this.getAttributeManager(),{iconAtlas:d,iconMapping:l,data:S,getIcon:k,textureParameters:U}=n,{iconManager:V}=this.state,$=d||this.internalState.isAsyncPropLoading("iconAtlas");if(V.setProps({loadOptions:n.loadOptions,autoPacking:!$,iconAtlas:d,iconMapping:$?l:null,textureParameters:U}),$?i.iconMapping!==n.iconMapping&&A.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&V.packIcons(S,k),r.extensionsChanged){var X;const{gl:ee}=this.context;(X=this.state.model)===null||X===void 0||X.delete(),this.state.model=this._getModel(ee),A.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:A,billboard:d,alphaCutoff:l}=this.props,{iconManager:S}=this.state,k=S.getTexture();k&&this.state.model.setUniforms(e).setUniforms({iconsTexture:k,iconsTextureDim:[k.width,k.height],sizeUnits:gu[A],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:d,alphaCutoff:l}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new _u(e,{...this.getShaders(),id:this.props.id,geometry:new El({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const i=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;i?i(e):Nn.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:i,anchorX:r=n/2,anchorY:A=i/2}=this.state.iconManager.getIconMapping(e);return[n/2-r,i/2-A]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:i,width:r,height:A}=this.state.iconManager.getIconMapping(e);return[n,i,r,A]}}ae(tp,"defaultProps",RY);ae(tp,"layerName","IconLayer");const OY=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,zY=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,_4=[0,0,0,255],FY={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:_4},getLineColor:{type:"accessor",value:_4},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Sw extends YA{getShaders(){return super.getShaders({vs:OY,fs:zY,modules:[Ah,lh]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:A,stroked:d,filled:l,billboard:S,antialiasing:k,lineWidthUnits:U,lineWidthScale:V,lineWidthMinPixels:$,lineWidthMaxPixels:X}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:d?1:0,filled:l,billboard:S,antialiasing:k,radiusUnits:gu[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:A,lineWidthUnits:gu[U],lineWidthScale:V,lineWidthMinPixels:$,lineWidthMaxPixels:X}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new _u(e,{...this.getShaders(),id:this.props.id,geometry:new El({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}ae(Sw,"defaultProps",FY);ae(Sw,"layerName","ScatterplotLayer");const Cw={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Pw(t,e,n={}){return NY(t,n)!==e?(VY(t,n),!0):!1}function NY(t,e={}){return Math.sign(UY(t,e))}function UY(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let A=0;for(let d=n,l=i-r;d<i;d+=r)A+=(t[d]-t[l])*(t[d+1]+t[l+1]),l=d;return A/2}function VY(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,A=(i-n)/r,d=Math.floor(A/2);for(let l=0;l<d;++l){const S=n+l*r,k=n+(A-1-l)*r;for(let U=0;U<r;++U){const V=t[S+U];t[S+U]=t[k+U],t[k+U]=V}}}function QA(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let A=0;A<n;A++)if(t[i-n+A]!==e[A]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function bv(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function bd(t,e,n,i,r=[]){const A=i+e*n;for(let d=0;d<n;d++)r[d]=t[A+d];return r}function Ev(t,e,n,i,r=[]){let A,d;if(n&8)A=(i[3]-t[1])/(e[1]-t[1]),d=3;else if(n&4)A=(i[1]-t[1])/(e[1]-t[1]),d=1;else if(n&2)A=(i[2]-t[0])/(e[0]-t[0]),d=2;else if(n&1)A=(i[0]-t[0])/(e[0]-t[0]),d=0;else return null;for(let l=0;l<t.length;l++)r[l]=(d&1)===l?i[d]:A*(e[l]-t[l])+t[l];return r}function Og(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function w5(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:A=[0,0],startIndex:d=0,endIndex:l=t.length}=e||{},S=(l-d)/n;let k=[];const U=[k],V=bd(t,0,n,d);let $,X;const ee=E5(V,r,A,[]),ue=[];QA(k,V);for(let we=1;we<S;we++){for($=bd(t,we,n,d,$),X=Og($,ee);X;){Ev(V,$,X,ee,ue);const ie=Og(ue,ee);ie&&(Ev(V,ue,ie,ee,ue),X=ie),QA(k,ue),bv(V,ue),GY(ee,r,X),i&&k.length>n&&(k=[],U.push(k),QA(k,V)),X=Og($,ee)}QA(k,$),bv(V,$)}return i?U:U[0]}const y4=0,jY=1;function og(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function b5(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:A=[0,0],edgeTypes:d=!1}=n||{},l=[],S=[{pos:t,types:d?new Array(t.length/i).fill(jY):null,holes:e||[]}],k=[[],[]];let U=[];for(;S.length;){const{pos:V,types:$,holes:X}=S.shift();QY(V,i,X[0]||V.length,k),U=E5(k[0],r,A,U);const ee=Og(k[1],U);if(ee){let ue=v4(V,$,i,0,X[0]||V.length,U,ee);const we={pos:ue[0].pos,types:ue[0].types,holes:[]},ie={pos:ue[1].pos,types:ue[1].types,holes:[]};S.push(we,ie);for(let Ae=0;Ae<X.length;Ae++)ue=v4(V,$,i,X[Ae],X[Ae+1]||V.length,U,ee),ue[0]&&(we.holes.push(we.pos.length),we.pos=og(we.pos,ue[0].pos),d&&(we.types=og(we.types,ue[0].types))),ue[1]&&(ie.holes.push(ie.pos.length),ie.pos=og(ie.pos,ue[1].pos),d&&(ie.types=og(ie.types,ue[1].types)))}else{const ue={positions:V};d&&(ue.edgeTypes=$),X.length&&(ue.holeIndices=X),l.push(ue)}}return l}function v4(t,e,n,i,r,A,d){const l=(r-i)/n,S=[],k=[],U=[],V=[],$=[];let X,ee,ue;const we=bd(t,l-1,n,i);let ie=Math.sign(d&8?we[1]-A[3]:we[0]-A[2]),Ae=e&&e[l-1],ce=0,Ce=0;for(let Ne=0;Ne<l;Ne++)X=bd(t,Ne,n,i,X),ee=Math.sign(d&8?X[1]-A[3]:X[0]-A[2]),ue=e&&e[i/n+Ne],ee&&ie&&ie!==ee&&(Ev(we,X,d,A,$),QA(S,$)&&U.push(Ae),QA(k,$)&&V.push(Ae)),ee<=0?(QA(S,X)&&U.push(ue),ce-=ee):U.length&&(U[U.length-1]=y4),ee>=0?(QA(k,X)&&V.push(ue),Ce+=ee):V.length&&(V[V.length-1]=y4),bv(we,X),ie=ee,Ae=ue;return[ce?{pos:S,types:e&&U}:null,Ce?{pos:k,types:e&&V}:null]}function E5(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],A=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=A,i[2]=r+e,i[3]=A+e,i}function GY(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function QY(t,e,n,i){let r=1/0,A=-1/0,d=1/0,l=-1/0;for(let S=0;S<n;S+=e){const k=t[S],U=t[S+1];r=k<r?k:r,A=k>A?k:A,d=U<d?U:d,l=U>l?U:l}return i[0][0]=r,i[0][1]=d,i[1][0]=A,i[1][1]=l,i}const HY=85.051129;function WY(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:A=!0}=e||{},d=t.slice(i,r);T5(d,n,0,r-i);const l=w5(d,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(A)for(const S of l)S5(S,n);return l}function $Y(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:A=!1}=n||{};e=e||[];const d=[],l=[];let S=0,k=0;for(let V=0;V<=e.length;V++){const $=e[V]||t.length,X=k,ee=ZY(t,i,S,$);for(let ue=ee;ue<$;ue++)d[k++]=t[ue];for(let ue=S;ue<ee;ue++)d[k++]=t[ue];T5(d,i,X,k),qY(d,i,X,k,n==null?void 0:n.maxLatitude),S=$,l[V]=k}l.pop();const U=b5(d,l,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:A});if(r)for(const V of U)S5(V.positions,i);return U}function ZY(t,e,n,i){let r=-1,A=-1;for(let d=n+1;d<i;d+=e){const l=Math.abs(t[d]);l>r&&(r=l,A=d-1)}return A}function qY(t,e,n,i,r=HY){const A=t[n],d=t[i-e];if(Math.abs(A-d)>180){const l=bd(t,0,e,n);l[0]+=Math.round((d-A)/360)*360,QA(t,l),l[1]=Math.sign(l[1])*r,QA(t,l),l[0]=A,QA(t,l)}}function T5(t,e,n,i){let r=t[0],A;for(let d=n;d<i;d+=e){A=t[d];const l=A-r;(l>180||l<-180)&&(A-=Math.round(l/360)*360),t[d]=r=A}}function S5(t,e){let n;const i=t.length/e;for(let A=0;A<i&&(n=t[A*e],(n+180)%360===0);A++);const r=-Math.round(n/360)*360;if(r!==0)for(let A=0;A<i;A++)t[A*e]+=r}class YY extends El{constructor(e){const{id:n=Sl("column-geometry")}=e,{indices:i,attributes:r}=XY(e);super({...e,id:n,indices:i,attributes:r})}}function XY(t){const{radius:e,height:n=1,nradial:i=10}=t;let{vertices:r}=t;r&&(Nn.assert(r.length>=i),r=r.flatMap(X=>[X[0],X[1]]),Pw(r,Cw.COUNTER_CLOCKWISE));const A=n>0,d=i+1,l=A?d*3+1:i,S=Math.PI*2/i,k=new Uint16Array(A?i*3*2:0),U=new Float32Array(l*3),V=new Float32Array(l*3);let $=0;if(A){for(let X=0;X<d;X++){const ee=X*S,ue=X%i,we=Math.sin(ee),ie=Math.cos(ee);for(let Ae=0;Ae<2;Ae++)U[$+0]=r?r[ue*2]:ie*e,U[$+1]=r?r[ue*2+1]:we*e,U[$+2]=(1/2-Ae)*n,V[$+0]=r?r[ue*2]:ie,V[$+1]=r?r[ue*2+1]:we,$+=3}U[$+0]=U[$-3],U[$+1]=U[$-2],U[$+2]=U[$-1],$+=3}for(let X=A?0:1;X<d;X++){const ee=Math.floor(X/2)*Math.sign(.5-X%2),ue=ee*S,we=(ee+i)%i,ie=Math.sin(ue),Ae=Math.cos(ue);U[$+0]=r?r[we*2]:Ae*e,U[$+1]=r?r[we*2+1]:ie*e,U[$+2]=n/2,V[$+2]=1,$+=3}if(A){let X=0;for(let ee=0;ee<i;ee++)k[X++]=ee*2+0,k[X++]=ee*2+2,k[X++]=ee*2+0,k[X++]=ee*2+1,k[X++]=ee*2+1,k[X++]=ee*2+3}return{indices:k,attributes:{POSITION:{size:3,value:U},NORMAL:{size:3,value:V}}}}const KY=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  float elevation = 0.0;
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,JY=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Om=[0,0,0,255],eX={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:Om},getLineColor:{type:"accessor",value:Om},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class x_ extends YA{getShaders(){const{gl:e}=this.context,n=!Zn(e),i={},r=this.props.flatShading&&ow(e,Ii.GLSL_DERIVATIVES);return r&&(i.FLAT_SHADING=1),super.getShaders({vs:KY,fs:JY,defines:i,transpileToGLSL100:n,modules:[Ah,r?Fk:zk,lh]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:Om},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:Om},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,A=r.extensionsChanged||n.flatShading!==i.flatShading;if(A){var d;const{gl:l}=this.context;(d=this.state.model)===null||d===void 0||d.delete(),this.state.model=this._getModel(l),this.getAttributeManager().invalidateAll()}(A||n.diskResolution!==i.diskResolution||n.vertices!==i.vertices||(n.extruded||n.stroked)!==(i.extruded||i.stroked))&&this._updateGeometry(n)}getGeometry(e,n,i){const r=new YY({radius:1,height:i?2:0,vertices:n,nradial:e});let A=0;if(n)for(let d=0;d<e;d++){const l=n[d],S=Math.sqrt(l[0]*l[0]+l[1]*l[1]);A+=S/e}else A=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*A}),r}_getModel(e){return new _u(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:i,stroked:r}){const A=this.getGeometry(e,n,i||r);this.setState({fillVertexCount:A.attributes.POSITION.value.length/3,wireframeVertexCount:A.indices.value.length}),this.state.model.setProps({geometry:A})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:i,lineWidthMinPixels:r,lineWidthMaxPixels:A,radiusUnits:d,elevationScale:l,extruded:S,filled:k,stroked:U,wireframe:V,offset:$,coverage:X,radius:ee,angle:ue}=this.props,{model:we,fillVertexCount:ie,wireframeVertexCount:Ae,edgeDistance:ce}=this.state;we.setUniforms(e).setUniforms({radius:ee,angle:ue/180*Math.PI,offset:$,extruded:S,stroked:U,coverage:X,elevationScale:l,edgeDistance:ce,radiusUnits:gu[d],widthUnits:gu[n],widthScale:i,widthMinPixels:r,widthMaxPixels:A}),S&&V&&(we.setProps({isIndexed:!0}),we.setVertexCount(Ae).setDrawMode(1).setUniforms({isStroke:!0}).draw()),k&&(we.setProps({isIndexed:!1}),we.setVertexCount(ie).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!S&&U&&(we.setProps({isIndexed:!1}),we.setVertexCount(ie*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}ae(x_,"layerName","ColumnLayer");ae(x_,"defaultProps",eX);function tX(t,e,n,i){let r;if(Array.isArray(t[0])){const A=t.length*e;r=new Array(A);for(let d=0;d<t.length;d++)for(let l=0;l<e;l++)r[d*e+l]=t[d][l]||0}else r=t;return n?w5(r,{size:e,gridResolution:n}):i?WY(r,{size:e}):r}const nX=1,iX=2,Ry=4;class rX extends v5{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?tX(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(x4(e)){let i=0;for(const r of e)i+=this.getGeometrySize(r);return i}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&x4(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const i=this.attributes.segmentTypes,r=e?this.isClosed(e):!1,{vertexStart:A,geometrySize:d}=n;i.fill(0,A,A+d),r?(i[A]=Ry,i[A+d-2]=Ry):(i[A]+=nX,i[A+d-2]+=iX),i[A+d-1]=Ry}_updatePositions(e,n){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:r,geometrySize:A}=n,d=new Array(3);for(let l=r,S=0;S<A;l++,S++)this.getPointOnPath(e,S,d),i[l*3]=d[0],i[l*3+1]=d[1],i[l*3+2]=d[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,i=[]){const{positionSize:r}=this;n*r>=e.length&&(n+=1-e.length/r);const A=n*r;return i[0]=e[A],i[1]=e[A+1],i[2]=r===3&&e[A+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,i=e.length-n;return e[0]===e[i]&&e[1]===e[i+1]&&(n===2||e[2]===e[i+2])}}function x4(t){return Array.isArray(t[0])}const sX=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,oX=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,C5=[0,0,0,255],aX={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:C5},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Oy={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class w_ extends YA{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(){return super.getShaders({vs:sX,fs:oX,modules:[Ah,lh]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Oy,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Oy,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Oy,defaultValue:C5},instancePickingColors:{size:3,type:5121,accessor:(i,{index:r,target:A})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,A)}}),this.setState({pathTesselator:new rX({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:i}=e,r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:l}=this.state,S=n.data.attributes||{};l.updateGeometry({data:n.data,geometryBuffer:S.getPath,buffers:S,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:l.instanceCount,startIndices:l.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var d;const{gl:l}=this.context;(d=this.state.model)===null||d===void 0||d.delete(),this.state.model=this._getModel(l),r.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(A=>A.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:i,billboard:r,miterLimit:A,widthUnits:d,widthScale:l,widthMinPixels:S,widthMaxPixels:k}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:gu[d],widthScale:l,miterLimit:A,widthMinPixels:S,widthMaxPixels:k}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],i=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new _u(e,{...this.getShaders(),id:this.props.id,geometry:new El({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(i),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}ae(w_,"defaultProps",aX);ae(w_,"layerName","PathLayer");var Mw={exports:{}};Mw.exports=b_;Mw.exports.default=b_;function b_(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,A=P5(t,0,r,n,!0),d=[];if(!A||A.next===A.prev)return d;var l,S,k,U,V,$,X;if(i&&(A=hX(t,e,A,n)),t.length>80*n){l=k=t[0],S=U=t[1];for(var ee=n;ee<r;ee+=n)V=t[ee],$=t[ee+1],V<l&&(l=V),$<S&&(S=$),V>k&&(k=V),$>U&&(U=$);X=Math.max(k-l,U-S),X=X!==0?32767/X:0}return Ed(A,d,n,l,S,X,0),d}function P5(t,e,n,i,r){var A,d;if(r===Cv(t,e,n,i)>0)for(A=e;A<n;A+=i)d=w4(A,t[A],t[A+1],d);else for(A=n-i;A>=e;A-=i)d=w4(A,t[A],t[A+1],d);return d&&E_(d,d.next)&&(Sd(d),d=d.next),d}function Jc(t,e){if(!t)return t;e||(e=t);var n=t,i;do if(i=!1,!n.steiner&&(E_(n,n.next)||or(n.prev,n,n.next)===0)){if(Sd(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Ed(t,e,n,i,r,A,d){if(t){!d&&A&&mX(t,i,r,A);for(var l=t,S,k;t.prev!==t.next;){if(S=t.prev,k=t.next,A?lX(t,i,r,A):AX(t)){e.push(S.i/n|0),e.push(t.i/n|0),e.push(k.i/n|0),Sd(t),t=k.next,l=k.next;continue}if(t=k,t===l){d?d===1?(t=uX(Jc(t),e,n),Ed(t,e,n,i,r,A,2)):d===2&&cX(t,e,n,i,r,A):Ed(Jc(t),e,n,i,r,A,1);break}}}}function AX(t){var e=t.prev,n=t,i=t.next;if(or(e,n,i)>=0)return!1;for(var r=e.x,A=n.x,d=i.x,l=e.y,S=n.y,k=i.y,U=r<A?r<d?r:d:A<d?A:d,V=l<S?l<k?l:k:S<k?S:k,$=r>A?r>d?r:d:A>d?A:d,X=l>S?l>k?l:k:S>k?S:k,ee=i.next;ee!==e;){if(ee.x>=U&&ee.x<=$&&ee.y>=V&&ee.y<=X&&e0(r,l,A,S,d,k,ee.x,ee.y)&&or(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function lX(t,e,n,i){var r=t.prev,A=t,d=t.next;if(or(r,A,d)>=0)return!1;for(var l=r.x,S=A.x,k=d.x,U=r.y,V=A.y,$=d.y,X=l<S?l<k?l:k:S<k?S:k,ee=U<V?U<$?U:$:V<$?V:$,ue=l>S?l>k?l:k:S>k?S:k,we=U>V?U>$?U:$:V>$?V:$,ie=Tv(X,ee,e,n,i),Ae=Tv(ue,we,e,n,i),ce=t.prevZ,Ce=t.nextZ;ce&&ce.z>=ie&&Ce&&Ce.z<=Ae;){if(ce.x>=X&&ce.x<=ue&&ce.y>=ee&&ce.y<=we&&ce!==r&&ce!==d&&e0(l,U,S,V,k,$,ce.x,ce.y)&&or(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,Ce.x>=X&&Ce.x<=ue&&Ce.y>=ee&&Ce.y<=we&&Ce!==r&&Ce!==d&&e0(l,U,S,V,k,$,Ce.x,Ce.y)&&or(Ce.prev,Ce,Ce.next)>=0))return!1;Ce=Ce.nextZ}for(;ce&&ce.z>=ie;){if(ce.x>=X&&ce.x<=ue&&ce.y>=ee&&ce.y<=we&&ce!==r&&ce!==d&&e0(l,U,S,V,k,$,ce.x,ce.y)&&or(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;Ce&&Ce.z<=Ae;){if(Ce.x>=X&&Ce.x<=ue&&Ce.y>=ee&&Ce.y<=we&&Ce!==r&&Ce!==d&&e0(l,U,S,V,k,$,Ce.x,Ce.y)&&or(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function uX(t,e,n){var i=t;do{var r=i.prev,A=i.next.next;!E_(r,A)&&M5(r,i,i.next,A)&&Td(r,A)&&Td(A,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(A.i/n|0),Sd(i),Sd(i.next),i=t=A),i=i.next}while(i!==t);return Jc(i)}function cX(t,e,n,i,r,A){var d=t;do{for(var l=d.next.next;l!==d.prev;){if(d.i!==l.i&&vX(d,l)){var S=I5(d,l);d=Jc(d,d.next),S=Jc(S,S.next),Ed(d,e,n,i,r,A,0),Ed(S,e,n,i,r,A,0);return}l=l.next}d=d.next}while(d!==t)}function hX(t,e,n,i){var r=[],A,d,l,S,k;for(A=0,d=e.length;A<d;A++)l=e[A]*i,S=A<d-1?e[A+1]*i:t.length,k=P5(t,l,S,i,!1),k===k.next&&(k.steiner=!0),r.push(yX(k));for(r.sort(fX),A=0;A<r.length;A++)n=dX(r[A],n);return n}function fX(t,e){return t.x-e.x}function dX(t,e){var n=pX(t,e);if(!n)return e;var i=I5(n,t);return Jc(i,i.next),Jc(n,n.next)}function pX(t,e){var n=e,i=t.x,r=t.y,A=-1/0,d;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var l=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=i&&l>A&&(A=l,d=n.x<n.next.x?n:n.next,l===i))return d}n=n.next}while(n!==e);if(!d)return null;var S=d,k=d.x,U=d.y,V=1/0,$;n=d;do i>=n.x&&n.x>=k&&i!==n.x&&e0(r<U?i:A,r,k,U,r<U?A:i,r,n.x,n.y)&&($=Math.abs(r-n.y)/(i-n.x),Td(n,t)&&($<V||$===V&&(n.x>d.x||n.x===d.x&&gX(d,n)))&&(d=n,V=$)),n=n.next;while(n!==S);return d}function gX(t,e){return or(t.prev,t,e.prev)<0&&or(e.next,t,t.next)<0}function mX(t,e,n,i){var r=t;do r.z===0&&(r.z=Tv(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,_X(r)}function _X(t){var e,n,i,r,A,d,l,S,k=1;do{for(n=t,t=null,A=null,d=0;n;){for(d++,i=n,l=0,e=0;e<k&&(l++,i=i.nextZ,!!i);e++);for(S=k;l>0||S>0&&i;)l!==0&&(S===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,l--):(r=i,i=i.nextZ,S--),A?A.nextZ=r:t=r,r.prevZ=A,A=r;n=i}A.nextZ=null,k*=2}while(d>1);return t}function Tv(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function yX(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function e0(t,e,n,i,r,A,d,l){return(r-d)*(e-l)>=(t-d)*(A-l)&&(t-d)*(i-l)>=(n-d)*(e-l)&&(n-d)*(A-l)>=(r-d)*(i-l)}function vX(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!xX(t,e)&&(Td(t,e)&&Td(e,t)&&wX(t,e)&&(or(t.prev,t,e.prev)||or(t,e.prev,e))||E_(t,e)&&or(t.prev,t,t.next)>0&&or(e.prev,e,e.next)>0)}function or(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function E_(t,e){return t.x===e.x&&t.y===e.y}function M5(t,e,n,i){var r=Ag(or(t,e,n)),A=Ag(or(t,e,i)),d=Ag(or(n,i,t)),l=Ag(or(n,i,e));return!!(r!==A&&d!==l||r===0&&ag(t,n,e)||A===0&&ag(t,i,e)||d===0&&ag(n,t,i)||l===0&&ag(n,e,i))}function ag(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ag(t){return t>0?1:t<0?-1:0}function xX(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M5(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Td(t,e){return or(t.prev,t,t.next)<0?or(t,e,t.next)>=0&&or(t,t.prev,e)>=0:or(t,e,t.prev)<0||or(t,t.next,e)<0}function wX(t,e){var n=t,i=!1,r=(t.x+e.x)/2,A=(t.y+e.y)/2;do n.y>A!=n.next.y>A&&n.next.y!==n.y&&r<(n.next.x-n.x)*(A-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function I5(t,e){var n=new Sv(t.i,t.x,t.y),i=new Sv(e.i,e.x,e.y),r=t.next,A=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,A.next=i,i.prev=A,i}function w4(t,e,n,i){var r=new Sv(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Sd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Sv(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}b_.deviation=function(t,e,n,i){var r=e&&e.length,A=r?e[0]*n:t.length,d=Math.abs(Cv(t,0,A,n));if(r)for(var l=0,S=e.length;l<S;l++){var k=e[l]*n,U=l<S-1?e[l+1]*n:t.length;d-=Math.abs(Cv(t,k,U,n))}var V=0;for(l=0;l<i.length;l+=3){var $=i[l]*n,X=i[l+1]*n,ee=i[l+2]*n;V+=Math.abs((t[$]-t[ee])*(t[X+1]-t[$+1])-(t[$]-t[X])*(t[ee+1]-t[$+1]))}return d===0&&V===0?0:Math.abs((V-d)/d)};function Cv(t,e,n,i){for(var r=0,A=e,d=n-i;A<n;A+=i)r+=(t[d]-t[A])*(t[A+1]+t[d+1]),d=A;return r}b_.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var A=0;A<t[r].length;A++)for(var d=0;d<e;d++)n.vertices.push(t[r][A][d]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var bX=Mw.exports;const EX=$m(bX),lg=Cw.CLOCKWISE,b4=Cw.COUNTER_CLOCKWISE,ec={isClosed:!0};function TX(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Bf(t){return"positions"in t?t.positions:t}function zg(t){return"holeIndices"in t?t.holeIndices:null}function SX(t){return Array.isArray(t[0])}function CX(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function PX(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function MX(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function E4(t,e,n,i,r){let A=e;const d=n.length;for(let l=0;l<d;l++)for(let S=0;S<i;S++)t[A++]=n[l][S]||0;if(!PX(n))for(let l=0;l<i;l++)t[A++]=n[0][l]||0;return ec.start=e,ec.end=A,ec.size=i,Pw(t,r,ec),A}function T4(t,e,n,i,r=0,A,d){A=A||n.length;const l=A-r;if(l<=0)return e;let S=e;for(let k=0;k<l;k++)t[S++]=n[r+k];if(!MX(n,i,r,A))for(let k=0;k<i;k++)t[S++]=n[r+k];return ec.start=e,ec.end=S,ec.size=i,Pw(t,d,ec),S}function k5(t,e){TX(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:A}=t;if(A){let d=0;for(let l=0;l<=A.length;l++)d=T4(n,d,r,e,A[l-1],A[l],l===0?lg:b4),i.push(d);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!SX(t))return T4(n,0,t,e,0,n.length,lg),n;if(!CX(t)){let r=0;for(const[A,d]of t.entries())r=E4(n,r,d,e,A===0?lg:b4),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return E4(n,0,t,e,lg),n}function zy(t,e,n){const i=t.length/3;let r=0;for(let A=0;A<i;A++){const d=(A+1)%i;r+=t[A*3+e]*t[d*3+n],r-=t[d*3+e]*t[A*3+n]}return Math.abs(r/2)}function S4(t,e,n,i){const r=t.length/3;for(let A=0;A<r;A++){const d=A*3,l=t[d+0],S=t[d+1],k=t[d+2];t[d+e]=l,t[d+n]=S,t[d+i]=k}}function IX(t,e,n,i){let r=zg(t);r&&(r=r.map(l=>l/e));let A=Bf(t);const d=i&&e===3;if(n){const l=A.length;A=A.slice();const S=[];for(let k=0;k<l;k+=e){S[0]=A[k],S[1]=A[k+1],d&&(S[2]=A[k+2]);const U=n(S);A[k]=U[0],A[k+1]=U[1],d&&(A[k+2]=U[2])}}if(d){const l=zy(A,0,1),S=zy(A,0,2),k=zy(A,1,2);if(!l&&!S&&!k)return[];l>S&&l>k||(S>k?(n||(A=A.slice()),S4(A,0,2,1)):(n||(A=A.slice()),S4(A,2,0,1)))}return EX(A,r,e)}class kX extends v5{constructor(e){const{fp64:n,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=k5(e,this.positionSize);return this.opts.resolution?b5(Bf(n),zg(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?$Y(Bf(n),zg(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(C4(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}return Bf(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&C4(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:i,indexStart:r}){const{attributes:A,indexStarts:d,typedArrayManager:l}=this;let S=A.indices;if(!S||!e)return;let k=r;const U=IX(e,this.positionSize,this.opts.preproject,this.opts.full3d);S=l.allocate(S,r+U.length,{copy:!0});for(let V=0;V<U.length;V++)S[k++]=U[V]+i;d[n+1]=r+U.length,A.indices=S}_updatePositions(e,{vertexStart:n,geometrySize:i}){const{attributes:{positions:r},positionSize:A}=this;if(!r||!e)return;const d=Bf(e);for(let l=n,S=0;S<i;l++,S++){const k=d[S*A],U=d[S*A+1],V=A>2?d[S*A+2]:0;r[l*3]=k,r[l*3+1]=U,r[l*3+2]=V}}_updateVertexValid(e,{vertexStart:n,geometrySize:i}){const{positionSize:r}=this,A=this.attributes.vertexValid,d=e&&zg(e);if(e&&e.edgeTypes?A.set(e.edgeTypes,n):A.fill(1,n,n+i),d)for(let l=0;l<d.length;l++)A[n+d[l]/r-1]=0;A[n+i-1]=0}}function C4(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const L5=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,LX=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(L5,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),DX=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(L5,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),BX=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,zm=[0,0,0,255],RX={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:zm},getLineColor:{type:"accessor",value:zm},material:!0},ug={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class T_ extends YA{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?LX:DX,fs:BX,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Ah,zk,lh]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:i}=this.props;const{_full3d:r}=this.props;n.isGeospatial&&i===$n.DEFAULT&&(i=$n.LNGLAT);let A;i===$n.LNGLAT&&(r?A=n.projectPosition.bind(n):A=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new kX({preproject:A,fp64:this.use64bitPositions(),IndexType:!e||aw(e,Ii.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const d=this.getAttributeManager(),l=!0;d.remove(["instancePickingColors"]),d.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:l},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:ug,accessor:"getPolygon",update:this.calculatePositions,noAlloc:l,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:l},elevations:{size:1,transition:ug,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ug,accessor:"getFillColor",defaultValue:zm,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ug,accessor:"getLineColor",defaultValue:zm,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(S,{index:k,target:U})=>this.encodePickingColor(S&&S.__source?S.__source.index:k,U),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(A=>A.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:i,wireframe:r,elevationScale:A}=this.props,{topModel:d,sideModel:l,polygonTesselator:S}=this.state,k={...e,extruded:!!n,elevationScale:A};l&&(l.setInstanceCount(S.instanceCount-1),l.setUniforms(k),r&&(l.setDrawMode(3),l.setUniforms({isWireframe:!0}).draw()),i&&(l.setDrawMode(6),l.setUniforms({isWireframe:!1}).draw())),d&&(d.setVertexCount(S.vertexCount),d.setUniforms(k).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:i,changeFlags:r}=e,A=this.getAttributeManager();if(r.extensionsChanged||n.filled!==i.filled||n.extruded!==i.extruded){var l;(l=this.state.models)===null||l===void 0||l.forEach(S=>S.delete()),this.setState(this._getModels(this.context.gl)),A.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:A}=this.state,d=e.data.attributes||{};A.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:d.getPolygon,buffers:d,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:A.instanceCount,startIndices:A.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:i,extruded:r}=this.props;let A,d;if(i){const l=this.getShaders("top");l.defines.NON_INSTANCED_MODEL=1,A=new _u(e,{...l,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(d=new _u(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new El({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),d.userData.excludeAttributes={indices:!0}),{models:[d,A].filter(Boolean),topModel:A,sideModel:d}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}ae(T_,"defaultProps",RX);ae(T_,"layerName","SolidPolygonLayer");function D5({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:A=1/0}=n,d=t.length;let l=d,S=d;for(let $=0;$<d;$++){const X=e(t[$]);if(l>$&&X>=r&&(l=$),X>=A){S=$;break}}let k=l;const V=S-l!==i.length?t.slice(S):void 0;for(let $=0;$<i.length;$++)t[k++]=i[$];if(V){for(let $=0;$<V.length;$++)t[k++]=V[$];t.length=k}return{startRow:l,endRow:l+i.length}}const B5=[0,0,0,255],OX=[0,0,0,255],zX={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:OX},getLineColor:{type:"accessor",value:B5},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class S_ extends N0{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&Nn.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const i=this.state.paths.slice(),r=e.dataChanged.map(A=>D5({data:i,getIndex:d=>d.__source.index,dataRange:A,replace:this._getPaths(A)}));this.setState({paths:i,pathsDiff:r})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:i,positionFormat:r,_normalize:A}=this.props,d=[],l=r==="XY"?2:3,{startRow:S,endRow:k}=e,{iterable:U,objectInfo:V}=_c(n,S,k);for(const $ of U){V.index++;let X=i($,V);A&&(X=k5(X,l));const{holeIndices:ee}=X,ue=X.positions||X;if(ee)for(let we=0;we<=ee.length;we++){const ie=ue.slice(ee[we-1]||0,ee[we]||ue.length);d.push(this.getSubLayerRow({path:ie},$,V.index))}else d.push(this.getSubLayerRow({path:ue},$,V.index))}return d}renderLayers(){const{data:e,_dataDiff:n,stroked:i,filled:r,extruded:A,wireframe:d,_normalize:l,_windingOrder:S,elevationScale:k,transitions:U,positionFormat:V}=this.props,{lineWidthUnits:$,lineWidthScale:X,lineWidthMinPixels:ee,lineWidthMaxPixels:ue,lineJointRounded:we,lineMiterLimit:ie,lineDashJustified:Ae}=this.props,{getFillColor:ce,getLineColor:Ce,getLineWidth:Ne,getLineDashArray:qe,getElevation:tt,getPolygon:lt,updateTriggers:at,material:ht}=this.props,{paths:Et,pathsDiff:St}=this.state,Mt=this.getSubLayerClass("fill",T_),Kt=this.getSubLayerClass("stroke",w_),pn=this.shouldRenderSubLayer("fill",Et)&&new Mt({_dataDiff:n,extruded:A,elevationScale:k,filled:r,wireframe:d,_normalize:l,_windingOrder:S,getElevation:tt,getFillColor:ce,getLineColor:A&&d?Ce:B5,material:ht,transitions:U},this.getSubLayerProps({id:"fill",updateTriggers:at&&{getPolygon:at.getPolygon,getElevation:at.getElevation,getFillColor:at.getFillColor,lineColors:A&&d,getLineColor:at.getLineColor}}),{data:e,positionFormat:V,getPolygon:lt}),ei=!A&&i&&this.shouldRenderSubLayer("stroke",Et)&&new Kt({_dataDiff:St&&(()=>St),widthUnits:$,widthScale:X,widthMinPixels:ee,widthMaxPixels:ue,jointRounded:we,miterLimit:ie,dashJustified:Ae,_pathType:"loop",transitions:U&&{getWidth:U.getLineWidth,getColor:U.getLineColor,getPath:U.getPolygon},getColor:this.getSubLayerAccessor(Ce),getWidth:this.getSubLayerAccessor(Ne),getDashArray:this.getSubLayerAccessor(qe)},this.getSubLayerProps({id:"stroke",updateTriggers:at&&{getWidth:at.getLineWidth,getColor:at.getLineColor,getDashArray:at.getLineDashArray}}),{data:Et,positionFormat:V,getPath:li=>li.path});return[!A&&pn,ei,A&&pn]}}ae(S_,"layerName","PolygonLayer");ae(S_,"defaultProps",zX);function FX(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return n!==-1?NX(t,i,n):null}function NX(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}function UX(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(r.length*3);const A=[];for(let d=0;d<r.length;d++)e(r[d],A),n[i][d*3+0]=A[0],n[i][d*3+1]=A[1],n[i][d*3+2]=A[2]}return n}const VX=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Fy=192/256,P4=[],jX={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class Iw extends tp{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:VX}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;let{outlineColor:r}=n;r!==i.outlineColor&&(r=r.map(A=>A/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!n.sdf&&n.outlineWidth&&Nn.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:i,outlineWidth:r}=this.props,{outlineColor:A}=this.state,d=r?Math.max(i,Fy*(1-r)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Fy,outlineBuffer:d,gamma:i,sdf:!!n,outlineColor:A},super.draw(e),n&&r){const{iconManager:l}=this.state;l.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Fy}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):P4}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):P4}}ae(Iw,"defaultProps",jX);ae(Iw,"layerName","MultiIconLayer");const Yf=1e20;class GX{constructor({fontSize:e=24,buffer:n=3,radius:i=8,cutoff:r=.25,fontFamily:A="sans-serif",fontWeight:d="normal",fontStyle:l="normal"}={}){this.buffer=n,this.cutoff=r,this.radius=i;const S=this.size=e+n*4,k=this._createCanvas(S),U=this.ctx=k.getContext("2d",{willReadFrequently:!0});U.font=`${l} ${d} ${e}px ${A}`,U.textBaseline="alphabetic",U.textAlign="left",U.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:A,actualBoundingBoxRight:d}=this.ctx.measureText(e),l=Math.ceil(i),S=0,k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-A))),U=Math.min(this.size-this.buffer,l+Math.ceil(r)),V=k+2*this.buffer,$=U+2*this.buffer,X=Math.max(V*$,0),ee=new Uint8ClampedArray(X),ue={data:ee,width:V,height:$,glyphWidth:k,glyphHeight:U,glyphTop:l,glyphLeft:S,glyphAdvance:n};if(k===0||U===0)return ue;const{ctx:we,buffer:ie,gridInner:Ae,gridOuter:ce}=this;we.clearRect(ie,ie,k,U),we.fillText(e,ie,ie+l);const Ce=we.getImageData(ie,ie,k,U);ce.fill(Yf,0,X),Ae.fill(0,0,X);for(let Ne=0;Ne<U;Ne++)for(let qe=0;qe<k;qe++){const tt=Ce.data[4*(Ne*k+qe)+3]/255;if(tt===0)continue;const lt=(Ne+ie)*V+qe+ie;if(tt===1)ce[lt]=0,Ae[lt]=Yf;else{const at=.5-tt;ce[lt]=at>0?at*at:0,Ae[lt]=at<0?at*at:0}}M4(ce,0,0,V,$,V,this.f,this.v,this.z),M4(Ae,ie,ie,k,U,V,this.f,this.v,this.z);for(let Ne=0;Ne<X;Ne++){const qe=Math.sqrt(ce[Ne])-Math.sqrt(Ae[Ne]);ee[Ne]=Math.round(255-255*(qe/this.radius+this.cutoff))}return ue}}function M4(t,e,n,i,r,A,d,l,S){for(let k=e;k<e+i;k++)I4(t,n*A+k,A,r,d,l,S);for(let k=n;k<n+r;k++)I4(t,k*A+e,1,i,d,l,S)}function I4(t,e,n,i,r,A,d){A[0]=0,d[0]=-Yf,d[1]=Yf,r[0]=t[e];for(let l=1,S=0,k=0;l<i;l++){r[l]=t[e+l*n];const U=l*l;do{const V=A[S];k=(r[l]-r[V]+U-V*V)/(l-V)/2}while(k<=d[S]&&--S>-1);S++,A[S]=l,d[S]=k,d[S+1]=Yf}for(let l=0,S=0;l<i;l++){for(;d[S+1]<l;)S++;const k=A[S],U=l-k;t[e+l*n]=r[k]+U*U}}const QX=32,HX=[];function WX(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function $X({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:A={},xOffset:d=0,yOffset:l=0}){let S=0,k=d;const U=n+i*2;for(const V of t)if(!A[V]){const $=e(V);k+$+i*2>r&&(k=0,S++),A[V]={x:k+i,y:l+S*U+i,width:$,height:U,layoutWidth:$,layoutHeight:n},k+=$+i*2}return{mapping:A,xOffset:k,yOffset:l+S*U,canvasHeight:WX(l+(S+1)*U)}}function R5(t,e,n,i){let r=0;for(let d=e;d<n;d++){var A;const l=t[d];r+=((A=i[l])===null||A===void 0?void 0:A.layoutWidth)||0}return r}function O5(t,e,n,i,r,A){let d=e,l=0;for(let S=e;S<n;S++){const k=R5(t,S,S+1,r);l+k>i&&(d<S&&A.push(S),d=S,l=0),l+=k}return l}function ZX(t,e,n,i,r,A){let d=e,l=e,S=e,k=0;for(let U=e;U<n;U++)if((t[U]===" "||t[U+1]===" "||U+1===n)&&(S=U+1),S>l){let V=R5(t,l,S,r);k+V>i&&(d<l&&(A.push(l),d=l,k=0),V>i&&(V=O5(t,l,S,i,r,A),d=A[A.length-1])),l=S,k+=V}return k}function qX(t,e,n,i,r=0,A){A===void 0&&(A=t.length);const d=[];return e==="break-all"?O5(t,r,A,n,i,d):ZX(t,r,A,n,i,d),d}function YX(t,e,n,i,r,A){let d=0,l=0;for(let S=e;S<n;S++){const k=t[S],U=i[k];U?(l||(l=U.layoutHeight),r[S]=d+U.layoutWidth/2,d+=U.layoutWidth):(Nn.warn("Missing character: ".concat(k," (").concat(k.codePointAt(0),")"))(),r[S]=d,d+=QX)}A[0]=d,A[1]=l}function XX(t,e,n,i,r){const A=Array.from(t),d=A.length,l=new Array(d),S=new Array(d),k=new Array(d),U=(n==="break-word"||n==="break-all")&&isFinite(i)&&i>0,V=[0,0],$=[0,0];let X=0,ee=0,ue=0;for(let ie=0;ie<=d;ie++){const Ae=A[ie];if((Ae===`
`||ie===d)&&(ue=ie),ue>ee){const ce=U?qX(A,n,i,r,ee,ue):HX;for(let Ce=0;Ce<=ce.length;Ce++){const Ne=Ce===0?ee:ce[Ce-1],qe=Ce<ce.length?ce[Ce]:ue;YX(A,Ne,qe,r,l,$);for(let tt=Ne;tt<qe;tt++){var we;const lt=A[tt],at=((we=r[lt])===null||we===void 0?void 0:we.layoutOffsetY)||0;S[tt]=X+$[1]/2+at,k[tt]=$[0]}X=X+$[1]*e,V[0]=Math.max(V[0],$[0])}ee=ue}Ae===`
`&&(l[ee]=0,S[ee]=0,k[ee]=0,ee++)}return V[1]=X,{x:l,y:S,rowWidth:k,size:V}}function KX({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:A}){const d=t.BYTES_PER_ELEMENT,l=n?n/d:1,S=i?i/d:0,k=r[e]||Math.ceil((t.length-S)/l),U=A&&new Set,V=new Array(e);let $=t;if(l>1||S>0){const X=t.constructor;$=new X(k);for(let ee=0;ee<k;ee++)$[ee]=t[ee*l+S]}for(let X=0;X<e;X++){const ee=r[X],ue=r[X+1]||k,we=$.subarray(ee,ue);V[X]=String.fromCodePoint.apply(null,we),U&&we.forEach(U.add,U)}if(U)for(const X of U)A.add(String.fromCodePoint(X));return{texts:V,characterCount:k}}class z5{constructor(e=5){ae(this,"limit",void 0),ae(this,"_cache",{}),ae(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function JX(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const c0={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:JX(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},k4=1024,L4=.9,D4=1.2,F5=3;let Fm=new z5(F5);function eK(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const i=Fm.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}function tK(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function B4(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function nK(t){Nn.assert(Number.isFinite(t)&&t>=F5,"Invalid cache limit"),Fm=new z5(t)}class iK{constructor(){ae(this,"props",{...c0}),ae(this,"_key",void 0),ae(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*D4+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=eK(this._key,this.props.characterSet),i=Fm.get(this._key);if(i&&n.size===0){this._atlas!==i&&(this._atlas=i);return}const r=this._generateFontAtlas(n,i);this._atlas=r,Fm.set(this._key,r)}_generateFontAtlas(e,n){const{fontFamily:i,fontWeight:r,fontSize:A,buffer:d,sdf:l,radius:S,cutoff:k}=this.props;let U=n&&n.data;U||(U=document.createElement("canvas"),U.width=k4);const V=U.getContext("2d",{willReadFrequently:!0});B4(V,i,A,r);const{mapping:$,canvasHeight:X,xOffset:ee,yOffset:ue}=$X({getFontWidth:we=>V.measureText(we).width,fontHeight:A*D4,buffer:d,characterSet:e,maxCanvasWidth:k4,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(U.height!==X){const we=V.getImageData(0,0,U.width,U.height);U.height=X,V.putImageData(we,0,0)}if(B4(V,i,A,r),l){const we=new GX({fontSize:A,buffer:d,radius:S,cutoff:k,fontFamily:i,fontWeight:"".concat(r)});for(const ie of e){const{data:Ae,width:ce,height:Ce,glyphTop:Ne}=we.draw(ie);$[ie].width=ce,$[ie].layoutOffsetY=A*L4-Ne;const qe=V.createImageData(ce,Ce);tK(Ae,qe),V.putImageData(qe,$[ie].x,$[ie].y)}}else for(const we of e)V.fillText(we,$[we].x,$[we].y+d+A*L4);return{xOffset:ee,yOffset:ue,mapping:$,data:U,width:U.width,height:U.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:i,buffer:r,sdf:A,radius:d,cutoff:l}=this.props;return A?"".concat(e," ").concat(n," ").concat(i," ").concat(r," ").concat(d," ").concat(l):"".concat(e," ").concat(n," ").concat(i," ").concat(r)}}const rK=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,sK=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,oK={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class kw extends YA{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(){return super.getShaders({vs:rK,fs:sK,modules:[Ah,lh]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var i;const{gl:r}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:A,sizeMaxPixels:d,getLineWidth:l}=this.props;let{padding:S}=this.props;S.length<4&&(S=[S[0],S[1],S[0],S[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!l,padding:S,sizeUnits:gu[r],sizeScale:i,sizeMinPixels:A,sizeMaxPixels:d}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new _u(e,{...this.getShaders(),id:this.props.id,geometry:new El({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}ae(kw,"defaultProps",oK);ae(kw,"layerName","TextBackgroundLayer");const R4={start:1,middle:0,end:-1},O4={top:1,center:0,bottom:-1},Ny=[0,0,0,255],aK=1,AK={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Ny},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:c0.characterSet},fontFamily:c0.fontFamily,fontWeight:c0.fontWeight,lineHeight:aK,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Ny},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Ny},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Lw extends N0{constructor(...e){super(...e),ae(this,"state",void 0),ae(this,"getBoundingRect",(n,i)=>{let{size:[r,A]}=this.transformParagraph(n,i);const{fontSize:d}=this.state.fontAtlasManager.props;r/=d,A/=d;const{getTextAnchor:l,getAlignmentBaseline:S}=this.props,k=R4[typeof l=="function"?l(n,i):l],U=O4[typeof S=="function"?S(n,i):S];return[(k-1)*r/2,(U-1)*A/2,r,A]}),ae(this,"getIconOffsets",(n,i)=>{const{getTextAnchor:r,getAlignmentBaseline:A}=this.props,{x:d,y:l,rowWidth:S,size:[k,U]}=this.transformParagraph(n,i),V=R4[typeof r=="function"?r(n,i):r],$=O4[typeof A=="function"?A(n,i):A],X=d.length,ee=new Array(X*2);let ue=0;for(let we=0;we<X;we++){const ie=(1-V)*(k-S[we])/2;ee[ue++]=(V-1)*k/2+ie+d[we],ee[ue++]=($-1)*U/2+l[we]}return ee})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new iK},this.props.maxWidth>0&&Nn.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==i.lineHeight||n.wordBreak!==i.wordBreak||n.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:A}=this.state,d={...e,characterSet:A,fontFamily:n,fontWeight:i};if(!r.mapping)return r.setProps(d),!0;for(const l in d)if(d[l]!==r.props[l])return r.setProps(d),!0;return!1}_updateText(){var e;const{data:n,characterSet:i}=this.props,r=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:A}=this.props,d=n.startIndices,l;const S=i==="auto"&&new Set;if(r&&d){const{texts:k,characterCount:U}=KX({...ArrayBuffer.isView(r)?{value:r}:r,length:n.length,startIndices:d,characterSet:S});l=U,A=(V,{index:$})=>k[$]}else{const{iterable:k,objectInfo:U}=_c(n);d=[0],l=0;for(const V of k){U.index++;const $=Array.from(A(V,U)||"");S&&$.forEach(S.add,S),l+=$.length,d.push(l)}}this.setState({getText:A,startIndices:d,numInstances:l,characterSet:S||i})}transformParagraph(e,n){const{fontAtlasManager:i}=this.state,r=i.mapping,A=this.state.getText,{wordBreak:d,lineHeight:l,maxWidth:S}=this.props,k=A(e,n)||"";return XX(k,l,d,S*i.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:n,getText:i,fontAtlasManager:{scale:r,texture:A,mapping:d},styleVersion:l}=this.state,{data:S,_dataDiff:k,getPosition:U,getColor:V,getSize:$,getAngle:X,getPixelOffset:ee,getBackgroundColor:ue,getBorderColor:we,getBorderWidth:ie,backgroundPadding:Ae,background:ce,billboard:Ce,fontSettings:Ne,outlineWidth:qe,outlineColor:tt,sizeScale:lt,sizeUnits:at,sizeMinPixels:ht,sizeMaxPixels:Et,transitions:St,updateTriggers:Mt}=this.props,Kt=this.getSubLayerClass("characters",Iw),pn=this.getSubLayerClass("background",kw);return[ce&&new pn({getFillColor:ue,getLineColor:we,getLineWidth:ie,padding:Ae,getPosition:U,getSize:$,getAngle:X,getPixelOffset:ee,billboard:Ce,sizeScale:lt,sizeUnits:at,sizeMinPixels:ht,sizeMaxPixels:Et,transitions:St&&{getPosition:St.getPosition,getAngle:St.getAngle,getSize:St.getSize,getFillColor:St.getBackgroundColor,getLineColor:St.getBorderColor,getLineWidth:St.getBorderWidth,getPixelOffset:St.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Mt.getPosition,getAngle:Mt.getAngle,getSize:Mt.getSize,getFillColor:Mt.getBackgroundColor,getLineColor:Mt.getBorderColor,getLineWidth:Mt.getBorderWidth,getPixelOffset:Mt.getPixelOffset,getBoundingRect:{getText:Mt.getText,getTextAnchor:Mt.getTextAnchor,getAlignmentBaseline:Mt.getAlignmentBaseline,styleVersion:l}}}),{data:S.attributes&&S.attributes.background?{length:S.length,attributes:S.attributes.background}:S,_dataDiff:k,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new Kt({sdf:Ne.sdf,smoothing:Number.isFinite(Ne.smoothing)?Ne.smoothing:c0.smoothing,outlineWidth:qe/(Ne.radius||c0.radius),outlineColor:tt,iconAtlas:A,iconMapping:d,getPosition:U,getColor:V,getSize:$,getAngle:X,getPixelOffset:ee,billboard:Ce,sizeScale:lt*r,sizeUnits:at,sizeMinPixels:ht*r,sizeMaxPixels:Et*r,transitions:St&&{getPosition:St.getPosition,getAngle:St.getAngle,getColor:St.getColor,getSize:St.getSize,getPixelOffset:St.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Mt.getText,getPosition:Mt.getPosition,getAngle:Mt.getAngle,getColor:Mt.getColor,getSize:Mt.getSize,getPixelOffset:Mt.getPixelOffset,getIconOffsets:{getTextAnchor:Mt.getTextAnchor,getAlignmentBaseline:Mt.getAlignmentBaseline,styleVersion:l}}}),{data:S,_dataDiff:k,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){nK(e)}}ae(Lw,"defaultProps",AK);ae(Lw,"layerName","TextLayer");const Fg={circle:{type:Sw,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:tp,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Lw,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Ng={type:w_,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Pv={type:T_,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Tf({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function Uy(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const A in e){const d=e[A];let l=t.props[A];A.startsWith("get")&&(l=t.getSubLayerAccessor(l),r.updateTriggers[d]=i[A],n&&(r.transitions[d]=n[A])),r[d]=l}return r}function lK(t){if(Array.isArray(t))return t;switch(Nn.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Nn.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function z4(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:A=t.length}=n;for(let d=r;d<A;d++){const l=t[d],{geometry:S}=l;if(S)if(S.type==="GeometryCollection"){Nn.assert(Array.isArray(S.geometries),"GeoJSON does not have geometries array");const{geometries:k}=S;for(let U=0;U<k.length;U++){const V=k[U];F4(V,i,e,l,d)}}else F4(S,i,e,l,d)}return i}function F4(t,e,n,i,r){const{type:A,coordinates:d}=t,{pointFeatures:l,lineFeatures:S,polygonFeatures:k,polygonOutlineFeatures:U}=e;if(!cK(A,d)){Nn.warn("".concat(A," coordinates are malformed"))();return}switch(A){case"Point":l.push(n({geometry:t},i,r));break;case"MultiPoint":d.forEach(V=>{l.push(n({geometry:{type:"Point",coordinates:V}},i,r))});break;case"LineString":S.push(n({geometry:t},i,r));break;case"MultiLineString":d.forEach(V=>{S.push(n({geometry:{type:"LineString",coordinates:V}},i,r))});break;case"Polygon":k.push(n({geometry:t},i,r)),d.forEach(V=>{U.push(n({geometry:{type:"LineString",coordinates:V}},i,r))});break;case"MultiPolygon":d.forEach(V=>{k.push(n({geometry:{type:"Polygon",coordinates:V}},i,r)),V.forEach($=>{U.push(n({geometry:{type:"LineString",coordinates:$}},i,r))})});break}}const uK={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function cK(t,e){let n=uK[t];for(Nn.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function N5(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function cg(t){return t.geometry.coordinates}function hK(t,e){const n=N5(),{pointFeatures:i,lineFeatures:r,polygonFeatures:A,polygonOutlineFeatures:d}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=cg,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=cg,n.polygons.data=A,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=cg,n.polygonsOutline.data=d,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=cg,n}function fK(t,e){const n=N5(),{points:i,lines:r,polygons:A}=t,d=UX(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:d.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:d.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:A.polygonIndices.value.length-1,startIndices:A.polygonIndices.value,attributes:{...A.attributes,getPolygon:A.positions,pickingColors:{size:3,value:d.polygons}},properties:A.properties,numericProps:A.numericProps,featureIds:A.featureIds},n.polygons._normalize=!1,A.triangles&&(n.polygons.data.attributes.indices=A.triangles.value),n.polygonsOutline.data={length:A.primitivePolygonIndices.value.length-1,startIndices:A.primitivePolygonIndices.value,attributes:{...A.attributes,getPath:A.positions,instancePickingColors:{size:3,value:d.polygons}},properties:A.properties,numericProps:A.numericProps,featureIds:A.featureIds},n.polygonsOutline._pathType="open",n}const dK=["points","linestrings","polygons"],pK={...Tf(Fg.circle),...Tf(Fg.icon),...Tf(Fg.text),...Tf(Ng),...Tf(Pv),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Dw extends N0{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const i=fK(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:n}){const i=lK(e.data),r=this.getSubLayerRow.bind(this);let A={};const d={};if(Array.isArray(n.dataChanged)){const S=this.state.features;for(const k in S)A[k]=S[k].slice(),d[k]=[];for(const k of n.dataChanged){const U=z4(i,r,k);for(const V in S)d[V].push(D5({data:A[V],getIndex:$=>$.__source.index,dataRange:k,replace:U[V]}))}}else A=z4(i,r);const l=hK(A,d);this.setState({features:A,featuresDiff:d,layerProps:l})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i,sourceLayer:r}=n;return n.featureType=dK.find(A=>r.id.startsWith("".concat(this.id,"-").concat(A,"-"))),i>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[i]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),i=e.featureType==="points";for(const r of this.getSubLayers())r.id.startsWith(n)===i&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:i}=this.state,r="polygons-fill",A=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,Pv.type);if(A){const d=Uy(this,Pv.props),l=e&&n;return l||delete d.getLineColor,d.updateTriggers.lineColors=l,new A(d,this.getSubLayerProps({id:r,updateTriggers:d.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:i}=this.state,r="polygons-stroke",A="linestrings",d=!e&&n&&this.shouldRenderSubLayer(r,i.polygonsOutline.data)&&this.getSubLayerClass(r,Ng.type),l=this.shouldRenderSubLayer(A,i.lines.data)&&this.getSubLayerClass(A,Ng.type);if(d||l){const S=Uy(this,Ng.props);return[d&&new d(S,this.getSubLayerProps({id:r,updateTriggers:S.updateTriggers}),i.polygonsOutline),l&&new l(S,this.getSubLayerProps({id:A,updateTriggers:S.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:i}=this.state;let{highlightedObjectIndex:r}=this.props;!i&&Number.isFinite(r)&&(r=n.points.data.findIndex(l=>l.__source.index===r));const A=new Set(e.split("+")),d=[];for(const l of A){const S="points-".concat(l),k=Fg[l],U=k&&this.shouldRenderSubLayer(S,n.points.data)&&this.getSubLayerClass(S,k.type);if(U){const V=Uy(this,k.props);let $=n.points;if(l==="text"&&i){const{instancePickingColors:X,...ee}=$.data.attributes;$={...$,data:{...$.data,attributes:ee}}}d.push(new U(V,this.getSubLayerProps({id:S,updateTriggers:V.updateTriggers,highlightedObjectIndex:r}),$))}}return d}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),i=this._renderLineLayers(),r=this._renderPointLayers();return[!e&&n,i,r,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(i,r)=>{const{data:A,index:d}=r,l=FX(A,d);return e(l,r)}}}ae(Dw,"layerName","GeoJsonLayer");ae(Dw,"defaultProps",pK);var Ho=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function A(oe){return e.locateFile?e.locateFile(oe,r):r+oe}var d;document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",d=function(ve,Pe,rt){var s=new XMLHttpRequest;s.open("GET",ve,!0),s.responseType="arraybuffer",s.onload=function(){if(s.status==200||s.status==0&&s.response){Pe(s.response);return}var ft=Or(ve);if(ft){Pe(ft.buffer);return}rt()},s.onerror=rt,s.send(null)};var l=e.print||console.log.bind(console),S=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var k=0,U=function(oe){k=oe},V=function(){return k},$=8;function X(oe,ve,Pe,rt){switch(Pe=Pe||"i8",Pe.charAt(Pe.length-1)==="*"&&(Pe="i32"),Pe){case"i1":St[oe>>0]=ve;break;case"i8":St[oe>>0]=ve;break;case"i16":Kt[oe>>1]=ve;break;case"i32":pn[oe>>2]=ve;break;case"i64":It=[ve>>>0,(Gi=ve,+ut(Gi)>=1?Gi>0?(Ln(+rs(Gi/4294967296),4294967295)|0)>>>0:~~+xr((Gi-+(~~Gi>>>0))/4294967296)>>>0:0)],pn[oe>>2]=It[0],pn[oe+4>>2]=It[1];break;case"float":ei[oe>>2]=ve;break;case"double":li[oe>>3]=ve;break;default:Ye("invalid type for setValue: "+Pe)}}function ee(oe,ve,Pe){switch(ve=ve||"i8",ve.charAt(ve.length-1)==="*"&&(ve="i32"),ve){case"i1":return St[oe>>0];case"i8":return St[oe>>0];case"i16":return Kt[oe>>1];case"i32":return pn[oe>>2];case"i64":return pn[oe>>2];case"float":return ei[oe>>2];case"double":return li[oe>>3];default:Ye("invalid type for getValue: "+ve)}return null}var ue=!1;function we(oe,ve){oe||Ye("Assertion failed: "+ve)}function ie(oe){var ve=e["_"+oe];return we(ve,"Cannot call unknown function "+oe+", make sure it is exported"),ve}function Ae(oe,ve,Pe,rt,s){var Z={string:function(pt){var Dn=0;if(pt!=null&&pt!==0){var hi=(pt.length<<2)+1;Dn=ke(hi),lt(pt,Dn,hi)}return Dn},array:function(pt){var Dn=ke(pt.length);return at(pt,Dn),Dn}};function ft(pt){return ve==="string"?qe(pt):ve==="boolean"?!!pt:pt}var mt=ie(oe),kt=[],yt=0;if(rt)for(var Pt=0;Pt<rt.length;Pt++){var Qt=Z[Pe[Pt]];Qt?(yt===0&&(yt=fe()),kt[Pt]=Qt(rt[Pt])):kt[Pt]=rt[Pt]}var Vt=mt.apply(null,kt);return Vt=ft(Vt),yt!==0&&re(yt),Vt}function ce(oe,ve,Pe,rt){Pe=Pe||[];var s=Pe.every(function(ft){return ft==="number"}),Z=ve!=="string";return Z&&s&&!rt?ie(oe):function(){return Ae(oe,ve,Pe,arguments)}}var Ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ne(oe,ve,Pe){for(var rt=ve+Pe,s=ve;oe[s]&&!(s>=rt);)++s;if(s-ve>16&&oe.subarray&&Ce)return Ce.decode(oe.subarray(ve,s));for(var Z="";ve<s;){var ft=oe[ve++];if(!(ft&128)){Z+=String.fromCharCode(ft);continue}var mt=oe[ve++]&63;if((ft&224)==192){Z+=String.fromCharCode((ft&31)<<6|mt);continue}var kt=oe[ve++]&63;if((ft&240)==224?ft=(ft&15)<<12|mt<<6|kt:ft=(ft&7)<<18|mt<<12|kt<<6|oe[ve++]&63,ft<65536)Z+=String.fromCharCode(ft);else{var yt=ft-65536;Z+=String.fromCharCode(55296|yt>>10,56320|yt&1023)}}return Z}function qe(oe,ve){return oe?Ne(Mt,oe,ve):""}function tt(oe,ve,Pe,rt){if(!(rt>0))return 0;for(var s=Pe,Z=Pe+rt-1,ft=0;ft<oe.length;++ft){var mt=oe.charCodeAt(ft);if(mt>=55296&&mt<=57343){var kt=oe.charCodeAt(++ft);mt=65536+((mt&1023)<<10)|kt&1023}if(mt<=127){if(Pe>=Z)break;ve[Pe++]=mt}else if(mt<=2047){if(Pe+1>=Z)break;ve[Pe++]=192|mt>>6,ve[Pe++]=128|mt&63}else if(mt<=65535){if(Pe+2>=Z)break;ve[Pe++]=224|mt>>12,ve[Pe++]=128|mt>>6&63,ve[Pe++]=128|mt&63}else{if(Pe+3>=Z)break;ve[Pe++]=240|mt>>18,ve[Pe++]=128|mt>>12&63,ve[Pe++]=128|mt>>6&63,ve[Pe++]=128|mt&63}}return ve[Pe]=0,Pe-s}function lt(oe,ve,Pe){return tt(oe,Mt,ve,Pe)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function at(oe,ve){St.set(oe,ve)}function ht(oe,ve){return oe%ve>0&&(oe+=ve-oe%ve),oe}var Et,St,Mt,Kt,pn,ei,li;function Nt(oe){Et=oe,e.HEAP8=St=new Int8Array(oe),e.HEAP16=Kt=new Int16Array(oe),e.HEAP32=pn=new Int32Array(oe),e.HEAPU8=Mt=new Uint8Array(oe),e.HEAPU16=new Uint16Array(oe),e.HEAPU32=new Uint32Array(oe),e.HEAPF32=ei=new Float32Array(oe),e.HEAPF64=li=new Float64Array(oe)}var dn=5266928,vn=24016,Bn=e.TOTAL_MEMORY||33554432;e.buffer?Et=e.buffer:Et=new ArrayBuffer(Bn),Bn=Et.byteLength,Nt(Et),pn[vn>>2]=dn;function Tn(oe){for(;oe.length>0;){var ve=oe.shift();if(typeof ve=="function"){ve();continue}var Pe=ve.func;typeof Pe=="number"?ve.arg===void 0?e.dynCall_v(Pe):e.dynCall_vi(Pe,ve.arg):Pe(ve.arg===void 0?null:ve.arg)}}var wi=[],Un=[],Hr=[],qi=[];function ti(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)vr(e.preRun.shift());Tn(wi)}function kr(){Tn(Un)}function Yn(){Tn(Hr)}function si(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Lr(e.postRun.shift());Tn(qi)}function vr(oe){wi.unshift(oe)}function Lr(oe){qi.unshift(oe)}var ut=Math.abs,xr=Math.ceil,rs=Math.floor,Ln=Math.min,gn=0,ji=null;function Ns(oe){gn++,e.monitorRunDependencies&&e.monitorRunDependencies(gn)}function ro(oe){if(gn--,e.monitorRunDependencies&&e.monitorRunDependencies(gn),gn==0&&ji){var ve=ji;ji=null,ve()}}e.preloadedImages={},e.preloadedAudios={};var Qn=null,Jn="data:application/octet-stream;base64,";function so(oe){return String.prototype.startsWith?oe.startsWith(Jn):oe.indexOf(Jn)===0}var Gi,It;Qn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Yi=24032;function Xi(oe){return oe}function Dr(oe){var ve=/\b__Z[\w\d_]+/g;return oe.replace(ve,function(Pe){var rt=Pe;return Pe===rt?Pe:rt+" ["+Pe+"]"})}function Wr(){var oe=new Error;if(!oe.stack){try{throw new Error(0)}catch(ve){oe=ve}if(!oe.stack)return"(no stack trace available)"}return oe.stack.toString()}function Lt(){var oe=Wr();return e.extraStackTrace&&(oe+=`
`+e.extraStackTrace()),Dr(oe)}function yn(oe,ve,Pe,rt){Ye("Assertion failed: "+qe(oe)+", at: "+[ve?qe(ve):"unknown filename",Pe,rt?qe(rt):"unknown function"])}function mn(){return St.length}function Qi(oe,ve,Pe){Mt.set(Mt.subarray(ve,ve+Pe),oe)}function Cs(oe){return e.___errno_location&&(pn[e.___errno_location()>>2]=oe),oe}function ln(oe){Ye("OOM")}function Br(oe){try{var ve=new ArrayBuffer(oe);return ve.byteLength!=oe?void 0:(new Int8Array(ve).set(St),os(ve),Nt(ve),1)}catch{}}function ss(oe){var ve=mn(),Pe=16777216,rt=2147483648-Pe;if(oe>rt)return!1;for(var s=16777216,Z=Math.max(ve,s);Z<oe;)Z<=536870912?Z=ht(2*Z,Pe):Z=Math.min(ht((3*Z+2147483648)/4,Pe),rt);var ft=Br(Z);return!!ft}var $r=typeof atob=="function"?atob:function(oe){var ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pe="",rt,s,Z,ft,mt,kt,yt,Pt=0;oe=oe.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ft=ve.indexOf(oe.charAt(Pt++)),mt=ve.indexOf(oe.charAt(Pt++)),kt=ve.indexOf(oe.charAt(Pt++)),yt=ve.indexOf(oe.charAt(Pt++)),rt=ft<<2|mt>>4,s=(mt&15)<<4|kt>>2,Z=(kt&3)<<6|yt,Pe=Pe+String.fromCharCode(rt),kt!==64&&(Pe=Pe+String.fromCharCode(s)),yt!==64&&(Pe=Pe+String.fromCharCode(Z));while(Pt<oe.length);return Pe};function Rr(oe){try{for(var ve=$r(oe),Pe=new Uint8Array(ve.length),rt=0;rt<ve.length;++rt)Pe[rt]=ve.charCodeAt(rt);return Pe}catch{throw new Error("Converting base64 string to bytes failed.")}}function Or(oe){if(so(oe))return Rr(oe.slice(Jn.length))}var ki={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Xn={a:Ye,b:U,c:V,d:yn,e:Cs,f:mn,g:Qi,h:ss,i:ln,j:Xi,k:Dr,l:Br,m:Wr,n:Lt,o:Yi,p:vn},Je=function(oe,ve,Pe){"almost asm";var rt=new oe.Int8Array(Pe),s=new oe.Int32Array(Pe);new oe.Uint8Array(Pe),new oe.Float32Array(Pe);var Z=new oe.Float64Array(Pe),ft=ve.p|0,mt=oe.Math.floor,kt=oe.Math.abs,yt=oe.Math.sqrt,Pt=oe.Math.pow,Qt=oe.Math.cos,Vt=oe.Math.sin,pt=oe.Math.tan,Dn=oe.Math.acos,hi=oe.Math.asin,ni=oe.Math.atan,Rn=oe.Math.atan2,_i=oe.Math.ceil,On=oe.Math.imul,qn=oe.Math.min,ur=oe.Math.clz32,an=ve.b,Ve=ve.c,Ut=ve.d,Se=ve.e,Ht=ve.f,Ki=ve.g,bi=ve.h,Eo=ve.i,De=24048;function oo(_){return rt=new Int8Array(_),s=new Int32Array(_),Z=new Float64Array(_),Pe=_,!0}function _e(_){_=_|0;var v=0;return v=De,De=De+_|0,De=De+15&-16,v|0}function ao(){return De|0}function cr(_){_=_|0,De=_}function Us(_,v){_=_|0,De=_}function Xo(_){return _=_|0,(On(_*3|0,_+1|0)|0)+1|0}function Vs(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0;Ko(_,v,E,L,0)|0&&(F=(On(E*3|0,E+1|0)|0)+1|0,gs(L|0,0,F<<3|0)|0,O=Jt(F,4)|0,O&&(hr(_,v,E,L,O,F,0),gt(O)))}function XA(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0;if(Ko(_,v,E,L,O)|0){if(F=(On(E*3|0,E+1|0)|0)+1|0,gs(L|0,0,F<<3|0)|0,O|0){gs(O|0,0,F<<2|0)|0,hr(_,v,E,L,O,F,0);return}O=Jt(F,4)|0,O&&(hr(_,v,E,L,O,F,0),gt(O))}}function Ko(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0;if(ze=De,De=De+16|0,Te=ze,F=L,s[F>>2]=_,s[F+4>>2]=v,F=(O|0)!=0,F&&(s[O>>2]=0),Si(_,v)|0)return Te=1,De=ze,Te|0;s[Te>>2]=0;e:do if((E|0)>=1)if(F)for(le=0,pe=1,Qe=1,z=0,F=_;;){if(!(z|le)){if(F=ge(F,v,4,Te)|0,v=Ve()|0,(F|0)==0&(v|0)==0){F=2;break e}if(Si(F,v)|0){F=1;break e}}if(F=ge(F,v,s[16+(le<<2)>>2]|0,Te)|0,v=Ve()|0,(F|0)==0&(v|0)==0){F=2;break e}if(_=L+(Qe<<3)|0,s[_>>2]=F,s[_+4>>2]=v,s[O+(Qe<<2)>>2]=pe,z=z+1|0,_=(z|0)==(pe|0),Q=le+1|0,Y=(Q|0)==6,Si(F,v)|0){F=1;break e}if(pe=pe+(Y&_&1)|0,(pe|0)>(E|0)){F=0;break}else le=_?Y?0:Q:le,Qe=Qe+1|0,z=_?0:z}else for(le=0,pe=1,Qe=1,z=0,F=_;;){if(!(z|le)){if(F=ge(F,v,4,Te)|0,v=Ve()|0,(F|0)==0&(v|0)==0){F=2;break e}if(Si(F,v)|0){F=1;break e}}if(F=ge(F,v,s[16+(le<<2)>>2]|0,Te)|0,v=Ve()|0,(F|0)==0&(v|0)==0){F=2;break e}if(_=L+(Qe<<3)|0,s[_>>2]=F,s[_+4>>2]=v,z=z+1|0,_=(z|0)==(pe|0),Q=le+1|0,Y=(Q|0)==6,Si(F,v)|0){F=1;break e}if(pe=pe+(Y&_&1)|0,(pe|0)>(E|0)){F=0;break}else le=_?Y?0:Q:le,Qe=Qe+1|0,z=_?0:z}else F=0;while(0);return Te=F,De=ze,Te|0}function hr(_,v,E,L,O,F,z){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0,F=F|0,z=z|0;var Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0;if(Qe=De,De=De+16|0,pe=Qe,(_|0)==0&(v|0)==0){De=Qe;return}if(Q=Er(_|0,v|0,F|0,((F|0)<0)<<31>>31|0)|0,Ve()|0,Y=L+(Q<<3)|0,Te=Y,ze=s[Te>>2]|0,Te=s[Te+4>>2]|0,le=(ze|0)==(_|0)&(Te|0)==(v|0),!((ze|0)==0&(Te|0)==0|le))do Q=(Q+1|0)%(F|0)|0,Y=L+(Q<<3)|0,ze=Y,Te=s[ze>>2]|0,ze=s[ze+4>>2]|0,le=(Te|0)==(_|0)&(ze|0)==(v|0);while(!((Te|0)==0&(ze|0)==0|le));if(Q=O+(Q<<2)|0,le&&(s[Q>>2]|0)<=(z|0)){De=Qe;return}if(ze=Y,s[ze>>2]=_,s[ze+4>>2]=v,s[Q>>2]=z,(z|0)>=(E|0)){De=Qe;return}ze=z+1|0,s[pe>>2]=0,Te=ge(_,v,2,pe)|0,hr(Te,Ve()|0,E,L,O,F,ze),s[pe>>2]=0,Te=ge(_,v,3,pe)|0,hr(Te,Ve()|0,E,L,O,F,ze),s[pe>>2]=0,Te=ge(_,v,1,pe)|0,hr(Te,Ve()|0,E,L,O,F,ze),s[pe>>2]=0,Te=ge(_,v,5,pe)|0,hr(Te,Ve()|0,E,L,O,F,ze),s[pe>>2]=0,Te=ge(_,v,4,pe)|0,hr(Te,Ve()|0,E,L,O,F,ze),s[pe>>2]=0,Te=ge(_,v,6,pe)|0,hr(Te,Ve()|0,E,L,O,F,ze),De=Qe}function ge(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0;if((s[L>>2]|0)>0){O=0;do E=Zr(E)|0,O=O+1|0;while((O|0)<(s[L>>2]|0))}Q=xt(_|0,v|0,45)|0,Ve()|0,Y=Q&127,F=dr(_,v)|0,O=xt(_|0,v|0,52)|0,Ve()|0,O=O&15;e:do if(!O)z=6;else for(;;){if(Qe=(15-O|0)*3|0,Te=xt(_|0,v|0,Qe|0)|0,Ve()|0,Te=Te&7,ze=(tr(O)|0)==0,O=O+-1|0,pe=qt(7,0,Qe|0)|0,v=v&~(Ve()|0),Qe=qt(s[(ze?464:48)+(Te*28|0)+(E<<2)>>2]|0,0,Qe|0)|0,le=Ve()|0,E=s[(ze?672:256)+(Te*28|0)+(E<<2)>>2]|0,_=Qe|_&~pe,v=le|v,!E){E=0;break e}if(!O){z=6;break}}while(0);(z|0)==6&&(ze=s[880+(Y*28|0)+(E<<2)>>2]|0,Te=qt(ze|0,0,45)|0,_=Te|_,v=Ve()|0|v&-1040385,E=s[4304+(Y*28|0)+(E<<2)>>2]|0,(ze&127|0)==127&&(ze=qt(s[880+(Y*28|0)+20>>2]|0,0,45)|0,v=Ve()|0|v&-1040385,E=s[4304+(Y*28|0)+20>>2]|0,_=Ps(ze|_,v)|0,v=Ve()|0,s[L>>2]=(s[L>>2]|0)+1)),z=xt(_|0,v|0,45)|0,Ve()|0,z=z&127;e:do if(wn(z)|0){t:do if((dr(_,v)|0)==1){if((Y|0)!=(z|0))if(AA(z,s[7728+(Y*28|0)>>2]|0)|0){_=hs(_,v)|0,F=1,v=Ve()|0;break}else{_=Ps(_,v)|0,F=1,v=Ve()|0;break}switch(F|0){case 5:{_=hs(_,v)|0,v=Ve()|0,s[L>>2]=(s[L>>2]|0)+5,F=0;break t}case 3:{_=Ps(_,v)|0,v=Ve()|0,s[L>>2]=(s[L>>2]|0)+1,F=0;break t}default:return Te=0,ze=0,an(Te|0),ze|0}}else F=0;while(0);if((E|0)>0){O=0;do _=er(_,v)|0,v=Ve()|0,O=O+1|0;while((O|0)!=(E|0))}if((Y|0)!=(z|0)){if(!(Li(z)|0)){if((F|0)!=0|(dr(_,v)|0)!=5)break;s[L>>2]=(s[L>>2]|0)+1;break}switch(Q&127){case 8:case 118:break e}(dr(_,v)|0)!=3&&(s[L>>2]=(s[L>>2]|0)+1)}}else if((E|0)>0){O=0;do _=Ps(_,v)|0,v=Ve()|0,O=O+1|0;while((O|0)!=(E|0))}while(0);return s[L>>2]=((s[L>>2]|0)+E|0)%6|0,Te=v,ze=_,an(Te|0),ze|0}function Ee(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0;if(Qe=De,De=De+16|0,pe=Qe,!E)return pe=L,s[pe>>2]=_,s[pe+4>>2]=v,pe=0,De=Qe,pe|0;s[pe>>2]=0;e:do if(Si(_,v)|0)_=1;else{if(F=(E|0)>0,F){O=0,le=_;do{if(le=ge(le,v,4,pe)|0,v=Ve()|0,(le|0)==0&(v|0)==0){_=2;break e}if(O=O+1|0,Si(le,v)|0){_=1;break e}}while((O|0)<(E|0));if(Y=L,s[Y>>2]=le,s[Y+4>>2]=v,Y=E+-1|0,F){F=0,z=1,O=le,_=v;do{if(O=ge(O,_,2,pe)|0,_=Ve()|0,(O|0)==0&(_|0)==0){_=2;break e}if(Q=L+(z<<3)|0,s[Q>>2]=O,s[Q+4>>2]=_,z=z+1|0,Si(O,_)|0){_=1;break e}F=F+1|0}while((F|0)<(E|0));Q=0,F=z;do{if(O=ge(O,_,3,pe)|0,_=Ve()|0,(O|0)==0&(_|0)==0){_=2;break e}if(z=L+(F<<3)|0,s[z>>2]=O,s[z+4>>2]=_,F=F+1|0,Si(O,_)|0){_=1;break e}Q=Q+1|0}while((Q|0)<(E|0));z=0;do{if(O=ge(O,_,1,pe)|0,_=Ve()|0,(O|0)==0&(_|0)==0){_=2;break e}if(Q=L+(F<<3)|0,s[Q>>2]=O,s[Q+4>>2]=_,F=F+1|0,Si(O,_)|0){_=1;break e}z=z+1|0}while((z|0)<(E|0));z=0;do{if(O=ge(O,_,5,pe)|0,_=Ve()|0,(O|0)==0&(_|0)==0){_=2;break e}if(Q=L+(F<<3)|0,s[Q>>2]=O,s[Q+4>>2]=_,F=F+1|0,Si(O,_)|0){_=1;break e}z=z+1|0}while((z|0)<(E|0));z=0;do{if(O=ge(O,_,4,pe)|0,_=Ve()|0,(O|0)==0&(_|0)==0){_=2;break e}if(Q=L+(F<<3)|0,s[Q>>2]=O,s[Q+4>>2]=_,F=F+1|0,Si(O,_)|0){_=1;break e}z=z+1|0}while((z|0)<(E|0));for(z=0;;){if(O=ge(O,_,6,pe)|0,_=Ve()|0,(O|0)==0&(_|0)==0){_=2;break e}if((z|0)!=(Y|0))if(Q=L+(F<<3)|0,s[Q>>2]=O,s[Q+4>>2]=_,!(Si(O,_)|0))F=F+1|0;else{_=1;break e}if(z=z+1|0,(z|0)>=(E|0)){z=le,F=v;break}}}else z=le,O=le,F=v,_=v}else z=L,s[z>>2]=_,s[z+4>>2]=v,z=_,O=_,F=v,_=v;_=((z|0)!=(O|0)|(F|0)!=(_|0))&1}while(0);return pe=_,De=Qe,pe|0}function Ge(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0;if(F=De,De=De+48|0,O=F+8|0,L=F,Q=_,z=s[Q+4>>2]|0,E=L,s[E>>2]=s[Q>>2],s[E+4>>2]=z,TA(L,O),O=fr(O,v)|0,v=s[L>>2]|0,L=s[_+8>>2]|0,(L|0)<=0)return Q=v,z=(O|0)<(Q|0),Q=z?Q:O,Q=Q+12|0,De=F,Q|0;E=s[_+12>>2]|0,_=0;do v=(s[E+(_<<3)>>2]|0)+v|0,_=_+1|0;while((_|0)<(L|0));return Q=(O|0)<(v|0),Q=Q?v:O,Q=Q+12|0,De=F,Q|0}function ot(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0;if(Q=De,De=De+48|0,L=Q+8|0,O=Q,!(vt(_,v,E)|0)){De=Q;return}if(Y=_,F=s[Y+4>>2]|0,z=O,s[z>>2]=s[Y>>2],s[z+4>>2]=F,TA(O,L),z=fr(L,v)|0,v=s[O>>2]|0,F=s[_+8>>2]|0,(F|0)>0){O=s[_+12>>2]|0,L=0;do v=(s[O+(L<<3)>>2]|0)+v|0,L=L+1|0;while((L|0)!=(F|0))}if(v=(z|0)<(v|0)?v:z,(v|0)<=-12){De=Q;return}Y=v+11|0,gs(E|0,0,(((Y|0)>0?Y:0)<<3)+8|0)|0,De=Q}function vt(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0,f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0;if(K=De,De=De+112|0,D=K+80|0,Y=K+72|0,N=K,G=K+56|0,le=_+8|0,W=Wi((s[le>>2]<<5)+32|0)|0,W||Ut(22848,22448,800,22456),uo(_,W),F=_,L=s[F+4>>2]|0,Q=Y,s[Q>>2]=s[F>>2],s[Q+4>>2]=L,TA(Y,D),Q=fr(D,v)|0,L=s[Y>>2]|0,F=s[le>>2]|0,(F|0)>0){z=s[_+12>>2]|0,O=0;do L=(s[z+(O<<3)>>2]|0)+L|0,O=O+1|0;while((O|0)!=(F|0))}if(Q=(Q|0)<(L|0)?L:Q,P=Q+12|0,O=Jt(P,8)|0,pe=Jt(P,8)|0,s[D>>2]=0,y=_,b=s[y+4>>2]|0,L=Y,s[L>>2]=s[y>>2],s[L+4>>2]=b,L=Zt(Y,P,v,D,O,pe)|0,L|0)return gt(O),gt(pe),gt(W),W=L,De=K,W|0;e:do if((s[le>>2]|0)>0){for(F=_+12|0,L=0;z=Zt((s[F>>2]|0)+(L<<3)|0,P,v,D,O,pe)|0,L=L+1|0,!(z|0);)if((L|0)>=(s[le>>2]|0))break e;return gt(O),gt(pe),gt(W),W=z,De=K,W|0}while(0);(Q|0)>-12&&gs(pe|0,0,((P|0)>1?P:1)<<3|0)|0;e:do if((s[D>>2]|0)>0){b=((P|0)<0)<<31>>31,I=O,u=pe,c=O,f=O,g=pe,y=O,L=O,a=O,m=pe,w=pe,T=pe,O=pe;t:for(;;){for(M=s[D>>2]|0,ze=0,it=0,F=0;;){z=N,Q=z+56|0;do s[z>>2]=0,z=z+4|0;while((z|0)<(Q|0));if(v=I+(ze<<3)|0,Y=s[v>>2]|0,v=s[v+4>>2]|0,Ko(Y,v,1,N,0)|0){z=N,Q=z+56|0;do s[z>>2]=0,z=z+4|0;while((z|0)<(Q|0));z=Jt(7,4)|0,z|0&&(hr(Y,v,1,N,z,7,0),gt(z))}Te=0;do{Qe=N+(Te<<3)|0,pe=s[Qe>>2]|0,Qe=s[Qe+4>>2]|0;n:do if(!((pe|0)==0&(Qe|0)==0)){if(Y=Er(pe|0,Qe|0,P|0,b|0)|0,Ve()|0,z=E+(Y<<3)|0,Q=z,v=s[Q>>2]|0,Q=s[Q+4>>2]|0,!((v|0)==0&(Q|0)==0))for(le=0;;){if((le|0)>(P|0))break t;if((v|0)==(pe|0)&(Q|0)==(Qe|0))break n;if(Y=(Y+1|0)%(P|0)|0,z=E+(Y<<3)|0,Q=z,v=s[Q>>2]|0,Q=s[Q+4>>2]|0,(v|0)==0&(Q|0)==0)break;le=le+1|0}(pe|0)==0&(Qe|0)==0||(fs(pe,Qe,G),Qa(_,W,G)|0&&(le=z,s[le>>2]=pe,s[le+4>>2]=Qe,le=u+(F<<3)|0,s[le>>2]=pe,s[le+4>>2]=Qe,F=F+1|0))}while(0);Te=Te+1|0}while(Te>>>0<7);if(it=it+1|0,(it|0)>=(M|0))break;ze=ze+1|0}if((M|0)>0&&gs(c|0,0,M<<3|0)|0,s[D>>2]=F,(F|0)>0)pe=O,Qe=T,Te=y,ze=w,it=m,M=u,O=a,T=L,w=f,m=c,a=pe,L=Qe,y=g,g=Te,f=ze,c=it,u=I,I=M;else break e}return gt(f),gt(g),gt(W),W=-1,De=K,W|0}else L=pe;while(0);return gt(W),gt(O),gt(L),W=0,De=K,W|0}function Zt(_,v,E,L,O,F){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0,F=F|0;var z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0,f=0,g=0,y=0,b=0,P=0,D=0;if(b=De,De=De+48|0,c=b+32|0,f=b+16|0,g=b,z=s[_>>2]|0,(z|0)<=0)return y=0,De=b,y|0;m=_+4|0,w=c+8|0,T=f+8|0,I=g+8|0,u=((v|0)<0)<<31>>31,a=0;e:for(;;){Q=s[m>>2]|0,it=Q+(a<<4)|0,s[c>>2]=s[it>>2],s[c+4>>2]=s[it+4>>2],s[c+8>>2]=s[it+8>>2],s[c+12>>2]=s[it+12>>2],(a|0)==(z+-1|0)?(s[f>>2]=s[Q>>2],s[f+4>>2]=s[Q+4>>2],s[f+8>>2]=s[Q+8>>2],s[f+12>>2]=s[Q+12>>2]):(it=Q+(a+1<<4)|0,s[f>>2]=s[it>>2],s[f+4>>2]=s[it+4>>2],s[f+8>>2]=s[it+8>>2],s[f+12>>2]=s[it+12>>2]),it=Fr(c,f,E)|0;t:do if((it|0)>0){M=+(it|0),ze=0;n:for(;;){D=+(it-ze|0),P=+(ze|0),Z[g>>3]=+Z[c>>3]*D/M+ +Z[f>>3]*P/M,Z[I>>3]=+Z[w>>3]*D/M+ +Z[T>>3]*P/M,Qe=yA(g,E)|0,Te=Ve()|0,Q=Er(Qe|0,Te|0,v|0,u|0)|0,Ve()|0,z=F+(Q<<3)|0,Y=z,le=s[Y>>2]|0,Y=s[Y+4>>2]|0;i:do if((le|0)==0&(Y|0)==0)y=14;else for(pe=0;;){if((pe|0)>(v|0)){z=1;break i}if((le|0)==(Qe|0)&(Y|0)==(Te|0)){z=7;break i}if(Q=(Q+1|0)%(v|0)|0,z=F+(Q<<3)|0,Y=z,le=s[Y>>2]|0,Y=s[Y+4>>2]|0,(le|0)==0&(Y|0)==0){y=14;break}else pe=pe+1|0}while(0);switch((y|0)==14&&(y=0,(Qe|0)==0&(Te|0)==0?z=7:(s[z>>2]=Qe,s[z+4>>2]=Te,z=s[L>>2]|0,pe=O+(z<<3)|0,s[pe>>2]=Qe,s[pe+4>>2]=Te,s[L>>2]=z+1,z=0)),z&7){case 7:case 0:break;default:break n}if(ze=ze+1|0,(it|0)<=(ze|0)){y=8;break t}}if(z|0){z=-1,y=20;break e}}else y=8;while(0);if((y|0)==8&&(y=0),a=a+1|0,z=s[_>>2]|0,(a|0)>=(z|0)){z=0,y=20;break}}return(y|0)==20?(De=b,z|0):0}function Cn(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0;if(le=De,De=De+176|0,Y=le,(v|0)<1){Gl(E,0,0),De=le;return}z=_,z=xt(s[z>>2]|0,s[z+4>>2]|0,52)|0,Ve()|0,Gl(E,(v|0)>6?v:6,z&15),z=0;do{if(L=_+(z<<3)|0,Vr(s[L>>2]|0,s[L+4>>2]|0,Y),L=s[Y>>2]|0,(L|0)>0){Q=0;do F=Y+8+(Q<<4)|0,Q=Q+1|0,L=Y+8+(((Q|0)%(L|0)|0)<<4)|0,O=Ql(E,L,F)|0,O?CA(E,O)|0:Ha(E,F,L)|0,L=s[Y>>2]|0;while((Q|0)<(L|0))}z=z+1|0}while((z|0)!=(v|0));De=le}function Ei(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0;if(F=De,De=De+32|0,L=F,O=F+16|0,Cn(_,v,O),s[E>>2]=0,s[E+4>>2]=0,s[E+8>>2]=0,_=ci(O)|0,!_){Ol(E)|0,Xr(O),De=F;return}do{v=wA(E)|0;do wc(v,_)|0,z=_+16|0,s[L>>2]=s[z>>2],s[L+4>>2]=s[z+4>>2],s[L+8>>2]=s[z+8>>2],s[L+12>>2]=s[z+12>>2],CA(O,_)|0,_=PA(O,L)|0;while(_|0);_=ci(O)|0}while(_|0);Ol(E)|0,Xr(O),De=F}function wn(_){return _=_|0,s[7728+(_*28|0)+16>>2]|0}function Li(_){return _=_|0,(_|0)==4|(_|0)==117|0}function En(_){return _=_|0,s[11152+((s[_>>2]|0)*216|0)+((s[_+4>>2]|0)*72|0)+((s[_+8>>2]|0)*24|0)+(s[_+12>>2]<<3)>>2]|0}function za(_){return _=_|0,s[11152+((s[_>>2]|0)*216|0)+((s[_+4>>2]|0)*72|0)+((s[_+8>>2]|0)*24|0)+(s[_+12>>2]<<3)+4>>2]|0}function zr(_,v){_=_|0,v=v|0,_=7728+(_*28|0)|0,s[v>>2]=s[_>>2],s[v+4>>2]=s[_+4>>2],s[v+8>>2]=s[_+8>>2],s[v+12>>2]=s[_+12>>2]}function aA(_,v){_=_|0,v=v|0;var E=0,L=0;if(v>>>0>20)return v=-1,v|0;do if((s[11152+(v*216|0)>>2]|0)!=(_|0))if((s[11152+(v*216|0)+8>>2]|0)!=(_|0))if((s[11152+(v*216|0)+16>>2]|0)!=(_|0))if((s[11152+(v*216|0)+24>>2]|0)!=(_|0))if((s[11152+(v*216|0)+32>>2]|0)!=(_|0))if((s[11152+(v*216|0)+40>>2]|0)!=(_|0))if((s[11152+(v*216|0)+48>>2]|0)!=(_|0))if((s[11152+(v*216|0)+56>>2]|0)!=(_|0))if((s[11152+(v*216|0)+64>>2]|0)!=(_|0))if((s[11152+(v*216|0)+72>>2]|0)!=(_|0))if((s[11152+(v*216|0)+80>>2]|0)!=(_|0))if((s[11152+(v*216|0)+88>>2]|0)!=(_|0))if((s[11152+(v*216|0)+96>>2]|0)!=(_|0))if((s[11152+(v*216|0)+104>>2]|0)!=(_|0))if((s[11152+(v*216|0)+112>>2]|0)!=(_|0))if((s[11152+(v*216|0)+120>>2]|0)!=(_|0))if((s[11152+(v*216|0)+128>>2]|0)!=(_|0))if((s[11152+(v*216|0)+136>>2]|0)==(_|0))_=2,E=1,L=2;else{if((s[11152+(v*216|0)+144>>2]|0)==(_|0)){_=0,E=2,L=0;break}if((s[11152+(v*216|0)+152>>2]|0)==(_|0)){_=0,E=2,L=1;break}if((s[11152+(v*216|0)+160>>2]|0)==(_|0)){_=0,E=2,L=2;break}if((s[11152+(v*216|0)+168>>2]|0)==(_|0)){_=1,E=2,L=0;break}if((s[11152+(v*216|0)+176>>2]|0)==(_|0)){_=1,E=2,L=1;break}if((s[11152+(v*216|0)+184>>2]|0)==(_|0)){_=1,E=2,L=2;break}if((s[11152+(v*216|0)+192>>2]|0)==(_|0)){_=2,E=2,L=0;break}if((s[11152+(v*216|0)+200>>2]|0)==(_|0)){_=2,E=2,L=1;break}if((s[11152+(v*216|0)+208>>2]|0)==(_|0)){_=2,E=2,L=2;break}else _=-1;return _|0}else _=2,E=1,L=1;else _=2,E=1,L=0;else _=1,E=1,L=2;else _=1,E=1,L=1;else _=1,E=1,L=0;else _=0,E=1,L=2;else _=0,E=1,L=1;else _=0,E=1,L=0;else _=2,E=0,L=2;else _=2,E=0,L=1;else _=2,E=0,L=0;else _=1,E=0,L=2;else _=1,E=0,L=1;else _=1,E=0,L=0;else _=0,E=0,L=2;else _=0,E=0,L=1;else _=0,E=0,L=0;while(0);return v=s[11152+(v*216|0)+(E*72|0)+(_*24|0)+(L<<3)+4>>2]|0,v|0}function AA(_,v){return _=_|0,v=v|0,(s[7728+(_*28|0)+20>>2]|0)==(v|0)?(v=1,v|0):(v=(s[7728+(_*28|0)+24>>2]|0)==(v|0),v|0)}function Jo(_,v){return _=_|0,v=v|0,s[880+(_*28|0)+(v<<2)>>2]|0}function To(_,v){return _=_|0,v=v|0,(s[880+(_*28|0)>>2]|0)==(v|0)?(v=0,v|0):(s[880+(_*28|0)+4>>2]|0)==(v|0)?(v=1,v|0):(s[880+(_*28|0)+8>>2]|0)==(v|0)?(v=2,v|0):(s[880+(_*28|0)+12>>2]|0)==(v|0)?(v=3,v|0):(s[880+(_*28|0)+16>>2]|0)==(v|0)?(v=4,v|0):(s[880+(_*28|0)+20>>2]|0)==(v|0)?(v=5,v|0):((s[880+(_*28|0)+24>>2]|0)==(v|0)?6:7)|0}function ea(){return 122}function ta(_){_=_|0;var v=0,E=0,L=0;v=0;do qt(v|0,0,45)|0,L=Ve()|0|134225919,E=_+(v<<3)|0,s[E>>2]=-1,s[E+4>>2]=L,v=v+1|0;while((v|0)!=122)}function So(_){return _=_|0,+Z[_+16>>3]<+Z[_+24>>3]|0}function lA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0;return E=+Z[v>>3],!(E>=+Z[_+8>>3])||!(E<=+Z[_>>3])?(v=0,v|0):(L=+Z[_+16>>3],E=+Z[_+24>>3],O=+Z[v+8>>3],v=O>=E,_=O<=L&1,L<E?v&&(_=1):v||(_=0),v=(_|0)!=0,v|0)}function fr(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0;z=De,De=De+288|0,E=z+264|0,L=z+96|0,O=z,F=O,Q=F+96|0;do s[F>>2]=0,F=F+4|0;while((F|0)<(Q|0));return Lo(v,O),F=O,Q=s[F>>2]|0,F=s[F+4>>2]|0,fs(Q,F,E),Vr(Q,F,L),Y=+fA(E,L+8|0),Z[E>>3]=+Z[_>>3],F=E+8|0,Z[F>>3]=+Z[_+16>>3],Z[L>>3]=+Z[_+8>>3],Q=L+8|0,Z[Q>>3]=+Z[_+24>>3],le=+fA(E,L),Q=~~+_i(+(le*le/+Wa(+ +kt(+((+Z[F>>3]-+Z[Q>>3])/(+Z[E>>3]-+Z[L>>3]))),3)/(Y*(Y*2.59807621135)*.8))),De=z,(Q|0?Q:1)|0}function Fr(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0;Q=De,De=De+288|0,L=Q+264|0,O=Q+96|0,F=Q,z=F,Y=z+96|0;do s[z>>2]=0,z=z+4|0;while((z|0)<(Y|0));return Lo(E,F),Y=F,z=s[Y>>2]|0,Y=s[Y+4>>2]|0,fs(z,Y,L),Vr(z,Y,O),le=+fA(L,O+8|0),Y=~~+_i(+(+fA(_,v)/(le*2))),De=Q,(Y|0?Y:1)|0}function KA(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0,s[_>>2]=v,s[_+4>>2]=E,s[_+8>>2]=L}function JA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0;Qe=v+8|0,s[Qe>>2]=0,Y=+Z[_>>3],z=+kt(+Y),le=+Z[_+8>>3],Q=+kt(+le)/.8660254037844386,z=z+Q*.5,E=~~z,_=~~Q,z=z-+(E|0),Q=Q-+(_|0);do if(z<.5)if(z<.3333333333333333)if(s[v>>2]=E,Q<(z+1)*.5){s[v+4>>2]=_;break}else{_=_+1|0,s[v+4>>2]=_;break}else if(Te=1-z,_=(!(Q<Te)&1)+_|0,s[v+4>>2]=_,Te<=Q&Q<z*2){E=E+1|0,s[v>>2]=E;break}else{s[v>>2]=E;break}else{if(!(z<.6666666666666666))if(E=E+1|0,s[v>>2]=E,Q<z*.5){s[v+4>>2]=_;break}else{_=_+1|0,s[v+4>>2]=_;break}if(Q<1-z){if(s[v+4>>2]=_,z*2+-1<Q){s[v>>2]=E;break}}else _=_+1|0,s[v+4>>2]=_;E=E+1|0,s[v>>2]=E}while(0);do if(Y<0)if(_&1){pe=(_+1|0)/2|0,pe=pa(E|0,((E|0)<0)<<31>>31|0,pe|0,((pe|0)<0)<<31>>31|0)|0,E=~~(+(E|0)-((+(pe>>>0)+4294967296*+(Ve()|0))*2+1)),s[v>>2]=E;break}else{pe=(_|0)/2|0,pe=pa(E|0,((E|0)<0)<<31>>31|0,pe|0,((pe|0)<0)<<31>>31|0)|0,E=~~(+(E|0)-(+(pe>>>0)+4294967296*+(Ve()|0))*2),s[v>>2]=E;break}while(0);pe=v+4|0,le<0&&(E=E-((_<<1|1|0)/2|0)|0,s[v>>2]=E,_=0-_|0,s[pe>>2]=_),L=_-E|0,(E|0)<0?(O=0-E|0,s[pe>>2]=L,s[Qe>>2]=O,s[v>>2]=0,_=L,E=0):O=0,(_|0)<0&&(E=E-_|0,s[v>>2]=E,O=O-_|0,s[Qe>>2]=O,s[pe>>2]=0,_=0),F=E-O|0,L=_-O|0,(O|0)<0&&(s[v>>2]=F,s[pe>>2]=L,s[Qe>>2]=0,_=L,E=F,O=0),L=(_|0)<(E|0)?_:E,L=(O|0)<(L|0)?O:L,!((L|0)<=0)&&(s[v>>2]=E-L,s[pe>>2]=_-L,s[Qe>>2]=O-L)}function Ti(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0;v=s[_>>2]|0,z=_+4|0,E=s[z>>2]|0,(v|0)<0&&(E=E-v|0,s[z>>2]=E,F=_+8|0,s[F>>2]=(s[F>>2]|0)-v,s[_>>2]=0,v=0),(E|0)<0?(v=v-E|0,s[_>>2]=v,F=_+8|0,O=(s[F>>2]|0)-E|0,s[F>>2]=O,s[z>>2]=0,E=0):(O=_+8|0,F=O,O=s[O>>2]|0),(O|0)<0&&(v=v-O|0,s[_>>2]=v,E=E-O|0,s[z>>2]=E,s[F>>2]=0,O=0),L=(E|0)<(v|0)?E:v,L=(O|0)<(L|0)?O:L,!((L|0)<=0)&&(s[_>>2]=v-L,s[z>>2]=E-L,s[F>>2]=O-L)}function as(_,v){_=_|0,v=v|0;var E=0,L=0;L=s[_+8>>2]|0,E=+((s[_+4>>2]|0)-L|0),Z[v>>3]=+((s[_>>2]|0)-L|0)-E*.5,Z[v+8>>3]=E*.8660254037844386}function rn(_,v,E){_=_|0,v=v|0,E=E|0,s[E>>2]=(s[v>>2]|0)+(s[_>>2]|0),s[E+4>>2]=(s[v+4>>2]|0)+(s[_+4>>2]|0),s[E+8>>2]=(s[v+8>>2]|0)+(s[_+8>>2]|0)}function As(_,v,E){_=_|0,v=v|0,E=E|0,s[E>>2]=(s[_>>2]|0)-(s[v>>2]|0),s[E+4>>2]=(s[_+4>>2]|0)-(s[v+4>>2]|0),s[E+8>>2]=(s[_+8>>2]|0)-(s[v+8>>2]|0)}function Hi(_,v){_=_|0,v=v|0;var E=0,L=0;E=On(s[_>>2]|0,v)|0,s[_>>2]=E,E=_+4|0,L=On(s[E>>2]|0,v)|0,s[E>>2]=L,_=_+8|0,v=On(s[_>>2]|0,v)|0,s[_>>2]=v}function Co(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;z=s[_>>2]|0,Q=(z|0)<0,L=(s[_+4>>2]|0)-(Q?z:0)|0,F=(L|0)<0,O=(F?0-L|0:0)+((s[_+8>>2]|0)-(Q?z:0))|0,E=(O|0)<0,_=E?0:O,v=(F?0:L)-(E?O:0)|0,O=(Q?0:z)-(F?L:0)-(E?O:0)|0,E=(v|0)<(O|0)?v:O,E=(_|0)<(E|0)?_:E,L=(E|0)>0,_=_-(L?E:0)|0,v=v-(L?E:0)|0;e:do switch(O-(L?E:0)|0){case 0:switch(v|0){case 0:return Q=_|0?(_|0)==1?1:7:0,Q|0;case 1:return Q=_|0?(_|0)==1?3:7:2,Q|0;default:break e}case 1:switch(v|0){case 0:return Q=_|0?(_|0)==1?5:7:4,Q|0;case 1:{if(!_)_=6;else break e;return _|0}default:break e}}while(0);return Q=7,Q|0}function Fa(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;z=_+8|0,E=s[z>>2]|0,v=(s[_>>2]|0)-E|0,Q=_+4|0,E=(s[Q>>2]|0)-E|0,L=jr(+((v*3|0)-E|0)/7)|0,s[_>>2]=L,v=jr(+((E<<1)+v|0)/7)|0,s[Q>>2]=v,s[z>>2]=0,E=v-L|0,(L|0)<0?(F=0-L|0,s[Q>>2]=E,s[z>>2]=F,s[_>>2]=0,v=E,L=0,E=F):E=0,(v|0)<0&&(L=L-v|0,s[_>>2]=L,E=E-v|0,s[z>>2]=E,s[Q>>2]=0,v=0),F=L-E|0,O=v-E|0,(E|0)<0?(s[_>>2]=F,s[Q>>2]=O,s[z>>2]=0,v=O,O=F,E=0):O=L,L=(v|0)<(O|0)?v:O,L=(E|0)<(L|0)?E:L,!((L|0)<=0)&&(s[_>>2]=O-L,s[Q>>2]=v-L,s[z>>2]=E-L)}function na(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;z=_+8|0,E=s[z>>2]|0,v=(s[_>>2]|0)-E|0,Q=_+4|0,E=(s[Q>>2]|0)-E|0,L=jr(+((v<<1)+E|0)/7)|0,s[_>>2]=L,v=jr(+((E*3|0)-v|0)/7)|0,s[Q>>2]=v,s[z>>2]=0,E=v-L|0,(L|0)<0?(F=0-L|0,s[Q>>2]=E,s[z>>2]=F,s[_>>2]=0,v=E,L=0,E=F):E=0,(v|0)<0&&(L=L-v|0,s[_>>2]=L,E=E-v|0,s[z>>2]=E,s[Q>>2]=0,v=0),F=L-E|0,O=v-E|0,(E|0)<0?(s[_>>2]=F,s[Q>>2]=O,s[z>>2]=0,v=O,O=F,E=0):O=L,L=(v|0)<(O|0)?v:O,L=(E|0)<(L|0)?E:L,!((L|0)<=0)&&(s[_>>2]=O-L,s[Q>>2]=v-L,s[z>>2]=E-L)}function uA(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;v=s[_>>2]|0,z=_+4|0,E=s[z>>2]|0,Q=_+8|0,L=s[Q>>2]|0,O=E+(v*3|0)|0,s[_>>2]=O,E=L+(E*3|0)|0,s[z>>2]=E,v=(L*3|0)+v|0,s[Q>>2]=v,L=E-O|0,(O|0)<0?(v=v-O|0,s[z>>2]=L,s[Q>>2]=v,s[_>>2]=0,E=L,L=0):L=O,(E|0)<0&&(L=L-E|0,s[_>>2]=L,v=v-E|0,s[Q>>2]=v,s[z>>2]=0,E=0),F=L-v|0,O=E-v|0,(v|0)<0?(s[_>>2]=F,s[z>>2]=O,s[Q>>2]=0,L=F,v=0):O=E,E=(O|0)<(L|0)?O:L,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(s[_>>2]=L-E,s[z>>2]=O-E,s[Q>>2]=v-E)}function ls(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;O=s[_>>2]|0,z=_+4|0,v=s[z>>2]|0,Q=_+8|0,E=s[Q>>2]|0,L=(v*3|0)+O|0,O=E+(O*3|0)|0,s[_>>2]=O,s[z>>2]=L,v=(E*3|0)+v|0,s[Q>>2]=v,E=L-O|0,(O|0)<0?(v=v-O|0,s[z>>2]=E,s[Q>>2]=v,s[_>>2]=0,O=0):E=L,(E|0)<0&&(O=O-E|0,s[_>>2]=O,v=v-E|0,s[Q>>2]=v,s[z>>2]=0,E=0),F=O-v|0,L=E-v|0,(v|0)<0?(s[_>>2]=F,s[z>>2]=L,s[Q>>2]=0,O=F,v=0):L=E,E=(L|0)<(O|0)?L:O,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(s[_>>2]=O-E,s[z>>2]=L-E,s[Q>>2]=v-E)}function Eu(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0;(v+-1|0)>>>0>=6||(O=(s[15472+(v*12|0)>>2]|0)+(s[_>>2]|0)|0,s[_>>2]=O,Q=_+4|0,L=(s[15472+(v*12|0)+4>>2]|0)+(s[Q>>2]|0)|0,s[Q>>2]=L,z=_+8|0,v=(s[15472+(v*12|0)+8>>2]|0)+(s[z>>2]|0)|0,s[z>>2]=v,E=L-O|0,(O|0)<0?(v=v-O|0,s[Q>>2]=E,s[z>>2]=v,s[_>>2]=0,L=0):(E=L,L=O),(E|0)<0&&(L=L-E|0,s[_>>2]=L,v=v-E|0,s[z>>2]=v,s[Q>>2]=0,E=0),F=L-v|0,O=E-v|0,(v|0)<0?(s[_>>2]=F,s[Q>>2]=O,s[z>>2]=0,L=F,v=0):O=E,E=(O|0)<(L|0)?O:L,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(s[_>>2]=L-E,s[Q>>2]=O-E,s[z>>2]=v-E))}function Ml(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;O=s[_>>2]|0,z=_+4|0,v=s[z>>2]|0,Q=_+8|0,E=s[Q>>2]|0,L=v+O|0,O=E+O|0,s[_>>2]=O,s[z>>2]=L,v=E+v|0,s[Q>>2]=v,E=L-O|0,(O|0)<0?(v=v-O|0,s[z>>2]=E,s[Q>>2]=v,s[_>>2]=0,L=0):(E=L,L=O),(E|0)<0&&(L=L-E|0,s[_>>2]=L,v=v-E|0,s[Q>>2]=v,s[z>>2]=0,E=0),F=L-v|0,O=E-v|0,(v|0)<0?(s[_>>2]=F,s[z>>2]=O,s[Q>>2]=0,L=F,v=0):O=E,E=(O|0)<(L|0)?O:L,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(s[_>>2]=L-E,s[z>>2]=O-E,s[Q>>2]=v-E)}function ia(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;v=s[_>>2]|0,z=_+4|0,L=s[z>>2]|0,Q=_+8|0,E=s[Q>>2]|0,O=L+v|0,s[_>>2]=O,L=E+L|0,s[z>>2]=L,v=E+v|0,s[Q>>2]=v,E=L-O|0,(O|0)<0?(v=v-O|0,s[z>>2]=E,s[Q>>2]=v,s[_>>2]=0,L=0):(E=L,L=O),(E|0)<0&&(L=L-E|0,s[_>>2]=L,v=v-E|0,s[Q>>2]=v,s[z>>2]=0,E=0),F=L-v|0,O=E-v|0,(v|0)<0?(s[_>>2]=F,s[z>>2]=O,s[Q>>2]=0,L=F,v=0):O=E,E=(O|0)<(L|0)?O:L,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(s[_>>2]=L-E,s[z>>2]=O-E,s[Q>>2]=v-E)}function Zr(_){switch(_=_|0,_|0){case 1:{_=5;break}case 5:{_=4;break}case 4:{_=6;break}case 6:{_=2;break}case 2:{_=3;break}case 3:{_=1;break}}return _|0}function Ao(_){switch(_=_|0,_|0){case 1:{_=3;break}case 3:{_=2;break}case 2:{_=6;break}case 6:{_=4;break}case 4:{_=5;break}case 5:{_=1;break}}return _|0}function Il(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;v=s[_>>2]|0,z=_+4|0,E=s[z>>2]|0,Q=_+8|0,L=s[Q>>2]|0,O=E+(v<<1)|0,s[_>>2]=O,E=L+(E<<1)|0,s[z>>2]=E,v=(L<<1)+v|0,s[Q>>2]=v,L=E-O|0,(O|0)<0?(v=v-O|0,s[z>>2]=L,s[Q>>2]=v,s[_>>2]=0,E=L,L=0):L=O,(E|0)<0&&(L=L-E|0,s[_>>2]=L,v=v-E|0,s[Q>>2]=v,s[z>>2]=0,E=0),F=L-v|0,O=E-v|0,(v|0)<0?(s[_>>2]=F,s[z>>2]=O,s[Q>>2]=0,L=F,v=0):O=E,E=(O|0)<(L|0)?O:L,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(s[_>>2]=L-E,s[z>>2]=O-E,s[Q>>2]=v-E)}function ra(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;O=s[_>>2]|0,z=_+4|0,v=s[z>>2]|0,Q=_+8|0,E=s[Q>>2]|0,L=(v<<1)+O|0,O=E+(O<<1)|0,s[_>>2]=O,s[z>>2]=L,v=(E<<1)+v|0,s[Q>>2]=v,E=L-O|0,(O|0)<0?(v=v-O|0,s[z>>2]=E,s[Q>>2]=v,s[_>>2]=0,O=0):E=L,(E|0)<0&&(O=O-E|0,s[_>>2]=O,v=v-E|0,s[Q>>2]=v,s[z>>2]=0,E=0),F=O-v|0,L=E-v|0,(v|0)<0?(s[_>>2]=F,s[z>>2]=L,s[Q>>2]=0,O=F,v=0):L=E,E=(L|0)<(O|0)?L:O,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(s[_>>2]=O-E,s[z>>2]=L-E,s[Q>>2]=v-E)}function us(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0;return z=(s[_>>2]|0)-(s[v>>2]|0)|0,Q=(z|0)<0,L=(s[_+4>>2]|0)-(s[v+4>>2]|0)-(Q?z:0)|0,F=(L|0)<0,O=(Q?0-z|0:0)+(s[_+8>>2]|0)-(s[v+8>>2]|0)+(F?0-L|0:0)|0,_=(O|0)<0,v=_?0:O,E=(F?0:L)-(_?O:0)|0,O=(Q?0:z)-(F?L:0)-(_?O:0)|0,_=(E|0)<(O|0)?E:O,_=(v|0)<(_|0)?v:_,L=(_|0)>0,v=v-(L?_:0)|0,E=E-(L?_:0)|0,_=O-(L?_:0)|0,_=(_|0)>-1?_:0-_|0,E=(E|0)>-1?E:0-E|0,v=(v|0)>-1?v:0-v|0,v=(E|0)>(v|0)?E:v,((_|0)>(v|0)?_:v)|0}function js(_,v){_=_|0,v=v|0;var E=0;E=s[_+8>>2]|0,s[v>>2]=(s[_>>2]|0)-E,s[v+4>>2]=(s[_+4>>2]|0)-E}function el(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0;L=s[_>>2]|0,s[v>>2]=L,_=s[_+4>>2]|0,z=v+4|0,s[z>>2]=_,Q=v+8|0,s[Q>>2]=0,E=_-L|0,(L|0)<0?(_=0-L|0,s[z>>2]=E,s[Q>>2]=_,s[v>>2]=0,L=0):(E=_,_=0),(E|0)<0&&(L=L-E|0,s[v>>2]=L,_=_-E|0,s[Q>>2]=_,s[z>>2]=0,E=0),F=L-_|0,O=E-_|0,(_|0)<0?(s[v>>2]=F,s[z>>2]=O,s[Q>>2]=0,E=O,O=F,_=0):O=L,L=(E|0)<(O|0)?E:O,L=(_|0)<(L|0)?_:L,!((L|0)<=0)&&(s[v>>2]=O-L,s[z>>2]=E-L,s[Q>>2]=_-L)}function Po(_){_=_|0;var v=0,E=0,L=0,O=0;v=_+8|0,O=s[v>>2]|0,E=O-(s[_>>2]|0)|0,s[_>>2]=E,L=_+4|0,_=(s[L>>2]|0)-O|0,s[L>>2]=_,s[v>>2]=0-(_+E)}function tl(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;E=s[_>>2]|0,v=0-E|0,s[_>>2]=v,z=_+8|0,s[z>>2]=0,Q=_+4|0,L=s[Q>>2]|0,O=L+E|0,(E|0)>0?(s[Q>>2]=O,s[z>>2]=E,s[_>>2]=0,v=0,L=O):E=0,(L|0)<0?(F=v-L|0,s[_>>2]=F,E=E-L|0,s[z>>2]=E,s[Q>>2]=0,O=F-E|0,v=0-E|0,(E|0)<0?(s[_>>2]=O,s[Q>>2]=v,s[z>>2]=0,L=v,E=0):(L=0,O=F)):O=v,v=(L|0)<(O|0)?L:O,v=(E|0)<(v|0)?E:v,!((v|0)<=0)&&(s[_>>2]=O-v,s[Q>>2]=L-v,s[z>>2]=E-v)}function Tu(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;L=De,De=De+16|0,O=L,kl(_,v,E,O),JA(O,E+4|0),De=L}function kl(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0;if(Y=De,De=De+32|0,F=Y,Ul(_,F),s[E>>2]=0,O=+yi(15888,F),z=+yi(15912,F),z<O&&(s[E>>2]=1,O=z),z=+yi(15936,F),z<O&&(s[E>>2]=2,O=z),z=+yi(15960,F),z<O&&(s[E>>2]=3,O=z),z=+yi(15984,F),z<O&&(s[E>>2]=4,O=z),z=+yi(16008,F),z<O&&(s[E>>2]=5,O=z),z=+yi(16032,F),z<O&&(s[E>>2]=6,O=z),z=+yi(16056,F),z<O&&(s[E>>2]=7,O=z),z=+yi(16080,F),z<O&&(s[E>>2]=8,O=z),z=+yi(16104,F),z<O&&(s[E>>2]=9,O=z),z=+yi(16128,F),z<O&&(s[E>>2]=10,O=z),z=+yi(16152,F),z<O&&(s[E>>2]=11,O=z),z=+yi(16176,F),z<O&&(s[E>>2]=12,O=z),z=+yi(16200,F),z<O&&(s[E>>2]=13,O=z),z=+yi(16224,F),z<O&&(s[E>>2]=14,O=z),z=+yi(16248,F),z<O&&(s[E>>2]=15,O=z),z=+yi(16272,F),z<O&&(s[E>>2]=16,O=z),z=+yi(16296,F),z<O&&(s[E>>2]=17,O=z),z=+yi(16320,F),z<O&&(s[E>>2]=18,O=z),z=+yi(16344,F),z<O&&(s[E>>2]=19,O=z),z=+Dn(+(1-O*.5)),z<1e-16){s[L>>2]=0,s[L+4>>2]=0,s[L+8>>2]=0,s[L+12>>2]=0,De=Y;return}if(E=s[E>>2]|0,O=+Z[16368+(E*24|0)>>3],O=+hA(O-+hA(+Na(15568+(E<<4)|0,_))),tr(v)|0?Q=+hA(O+-.3334731722518321):Q=O,O=+pt(+z)/.381966011250105,(v|0)>0){F=0;do O=O*2.6457513110645907,F=F+1|0;while((F|0)!=(v|0))}z=+Qt(+Q)*O,Z[L>>3]=z,Q=+Vt(+Q)*O,Z[L+8>>3]=Q,De=Y}function cs(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0;if(F=+sl(_),F<1e-16){v=15568+(v<<4)|0,s[O>>2]=s[v>>2],s[O+4>>2]=s[v+4>>2],s[O+8>>2]=s[v+8>>2],s[O+12>>2]=s[v+12>>2];return}if(z=+Rn(+ +Z[_+8>>3],+ +Z[_>>3]),(E|0)>0){_=0;do F=F/2.6457513110645907,_=_+1|0;while((_|0)!=(E|0))}L?(F=F/3,E=(tr(E)|0)==0,F=+ni(+((E?F:F/2.6457513110645907)*.381966011250105))):(F=+ni(+(F*.381966011250105)),tr(E)|0&&(z=+hA(z+.3334731722518321))),xc(15568+(v<<4)|0,+hA(+Z[16368+(v*24|0)>>3]-z),F,O)}function Su(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;L=De,De=De+16|0,O=L,as(_+4|0,O),cs(O,s[_>>2]|0,v,0,E),De=L}function sa(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0,f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0;if(G=De,De=De+272|0,F=G+256|0,w=G+240|0,P=G,D=G+224|0,N=G+208|0,T=G+176|0,I=G+160|0,u=G+192|0,c=G+144|0,f=G+128|0,g=G+112|0,y=G+96|0,b=G+80|0,s[F>>2]=v,s[w>>2]=s[_>>2],s[w+4>>2]=s[_+4>>2],s[w+8>>2]=s[_+8>>2],s[w+12>>2]=s[_+12>>2],oa(w,F,P),s[O>>2]=0,w=L+E+((L|0)==5&1)|0,(w|0)<=(E|0)){De=G;return}Y=s[F>>2]|0,le=D+4|0,pe=T+4|0,Qe=E+5|0,Te=16848+(Y<<2)|0,ze=16928+(Y<<2)|0,it=f+8|0,M=g+8|0,a=y+8|0,m=N+4|0,Q=E;e:for(;;){z=P+(((Q|0)%5|0)<<4)|0,s[N>>2]=s[z>>2],s[N+4>>2]=s[z+4>>2],s[N+8>>2]=s[z+8>>2],s[N+12>>2]=s[z+12>>2];do;while((aa(N,Y,0,1)|0)==2);if((Q|0)>(E|0)&(tr(v)|0)!=0){if(s[T>>2]=s[N>>2],s[T+4>>2]=s[N+4>>2],s[T+8>>2]=s[N+8>>2],s[T+12>>2]=s[N+12>>2],as(le,I),L=s[T>>2]|0,F=s[17008+(L*80|0)+(s[D>>2]<<2)>>2]|0,s[T>>2]=s[18608+(L*80|0)+(F*20|0)>>2],z=s[18608+(L*80|0)+(F*20|0)+16>>2]|0,(z|0)>0){_=0;do Ml(pe),_=_+1|0;while((_|0)<(z|0))}switch(z=18608+(L*80|0)+(F*20|0)+4|0,s[u>>2]=s[z>>2],s[u+4>>2]=s[z+4>>2],s[u+8>>2]=s[z+8>>2],Hi(u,(s[Te>>2]|0)*3|0),rn(pe,u,pe),Ti(pe),as(pe,c),W=+(s[ze>>2]|0),Z[f>>3]=W*3,Z[it>>3]=0,K=W*-1.5,Z[g>>3]=K,Z[M>>3]=W*2.598076211353316,Z[y>>3]=K,Z[a>>3]=W*-2.598076211353316,s[17008+((s[T>>2]|0)*80|0)+(s[N>>2]<<2)>>2]|0){case 1:{_=g,L=f;break}case 3:{_=y,L=g;break}case 2:{_=f,L=y;break}default:{_=12;break e}}wr(I,c,L,_,b),cs(b,s[T>>2]|0,Y,1,O+8+(s[O>>2]<<4)|0),s[O>>2]=(s[O>>2]|0)+1}if((Q|0)<(Qe|0)&&(as(m,T),cs(T,s[N>>2]|0,Y,1,O+8+(s[O>>2]<<4)|0),s[O>>2]=(s[O>>2]|0)+1),s[D>>2]=s[N>>2],s[D+4>>2]=s[N+4>>2],s[D+8>>2]=s[N+8>>2],s[D+12>>2]=s[N+12>>2],Q=Q+1|0,(Q|0)>=(w|0)){_=3;break}}if((_|0)==3){De=G;return}else(_|0)==12&&Ut(22474,22521,581,22531)}function oa(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0;Y=De,De=De+128|0,L=Y+64|0,O=Y,F=L,z=20208,Q=F+60|0;do s[F>>2]=s[z>>2],F=F+4|0,z=z+4|0;while((F|0)<(Q|0));F=O,z=20272,Q=F+60|0;do s[F>>2]=s[z>>2],F=F+4|0,z=z+4|0;while((F|0)<(Q|0));Q=(tr(s[v>>2]|0)|0)==0,L=Q?L:O,O=_+4|0,Il(O),ra(O),tr(s[v>>2]|0)|0&&(ls(O),s[v>>2]=(s[v>>2]|0)+1),s[E>>2]=s[_>>2],v=E+4|0,rn(O,L,v),Ti(v),s[E+16>>2]=s[_>>2],v=E+20|0,rn(O,L+12|0,v),Ti(v),s[E+32>>2]=s[_>>2],v=E+36|0,rn(O,L+24|0,v),Ti(v),s[E+48>>2]=s[_>>2],v=E+52|0,rn(O,L+36|0,v),Ti(v),s[E+64>>2]=s[_>>2],E=E+68|0,rn(O,L+48|0,E),Ti(E),De=Y}function aa(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0;if(it=De,De=De+32|0,Te=it+12|0,Q=it,ze=_+4|0,Qe=s[16928+(v<<2)>>2]|0,pe=(L|0)!=0,Qe=pe?Qe*3|0:Qe,O=s[ze>>2]|0,le=_+8|0,z=s[le>>2]|0,pe){if(F=_+12|0,L=s[F>>2]|0,O=z+O+L|0,(O|0)==(Qe|0))return ze=1,De=it,ze|0;Y=F}else Y=_+12|0,L=s[Y>>2]|0,O=z+O+L|0;if((O|0)<=(Qe|0))return ze=0,De=it,ze|0;do if((L|0)>0){if(L=s[_>>2]|0,(z|0)>0){F=18608+(L*80|0)+60|0,L=_;break}L=18608+(L*80|0)+40|0,E?(KA(Te,Qe,0,0),As(ze,Te,Q),ia(Q),rn(Q,Te,ze),F=L,L=_):(F=L,L=_)}else F=18608+((s[_>>2]|0)*80|0)+20|0,L=_;while(0);if(s[L>>2]=s[F>>2],O=F+16|0,(s[O>>2]|0)>0){L=0;do Ml(ze),L=L+1|0;while((L|0)<(s[O>>2]|0))}return _=F+4|0,s[Te>>2]=s[_>>2],s[Te+4>>2]=s[_+4>>2],s[Te+8>>2]=s[_+8>>2],v=s[16848+(v<<2)>>2]|0,Hi(Te,pe?v*3|0:v),rn(ze,Te,ze),Ti(ze),pe?L=((s[le>>2]|0)+(s[ze>>2]|0)+(s[Y>>2]|0)|0)==(Qe|0)?1:2:L=2,ze=L,De=it,ze|0}function Ll(_,v){_=_|0,v=v|0;var E=0;do E=aa(_,v,0,1)|0;while((E|0)==2);return E|0}function Hn(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0,f=0,g=0,y=0,b=0,P=0;if(y=De,De=De+240|0,F=y+224|0,u=y+208|0,c=y,f=y+192|0,g=y+176|0,a=y+160|0,m=y+144|0,w=y+128|0,T=y+112|0,I=y+96|0,s[F>>2]=v,s[u>>2]=s[_>>2],s[u+4>>2]=s[_+4>>2],s[u+8>>2]=s[_+8>>2],s[u+12>>2]=s[_+12>>2],cA(u,F,c),s[O>>2]=0,M=L+E+((L|0)==6&1)|0,(M|0)<=(E|0)){De=y;return}Y=s[F>>2]|0,le=E+6|0,pe=16928+(Y<<2)|0,Qe=m+8|0,Te=w+8|0,ze=T+8|0,it=f+4|0,z=0,Q=E,L=-1;e:for(;;){if(F=(Q|0)%6|0,_=c+(F<<4)|0,s[f>>2]=s[_>>2],s[f+4>>2]=s[_+4>>2],s[f+8>>2]=s[_+8>>2],s[f+12>>2]=s[_+12>>2],_=z,z=aa(f,Y,0,1)|0,(Q|0)>(E|0)&(tr(v)|0)!=0&&(_|0)!=1&&(s[f>>2]|0)!=(L|0)){switch(as(c+(((F+5|0)%6|0)<<4)+4|0,g),as(c+(F<<4)+4|0,a),b=+(s[pe>>2]|0),Z[m>>3]=b*3,Z[Qe>>3]=0,P=b*-1.5,Z[w>>3]=P,Z[Te>>3]=b*2.598076211353316,Z[T>>3]=P,Z[ze>>3]=b*-2.598076211353316,F=s[u>>2]|0,s[17008+(F*80|0)+(((L|0)==(F|0)?s[f>>2]|0:L)<<2)>>2]|0){case 1:{_=w,L=m;break}case 3:{_=T,L=w;break}case 2:{_=m,L=T;break}default:{_=8;break e}}wr(g,a,L,_,I),!(co(g,I)|0)&&!(co(a,I)|0)&&(cs(I,s[u>>2]|0,Y,1,O+8+(s[O>>2]<<4)|0),s[O>>2]=(s[O>>2]|0)+1)}if((Q|0)<(le|0)&&(as(it,g),cs(g,s[f>>2]|0,Y,1,O+8+(s[O>>2]<<4)|0),s[O>>2]=(s[O>>2]|0)+1),Q=Q+1|0,(Q|0)>=(M|0)){_=3;break}else L=s[f>>2]|0}if((_|0)==3){De=y;return}else(_|0)==8&&Ut(22557,22521,746,22602)}function cA(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0;Y=De,De=De+160|0,L=Y+80|0,O=Y,F=L,z=20336,Q=F+72|0;do s[F>>2]=s[z>>2],F=F+4|0,z=z+4|0;while((F|0)<(Q|0));F=O,z=20416,Q=F+72|0;do s[F>>2]=s[z>>2],F=F+4|0,z=z+4|0;while((F|0)<(Q|0));Q=(tr(s[v>>2]|0)|0)==0,L=Q?L:O,O=_+4|0,Il(O),ra(O),tr(s[v>>2]|0)|0&&(ls(O),s[v>>2]=(s[v>>2]|0)+1),s[E>>2]=s[_>>2],v=E+4|0,rn(O,L,v),Ti(v),s[E+16>>2]=s[_>>2],v=E+20|0,rn(O,L+12|0,v),Ti(v),s[E+32>>2]=s[_>>2],v=E+36|0,rn(O,L+24|0,v),Ti(v),s[E+48>>2]=s[_>>2],v=E+52|0,rn(O,L+36|0,v),Ti(v),s[E+64>>2]=s[_>>2],v=E+68|0,rn(O,L+48|0,v),Ti(v),s[E+80>>2]=s[_>>2],E=E+84|0,rn(O,L+60|0,E),Ti(E),De=Y}function hA(_){_=+_;var v=0;return v=_<0?_+6.283185307179586:_,+(_>=6.283185307179586?v+-6.283185307179586:v)}function Gs(_,v){return _=_|0,v=v|0,+kt(+(+Z[_>>3]-+Z[v>>3]))<17453292519943298e-27?(v=+kt(+(+Z[_+8>>3]-+Z[v+8>>3]))<17453292519943298e-27,v|0):(v=0,v|0)}function Aa(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0;return O=+Z[v>>3],L=+Z[_>>3],F=+Vt(+((O-L)*.5)),E=+Vt(+((+Z[v+8>>3]-+Z[_+8>>3])*.5)),E=F*F+E*(+Qt(+O)*+Qt(+L)*E),+(+Rn(+ +yt(+E),+ +yt(+(1-E)))*2)}function fA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0;return O=+Z[v>>3],L=+Z[_>>3],F=+Vt(+((O-L)*.5)),E=+Vt(+((+Z[v+8>>3]-+Z[_+8>>3])*.5)),E=F*F+E*(+Qt(+O)*+Qt(+L)*E),+(+Rn(+ +yt(+E),+ +yt(+(1-E)))*2*6371.007180918475)}function vc(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0;return O=+Z[v>>3],L=+Z[_>>3],F=+Vt(+((O-L)*.5)),E=+Vt(+((+Z[v+8>>3]-+Z[_+8>>3])*.5)),E=F*F+E*(+Qt(+O)*+Qt(+L)*E),+(+Rn(+ +yt(+E),+ +yt(+(1-E)))*2*6371.007180918475*1e3)}function Na(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0;return F=+Z[v>>3],L=+Qt(+F),O=+Z[v+8>>3]-+Z[_+8>>3],z=L*+Vt(+O),E=+Z[_>>3],+ +Rn(+z,+(+Vt(+F)*+Qt(+E)-+Qt(+O)*(L*+Vt(+E))))}function xc(_,v,E,L){_=_|0,v=+v,E=+E,L=L|0;var O=0,F=0,z=0,Q=0;if(E<1e-16){s[L>>2]=s[_>>2],s[L+4>>2]=s[_+4>>2],s[L+8>>2]=s[_+8>>2],s[L+12>>2]=s[_+12>>2];return}F=v<0?v+6.283185307179586:v,F=v>=6.283185307179586?F+-6.283185307179586:F;do if(F<1e-16)v=+Z[_>>3]+E,Z[L>>3]=v,O=L;else{if(O=+kt(+(F+-3.141592653589793))<1e-16,v=+Z[_>>3],O){v=v-E,Z[L>>3]=v,O=L;break}if(z=+Qt(+E),E=+Vt(+E),v=z*+Vt(+v)+ +Qt(+F)*(E*+Qt(+v)),v=v>1?1:v,v=+hi(+(v<-1?-1:v)),Z[L>>3]=v,+kt(+(v+-1.5707963267948966))<1e-16){Z[L>>3]=1.5707963267948966,Z[L+8>>3]=0;return}if(+kt(+(v+1.5707963267948966))<1e-16){Z[L>>3]=-1.5707963267948966,Z[L+8>>3]=0;return}if(Q=+Qt(+v),F=E*+Vt(+F)/Q,E=+Z[_>>3],v=(z-+Vt(+v)*+Vt(+E))/+Qt(+E)/Q,z=F>1?1:F,v=v>1?1:v,v=+Z[_+8>>3]+ +Rn(+(z<-1?-1:z),+(v<-1?-1:v)),v>3.141592653589793)do v=v+-6.283185307179586;while(v>3.141592653589793);if(v<-3.141592653589793)do v=v+6.283185307179586;while(v<-3.141592653589793);Z[L+8>>3]=v;return}while(0);if(+kt(+(v+-1.5707963267948966))<1e-16){Z[O>>3]=1.5707963267948966,Z[L+8>>3]=0;return}if(+kt(+(v+1.5707963267948966))<1e-16){Z[O>>3]=-1.5707963267948966,Z[L+8>>3]=0;return}if(v=+Z[_+8>>3],v>3.141592653589793)do v=v+-6.283185307179586;while(v>3.141592653589793);if(v<-3.141592653589793)do v=v+6.283185307179586;while(v<-3.141592653589793);Z[L+8>>3]=v}function fi(_){return _=_|0,+ +Z[20496+(_<<3)>>3]}function dA(_){return _=_|0,+ +Z[20624+(_<<3)>>3]}function bn(_){return _=_|0,+ +Z[20752+(_<<3)>>3]}function pA(_){return _=_|0,+ +Z[20880+(_<<3)>>3]}function ii(_){_=_|0;var v=0;return v=21008+(_<<3)|0,_=s[v>>2]|0,an(s[v+4>>2]|0),_|0}function Wn(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0;return Te=+Z[v>>3],pe=+Z[_>>3],Y=+Vt(+((Te-pe)*.5)),F=+Z[v+8>>3],le=+Z[_+8>>3],z=+Vt(+((F-le)*.5)),Q=+Qt(+pe),Qe=+Qt(+Te),z=Y*Y+z*(Qe*Q*z),z=+Rn(+ +yt(+z),+ +yt(+(1-z)))*2,Y=+Z[E>>3],Te=+Vt(+((Y-Te)*.5)),L=+Z[E+8>>3],F=+Vt(+((L-F)*.5)),O=+Qt(+Y),F=Te*Te+F*(Qe*O*F),F=+Rn(+ +yt(+F),+ +yt(+(1-F)))*2,Y=+Vt(+((pe-Y)*.5)),L=+Vt(+((le-L)*.5)),L=Y*Y+L*(Q*O*L),L=+Rn(+ +yt(+L),+ +yt(+(1-L)))*2,O=(z+F+L)*.5,+(+ni(+ +yt(+(+pt(+(O*.5))*+pt(+((O-z)*.5))*+pt(+((O-F)*.5))*+pt(+((O-L)*.5)))))*4)}function la(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0;if(F=De,De=De+192|0,L=F+168|0,O=F,fs(_,v,L),Vr(_,v,O),v=s[O>>2]|0,(v|0)<=0)return E=0,De=F,+E;if(E=+Wn(O+8|0,O+8+(((v|0)!=1&1)<<4)|0,L)+0,(v|0)==1)return De=F,+E;_=1;do z=_,_=_+1|0,E=E+ +Wn(O+8+(z<<4)|0,O+8+(((_|0)%(v|0)|0)<<4)|0,L);while((_|0)<(v|0));return De=F,+E}function Ua(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0;if(F=De,De=De+192|0,L=F+168|0,O=F,fs(_,v,L),Vr(_,v,O),v=s[O>>2]|0,(v|0)>0){if(E=+Wn(O+8|0,O+8+(((v|0)!=1&1)<<4)|0,L)+0,(v|0)!=1){_=1;do z=_,_=_+1|0,E=E+ +Wn(O+8+(z<<4)|0,O+8+(((_|0)%(v|0)|0)<<4)|0,L);while((_|0)<(v|0))}}else E=0;return De=F,+(E*6371.007180918475*6371.007180918475)}function gA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0;if(F=De,De=De+192|0,L=F+168|0,O=F,fs(_,v,L),Vr(_,v,O),v=s[O>>2]|0,(v|0)>0){if(E=+Wn(O+8|0,O+8+(((v|0)!=1&1)<<4)|0,L)+0,(v|0)!=1){_=1;do z=_,_=_+1|0,E=E+ +Wn(O+8+(z<<4)|0,O+8+(((_|0)%(v|0)|0)<<4)|0,L);while((_|0)<(v|0))}}else E=0;return De=F,+(E*6371.007180918475*6371.007180918475*1e3*1e3)}function Dl(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0;if(z=De,De=De+176|0,F=z,ds(_,v,F),_=s[F>>2]|0,(_|0)<=1)return O=0,De=z,+O;v=_+-1|0,_=0,E=0,L=+Z[F+8>>3],O=+Z[F+16>>3];do _=_+1|0,Y=L,L=+Z[F+8+(_<<4)>>3],le=+Vt(+((L-Y)*.5)),Q=O,O=+Z[F+8+(_<<4)+8>>3],Q=+Vt(+((O-Q)*.5)),Q=le*le+Q*(+Qt(+L)*+Qt(+Y)*Q),E=E+ +Rn(+ +yt(+Q),+ +yt(+(1-Q)))*2;while((_|0)<(v|0));return De=z,+E}function Va(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0;if(z=De,De=De+176|0,F=z,ds(_,v,F),_=s[F>>2]|0,(_|0)<=1)return O=0,De=z,+O;v=_+-1|0,_=0,E=0,L=+Z[F+8>>3],O=+Z[F+16>>3];do _=_+1|0,Y=L,L=+Z[F+8+(_<<4)>>3],le=+Vt(+((L-Y)*.5)),Q=O,O=+Z[F+8+(_<<4)+8>>3],Q=+Vt(+((O-Q)*.5)),Q=le*le+Q*(+Qt(+Y)*+Qt(+L)*Q),E=E+ +Rn(+ +yt(+Q),+ +yt(+(1-Q)))*2;while((_|0)!=(v|0));return le=E*6371.007180918475,De=z,+le}function ui(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0;if(z=De,De=De+176|0,F=z,ds(_,v,F),_=s[F>>2]|0,(_|0)<=1)return O=0,De=z,+O;v=_+-1|0,_=0,E=0,L=+Z[F+8>>3],O=+Z[F+16>>3];do _=_+1|0,Y=L,L=+Z[F+8+(_<<4)>>3],le=+Vt(+((L-Y)*.5)),Q=O,O=+Z[F+8+(_<<4)+8>>3],Q=+Vt(+((O-Q)*.5)),Q=le*le+Q*(+Qt(+Y)*+Qt(+L)*Q),E=E+ +Rn(+ +yt(+Q),+ +yt(+(1-Q)))*2;while((_|0)!=(v|0));return le=E*6371.007180918475*1e3,De=z,+le}function Bl(_,v){return _=_|0,v=v|0,v=xt(_|0,v|0,52)|0,Ve()|0,v&15|0}function ja(_,v){return _=_|0,v=v|0,v=xt(_|0,v|0,45)|0,Ve()|0,v&127|0}function mA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0;if(!(!0&(v&-16777216|0)==134217728)||(z=xt(_|0,v|0,45)|0,Ve()|0,z=z&127,z>>>0>121))return v=0,v|0;E=xt(_|0,v|0,52)|0,Ve()|0,E=E&15;do if(E|0){for(O=1,L=0;;){if(F=xt(_|0,v|0,(15-O|0)*3|0)|0,Ve()|0,F=F&7,(F|0)!=0&(L^1))if((F|0)==1&(wn(z)|0)!=0){Q=0,L=13;break}else L=1;if((F|0)==7){Q=0,L=13;break}if(O>>>0<E>>>0)O=O+1|0;else{L=9;break}}if((L|0)==9){if((E|0)==15)Q=1;else break;return Q|0}else if((L|0)==13)return Q|0}while(0);for(;;){if(Q=xt(_|0,v|0,(14-E|0)*3|0)|0,Ve()|0,!((Q&7|0)==7&!0)){Q=0,L=13;break}if(E>>>0<14)E=E+1|0;else{Q=1,L=13;break}}return(L|0)==13?Q|0:0}function _A(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;if(L=xt(_|0,v|0,52)|0,Ve()|0,L=L&15,(L|0)>=(E|0)){if((L|0)!=(E|0))if(E>>>0<=15){if(O=qt(E|0,0,52)|0,_=O|_,v=Ve()|0|v&-15728641,(L|0)>(E|0))do O=qt(7,0,(14-E|0)*3|0)|0,E=E+1|0,_=O|_,v=Ve()|0|v;while((E|0)<(L|0))}else v=0,_=0}else v=0,_=0;return an(v|0),_|0}function nl(_,v,E){return _=_|0,v=v|0,E=E|0,_=xt(_|0,v|0,52)|0,Ve()|0,_=_&15,(E|0)<16&(_|0)<=(E|0)?(E=Bt(7,E-_|0)|0,E|0):(E=0,E|0)}function Ji(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0;if(z=xt(_|0,v|0,52)|0,Ve()|0,z=z&15,!!((E|0)<16&(z|0)<=(E|0))){if((z|0)==(E|0)){E=L,s[E>>2]=_,s[E+4>>2]=v;return}if(Y=Bt(7,E-z|0)|0,le=(Y|0)/7|0,Q=xt(_|0,v|0,45)|0,Ve()|0,!(wn(Q&127)|0))F=0;else{e:do if(!z)O=0;else for(F=1;;){if(O=xt(_|0,v|0,(15-F|0)*3|0)|0,Ve()|0,O=O&7,O|0)break e;if(F>>>0<z>>>0)F=F+1|0;else{O=0;break}}while(0);F=(O|0)==0}if(pe=qt(z+1|0,0,52)|0,O=Ve()|0|v&-15728641,Q=(14-z|0)*3|0,v=qt(7,0,Q|0)|0,v=(pe|_)&~v,z=O&~(Ve()|0),Ji(v,z,E,L),O=L+(le<<3)|0,!F){pe=qt(1,0,Q|0)|0,Ji(pe|v,Ve()|0|z,E,O),pe=O+(le<<3)|0,Y=qt(2,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe),pe=pe+(le<<3)|0,Y=qt(3,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe),pe=pe+(le<<3)|0,Y=qt(4,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe),pe=pe+(le<<3)|0,Y=qt(5,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe),Y=qt(6,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe+(le<<3)|0);return}F=O+(le<<3)|0,(Y|0)>6&&(Y=O+8|0,pe=(F>>>0>Y>>>0?F:Y)+-1+(0-O)|0,gs(O|0,0,pe+8&-8|0)|0,O=Y+(pe>>>3<<3)|0),pe=qt(2,0,Q|0)|0,Ji(pe|v,Ve()|0|z,E,O),pe=O+(le<<3)|0,Y=qt(3,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe),pe=pe+(le<<3)|0,Y=qt(4,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe),pe=pe+(le<<3)|0,Y=qt(5,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe),Y=qt(6,0,Q|0)|0,Ji(Y|v,Ve()|0|z,E,pe+(le<<3)|0)}}function Si(_,v){_=_|0,v=v|0;var E=0,L=0,O=0;if(O=xt(_|0,v|0,45)|0,Ve()|0,!(wn(O&127)|0))return O=0,O|0;O=xt(_|0,v|0,52)|0,Ve()|0,O=O&15;e:do if(!O)E=0;else for(L=1;;){if(E=xt(_|0,v|0,(15-L|0)*3|0)|0,Ve()|0,E=E&7,E|0)break e;if(L>>>0<O>>>0)L=L+1|0;else{E=0;break}}while(0);return O=(E|0)==0&1,O|0}function Nr(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;if(L=xt(_|0,v|0,52)|0,Ve()|0,L=L&15,(E|0)<16&(L|0)<=(E|0)){if((L|0)!=(E|0)&&(O=qt(E|0,0,52)|0,_=O|_,v=Ve()|0|v&-15728641,(L|0)<(E|0)))do O=qt(7,0,(14-L|0)*3|0)|0,L=L+1|0,_=_&~O,v=v&~(Ve()|0);while((L|0)<(E|0))}else v=0,_=0;return an(v|0),_|0}function il(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0,f=0,g=0;if(!E)return f=0,f|0;if(O=_,L=s[O>>2]|0,O=s[O+4>>2]|0,!0&(O&15728640|0)==0){if((E|0)<=0||(f=v,s[f>>2]=L,s[f+4>>2]=O,(E|0)==1))return f=0,f|0;L=1;do u=_+(L<<3)|0,c=s[u+4>>2]|0,f=v+(L<<3)|0,s[f>>2]=s[u>>2],s[f+4>>2]=c,L=L+1|0;while((L|0)!=(E|0));return L=0,L|0}if(u=E<<3,c=Wi(u)|0,!c)return f=-3,f|0;if(pi(c|0,_|0,u|0)|0,I=Jt(E,8)|0,!I)return gt(c),f=-3,f|0;L=E;e:for(;;){z=c,pe=s[z>>2]|0,z=s[z+4>>2]|0,w=xt(pe|0,z|0,52)|0,Ve()|0,w=w&15,T=w+-1|0,m=(L|0)>0;t:do if(m){if(a=((L|0)<0)<<31>>31,it=qt(T|0,0,52)|0,M=Ve()|0,T>>>0>15)for(O=0,_=pe,E=z;;){if(!((_|0)==0&(E|0)==0)){if(F=xt(_|0,E|0,52)|0,Ve()|0,F=F&15,Q=(F|0)<(T|0),F=(F|0)==(T|0),le=Q?0:F?_:0,_=Q?0:F?E:0,E=Er(le|0,_|0,L|0,a|0)|0,Ve()|0,F=I+(E<<3)|0,Q=F,Y=s[Q>>2]|0,Q=s[Q+4>>2]|0,(Y|0)==0&(Q|0)==0)E=le;else for(it=0,ze=E,Te=Q,E=le;;){if((it|0)>(L|0)){f=41;break e}if((Y|0)==(E|0)&(Te&-117440513|0)==(_|0)){le=xt(Y|0,Te|0,56)|0,Ve()|0,le=le&7,Qe=le+1|0,M=xt(Y|0,Te|0,45)|0,Ve()|0;n:do if(!(wn(M&127)|0))Q=7;else{if(Y=xt(Y|0,Te|0,52)|0,Ve()|0,Y=Y&15,!Y){Q=6;break}for(Q=1;;){if(M=qt(7,0,(15-Q|0)*3|0)|0,!((M&E|0)==0&((Ve()|0)&_|0)==0)){Q=7;break n}if(Q>>>0<Y>>>0)Q=Q+1|0;else{Q=6;break}}}while(0);if((le+2|0)>>>0>Q>>>0){f=51;break e}M=qt(Qe|0,0,56)|0,_=Ve()|0|_&-117440513,Q=F,s[Q>>2]=0,s[Q+4>>2]=0,Q=ze,E=M|E}else Q=(ze+1|0)%(L|0)|0;if(F=I+(Q<<3)|0,Te=F,Y=s[Te>>2]|0,Te=s[Te+4>>2]|0,(Y|0)==0&(Te|0)==0)break;it=it+1|0,ze=Q}M=F,s[M>>2]=E,s[M+4>>2]=_}if(O=O+1|0,(O|0)>=(L|0))break t;E=c+(O<<3)|0,_=s[E>>2]|0,E=s[E+4>>2]|0}for(O=0,_=pe,E=z;;){if(!((_|0)==0&(E|0)==0)){if(Q=xt(_|0,E|0,52)|0,Ve()|0,Q=Q&15,(Q|0)>=(T|0)){if((Q|0)!=(T|0)&&(_=_|it,E=E&-15728641|M,Q>>>0>=w>>>0)){F=T;do ze=qt(7,0,(14-F|0)*3|0)|0,F=F+1|0,_=ze|_,E=Ve()|0|E;while(F>>>0<Q>>>0)}}else _=0,E=0;if(Q=Er(_|0,E|0,L|0,a|0)|0,Ve()|0,F=I+(Q<<3)|0,Y=F,le=s[Y>>2]|0,Y=s[Y+4>>2]|0,!((le|0)==0&(Y|0)==0))for(ze=0;;){if((ze|0)>(L|0)){f=41;break e}if((le|0)==(_|0)&(Y&-117440513|0)==(E|0)){Qe=xt(le|0,Y|0,56)|0,Ve()|0,Qe=Qe&7,Te=Qe+1|0,g=xt(le|0,Y|0,45)|0,Ve()|0;n:do if(!(wn(g&127)|0))Y=7;else{if(le=xt(le|0,Y|0,52)|0,Ve()|0,le=le&15,!le){Y=6;break}for(Y=1;;){if(g=qt(7,0,(15-Y|0)*3|0)|0,!((g&_|0)==0&((Ve()|0)&E|0)==0)){Y=7;break n}if(Y>>>0<le>>>0)Y=Y+1|0;else{Y=6;break}}}while(0);if((Qe+2|0)>>>0>Y>>>0){f=51;break e}g=qt(Te|0,0,56)|0,E=Ve()|0|E&-117440513,Te=F,s[Te>>2]=0,s[Te+4>>2]=0,_=g|_}else Q=(Q+1|0)%(L|0)|0;if(F=I+(Q<<3)|0,Y=F,le=s[Y>>2]|0,Y=s[Y+4>>2]|0,(le|0)==0&(Y|0)==0)break;ze=ze+1|0}g=F,s[g>>2]=_,s[g+4>>2]=E}if(O=O+1|0,(O|0)>=(L|0))break t;E=c+(O<<3)|0,_=s[E>>2]|0,E=s[E+4>>2]|0}}while(0);if((L+5|0)>>>0<11){f=99;break}if(M=Jt((L|0)/6|0,8)|0,!M){f=58;break}t:do if(m){ze=0,Te=0;do{if(Q=I+(ze<<3)|0,_=Q,O=s[_>>2]|0,_=s[_+4>>2]|0,!((O|0)==0&(_|0)==0)){Y=xt(O|0,_|0,56)|0,Ve()|0,Y=Y&7,E=Y+1|0,le=_&-117440513,g=xt(O|0,_|0,45)|0,Ve()|0;n:do if(wn(g&127)|0){if(Qe=xt(O|0,_|0,52)|0,Ve()|0,Qe=Qe&15,Qe|0)for(F=1;;){if(g=qt(7,0,(15-F|0)*3|0)|0,!((O&g|0)==0&(le&(Ve()|0)|0)==0))break n;if(F>>>0<Qe>>>0)F=F+1|0;else break}_=qt(E|0,0,56)|0,O=_|O,_=Ve()|0|le,E=Q,s[E>>2]=O,s[E+4>>2]=_,E=Y+2|0}while(0);(E|0)==7&&(g=M+(Te<<3)|0,s[g>>2]=O,s[g+4>>2]=_&-117440513,Te=Te+1|0)}ze=ze+1|0}while((ze|0)!=(L|0));if(m){if(it=((L|0)<0)<<31>>31,Qe=qt(T|0,0,52)|0,ze=Ve()|0,T>>>0>15)for(_=0,O=0;;){do if(!((pe|0)==0&(z|0)==0)){for(Y=xt(pe|0,z|0,52)|0,Ve()|0,Y=Y&15,F=(Y|0)<(T|0),Y=(Y|0)==(T|0),Q=F?0:Y?pe:0,Y=F?0:Y?z:0,F=Er(Q|0,Y|0,L|0,it|0)|0,Ve()|0,E=0;;){if((E|0)>(L|0)){f=98;break e}if(g=I+(F<<3)|0,le=s[g+4>>2]|0,(le&-117440513|0)==(Y|0)&&(s[g>>2]|0)==(Q|0)){f=70;break}if(F=(F+1|0)%(L|0)|0,g=I+(F<<3)|0,(s[g>>2]|0)==(Q|0)&&(s[g+4>>2]|0)==(Y|0))break;E=E+1|0}if((f|0)==70&&(f=0,!0&(le&117440512|0)==100663296))break;g=v+(O<<3)|0,s[g>>2]=pe,s[g+4>>2]=z,O=O+1|0}while(0);if(_=_+1|0,(_|0)>=(L|0)){L=Te;break t}z=c+(_<<3)|0,pe=s[z>>2]|0,z=s[z+4>>2]|0}for(_=0,O=0;;){do if(!((pe|0)==0&(z|0)==0)){if(Y=xt(pe|0,z|0,52)|0,Ve()|0,Y=Y&15,(Y|0)>=(T|0))if((Y|0)!=(T|0))if(E=pe|Qe,F=z&-15728641|ze,Y>>>0<w>>>0)Y=F;else{Q=T;do g=qt(7,0,(14-Q|0)*3|0)|0,Q=Q+1|0,E=g|E,F=Ve()|0|F;while(Q>>>0<Y>>>0);Y=F}else E=pe,Y=z;else E=0,Y=0;for(Q=Er(E|0,Y|0,L|0,it|0)|0,Ve()|0,F=0;;){if((F|0)>(L|0)){f=98;break e}if(g=I+(Q<<3)|0,le=s[g+4>>2]|0,(le&-117440513|0)==(Y|0)&&(s[g>>2]|0)==(E|0)){f=93;break}if(Q=(Q+1|0)%(L|0)|0,g=I+(Q<<3)|0,(s[g>>2]|0)==(E|0)&&(s[g+4>>2]|0)==(Y|0))break;F=F+1|0}if((f|0)==93&&(f=0,!0&(le&117440512|0)==100663296))break;g=v+(O<<3)|0,s[g>>2]=pe,s[g+4>>2]=z,O=O+1|0}while(0);if(_=_+1|0,(_|0)>=(L|0)){L=Te;break t}z=c+(_<<3)|0,pe=s[z>>2]|0,z=s[z+4>>2]|0}}else O=0,L=Te}else O=0,L=0;while(0);if(gs(I|0,0,u|0)|0,pi(c|0,M|0,L<<3|0)|0,gt(M),L)v=v+(O<<3)|0;else break}return(f|0)==41?(gt(c),gt(I),g=-1,g|0):(f|0)==51?(gt(c),gt(I),g=-2,g|0):(f|0)==58?(gt(c),gt(I),g=-3,g|0):(f|0)==98?(gt(M),gt(c),gt(I),g=-1,g|0):((f|0)==99&&pi(v|0,c|0,L<<3|0)|0,gt(c),gt(I),g=0,g|0)}function oi(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0;if((v|0)<=0)return O=0,O|0;if((O|0)>=16){for(F=0;;){if(pe=_+(F<<3)|0,!((s[pe>>2]|0)==0&(s[pe+4>>2]|0)==0)){F=14;break}if(F=F+1|0,(F|0)>=(v|0)){z=0,F=16;break}}if((F|0)==14)return((L|0)>0?-2:-1)|0;if((F|0)==16)return z|0}F=0,pe=0;e:for(;;){le=_+(pe<<3)|0,Q=le,z=s[Q>>2]|0,Q=s[Q+4>>2]|0;do if(!((z|0)==0&(Q|0)==0)){if((F|0)>=(L|0)){z=-1,F=16;break e}if(Y=xt(z|0,Q|0,52)|0,Ve()|0,Y=Y&15,(Y|0)>(O|0)){z=-2,F=16;break e}if((Y|0)==(O|0)){le=E+(F<<3)|0,s[le>>2]=z,s[le+4>>2]=Q,F=F+1|0;break}if(z=(Bt(7,O-Y|0)|0)+F|0,(z|0)>(L|0)){z=-1,F=16;break e}Ji(s[le>>2]|0,s[le+4>>2]|0,O,E+(F<<3)|0),F=z}while(0);if(pe=pe+1|0,(pe|0)>=(v|0)){z=0,F=16;break}}return(F|0)==16?z|0:0}function ua(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0;if((v|0)<=0)return E=0,E|0;if((E|0)>=16){for(L=0;;){if(z=_+(L<<3)|0,!((s[z>>2]|0)==0&(s[z+4>>2]|0)==0)){L=-1,O=13;break}if(L=L+1|0,(L|0)>=(v|0)){L=0,O=13;break}}if((O|0)==13)return L|0}L=0,z=0;e:for(;;){O=_+(z<<3)|0,F=s[O>>2]|0,O=s[O+4>>2]|0;do if(!((F|0)==0&(O|0)==0)){if(O=xt(F|0,O|0,52)|0,Ve()|0,O=O&15,(O|0)>(E|0)){L=-1,O=13;break e}if((O|0)==(E|0)){L=L+1|0;break}else{L=(Bt(7,E-O|0)|0)+L|0;break}}while(0);if(z=z+1|0,(z|0)>=(v|0)){O=13;break}}return(O|0)==13?L|0:0}function Ur(_,v){return _=_|0,v=v|0,v=xt(_|0,v|0,52)|0,Ve()|0,v&1|0}function dr(_,v){_=_|0,v=v|0;var E=0,L=0,O=0;if(O=xt(_|0,v|0,52)|0,Ve()|0,O=O&15,!O)return O=0,O|0;for(L=1;;){if(E=xt(_|0,v|0,(15-L|0)*3|0)|0,Ve()|0,E=E&7,E|0){L=5;break}if(L>>>0<O>>>0)L=L+1|0;else{E=0,L=5;break}}return(L|0)==5?E|0:0}function er(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0;if(Y=xt(_|0,v|0,52)|0,Ve()|0,Y=Y&15,!Y)return Q=v,Y=_,an(Q|0),Y|0;for(Q=1,E=0;;){F=(15-Q|0)*3|0,L=qt(7,0,F|0)|0,O=Ve()|0,z=xt(_|0,v|0,F|0)|0,Ve()|0,F=qt(Zr(z&7)|0,0,F|0)|0,z=Ve()|0,_=F|_&~L,v=z|v&~O;e:do if(!E)if((F&L|0)==0&(z&O|0)==0)E=0;else if(L=xt(_|0,v|0,52)|0,Ve()|0,L=L&15,!L)E=1;else{E=1;t:for(;;){switch(z=xt(_|0,v|0,(15-E|0)*3|0)|0,Ve()|0,z&7){case 1:break t;case 0:break;default:{E=1;break e}}if(E>>>0<L>>>0)E=E+1|0;else{E=1;break e}}for(E=1;;)if(z=(15-E|0)*3|0,O=xt(_|0,v|0,z|0)|0,Ve()|0,F=qt(7,0,z|0)|0,v=v&~(Ve()|0),z=qt(Zr(O&7)|0,0,z|0)|0,_=_&~F|z,v=v|(Ve()|0),E>>>0<L>>>0)E=E+1|0;else{E=1;break}}while(0);if(Q>>>0<Y>>>0)Q=Q+1|0;else break}return an(v|0),_|0}function Ps(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0;if(L=xt(_|0,v|0,52)|0,Ve()|0,L=L&15,!L)return E=v,L=_,an(E|0),L|0;for(E=1;F=(15-E|0)*3|0,z=xt(_|0,v|0,F|0)|0,Ve()|0,O=qt(7,0,F|0)|0,v=v&~(Ve()|0),F=qt(Zr(z&7)|0,0,F|0)|0,_=F|_&~O,v=Ve()|0|v,E>>>0<L>>>0;)E=E+1|0;return an(v|0),_|0}function Ms(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0;if(Y=xt(_|0,v|0,52)|0,Ve()|0,Y=Y&15,!Y)return Q=v,Y=_,an(Q|0),Y|0;for(Q=1,E=0;;){F=(15-Q|0)*3|0,L=qt(7,0,F|0)|0,O=Ve()|0,z=xt(_|0,v|0,F|0)|0,Ve()|0,F=qt(Ao(z&7)|0,0,F|0)|0,z=Ve()|0,_=F|_&~L,v=z|v&~O;e:do if(!E)if((F&L|0)==0&(z&O|0)==0)E=0;else if(L=xt(_|0,v|0,52)|0,Ve()|0,L=L&15,!L)E=1;else{E=1;t:for(;;){switch(z=xt(_|0,v|0,(15-E|0)*3|0)|0,Ve()|0,z&7){case 1:break t;case 0:break;default:{E=1;break e}}if(E>>>0<L>>>0)E=E+1|0;else{E=1;break e}}for(E=1;;)if(O=(15-E|0)*3|0,F=qt(7,0,O|0)|0,z=v&~(Ve()|0),v=xt(_|0,v|0,O|0)|0,Ve()|0,v=qt(Ao(v&7)|0,0,O|0)|0,_=_&~F|v,v=z|(Ve()|0),E>>>0<L>>>0)E=E+1|0;else{E=1;break}}while(0);if(Q>>>0<Y>>>0)Q=Q+1|0;else break}return an(v|0),_|0}function hs(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0;if(L=xt(_|0,v|0,52)|0,Ve()|0,L=L&15,!L)return E=v,L=_,an(E|0),L|0;for(E=1;z=(15-E|0)*3|0,F=qt(7,0,z|0)|0,O=v&~(Ve()|0),v=xt(_|0,v|0,z|0)|0,Ve()|0,v=qt(Ao(v&7)|0,0,z|0)|0,_=v|_&~F,v=Ve()|0|O,E>>>0<L>>>0;)E=E+1|0;return an(v|0),_|0}function Mo(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0;if(Y=De,De=De+64|0,Q=Y+40|0,L=Y+24|0,O=Y+12|0,F=Y,qt(v|0,0,52)|0,E=Ve()|0|134225919,!v)return(s[_+4>>2]|0)>2||(s[_+8>>2]|0)>2||(s[_+12>>2]|0)>2?(z=0,Q=0,an(z|0),De=Y,Q|0):(qt(En(_)|0,0,45)|0,z=Ve()|0|E,Q=-1,an(z|0),De=Y,Q|0);if(s[Q>>2]=s[_>>2],s[Q+4>>2]=s[_+4>>2],s[Q+8>>2]=s[_+8>>2],s[Q+12>>2]=s[_+12>>2],z=Q+4|0,(v|0)>0)for(_=-1;s[L>>2]=s[z>>2],s[L+4>>2]=s[z+4>>2],s[L+8>>2]=s[z+8>>2],v&1?(Fa(z),s[O>>2]=s[z>>2],s[O+4>>2]=s[z+4>>2],s[O+8>>2]=s[z+8>>2],uA(O)):(na(z),s[O>>2]=s[z>>2],s[O+4>>2]=s[z+4>>2],s[O+8>>2]=s[z+8>>2],ls(O)),As(L,O,F),Ti(F),pe=(15-v|0)*3|0,le=qt(7,0,pe|0)|0,E=E&~(Ve()|0),pe=qt(Co(F)|0,0,pe|0)|0,_=pe|_&~le,E=Ve()|0|E,(v|0)>1;)v=v+-1|0;else _=-1;e:do if((s[z>>2]|0)<=2&&(s[Q+8>>2]|0)<=2&&(s[Q+12>>2]|0)<=2){if(L=En(Q)|0,v=qt(L|0,0,45)|0,v=v|_,_=Ve()|0|E&-1040385,F=za(Q)|0,!(wn(L)|0)){if((F|0)<=0)break;for(O=0;;){if(L=xt(v|0,_|0,52)|0,Ve()|0,L=L&15,L)for(E=1;pe=(15-E|0)*3|0,Q=xt(v|0,_|0,pe|0)|0,Ve()|0,le=qt(7,0,pe|0)|0,_=_&~(Ve()|0),pe=qt(Zr(Q&7)|0,0,pe|0)|0,v=v&~le|pe,_=_|(Ve()|0),E>>>0<L>>>0;)E=E+1|0;if(O=O+1|0,(O|0)==(F|0))break e}}O=xt(v|0,_|0,52)|0,Ve()|0,O=O&15;t:do if(O){E=1;n:for(;;){switch(pe=xt(v|0,_|0,(15-E|0)*3|0)|0,Ve()|0,pe&7){case 1:break n;case 0:break;default:break t}if(E>>>0<O>>>0)E=E+1|0;else break t}if(AA(L,s[Q>>2]|0)|0)for(E=1;Q=(15-E|0)*3|0,le=qt(7,0,Q|0)|0,pe=_&~(Ve()|0),_=xt(v|0,_|0,Q|0)|0,Ve()|0,_=qt(Ao(_&7)|0,0,Q|0)|0,v=v&~le|_,_=pe|(Ve()|0),E>>>0<O>>>0;)E=E+1|0;else for(E=1;pe=(15-E|0)*3|0,Q=xt(v|0,_|0,pe|0)|0,Ve()|0,le=qt(7,0,pe|0)|0,_=_&~(Ve()|0),pe=qt(Zr(Q&7)|0,0,pe|0)|0,v=v&~le|pe,_=_|(Ve()|0),E>>>0<O>>>0;)E=E+1|0}while(0);if((F|0)>0){E=0;do v=er(v,_)|0,_=Ve()|0,E=E+1|0;while((E|0)!=(F|0))}}else v=0,_=0;while(0);return le=_,pe=v,an(le|0),De=Y,pe|0}function tr(_){return _=_|0,(_|0)%2|0|0}function yA(_,v){_=_|0,v=v|0;var E=0,L=0;return L=De,De=De+16|0,E=L,v>>>0<=15&&(s[_+4>>2]&2146435072|0)!=2146435072&&(s[_+8+4>>2]&2146435072|0)!=2146435072?(Tu(_,v,E),v=Mo(E,v)|0,_=Ve()|0):(_=0,v=0),an(_|0),De=L,v|0}function Io(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0;if(O=E+4|0,F=xt(_|0,v|0,52)|0,Ve()|0,F=F&15,z=xt(_|0,v|0,45)|0,Ve()|0,L=(F|0)==0,wn(z&127)|0){if(L)return z=1,z|0;L=1}else{if(L)return z=0,z|0;!(s[O>>2]|0)&&!(s[E+8>>2]|0)?L=(s[E+12>>2]|0)!=0&1:L=1}for(E=1;E&1?uA(O):ls(O),z=xt(_|0,v|0,(15-E|0)*3|0)|0,Ve()|0,Eu(O,z&7),E>>>0<F>>>0;)E=E+1|0;return L|0}function ko(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0;pe=De,De=De+16|0,Y=pe,le=xt(_|0,v|0,45)|0,Ve()|0,le=le&127;e:do if(wn(le)|0&&(F=xt(_|0,v|0,52)|0,Ve()|0,F=F&15,(F|0)!=0)){L=1;t:for(;;){switch(Q=xt(_|0,v|0,(15-L|0)*3|0)|0,Ve()|0,Q&7){case 5:break t;case 0:break;default:{L=v;break e}}if(L>>>0<F>>>0)L=L+1|0;else{L=v;break e}}for(O=1,L=v;v=(15-O|0)*3|0,z=qt(7,0,v|0)|0,Q=L&~(Ve()|0),L=xt(_|0,L|0,v|0)|0,Ve()|0,L=qt(Ao(L&7)|0,0,v|0)|0,_=_&~z|L,L=Q|(Ve()|0),O>>>0<F>>>0;)O=O+1|0}else L=v;while(0);if(Q=7728+(le*28|0)|0,s[E>>2]=s[Q>>2],s[E+4>>2]=s[Q+4>>2],s[E+8>>2]=s[Q+8>>2],s[E+12>>2]=s[Q+12>>2],!(Io(_,L,E)|0)){De=pe;return}if(z=E+4|0,s[Y>>2]=s[z>>2],s[Y+4>>2]=s[z+4>>2],s[Y+8>>2]=s[z+8>>2],F=xt(_|0,L|0,52)|0,Ve()|0,Q=F&15,F&1?(ls(z),F=Q+1|0):F=Q,!(wn(le)|0))L=0;else{e:do if(!Q)L=0;else for(v=1;;){if(O=xt(_|0,L|0,(15-v|0)*3|0)|0,Ve()|0,O=O&7,O|0){L=O;break e}if(v>>>0<Q>>>0)v=v+1|0;else{L=0;break}}while(0);L=(L|0)==4&1}if(!(aa(E,F,L,0)|0))(F|0)!=(Q|0)&&(s[z>>2]=s[Y>>2],s[z+4>>2]=s[Y+4>>2],s[z+8>>2]=s[Y+8>>2]);else{if(wn(le)|0)do;while(aa(E,F,0,0)|0);(F|0)!=(Q|0)&&na(z)}De=pe}function fs(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;L=De,De=De+16|0,O=L,ko(_,v,O),v=xt(_|0,v|0,52)|0,Ve()|0,Su(O,v&15,E),De=L}function Vr(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0;z=De,De=De+16|0,F=z,ko(_,v,F),L=xt(_|0,v|0,45)|0,Ve()|0,L=(wn(L&127)|0)==0,O=xt(_|0,v|0,52)|0,Ve()|0,O=O&15;e:do if(!L){if(O|0)for(L=1;;){if(Q=qt(7,0,(15-L|0)*3|0)|0,!((Q&_|0)==0&((Ve()|0)&v|0)==0))break e;if(L>>>0<O>>>0)L=L+1|0;else break}sa(F,O,0,5,E),De=z;return}while(0);Hn(F,O,0,6,E),De=z}function Cu(_,v){_=_|0,v=v|0;var E=0,L=0,O=0;if(L=xt(_|0,v|0,45)|0,Ve()|0,!(wn(L&127)|0))return L=2,L|0;if(L=xt(_|0,v|0,52)|0,Ve()|0,L=L&15,!L)return L=5,L|0;for(E=1;;){if(O=qt(7,0,(15-E|0)*3|0)|0,!((O&_|0)==0&((Ve()|0)&v|0)==0)){E=2,_=6;break}if(E>>>0<L>>>0)E=E+1|0;else{E=5,_=6;break}}return(_|0)==6?E|0:0}function ca(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0;Qe=De,De=De+128|0,le=Qe+112|0,F=Qe+96|0,pe=Qe,O=xt(_|0,v|0,52)|0,Ve()|0,Q=O&15,s[le>>2]=Q,z=xt(_|0,v|0,45)|0,Ve()|0,z=z&127;e:do if(wn(z)|0){if(Q|0)for(L=1;;){if(Y=qt(7,0,(15-L|0)*3|0)|0,!((Y&_|0)==0&((Ve()|0)&v|0)==0)){O=0;break e}if(L>>>0<Q>>>0)L=L+1|0;else break}if(O&1)O=1;else{Y=qt(Q+1|0,0,52)|0,pe=Ve()|0|v&-15728641,le=qt(7,0,(14-Q|0)*3|0)|0,ca((Y|_)&~le,pe&~(Ve()|0),E),De=Qe;return}}else O=0;while(0);ko(_,v,F),O?(oa(F,le,pe),Y=5):(cA(F,le,pe),Y=6);e:do if(wn(z)|0)if(!Q)L=20;else for(L=1;;){if(z=qt(7,0,(15-L|0)*3|0)|0,!((z&_|0)==0&((Ve()|0)&v|0)==0)){L=8;break e}if(L>>>0<Q>>>0)L=L+1|0;else{L=20;break}}else L=8;while(0);if(gs(E|0,-1,L|0)|0,O){O=0;do{for(F=pe+(O<<4)|0,Ll(F,s[le>>2]|0)|0,F=s[F>>2]|0,L=0;z=E+(L<<2)|0,Q=s[z>>2]|0,!((Q|0)==-1|(Q|0)==(F|0));)L=L+1|0;s[z>>2]=F,O=O+1|0}while((O|0)!=(Y|0))}else{O=0;do{for(F=pe+(O<<4)|0,aa(F,s[le>>2]|0,0,1)|0,F=s[F>>2]|0,L=0;z=E+(L<<2)|0,Q=s[z>>2]|0,!((Q|0)==-1|(Q|0)==(F|0));)L=L+1|0;s[z>>2]=F,O=O+1|0}while((O|0)!=(Y|0))}De=Qe}function Rl(){return 12}function Lo(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0;if(qt(_|0,0,52)|0,Q=Ve()|0|134225919,(_|0)<1){L=0,E=0;do wn(L)|0&&(qt(L|0,0,45)|0,z=Q|(Ve()|0),_=v+(E<<3)|0,s[_>>2]=-1,s[_+4>>2]=z,E=E+1|0),L=L+1|0;while((L|0)!=122);return}z=0,E=0;do{if(wn(z)|0){for(qt(z|0,0,45)|0,L=1,O=-1,F=Q|(Ve()|0);Y=qt(7,0,(15-L|0)*3|0)|0,O=O&~Y,F=F&~(Ve()|0),(L|0)!=(_|0);)L=L+1|0;Y=v+(E<<3)|0,s[Y>>2]=O,s[Y+4>>2]=F,E=E+1|0}z=z+1|0}while((z|0)!=122)}function Do(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0,le=0;if(Q=De,De=De+64|0,z=Q,(_|0)==(E|0)&(v|0)==(L|0)|(!1|(v&2013265920|0)!=134217728|(!1|(L&2013265920|0)!=134217728))||(O=xt(_|0,v|0,52)|0,Ve()|0,O=O&15,F=xt(E|0,L|0,52)|0,Ve()|0,(O|0)!=(F&15|0)))return z=0,De=Q,z|0;if(F=O+-1|0,O>>>0>1&&(le=_A(_,v,F)|0,Y=Ve()|0,F=_A(E,L,F)|0,(le|0)==(F|0)&(Y|0)==(Ve()|0))&&(F=(O^15)*3|0,O=xt(_|0,v|0,F|0)|0,Ve()|0,O=O&7,F=xt(E|0,L|0,F|0)|0,Ve()|0,F=F&7,(O|0)==0|(F|0)==0||(s[21136+(O<<2)>>2]|0)==(F|0)||(s[21168+(O<<2)>>2]|0)==(F|0)))return le=1,De=Q,le|0;O=z,F=O+56|0;do s[O>>2]=0,O=O+4|0;while((O|0)<(F|0));return Vs(_,v,1,z),le=z,!((s[le>>2]|0)==(E|0)&&(s[le+4>>2]|0)==(L|0))&&(le=z+8|0,!((s[le>>2]|0)==(E|0)&&(s[le+4>>2]|0)==(L|0)))&&(le=z+16|0,!((s[le>>2]|0)==(E|0)&&(s[le+4>>2]|0)==(L|0)))&&(le=z+24|0,!((s[le>>2]|0)==(E|0)&&(s[le+4>>2]|0)==(L|0)))&&(le=z+32|0,!((s[le>>2]|0)==(E|0)&&(s[le+4>>2]|0)==(L|0)))&&(le=z+40|0,!((s[le>>2]|0)==(E|0)&&(s[le+4>>2]|0)==(L|0)))?(O=z+48|0,O=((s[O>>2]|0)==(E|0)?(s[O+4>>2]|0)==(L|0):0)&1):O=1,le=O,De=Q,le|0}function Pu(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0;if(le=De,De=De+16|0,z=le,!(Do(_,v,E,L)|0))return Q=0,Y=0,an(Q|0),De=le,Y|0;for(Q=v&-2130706433,O=(Si(_,v)|0)==0,O=O?1:2;s[z>>2]=0,pe=ge(_,v,O,z)|0,F=O+1|0,!((pe|0)==(E|0)&(Ve()|0)==(L|0));)if(F>>>0<7)O=F;else{O=0,_=0,Y=6;break}return(Y|0)==6?(an(O|0),De=le,_|0):(pe=qt(O|0,0,56)|0,Y=Q|(Ve()|0)|268435456,pe=_|pe,an(Y|0),De=le,pe|0)}function lo(_,v){_=_|0,v=v|0;var E=0;return E=!0&(v&2013265920|0)==268435456,an((E?v&-2130706433|134217728:0)|0),(E?_:0)|0}function vA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0;return L=De,De=De+16|0,E=L,!0&(v&2013265920|0)==268435456?(O=xt(_|0,v|0,56)|0,Ve()|0,s[E>>2]=0,E=ge(_,v&-2130706433|134217728,O&7,E)|0,v=Ve()|0,an(v|0),De=L,E|0):(v=0,E=0,an(v|0),De=L,E|0)}function qr(_,v){_=_|0,v=v|0;var E=0;if(!(!0&(v&2013265920|0)==268435456))return E=0,E|0;switch(E=xt(_|0,v|0,56)|0,Ve()|0,E&7){case 0:case 7:return E=0,E|0}return E=v&-2130706433|134217728,!0&(v&117440512|0)==16777216&(Si(_,E)|0)!=0?(E=0,E|0):(E=mA(_,E)|0,E|0)}function Di(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0;F=De,De=De+16|0,L=F,z=!0&(v&2013265920|0)==268435456,O=v&-2130706433|134217728,Q=E,s[Q>>2]=z?_:0,s[Q+4>>2]=z?O:0,z?(v=xt(_|0,v|0,56)|0,Ve()|0,s[L>>2]=0,_=ge(_,O,v&7,L)|0,v=Ve()|0):(_=0,v=0),Q=E+8|0,s[Q>>2]=_,s[Q+4>>2]=v,De=F}function xA(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;O=(Si(_,v)|0)==0,v=v&-2130706433,L=E,s[L>>2]=O?_:0,s[L+4>>2]=O?v|285212672:0,L=E+8|0,s[L>>2]=_,s[L+4>>2]=v|301989888,L=E+16|0,s[L>>2]=_,s[L+4>>2]=v|318767104,L=E+24|0,s[L>>2]=_,s[L+4>>2]=v|335544320,L=E+32|0,s[L>>2]=_,s[L+4>>2]=v|352321536,E=E+40|0,s[E>>2]=_,s[E+4>>2]=v|369098752}function ds(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0;if(z=De,De=De+16|0,F=z,L=xt(_|0,v|0,56)|0,Ve()|0,Q=!0&(v&2013265920|0)==268435456,O=Q?_:0,_=Q?v&-2130706433|134217728:0,v=jl(O,_,L&7)|0,(v|0)==-1){s[E>>2]=0,De=z;return}ko(O,_,F),L=xt(O|0,_|0,52)|0,Ve()|0,L=L&15,Si(O,_)|0?sa(F,L,v,2,E):Hn(F,L,v,2,E),De=z}function wA(_){_=_|0;var v=0,E=0,L=0;return v=Jt(1,12)|0,v||Ut(22691,22646,49,22704),E=_+4|0,L=s[E>>2]|0,L|0?(L=L+8|0,s[L>>2]=v,s[E>>2]=v,v|0):(s[_>>2]|0&&Ut(22721,22646,61,22744),L=_,s[L>>2]=v,s[E>>2]=v,v|0)}function wc(_,v){_=_|0,v=v|0;var E=0,L=0;return L=Wi(24)|0,L||Ut(22758,22646,78,22772),s[L>>2]=s[v>>2],s[L+4>>2]=s[v+4>>2],s[L+8>>2]=s[v+8>>2],s[L+12>>2]=s[v+12>>2],s[L+16>>2]=0,v=_+4|0,E=s[v>>2]|0,E|0?(s[E+16>>2]=L,s[v>>2]=L,L|0):(s[_>>2]|0&&Ut(22787,22646,82,22772),s[_>>2]=L,s[v>>2]=L,L|0)}function ha(_){_=_|0;var v=0,E=0,L=0,O=0;if(_)for(L=1;;){if(v=s[_>>2]|0,v|0)do{if(E=s[v>>2]|0,E|0)do O=E,E=s[E+16>>2]|0,gt(O);while(E|0);O=v,v=s[v+8>>2]|0,gt(O)}while(v|0);if(v=_,_=s[_+8>>2]|0,L||gt(v),_)L=0;else break}}function Ol(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0,f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0;if(O=_+8|0,s[O>>2]|0)return K=1,K|0;if(L=s[_>>2]|0,!L)return K=0,K|0;v=L,E=0;do E=E+1|0,v=s[v+8>>2]|0;while(v|0);if(E>>>0<2)return K=0,K|0;G=Wi(E<<2)|0,G||Ut(22807,22646,317,22826),N=Wi(E<<5)|0,N||Ut(22848,22646,321,22826),s[_>>2]=0,c=_+4|0,s[c>>2]=0,s[O>>2]=0,E=0,D=0,u=0,Qe=0;e:for(;;){if(pe=s[L>>2]|0,pe){F=0,z=pe;do{if(Y=+Z[z+8>>3],v=z,z=s[z+16>>2]|0,le=(z|0)==0,O=le?pe:z,Q=+Z[O+8>>3],+kt(+(Y-Q))>3.141592653589793){K=14;break}F=F+(Q-Y)*(+Z[v>>3]+ +Z[O>>3])}while(!le);if((K|0)==14){K=0,F=0,v=pe;do I=+Z[v+8>>3],P=v+16|0,b=s[P>>2]|0,b=b|0?b:pe,T=+Z[b+8>>3],F=F+(+Z[v>>3]+ +Z[b>>3])*((T<0?T+6.283185307179586:T)-(I<0?I+6.283185307179586:I)),v=s[(v|0?P:L)>>2]|0;while(v|0)}F>0?(s[G+(D<<2)>>2]=L,D=D+1|0,O=u,v=Qe):K=19}else K=19;if((K|0)==19){K=0;do if(E){if(v=E+8|0,s[v>>2]|0){K=21;break e}if(E=Jt(1,12)|0,!E){K=23;break e}s[v>>2]=E,O=E+4|0,z=E,v=Qe}else if(Qe){O=c,z=Qe+8|0,v=L,E=_;break}else if(s[_>>2]|0){K=27;break e}else{O=c,z=_,v=L,E=_;break}while(0);if(s[z>>2]=L,s[O>>2]=L,z=N+(u<<5)|0,le=s[L>>2]|0,le){for(pe=N+(u<<5)+8|0,Z[pe>>3]=17976931348623157e292,Qe=N+(u<<5)+24|0,Z[Qe>>3]=17976931348623157e292,Z[z>>3]=-17976931348623157e292,Te=N+(u<<5)+16|0,Z[Te>>3]=-17976931348623157e292,m=17976931348623157e292,w=-17976931348623157e292,O=0,ze=le,Y=17976931348623157e292,M=17976931348623157e292,a=-17976931348623157e292,Q=-17976931348623157e292;F=+Z[ze>>3],I=+Z[ze+8>>3],ze=s[ze+16>>2]|0,it=(ze|0)==0,T=+Z[(it?le:ze)+8>>3],F<Y&&(Z[pe>>3]=F,Y=F),I<M&&(Z[Qe>>3]=I,M=I),F>a?Z[z>>3]=F:F=a,I>Q&&(Z[Te>>3]=I,Q=I),m=I>0&I<m?I:m,w=I<0&I>w?I:w,O=O|+kt(+(I-T))>3.141592653589793,!it;)a=F;O&&(Z[Te>>3]=w,Z[Qe>>3]=m)}else s[z>>2]=0,s[z+4>>2]=0,s[z+8>>2]=0,s[z+12>>2]=0,s[z+16>>2]=0,s[z+20>>2]=0,s[z+24>>2]=0,s[z+28>>2]=0;O=u+1|0}if(P=L+8|0,L=s[P>>2]|0,s[P>>2]=0,L)u=O,Qe=v;else{K=45;break}}if((K|0)==21)Ut(22624,22646,35,22658);else if((K|0)==23)Ut(22678,22646,37,22658);else if((K|0)==27)Ut(22721,22646,61,22744);else if((K|0)==45){e:do if((D|0)>0){for(P=(O|0)==0,y=O<<2,b=(_|0)==0,g=0,v=0;;){if(f=s[G+(g<<2)>>2]|0,P)K=73;else{if(u=Wi(y)|0,!u){K=50;break}if(c=Wi(y)|0,!c){K=52;break}t:do if(b)E=0;else{for(O=0,E=0,z=_;L=N+(O<<5)|0,fa(s[z>>2]|0,L,s[f>>2]|0)|0?(s[u+(E<<2)>>2]=z,s[c+(E<<2)>>2]=L,it=E+1|0):it=E,z=s[z+8>>2]|0,z;)O=O+1|0,E=it;if((it|0)>0)if(L=s[u>>2]|0,(it|0)==1)E=L;else for(Te=0,ze=-1,E=L,Qe=L;;){for(le=s[Qe>>2]|0,L=0,z=0;O=s[s[u+(z<<2)>>2]>>2]|0,(O|0)==(le|0)?pe=L:pe=L+((fa(O,s[c+(z<<2)>>2]|0,s[le>>2]|0)|0)&1)|0,z=z+1|0,(z|0)!=(it|0);)L=pe;if(O=(pe|0)>(ze|0),E=O?Qe:E,L=Te+1|0,(L|0)==(it|0))break t;Te=L,ze=O?pe:ze,Qe=s[u+(L<<2)>>2]|0}else E=0}while(0);if(gt(u),gt(c),E){if(O=E+4|0,L=s[O>>2]|0,L)E=L+8|0;else if(s[E>>2]|0){K=70;break}s[E>>2]=f,s[O>>2]=f}else K=73}if((K|0)==73){if(K=0,v=s[f>>2]|0,v|0)do c=v,v=s[v+16>>2]|0,gt(c);while(v|0);gt(f),v=2}if(g=g+1|0,(g|0)>=(D|0)){W=v;break e}}(K|0)==50?Ut(22863,22646,249,22882):(K|0)==52?Ut(22901,22646,252,22882):(K|0)==70&&Ut(22721,22646,61,22744)}else W=0;while(0);return gt(G),gt(N),K=W,K|0}return 0}function fa(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0;if(!(lA(v,E)|0)||(v=So(v)|0,le=+Z[E>>3],L=+Z[E+8>>3],L=v&L<0?L+6.283185307179586:L,_=s[_>>2]|0,!_))return _=0,_|0;if(v){v=0,E=_;e:for(;;){for(;z=+Z[E>>3],Y=+Z[E+8>>3],E=E+16|0,pe=s[E>>2]|0,pe=pe|0?pe:_,F=+Z[pe>>3],O=+Z[pe+8>>3],z>F?(Q=z,z=Y):(Q=F,F=z,z=O,O=Y),!!(le<F|le>Q);)if(E=s[E>>2]|0,!E){E=22;break e}if(Y=O<0?O+6.283185307179586:O,z=z<0?z+6.283185307179586:z,L=z==L|Y==L?L+-2220446049250313e-31:L,Y=Y+(le-F)/(Q-F)*(z-Y),(Y<0?Y+6.283185307179586:Y)>L&&(v=v^1),E=s[E>>2]|0,!E){E=22;break}}if((E|0)==22)return v|0}else{v=0,E=_;e:for(;;){for(;z=+Z[E>>3],Y=+Z[E+8>>3],E=E+16|0,pe=s[E>>2]|0,pe=pe|0?pe:_,F=+Z[pe>>3],O=+Z[pe+8>>3],z>F?(Q=z,z=Y):(Q=F,F=z,z=O,O=Y),!!(le<F|le>Q);)if(E=s[E>>2]|0,!E){E=22;break e}if(L=z==L|O==L?L+-2220446049250313e-31:L,O+(le-F)/(Q-F)*(z-O)>L&&(v=v^1),E=s[E>>2]|0,!E){E=22;break}}if((E|0)==22)return v|0}return 0}function Yr(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0;if(w=De,De=De+32|0,m=w+16|0,a=w,F=xt(_|0,v|0,52)|0,Ve()|0,F=F&15,ze=xt(E|0,L|0,52)|0,Ve()|0,(F|0)!=(ze&15|0))return m=1,De=w,m|0;if(le=xt(_|0,v|0,45)|0,Ve()|0,le=le&127,pe=xt(E|0,L|0,45)|0,Ve()|0,pe=pe&127,ze=(le|0)!=(pe|0),ze){if(Q=To(le,pe)|0,(Q|0)==7)return m=2,De=w,m|0;Y=To(pe,le)|0,(Y|0)==7?Ut(22925,22949,151,22959):(it=Q,z=Y)}else it=0,z=0;Qe=wn(le)|0,Te=wn(pe)|0,s[m>>2]=0,s[m+4>>2]=0,s[m+8>>2]=0,s[m+12>>2]=0;do if(it){if(pe=s[4304+(le*28|0)+(it<<2)>>2]|0,Q=(pe|0)>0,Te)if(Q){le=0,Y=E,Q=L;do Y=Ms(Y,Q)|0,Q=Ve()|0,z=Ao(z)|0,(z|0)==1&&(z=Ao(1)|0),le=le+1|0;while((le|0)!=(pe|0));pe=z,le=Y,Y=Q}else pe=z,le=E,Y=L;else if(Q){le=0,Y=E,Q=L;do Y=hs(Y,Q)|0,Q=Ve()|0,z=Ao(z)|0,le=le+1|0;while((le|0)!=(pe|0));pe=z,le=Y,Y=Q}else pe=z,le=E,Y=L;if(Io(le,Y,m)|0,ze||Ut(22972,22949,181,22959),Q=(Qe|0)!=0,z=(Te|0)!=0,Q&z&&Ut(22999,22949,182,22959),Q){if(z=dr(_,v)|0,rt[22032+(z*7|0)+it>>0]|0){F=3;break}Y=s[21200+(z*28|0)+(it<<2)>>2]|0,le=Y,M=26}else if(z){if(z=dr(le,Y)|0,rt[22032+(z*7|0)+pe>>0]|0){F=4;break}le=0,Y=s[21200+(pe*28|0)+(z<<2)>>2]|0,M=26}else z=0;if((M|0)==26)if((Y|0)<=-1&&Ut(23030,22949,212,22959),(le|0)<=-1&&Ut(23053,22949,213,22959),(Y|0)>0){Q=m+4|0,z=0;do ia(Q),z=z+1|0;while((z|0)!=(Y|0));z=le}else z=le;if(s[a>>2]=0,s[a+4>>2]=0,s[a+8>>2]=0,Eu(a,it),F|0)for(;tr(F)|0?uA(a):ls(a),(F|0)>1;)F=F+-1|0;if((z|0)>0){F=0;do ia(a),F=F+1|0;while((F|0)!=(z|0))}M=m+4|0,rn(M,a,M),Ti(M),M=50}else if(Io(E,L,m)|0,(Qe|0)!=0&(Te|0)!=0)if((pe|0)!=(le|0)&&Ut(23077,22949,243,22959),z=dr(_,v)|0,F=dr(E,L)|0,rt[22032+(z*7|0)+F>>0]|0)F=5;else if(z=s[21200+(z*28|0)+(F<<2)>>2]|0,(z|0)>0){Q=m+4|0,F=0;do ia(Q),F=F+1|0;while((F|0)!=(z|0));M=50}else M=50;else M=50;while(0);return(M|0)==50&&(F=m+4|0,s[O>>2]=s[F>>2],s[O+4>>2]=s[F+4>>2],s[O+8>>2]=s[F+8>>2],F=0),m=F,De=w,m|0}function Is(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0;if(it=De,De=De+48|0,z=it+36|0,Q=it+24|0,Y=it+12|0,le=it,F=xt(_|0,v|0,52)|0,Ve()|0,F=F&15,Te=xt(_|0,v|0,45)|0,Ve()|0,Te=Te&127,pe=wn(Te)|0,qt(F|0,0,52)|0,a=Ve()|0|134225919,M=L,s[M>>2]=-1,s[M+4>>2]=a,!F)return(s[E>>2]|0)>1||(s[E+4>>2]|0)>1||(s[E+8>>2]|0)>1||(O=Jo(Te,Co(E)|0)|0,(O|0)==127)?(a=1,De=it,a|0):(ze=qt(O|0,0,45)|0,M=Ve()|0,Te=L,M=s[Te+4>>2]&-1040385|M,a=L,s[a>>2]=s[Te>>2]|ze,s[a+4>>2]=M,a=0,De=it,a|0);for(s[z>>2]=s[E>>2],s[z+4>>2]=s[E+4>>2],s[z+8>>2]=s[E+8>>2];s[Q>>2]=s[z>>2],s[Q+4>>2]=s[z+4>>2],s[Q+8>>2]=s[z+8>>2],tr(F)|0?(Fa(z),s[Y>>2]=s[z>>2],s[Y+4>>2]=s[z+4>>2],s[Y+8>>2]=s[z+8>>2],uA(Y)):(na(z),s[Y>>2]=s[z>>2],s[Y+4>>2]=s[z+4>>2],s[Y+8>>2]=s[z+8>>2],ls(Y)),As(Q,Y,le),Ti(le),M=L,m=s[M>>2]|0,M=s[M+4>>2]|0,w=(15-F|0)*3|0,E=qt(7,0,w|0)|0,M=M&~(Ve()|0),w=qt(Co(le)|0,0,w|0)|0,M=Ve()|0|M,a=L,s[a>>2]=w|m&~E,s[a+4>>2]=M,(F|0)>1;)F=F+-1|0;e:do if((s[z>>2]|0)<=1&&(s[z+4>>2]|0)<=1&&(s[z+8>>2]|0)<=1){F=Co(z)|0,Q=Jo(Te,F)|0,(Q|0)==127?le=0:le=wn(Q)|0;t:do if(F){if(pe){if(z=21408+((dr(_,v)|0)*28|0)+(F<<2)|0,z=s[z>>2]|0,(z|0)>0){E=0;do F=Zr(F)|0,E=E+1|0;while((E|0)!=(z|0))}if((F|0)==1){O=3;break e}E=Jo(Te,F)|0,(E|0)==127&&Ut(23104,22949,376,23134),wn(E)|0?Ut(23147,22949,377,23134):(ze=z,Qe=F,O=E)}else ze=0,Qe=F,O=Q;if(Y=s[4304+(Te*28|0)+(Qe<<2)>>2]|0,(Y|0)<=-1&&Ut(23178,22949,384,23134),!le){if((ze|0)<=-1&&Ut(23030,22949,417,23134),ze|0){z=L,F=0,E=s[z>>2]|0,z=s[z+4>>2]|0;do E=Ps(E,z)|0,z=Ve()|0,w=L,s[w>>2]=E,s[w+4>>2]=z,F=F+1|0;while((F|0)<(ze|0))}if((Y|0)<=0){F=54;break}for(z=L,F=0,E=s[z>>2]|0,z=s[z+4>>2]|0;;)if(E=Ps(E,z)|0,z=Ve()|0,w=L,s[w>>2]=E,s[w+4>>2]=z,F=F+1|0,(F|0)==(Y|0)){F=54;break t}}if(Q=To(O,Te)|0,(Q|0)==7&&Ut(22925,22949,393,23134),F=L,E=s[F>>2]|0,F=s[F+4>>2]|0,(Y|0)>0){z=0;do E=Ps(E,F)|0,F=Ve()|0,w=L,s[w>>2]=E,s[w+4>>2]=F,z=z+1|0;while((z|0)!=(Y|0))}if(E=dr(E,F)|0,w=Li(O)|0,E=s[(w?21824:21616)+(Q*28|0)+(E<<2)>>2]|0,(E|0)<=-1&&Ut(23030,22949,412,23134),!E)F=54;else{Q=L,F=0,z=s[Q>>2]|0,Q=s[Q+4>>2]|0;do z=er(z,Q)|0,Q=Ve()|0,w=L,s[w>>2]=z,s[w+4>>2]=Q,F=F+1|0;while((F|0)<(E|0));F=54}}else if((pe|0)!=0&(le|0)!=0)if(w=dr(_,v)|0,F=L,F=21408+(w*28|0)+((dr(s[F>>2]|0,s[F+4>>2]|0)|0)<<2)|0,F=s[F>>2]|0,(F|0)<=-1&&Ut(23201,22949,433,23134),!F)O=Q,F=55;else{z=L,O=0,E=s[z>>2]|0,z=s[z+4>>2]|0;do E=Ps(E,z)|0,z=Ve()|0,w=L,s[w>>2]=E,s[w+4>>2]=z,O=O+1|0;while((O|0)<(F|0));O=Q,F=54}else O=Q,F=54;while(0);if((F|0)==54&&le&&(F=55),(F|0)==55&&(w=L,(dr(s[w>>2]|0,s[w+4>>2]|0)|0)==1)){O=4;break}w=L,a=s[w>>2]|0,w=s[w+4>>2]&-1040385,m=qt(O|0,0,45)|0,w=w|(Ve()|0),O=L,s[O>>2]=a|m,s[O+4>>2]=w,O=0}else O=2;while(0);return w=O,De=it,w|0}function Wt(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0;return z=De,De=De+16|0,F=z,_=Yr(_,v,E,L,F)|0,_||(js(F,O),_=0),De=z,_|0}function Ga(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0;return O=De,De=De+16|0,F=O,el(E,F),L=Is(_,v,F,L)|0,De=O,L|0}function bA(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0;return z=De,De=De+32|0,O=z+12|0,F=z,!(Yr(_,v,_,v,O)|0)&&!(Yr(_,v,E,L,F)|0)?_=us(O,F)|0:_=-1,De=z,_|0}function da(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0,z=0;return z=De,De=De+32|0,O=z+12|0,F=z,!(Yr(_,v,_,v,O)|0)&&!(Yr(_,v,E,L,F)|0)?_=us(O,F)|0:_=-1,De=z,(_>>>31^1)+_|0}function zl(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0;if(u=De,De=De+48|0,F=u+24|0,z=u+12|0,I=u,!(Yr(_,v,_,v,F)|0)&&!(Yr(_,v,E,L,z)|0)){if(T=us(F,z)|0,(T|0)<0)return I=T,De=u,I|0;for(s[F>>2]=0,s[F+4>>2]=0,s[F+8>>2]=0,s[z>>2]=0,s[z+4>>2]=0,s[z+8>>2]=0,Yr(_,v,_,v,F)|0,Yr(_,v,E,L,z)|0,Po(F),Po(z),T?(pe=s[F>>2]|0,ze=+(T|0),a=F+4|0,Qe=s[a>>2]|0,m=F+8|0,Te=s[m>>2]|0,w=F,E=pe,L=Qe,F=Te,it=+((s[z>>2]|0)-pe|0)/ze,M=+((s[z+4>>2]|0)-Qe|0)/ze,ze=+((s[z+8>>2]|0)-Te|0)/ze):(L=F+4|0,Te=F+8|0,a=L,m=Te,w=F,E=s[F>>2]|0,L=s[L>>2]|0,F=s[Te>>2]|0,it=0,M=0,ze=0),s[I>>2]=E,Te=I+4|0,s[Te>>2]=L,Qe=I+8|0,s[Qe>>2]=F,pe=0;;){Y=+(pe|0),c=it*Y+ +(E|0),Q=M*Y+ +(s[a>>2]|0),Y=ze*Y+ +(s[m>>2]|0),L=~~+ai(+c),z=~~+ai(+Q),E=~~+ai(+Y),c=+kt(+(+(L|0)-c)),Q=+kt(+(+(z|0)-Q)),Y=+kt(+(+(E|0)-Y));do if(c>Q&c>Y)L=0-(z+E)|0,F=z;else if(le=0-L|0,Q>Y){F=le-E|0;break}else{F=z,E=le-z|0;break}while(0);if(s[I>>2]=L,s[Te>>2]=F,s[Qe>>2]=E,tl(I),Is(_,v,I,O+(pe<<3)|0)|0,(pe|0)==(T|0))break;pe=pe+1|0,E=s[w>>2]|0}return I=0,De=u,I|0}return I=-1,De=u,I|0}function Bt(_,v){_=_|0,v=v|0;var E=0;if(!v)return E=1,E|0;E=_,_=1;do _=On(v&1|0?E:1,_)|0,v=v>>1,E=On(E,E)|0;while(v|0);return _|0}function EA(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0;if(!(lA(v,E)|0)||(v=So(v)|0,Te=+Z[E>>3],L=+Z[E+8>>3],L=v&L<0?L+6.283185307179586:L,Qe=s[_>>2]|0,(Qe|0)<=0))return Qe=0,Qe|0;if(pe=s[_+4>>2]|0,v){v=0,E=-1,_=0;e:for(;;){for(le=_;z=+Z[pe+(le<<4)>>3],Y=+Z[pe+(le<<4)+8>>3],_=(E+2|0)%(Qe|0)|0,F=+Z[pe+(_<<4)>>3],O=+Z[pe+(_<<4)+8>>3],z>F?(Q=z,z=Y):(Q=F,F=z,z=O,O=Y),!!(Te<F|Te>Q);)if(E=le+1|0,(E|0)<(Qe|0))_=le,le=E,E=_;else{E=22;break e}if(Y=O<0?O+6.283185307179586:O,z=z<0?z+6.283185307179586:z,L=z==L|Y==L?L+-2220446049250313e-31:L,Y=Y+(Te-F)/(Q-F)*(z-Y),(Y<0?Y+6.283185307179586:Y)>L&&(v=v^1),_=le+1|0,(_|0)>=(Qe|0)){E=22;break}else E=le}if((E|0)==22)return v|0}else{v=0,E=-1,_=0;e:for(;;){for(le=_;z=+Z[pe+(le<<4)>>3],Y=+Z[pe+(le<<4)+8>>3],_=(E+2|0)%(Qe|0)|0,F=+Z[pe+(_<<4)>>3],O=+Z[pe+(_<<4)+8>>3],z>F?(Q=z,z=Y):(Q=F,F=z,z=O,O=Y),!!(Te<F|Te>Q);)if(E=le+1|0,(E|0)<(Qe|0))_=le,le=E,E=_;else{E=22;break e}if(L=z==L|O==L?L+-2220446049250313e-31:L,O+(Te-F)/(Q-F)*(z-O)>L&&(v=v^1),_=le+1|0,(_|0)>=(Qe|0)){E=22;break}else E=le}if((E|0)==22)return v|0}return 0}function TA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0;if(it=s[_>>2]|0,!it){s[v>>2]=0,s[v+4>>2]=0,s[v+8>>2]=0,s[v+12>>2]=0,s[v+16>>2]=0,s[v+20>>2]=0,s[v+24>>2]=0,s[v+28>>2]=0;return}if(M=v+8|0,Z[M>>3]=17976931348623157e292,a=v+24|0,Z[a>>3]=17976931348623157e292,Z[v>>3]=-17976931348623157e292,m=v+16|0,Z[m>>3]=-17976931348623157e292,!((it|0)<=0)){for(Te=s[_+4>>2]|0,le=17976931348623157e292,pe=-17976931348623157e292,Qe=0,_=-1,F=17976931348623157e292,z=17976931348623157e292,Y=-17976931348623157e292,L=-17976931348623157e292,ze=0;E=+Z[Te+(ze<<4)>>3],Q=+Z[Te+(ze<<4)+8>>3],_=_+2|0,O=+Z[Te+(((_|0)==(it|0)?0:_)<<4)+8>>3],E<F&&(Z[M>>3]=E,F=E),Q<z&&(Z[a>>3]=Q,z=Q),E>Y?Z[v>>3]=E:E=Y,Q>L&&(Z[m>>3]=Q,L=Q),le=Q>0&Q<le?Q:le,pe=Q<0&Q>pe?Q:pe,Qe=Qe|+kt(+(Q-O))>3.141592653589793,_=ze+1|0,(_|0)!=(it|0);)w=ze,Y=E,ze=_,_=w;Qe&&(Z[m>>3]=pe,Z[a>>3]=le)}}function uo(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0,c=0,f=0;if(it=s[_>>2]|0,it){if(M=v+8|0,Z[M>>3]=17976931348623157e292,a=v+24|0,Z[a>>3]=17976931348623157e292,Z[v>>3]=-17976931348623157e292,m=v+16|0,Z[m>>3]=-17976931348623157e292,(it|0)>0){for(O=s[_+4>>2]|0,Te=17976931348623157e292,ze=-17976931348623157e292,L=0,E=-1,Y=17976931348623157e292,le=17976931348623157e292,Qe=-17976931348623157e292,z=-17976931348623157e292,w=0;F=+Z[O+(w<<4)>>3],pe=+Z[O+(w<<4)+8>>3],c=E+2|0,Q=+Z[O+(((c|0)==(it|0)?0:c)<<4)+8>>3],F<Y&&(Z[M>>3]=F,Y=F),pe<le&&(Z[a>>3]=pe,le=pe),F>Qe?Z[v>>3]=F:F=Qe,pe>z&&(Z[m>>3]=pe,z=pe),Te=pe>0&pe<Te?pe:Te,ze=pe<0&pe>ze?pe:ze,L=L|+kt(+(pe-Q))>3.141592653589793,E=w+1|0,(E|0)!=(it|0);)c=w,Qe=F,w=E,E=c;L&&(Z[m>>3]=ze,Z[a>>3]=Te)}}else s[v>>2]=0,s[v+4>>2]=0,s[v+8>>2]=0,s[v+12>>2]=0,s[v+16>>2]=0,s[v+20>>2]=0,s[v+24>>2]=0,s[v+28>>2]=0;if(c=_+8|0,E=s[c>>2]|0,!((E|0)<=0)){u=_+12|0,I=0;do if(O=s[u>>2]|0,L=I,I=I+1|0,a=v+(I<<5)|0,m=s[O+(L<<3)>>2]|0,m){if(w=v+(I<<5)+8|0,Z[w>>3]=17976931348623157e292,_=v+(I<<5)+24|0,Z[_>>3]=17976931348623157e292,Z[a>>3]=-17976931348623157e292,T=v+(I<<5)+16|0,Z[T>>3]=-17976931348623157e292,(m|0)>0){for(it=s[O+(L<<3)+4>>2]|0,Te=17976931348623157e292,ze=-17976931348623157e292,O=0,L=-1,M=0,Y=17976931348623157e292,le=17976931348623157e292,pe=-17976931348623157e292,z=-17976931348623157e292;F=+Z[it+(M<<4)>>3],Qe=+Z[it+(M<<4)+8>>3],L=L+2|0,Q=+Z[it+(((L|0)==(m|0)?0:L)<<4)+8>>3],F<Y&&(Z[w>>3]=F,Y=F),Qe<le&&(Z[_>>3]=Qe,le=Qe),F>pe?Z[a>>3]=F:F=pe,Qe>z&&(Z[T>>3]=Qe,z=Qe),Te=Qe>0&Qe<Te?Qe:Te,ze=Qe<0&Qe>ze?Qe:ze,O=O|+kt(+(Qe-Q))>3.141592653589793,L=M+1|0,(L|0)!=(m|0);)f=M,M=L,pe=F,L=f;O&&(Z[T>>3]=ze,Z[_>>3]=Te)}}else s[a>>2]=0,s[a+4>>2]=0,s[a+8>>2]=0,s[a+12>>2]=0,s[a+16>>2]=0,s[a+20>>2]=0,s[a+24>>2]=0,s[a+28>>2]=0,E=s[c>>2]|0;while((I|0)<(E|0))}}function Qa(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0;if(!(EA(_,v,E)|0))return O=0,O|0;if(O=_+8|0,(s[O>>2]|0)<=0)return O=1,O|0;for(L=_+12|0,_=0;;){if(F=_,_=_+1|0,EA((s[L>>2]|0)+(F<<3)|0,v+(_<<5)|0,E)|0){_=0,L=6;break}if((_|0)>=(s[O>>2]|0)){_=1,L=6;break}}return(L|0)==6?_|0:0}function SA(){return 8}function Fl(){return 16}function bc(){return 168}function Mu(){return 8}function Nl(){return 16}function ps(){return 12}function rl(){return 8}function sl(_){_=_|0;var v=0,E=0;return E=+Z[_>>3],v=+Z[_+8>>3],+ +yt(+(E*E+v*v))}function wr(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0;le=+Z[_>>3],Y=+Z[v>>3]-le,Q=+Z[_+8>>3],z=+Z[v+8>>3]-Q,Qe=+Z[E>>3],F=+Z[L>>3]-Qe,Te=+Z[E+8>>3],pe=+Z[L+8>>3]-Te,F=(F*(Q-Te)-(le-Qe)*pe)/(Y*pe-z*F),Z[O>>3]=le+Y*F,Z[O+8>>3]=Q+z*F}function co(_,v){return _=_|0,v=v|0,+Z[_>>3]!=+Z[v>>3]?(v=0,v|0):(v=+Z[_+8>>3]==+Z[v+8>>3],v|0)}function yi(_,v){_=_|0,v=v|0;var E=0,L=0,O=0;return O=+Z[_>>3]-+Z[v>>3],L=+Z[_+8>>3]-+Z[v+8>>3],E=+Z[_+16>>3]-+Z[v+16>>3],+(O*O+L*L+E*E)}function Ul(_,v){_=_|0,v=v|0;var E=0,L=0,O=0;E=+Z[_>>3],L=+Qt(+E),E=+Vt(+E),Z[v+16>>3]=E,E=+Z[_+8>>3],O=L*+Qt(+E),Z[v>>3]=O,E=L*+Vt(+E),Z[v+8>>3]=E}function Vl(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0;if(le=De,De=De+32|0,O=le+16|0,F=le,ko(_,v,O),z=ja(_,v)|0,Y=dr(_,v)|0,zr(z,F),v=aA(z,s[O>>2]|0)|0,!(wn(z)|0))return Y=v,De=le,Y|0;do switch(z|0){case 4:{_=0,E=14;break}case 14:{_=1,E=14;break}case 24:{_=2,E=14;break}case 38:{_=3,E=14;break}case 49:{_=4,E=14;break}case 58:{_=5,E=14;break}case 63:{_=6,E=14;break}case 72:{_=7,E=14;break}case 83:{_=8,E=14;break}case 97:{_=9,E=14;break}case 107:{_=10,E=14;break}case 117:{_=11,E=14;break}default:Q=0,L=0}while(0);return(E|0)==14&&(Q=s[22096+(_*24|0)+8>>2]|0,L=s[22096+(_*24|0)+16>>2]|0),_=s[O>>2]|0,(_|0)!=(s[F>>2]|0)&&(z=Li(z)|0,_=s[O>>2]|0,z|(_|0)==(L|0)&&(v=(v+1|0)%6|0)),(Y|0)==3&(_|0)==(L|0)?(Y=(v+5|0)%6|0,De=le,Y|0):(Y|0)==5&(_|0)==(Q|0)?(Y=(v+1|0)%6|0,De=le,Y|0):(Y=v,De=le,Y|0)}function jl(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;return L=Si(_,v)|0,(E+-1|0)>>>0>5||(O=(L|0)!=0,(E|0)==1&O)?(E=-1,E|0):(L=Vl(_,v)|0,O?(E=(5-L+(s[22384+(E<<2)>>2]|0)|0)%5|0,E|0):(E=(6-L+(s[22416+(E<<2)>>2]|0)|0)%6|0,E|0))}function Gl(_,v,E){_=_|0,v=v|0,E=E|0;var L=0;(v|0)>0?(L=Jt(v,4)|0,s[_>>2]=L,L||Ut(23230,23253,40,23267)):s[_>>2]=0,s[_+4>>2]=v,s[_+8>>2]=0,s[_+12>>2]=E}function Xr(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0;O=_+4|0,F=_+12|0,z=_+8|0;e:for(;;){for(E=s[O>>2]|0,v=0;;){if((v|0)>=(E|0))break e;if(L=s[_>>2]|0,Q=s[L+(v<<2)>>2]|0,!Q)v=v+1|0;else break}v=L+(~~(+kt(+(+Pt(10,+ +(15-(s[F>>2]|0)|0))*(+Z[Q>>3]+ +Z[Q+8>>3])))%+(E|0))>>>0<<2)|0,E=s[v>>2]|0;t:do if(E|0){if(L=Q+32|0,(E|0)==(Q|0))s[v>>2]=s[L>>2];else{if(E=E+32|0,v=s[E>>2]|0,!v)break;for(;(v|0)!=(Q|0);)if(E=v+32|0,v=s[E>>2]|0,!v)break t;s[E>>2]=s[L>>2]}gt(Q),s[z>>2]=(s[z>>2]|0)+-1}while(0)}gt(s[_>>2]|0)}function ci(_){_=_|0;var v=0,E=0,L=0;for(L=s[_+4>>2]|0,E=0;;){if((E|0)>=(L|0)){v=0,E=4;break}if(v=s[(s[_>>2]|0)+(E<<2)>>2]|0,!v)E=E+1|0;else{E=4;break}}return(E|0)==4?v|0:0}function CA(_,v){_=_|0,v=v|0;var E=0,L=0,O=0,F=0;if(E=~~(+kt(+(+Pt(10,+ +(15-(s[_+12>>2]|0)|0))*(+Z[v>>3]+ +Z[v+8>>3])))%+(s[_+4>>2]|0))>>>0,E=(s[_>>2]|0)+(E<<2)|0,L=s[E>>2]|0,!L)return F=1,F|0;F=v+32|0;do if((L|0)!=(v|0)){if(E=s[L+32>>2]|0,!E)return F=1,F|0;for(O=E;;){if((O|0)==(v|0)){O=8;break}if(E=s[O+32>>2]|0,E)L=O,O=E;else{E=1,O=10;break}}if((O|0)==8){s[L+32>>2]=s[F>>2];break}else if((O|0)==10)return E|0}else s[E>>2]=s[F>>2];while(0);return gt(v),F=_+8|0,s[F>>2]=(s[F>>2]|0)+-1,F=0,F|0}function Ha(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0;F=Wi(40)|0,F||Ut(23283,23253,98,23296),s[F>>2]=s[v>>2],s[F+4>>2]=s[v+4>>2],s[F+8>>2]=s[v+8>>2],s[F+12>>2]=s[v+12>>2],O=F+16|0,s[O>>2]=s[E>>2],s[O+4>>2]=s[E+4>>2],s[O+8>>2]=s[E+8>>2],s[O+12>>2]=s[E+12>>2],s[F+32>>2]=0,O=~~(+kt(+(+Pt(10,+ +(15-(s[_+12>>2]|0)|0))*(+Z[v>>3]+ +Z[v+8>>3])))%+(s[_+4>>2]|0))>>>0,O=(s[_>>2]|0)+(O<<2)|0,L=s[O>>2]|0;do if(!L)s[O>>2]=F;else{for(;!(Gs(L,v)|0&&Gs(L+16|0,E)|0);)if(O=s[L+32>>2]|0,L=O|0?O:L,!(s[L+32>>2]|0)){z=10;break}if((z|0)==10){s[L+32>>2]=F;break}return gt(F),z=L,z|0}while(0);return z=_+8|0,s[z>>2]=(s[z>>2]|0)+1,z=F,z|0}function Ql(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0;if(O=~~(+kt(+(+Pt(10,+ +(15-(s[_+12>>2]|0)|0))*(+Z[v>>3]+ +Z[v+8>>3])))%+(s[_+4>>2]|0))>>>0,O=s[(s[_>>2]|0)+(O<<2)>>2]|0,!O)return E=0,E|0;if(!E){for(_=O;;){if(Gs(_,v)|0){L=10;break}if(_=s[_+32>>2]|0,!_){_=0,L=10;break}}if((L|0)==10)return _|0}for(_=O;;){if(Gs(_,v)|0&&Gs(_+16|0,E)|0){L=10;break}if(_=s[_+32>>2]|0,!_){_=0,L=10;break}}return(L|0)==10?_|0:0}function PA(_,v){_=_|0,v=v|0;var E=0;if(E=~~(+kt(+(+Pt(10,+ +(15-(s[_+12>>2]|0)|0))*(+Z[v>>3]+ +Z[v+8>>3])))%+(s[_+4>>2]|0))>>>0,_=s[(s[_>>2]|0)+(E<<2)>>2]|0,!_)return E=0,E|0;for(;;){if(Gs(_,v)|0){v=5;break}if(_=s[_+32>>2]|0,!_){_=0,v=5;break}}return(v|0)==5?_|0:0}function Ci(){return 23312}function Ec(_){return _=+_,+ +Bi(+_)}function jr(_){return _=+_,~~+Ec(_)|0}function Wi(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0,M=0,a=0,m=0,w=0,T=0,I=0,u=0;u=De,De=De+16|0,Te=u;do if(_>>>0<245){if(le=_>>>0<11?16:_+11&-8,_=le>>>3,Qe=s[5829]|0,E=Qe>>>_,E&3|0)return v=(E&1^1)+_|0,_=23356+(v<<1<<2)|0,E=_+8|0,L=s[E>>2]|0,O=L+8|0,F=s[O>>2]|0,(F|0)==(_|0)?s[5829]=Qe&~(1<<v):(s[F+12>>2]=_,s[E>>2]=F),I=v<<3,s[L+4>>2]=I|3,I=L+I+4|0,s[I>>2]=s[I>>2]|1,I=O,De=u,I|0;if(pe=s[5831]|0,le>>>0>pe>>>0){if(E|0)return v=2<<_,v=E<<_&(v|0-v),v=(v&0-v)+-1|0,Q=v>>>12&16,v=v>>>Q,E=v>>>5&8,v=v>>>E,F=v>>>2&4,v=v>>>F,_=v>>>1&2,v=v>>>_,L=v>>>1&1,L=(E|Q|F|_|L)+(v>>>L)|0,v=23356+(L<<1<<2)|0,_=v+8|0,F=s[_>>2]|0,Q=F+8|0,E=s[Q>>2]|0,(E|0)==(v|0)?(_=Qe&~(1<<L),s[5829]=_):(s[E+12>>2]=v,s[_>>2]=E,_=Qe),I=L<<3,z=I-le|0,s[F+4>>2]=le|3,O=F+le|0,s[O+4>>2]=z|1,s[F+I>>2]=z,pe|0&&(L=s[5834]|0,v=pe>>>3,E=23356+(v<<1<<2)|0,v=1<<v,_&v?(_=E+8|0,v=s[_>>2]|0):(s[5829]=_|v,v=E,_=E+8|0),s[_>>2]=L,s[v+12>>2]=L,s[L+8>>2]=v,s[L+12>>2]=E),s[5831]=z,s[5834]=O,I=Q,De=u,I|0;if(F=s[5830]|0,F){for(E=(F&0-F)+-1|0,O=E>>>12&16,E=E>>>O,L=E>>>5&8,E=E>>>L,z=E>>>2&4,E=E>>>z,Q=E>>>1&2,E=E>>>Q,Y=E>>>1&1,Y=s[23620+((L|O|z|Q|Y)+(E>>>Y)<<2)>>2]|0,E=Y,Q=Y,Y=(s[Y+4>>2]&-8)-le|0;_=s[E+16>>2]|0,!(!_&&(_=s[E+20>>2]|0,!_));)z=(s[_+4>>2]&-8)-le|0,O=z>>>0<Y>>>0,E=_,Q=O?_:Q,Y=O?z:Y;if(z=Q+le|0,z>>>0>Q>>>0){O=s[Q+24>>2]|0,v=s[Q+12>>2]|0;do if((v|0)==(Q|0)){if(_=Q+20|0,v=s[_>>2]|0,!v&&(_=Q+16|0,v=s[_>>2]|0,!v)){E=0;break}for(;;)if(L=v+20|0,E=s[L>>2]|0,E)v=E,_=L;else if(L=v+16|0,E=s[L>>2]|0,E)v=E,_=L;else break;s[_>>2]=0,E=v}else E=s[Q+8>>2]|0,s[E+12>>2]=v,s[v+8>>2]=E,E=v;while(0);do if(O|0){if(v=s[Q+28>>2]|0,_=23620+(v<<2)|0,(Q|0)==(s[_>>2]|0)){if(s[_>>2]=E,!E){s[5830]=F&~(1<<v);break}}else if(I=O+16|0,s[((s[I>>2]|0)==(Q|0)?I:O+20|0)>>2]=E,!E)break;s[E+24>>2]=O,v=s[Q+16>>2]|0,v|0&&(s[E+16>>2]=v,s[v+24>>2]=E),v=s[Q+20>>2]|0,v|0&&(s[E+20>>2]=v,s[v+24>>2]=E)}while(0);return Y>>>0<16?(I=Y+le|0,s[Q+4>>2]=I|3,I=Q+I+4|0,s[I>>2]=s[I>>2]|1):(s[Q+4>>2]=le|3,s[z+4>>2]=Y|1,s[z+Y>>2]=Y,pe|0&&(L=s[5834]|0,v=pe>>>3,E=23356+(v<<1<<2)|0,v=1<<v,v&Qe?(_=E+8|0,v=s[_>>2]|0):(s[5829]=v|Qe,v=E,_=E+8|0),s[_>>2]=L,s[v+12>>2]=L,s[L+8>>2]=v,s[L+12>>2]=E),s[5831]=Y,s[5834]=z),I=Q+8|0,De=u,I|0}else Qe=le}else Qe=le}else Qe=le}else if(_>>>0<=4294967231)if(_=_+11|0,le=_&-8,L=s[5830]|0,L){O=0-le|0,_=_>>>8,_?le>>>0>16777215?Y=31:(Qe=(_+1048320|0)>>>16&8,M=_<<Qe,Q=(M+520192|0)>>>16&4,M=M<<Q,Y=(M+245760|0)>>>16&2,Y=14-(Q|Qe|Y)+(M<<Y>>>15)|0,Y=le>>>(Y+7|0)&1|Y<<1):Y=0,E=s[23620+(Y<<2)>>2]|0;e:do if(!E)E=0,_=0,M=61;else for(_=0,Q=le<<((Y|0)==31?0:25-(Y>>>1)|0),F=0;;){if(z=(s[E+4>>2]&-8)-le|0,z>>>0<O>>>0)if(z)_=E,O=z;else{_=E,O=0,M=65;break e}if(M=s[E+20>>2]|0,E=s[E+16+(Q>>>31<<2)>>2]|0,F=(M|0)==0|(M|0)==(E|0)?F:M,E)Q=Q<<1;else{E=F,M=61;break}}while(0);if((M|0)==61){if((E|0)==0&(_|0)==0){if(_=2<<Y,_=(_|0-_)&L,!_){Qe=le;break}Qe=(_&0-_)+-1|0,z=Qe>>>12&16,Qe=Qe>>>z,F=Qe>>>5&8,Qe=Qe>>>F,Q=Qe>>>2&4,Qe=Qe>>>Q,Y=Qe>>>1&2,Qe=Qe>>>Y,E=Qe>>>1&1,_=0,E=s[23620+((F|z|Q|Y|E)+(Qe>>>E)<<2)>>2]|0}E?M=65:(Q=_,z=O)}if((M|0)==65)for(F=E;;)if(Qe=(s[F+4>>2]&-8)-le|0,E=Qe>>>0<O>>>0,O=E?Qe:O,_=E?F:_,E=s[F+16>>2]|0,E||(E=s[F+20>>2]|0),E)F=E;else{Q=_,z=O;break}if(Q|0&&z>>>0<((s[5831]|0)-le|0)>>>0&&(pe=Q+le|0,pe>>>0>Q>>>0)){F=s[Q+24>>2]|0,v=s[Q+12>>2]|0;do if((v|0)==(Q|0)){if(_=Q+20|0,v=s[_>>2]|0,!v&&(_=Q+16|0,v=s[_>>2]|0,!v)){v=0;break}for(;;)if(O=v+20|0,E=s[O>>2]|0,E)v=E,_=O;else if(O=v+16|0,E=s[O>>2]|0,E)v=E,_=O;else break;s[_>>2]=0}else I=s[Q+8>>2]|0,s[I+12>>2]=v,s[v+8>>2]=I;while(0);do if(F){if(_=s[Q+28>>2]|0,E=23620+(_<<2)|0,(Q|0)==(s[E>>2]|0)){if(s[E>>2]=v,!v){L=L&~(1<<_),s[5830]=L;break}}else if(I=F+16|0,s[((s[I>>2]|0)==(Q|0)?I:F+20|0)>>2]=v,!v)break;s[v+24>>2]=F,_=s[Q+16>>2]|0,_|0&&(s[v+16>>2]=_,s[_+24>>2]=v),_=s[Q+20>>2]|0,_&&(s[v+20>>2]=_,s[_+24>>2]=v)}while(0);e:do if(z>>>0<16)I=z+le|0,s[Q+4>>2]=I|3,I=Q+I+4|0,s[I>>2]=s[I>>2]|1;else{if(s[Q+4>>2]=le|3,s[pe+4>>2]=z|1,s[pe+z>>2]=z,v=z>>>3,z>>>0<256){E=23356+(v<<1<<2)|0,_=s[5829]|0,v=1<<v,_&v?(_=E+8|0,v=s[_>>2]|0):(s[5829]=_|v,v=E,_=E+8|0),s[_>>2]=pe,s[v+12>>2]=pe,s[pe+8>>2]=v,s[pe+12>>2]=E;break}if(v=z>>>8,v?z>>>0>16777215?E=31:(T=(v+1048320|0)>>>16&8,I=v<<T,w=(I+520192|0)>>>16&4,I=I<<w,E=(I+245760|0)>>>16&2,E=14-(w|T|E)+(I<<E>>>15)|0,E=z>>>(E+7|0)&1|E<<1):E=0,v=23620+(E<<2)|0,s[pe+28>>2]=E,_=pe+16|0,s[_+4>>2]=0,s[_>>2]=0,_=1<<E,!(L&_)){s[5830]=L|_,s[v>>2]=pe,s[pe+24>>2]=v,s[pe+12>>2]=pe,s[pe+8>>2]=pe;break}v=s[v>>2]|0;t:do if((s[v+4>>2]&-8|0)!=(z|0)){for(L=z<<((E|0)==31?0:25-(E>>>1)|0);E=v+16+(L>>>31<<2)|0,_=s[E>>2]|0,!!_;)if((s[_+4>>2]&-8|0)==(z|0)){v=_;break t}else L=L<<1,v=_;s[E>>2]=pe,s[pe+24>>2]=v,s[pe+12>>2]=pe,s[pe+8>>2]=pe;break e}while(0);T=v+8|0,I=s[T>>2]|0,s[I+12>>2]=pe,s[T>>2]=pe,s[pe+8>>2]=I,s[pe+12>>2]=v,s[pe+24>>2]=0}while(0);return I=Q+8|0,De=u,I|0}else Qe=le}else Qe=le;else Qe=-1;while(0);if(E=s[5831]|0,E>>>0>=Qe>>>0)return v=E-Qe|0,_=s[5834]|0,v>>>0>15?(I=_+Qe|0,s[5834]=I,s[5831]=v,s[I+4>>2]=v|1,s[_+E>>2]=v,s[_+4>>2]=Qe|3):(s[5831]=0,s[5834]=0,s[_+4>>2]=E|3,I=_+E+4|0,s[I>>2]=s[I>>2]|1),I=_+8|0,De=u,I|0;if(z=s[5832]|0,z>>>0>Qe>>>0)return w=z-Qe|0,s[5832]=w,I=s[5835]|0,T=I+Qe|0,s[5835]=T,s[T+4>>2]=w|1,s[I+4>>2]=Qe|3,I=I+8|0,De=u,I|0;if(s[5947]|0?_=s[5949]|0:(s[5949]=4096,s[5948]=4096,s[5950]=-1,s[5951]=-1,s[5952]=0,s[5940]=0,s[5947]=Te&-16^1431655768,_=4096),Q=Qe+48|0,Y=Qe+47|0,F=_+Y|0,O=0-_|0,le=F&O,le>>>0<=Qe>>>0||(_=s[5939]|0,_|0&&(pe=s[5937]|0,Te=pe+le|0,Te>>>0<=pe>>>0|Te>>>0>_>>>0)))return I=0,De=u,I|0;e:do if(s[5940]&4)v=0,M=143;else{E=s[5835]|0;t:do if(E){for(L=23764;Te=s[L>>2]|0,!(Te>>>0<=E>>>0&&(Te+(s[L+4>>2]|0)|0)>>>0>E>>>0);)if(_=s[L+8>>2]|0,_)L=_;else{M=128;break t}if(v=F-z&O,v>>>0<2147483647)if(_=Pi(v|0)|0,(_|0)==((s[L>>2]|0)+(s[L+4>>2]|0)|0)){if((_|0)!=-1){z=v,F=_,M=145;break e}}else L=_,M=136;else v=0}else M=128;while(0);do if((M|0)==128)if(E=Pi(0)|0,(E|0)!=-1&&(v=E,ze=s[5948]|0,it=ze+-1|0,v=(it&v|0?(it+v&0-ze)-v|0:0)+le|0,ze=s[5937]|0,it=v+ze|0,v>>>0>Qe>>>0&v>>>0<2147483647)){if(Te=s[5939]|0,Te|0&&it>>>0<=ze>>>0|it>>>0>Te>>>0){v=0;break}if(_=Pi(v|0)|0,(_|0)==(E|0)){z=v,F=E,M=145;break e}else L=_,M=136}else v=0;while(0);do if((M|0)==136){if(E=0-v|0,!(Q>>>0>v>>>0&(v>>>0<2147483647&(L|0)!=-1)))if((L|0)==-1){v=0;break}else{z=v,F=L,M=145;break e}if(_=s[5949]|0,_=Y-v+_&0-_,_>>>0>=2147483647){z=v,F=L,M=145;break e}if((Pi(_|0)|0)==-1){Pi(E|0)|0,v=0;break}else{z=_+v|0,F=L,M=145;break e}}while(0);s[5940]=s[5940]|4,M=143}while(0);if((M|0)==143&&le>>>0<2147483647&&(w=Pi(le|0)|0,it=Pi(0)|0,a=it-w|0,m=a>>>0>(Qe+40|0)>>>0,!((w|0)==-1|m^1|w>>>0<it>>>0&((w|0)!=-1&(it|0)!=-1)^1))&&(z=m?a:v,F=w,M=145),(M|0)==145){v=(s[5937]|0)+z|0,s[5937]=v,v>>>0>(s[5938]|0)>>>0&&(s[5938]=v),Y=s[5835]|0;e:do if(Y){for(v=23764;;){if(_=s[v>>2]|0,E=s[v+4>>2]|0,(F|0)==(_+E|0)){M=154;break}if(L=s[v+8>>2]|0,L)v=L;else break}if((M|0)==154&&(T=v+4|0,(s[v+12>>2]&8|0)==0)&&F>>>0>Y>>>0&_>>>0<=Y>>>0){s[T>>2]=E+z,I=(s[5832]|0)+z|0,w=Y+8|0,w=w&7|0?0-w&7:0,T=Y+w|0,w=I-w|0,s[5835]=T,s[5832]=w,s[T+4>>2]=w|1,s[Y+I+4>>2]=40,s[5836]=s[5951];break}for(F>>>0<(s[5833]|0)>>>0&&(s[5833]=F),E=F+z|0,v=23764;;){if((s[v>>2]|0)==(E|0)){M=162;break}if(_=s[v+8>>2]|0,_)v=_;else break}if((M|0)==162&&!(s[v+12>>2]&8|0)){s[v>>2]=F,pe=v+4|0,s[pe>>2]=(s[pe>>2]|0)+z,pe=F+8|0,pe=F+(pe&7|0?0-pe&7:0)|0,v=E+8|0,v=E+(v&7|0?0-v&7:0)|0,le=pe+Qe|0,Q=v-pe-Qe|0,s[pe+4>>2]=Qe|3;t:do if((Y|0)==(v|0))I=(s[5832]|0)+Q|0,s[5832]=I,s[5835]=le,s[le+4>>2]=I|1;else{if((s[5834]|0)==(v|0)){I=(s[5831]|0)+Q|0,s[5831]=I,s[5834]=le,s[le+4>>2]=I|1,s[le+I>>2]=I;break}if(_=s[v+4>>2]|0,(_&3|0)==1){z=_&-8,L=_>>>3;n:do if(_>>>0<256)if(_=s[v+8>>2]|0,E=s[v+12>>2]|0,(E|0)==(_|0)){s[5829]=s[5829]&~(1<<L);break}else{s[_+12>>2]=E,s[E+8>>2]=_;break}else{F=s[v+24>>2]|0,_=s[v+12>>2]|0;do if((_|0)==(v|0)){if(E=v+16|0,L=E+4|0,_=s[L>>2]|0,_)E=L;else if(_=s[E>>2]|0,!_){_=0;break}for(;;)if(O=_+20|0,L=s[O>>2]|0,L)_=L,E=O;else if(O=_+16|0,L=s[O>>2]|0,L)_=L,E=O;else break;s[E>>2]=0}else I=s[v+8>>2]|0,s[I+12>>2]=_,s[_+8>>2]=I;while(0);if(!F)break;E=s[v+28>>2]|0,L=23620+(E<<2)|0;do if((s[L>>2]|0)!=(v|0)){if(I=F+16|0,s[((s[I>>2]|0)==(v|0)?I:F+20|0)>>2]=_,!_)break n}else{if(s[L>>2]=_,_|0)break;s[5830]=s[5830]&~(1<<E);break n}while(0);if(s[_+24>>2]=F,E=v+16|0,L=s[E>>2]|0,L|0&&(s[_+16>>2]=L,s[L+24>>2]=_),E=s[E+4>>2]|0,!E)break;s[_+20>>2]=E,s[E+24>>2]=_}while(0);v=v+z|0,O=z+Q|0}else O=Q;if(v=v+4|0,s[v>>2]=s[v>>2]&-2,s[le+4>>2]=O|1,s[le+O>>2]=O,v=O>>>3,O>>>0<256){E=23356+(v<<1<<2)|0,_=s[5829]|0,v=1<<v,_&v?(_=E+8|0,v=s[_>>2]|0):(s[5829]=_|v,v=E,_=E+8|0),s[_>>2]=le,s[v+12>>2]=le,s[le+8>>2]=v,s[le+12>>2]=E;break}v=O>>>8;do if(!v)L=0;else{if(O>>>0>16777215){L=31;break}T=(v+1048320|0)>>>16&8,I=v<<T,w=(I+520192|0)>>>16&4,I=I<<w,L=(I+245760|0)>>>16&2,L=14-(w|T|L)+(I<<L>>>15)|0,L=O>>>(L+7|0)&1|L<<1}while(0);if(v=23620+(L<<2)|0,s[le+28>>2]=L,_=le+16|0,s[_+4>>2]=0,s[_>>2]=0,_=s[5830]|0,E=1<<L,!(_&E)){s[5830]=_|E,s[v>>2]=le,s[le+24>>2]=v,s[le+12>>2]=le,s[le+8>>2]=le;break}v=s[v>>2]|0;n:do if((s[v+4>>2]&-8|0)!=(O|0)){for(L=O<<((L|0)==31?0:25-(L>>>1)|0);E=v+16+(L>>>31<<2)|0,_=s[E>>2]|0,!!_;)if((s[_+4>>2]&-8|0)==(O|0)){v=_;break n}else L=L<<1,v=_;s[E>>2]=le,s[le+24>>2]=v,s[le+12>>2]=le,s[le+8>>2]=le;break t}while(0);T=v+8|0,I=s[T>>2]|0,s[I+12>>2]=le,s[T>>2]=le,s[le+8>>2]=I,s[le+12>>2]=v,s[le+24>>2]=0}while(0);return I=pe+8|0,De=u,I|0}for(v=23764;_=s[v>>2]|0,!(_>>>0<=Y>>>0&&(I=_+(s[v+4>>2]|0)|0,I>>>0>Y>>>0));)v=s[v+8>>2]|0;O=I+-47|0,_=O+8|0,_=O+(_&7|0?0-_&7:0)|0,O=Y+16|0,_=_>>>0<O>>>0?Y:_,v=_+8|0,E=z+-40|0,w=F+8|0,w=w&7|0?0-w&7:0,T=F+w|0,w=E-w|0,s[5835]=T,s[5832]=w,s[T+4>>2]=w|1,s[F+E+4>>2]=40,s[5836]=s[5951],E=_+4|0,s[E>>2]=27,s[v>>2]=s[5941],s[v+4>>2]=s[5942],s[v+8>>2]=s[5943],s[v+12>>2]=s[5944],s[5941]=F,s[5942]=z,s[5944]=0,s[5943]=v,v=_+24|0;do T=v,v=v+4|0,s[v>>2]=7;while((T+8|0)>>>0<I>>>0);if((_|0)!=(Y|0)){if(F=_-Y|0,s[E>>2]=s[E>>2]&-2,s[Y+4>>2]=F|1,s[_>>2]=F,v=F>>>3,F>>>0<256){E=23356+(v<<1<<2)|0,_=s[5829]|0,v=1<<v,_&v?(_=E+8|0,v=s[_>>2]|0):(s[5829]=_|v,v=E,_=E+8|0),s[_>>2]=Y,s[v+12>>2]=Y,s[Y+8>>2]=v,s[Y+12>>2]=E;break}if(v=F>>>8,v?F>>>0>16777215?L=31:(T=(v+1048320|0)>>>16&8,I=v<<T,w=(I+520192|0)>>>16&4,I=I<<w,L=(I+245760|0)>>>16&2,L=14-(w|T|L)+(I<<L>>>15)|0,L=F>>>(L+7|0)&1|L<<1):L=0,E=23620+(L<<2)|0,s[Y+28>>2]=L,s[Y+20>>2]=0,s[O>>2]=0,v=s[5830]|0,_=1<<L,!(v&_)){s[5830]=v|_,s[E>>2]=Y,s[Y+24>>2]=E,s[Y+12>>2]=Y,s[Y+8>>2]=Y;break}v=s[E>>2]|0;t:do if((s[v+4>>2]&-8|0)!=(F|0)){for(L=F<<((L|0)==31?0:25-(L>>>1)|0);E=v+16+(L>>>31<<2)|0,_=s[E>>2]|0,!!_;)if((s[_+4>>2]&-8|0)==(F|0)){v=_;break t}else L=L<<1,v=_;s[E>>2]=Y,s[Y+24>>2]=v,s[Y+12>>2]=Y,s[Y+8>>2]=Y;break e}while(0);T=v+8|0,I=s[T>>2]|0,s[I+12>>2]=Y,s[T>>2]=Y,s[Y+8>>2]=I,s[Y+12>>2]=v,s[Y+24>>2]=0}}else I=s[5833]|0,(I|0)==0|F>>>0<I>>>0&&(s[5833]=F),s[5941]=F,s[5942]=z,s[5944]=0,s[5838]=s[5947],s[5837]=-1,s[5842]=23356,s[5841]=23356,s[5844]=23364,s[5843]=23364,s[5846]=23372,s[5845]=23372,s[5848]=23380,s[5847]=23380,s[5850]=23388,s[5849]=23388,s[5852]=23396,s[5851]=23396,s[5854]=23404,s[5853]=23404,s[5856]=23412,s[5855]=23412,s[5858]=23420,s[5857]=23420,s[5860]=23428,s[5859]=23428,s[5862]=23436,s[5861]=23436,s[5864]=23444,s[5863]=23444,s[5866]=23452,s[5865]=23452,s[5868]=23460,s[5867]=23460,s[5870]=23468,s[5869]=23468,s[5872]=23476,s[5871]=23476,s[5874]=23484,s[5873]=23484,s[5876]=23492,s[5875]=23492,s[5878]=23500,s[5877]=23500,s[5880]=23508,s[5879]=23508,s[5882]=23516,s[5881]=23516,s[5884]=23524,s[5883]=23524,s[5886]=23532,s[5885]=23532,s[5888]=23540,s[5887]=23540,s[5890]=23548,s[5889]=23548,s[5892]=23556,s[5891]=23556,s[5894]=23564,s[5893]=23564,s[5896]=23572,s[5895]=23572,s[5898]=23580,s[5897]=23580,s[5900]=23588,s[5899]=23588,s[5902]=23596,s[5901]=23596,s[5904]=23604,s[5903]=23604,I=z+-40|0,w=F+8|0,w=w&7|0?0-w&7:0,T=F+w|0,w=I-w|0,s[5835]=T,s[5832]=w,s[T+4>>2]=w|1,s[F+I+4>>2]=40,s[5836]=s[5951];while(0);if(v=s[5832]|0,v>>>0>Qe>>>0)return w=v-Qe|0,s[5832]=w,I=s[5835]|0,T=I+Qe|0,s[5835]=T,s[T+4>>2]=w|1,s[I+4>>2]=Qe|3,I=I+8|0,De=u,I|0}return I=Ci()|0,s[I>>2]=12,I=0,De=u,I|0}function gt(_){_=_|0;var v=0,E=0,L=0,O=0,F=0,z=0,Q=0,Y=0;if(_){E=_+-8|0,O=s[5833]|0,_=s[_+-4>>2]|0,v=_&-8,Y=E+v|0;do if(_&1)Q=E,z=E;else{if(L=s[E>>2]|0,!(_&3)||(z=E+(0-L)|0,F=L+v|0,z>>>0<O>>>0))return;if((s[5834]|0)==(z|0)){if(_=Y+4|0,v=s[_>>2]|0,(v&3|0)!=3){Q=z,v=F;break}s[5831]=F,s[_>>2]=v&-2,s[z+4>>2]=F|1,s[z+F>>2]=F;return}if(E=L>>>3,L>>>0<256)if(_=s[z+8>>2]|0,v=s[z+12>>2]|0,(v|0)==(_|0)){s[5829]=s[5829]&~(1<<E),Q=z,v=F;break}else{s[_+12>>2]=v,s[v+8>>2]=_,Q=z,v=F;break}O=s[z+24>>2]|0,_=s[z+12>>2]|0;do if((_|0)==(z|0)){if(v=z+16|0,E=v+4|0,_=s[E>>2]|0,_)v=E;else if(_=s[v>>2]|0,!_){_=0;break}for(;;)if(L=_+20|0,E=s[L>>2]|0,E)_=E,v=L;else if(L=_+16|0,E=s[L>>2]|0,E)_=E,v=L;else break;s[v>>2]=0}else Q=s[z+8>>2]|0,s[Q+12>>2]=_,s[_+8>>2]=Q;while(0);if(O){if(v=s[z+28>>2]|0,E=23620+(v<<2)|0,(s[E>>2]|0)==(z|0)){if(s[E>>2]=_,!_){s[5830]=s[5830]&~(1<<v),Q=z,v=F;break}}else if(Q=O+16|0,s[((s[Q>>2]|0)==(z|0)?Q:O+20|0)>>2]=_,!_){Q=z,v=F;break}s[_+24>>2]=O,v=z+16|0,E=s[v>>2]|0,E|0&&(s[_+16>>2]=E,s[E+24>>2]=_),v=s[v+4>>2]|0,v?(s[_+20>>2]=v,s[v+24>>2]=_,Q=z,v=F):(Q=z,v=F)}else Q=z,v=F}while(0);if(!(z>>>0>=Y>>>0)&&(_=Y+4|0,L=s[_>>2]|0,!!(L&1))){if(L&2)s[_>>2]=L&-2,s[Q+4>>2]=v|1,s[z+v>>2]=v,O=v;else{if((s[5835]|0)==(Y|0)){if(Y=(s[5832]|0)+v|0,s[5832]=Y,s[5835]=Q,s[Q+4>>2]=Y|1,(Q|0)!=(s[5834]|0))return;s[5834]=0,s[5831]=0;return}if((s[5834]|0)==(Y|0)){Y=(s[5831]|0)+v|0,s[5831]=Y,s[5834]=z,s[Q+4>>2]=Y|1,s[z+Y>>2]=Y;return}O=(L&-8)+v|0,E=L>>>3;do if(L>>>0<256)if(v=s[Y+8>>2]|0,_=s[Y+12>>2]|0,(_|0)==(v|0)){s[5829]=s[5829]&~(1<<E);break}else{s[v+12>>2]=_,s[_+8>>2]=v;break}else{F=s[Y+24>>2]|0,_=s[Y+12>>2]|0;do if((_|0)==(Y|0)){if(v=Y+16|0,E=v+4|0,_=s[E>>2]|0,_)v=E;else if(_=s[v>>2]|0,!_){E=0;break}for(;;)if(L=_+20|0,E=s[L>>2]|0,E)_=E,v=L;else if(L=_+16|0,E=s[L>>2]|0,E)_=E,v=L;else break;s[v>>2]=0,E=_}else E=s[Y+8>>2]|0,s[E+12>>2]=_,s[_+8>>2]=E,E=_;while(0);if(F|0){if(_=s[Y+28>>2]|0,v=23620+(_<<2)|0,(s[v>>2]|0)==(Y|0)){if(s[v>>2]=E,!E){s[5830]=s[5830]&~(1<<_);break}}else if(L=F+16|0,s[((s[L>>2]|0)==(Y|0)?L:F+20|0)>>2]=E,!E)break;s[E+24>>2]=F,_=Y+16|0,v=s[_>>2]|0,v|0&&(s[E+16>>2]=v,s[v+24>>2]=E),_=s[_+4>>2]|0,_|0&&(s[E+20>>2]=_,s[_+24>>2]=E)}}while(0);if(s[Q+4>>2]=O|1,s[z+O>>2]=O,(Q|0)==(s[5834]|0)){s[5831]=O;return}}if(_=O>>>3,O>>>0<256){E=23356+(_<<1<<2)|0,v=s[5829]|0,_=1<<_,v&_?(v=E+8|0,_=s[v>>2]|0):(s[5829]=v|_,_=E,v=E+8|0),s[v>>2]=Q,s[_+12>>2]=Q,s[Q+8>>2]=_,s[Q+12>>2]=E;return}_=O>>>8,_?O>>>0>16777215?L=31:(z=(_+1048320|0)>>>16&8,Y=_<<z,F=(Y+520192|0)>>>16&4,Y=Y<<F,L=(Y+245760|0)>>>16&2,L=14-(F|z|L)+(Y<<L>>>15)|0,L=O>>>(L+7|0)&1|L<<1):L=0,_=23620+(L<<2)|0,s[Q+28>>2]=L,s[Q+20>>2]=0,s[Q+16>>2]=0,v=s[5830]|0,E=1<<L;e:do if(!(v&E))s[5830]=v|E,s[_>>2]=Q,s[Q+24>>2]=_,s[Q+12>>2]=Q,s[Q+8>>2]=Q;else{_=s[_>>2]|0;t:do if((s[_+4>>2]&-8|0)!=(O|0)){for(L=O<<((L|0)==31?0:25-(L>>>1)|0);E=_+16+(L>>>31<<2)|0,v=s[E>>2]|0,!!v;)if((s[v+4>>2]&-8|0)==(O|0)){_=v;break t}else L=L<<1,_=v;s[E>>2]=Q,s[Q+24>>2]=_,s[Q+12>>2]=Q,s[Q+8>>2]=Q;break e}while(0);z=_+8|0,Y=s[z>>2]|0,s[Y+12>>2]=Q,s[z>>2]=Q,s[Q+8>>2]=Y,s[Q+12>>2]=_,s[Q+24>>2]=0}while(0);if(Y=(s[5837]|0)+-1|0,s[5837]=Y,!(Y|0)){for(_=23772;_=s[_>>2]|0,_;)_=_+8|0;s[5837]=-1}}}}function Jt(_,v){_=_|0,v=v|0;var E=0;return _?(E=On(v,_)|0,(v|_)>>>0>65535&&(E=((E>>>0)/(_>>>0)|0|0)==(v|0)?E:-1)):E=0,_=Wi(E)|0,!_||!(s[_+-4>>2]&3)||gs(_|0,0,E|0)|0,_|0}function ol(_,v,E,L){return _=_|0,v=v|0,E=E|0,L=L|0,E=_+E>>>0,an(v+L+(E>>>0<_>>>0|0)>>>0|0),E|0|0}function pa(_,v,E,L){return _=_|0,v=v|0,E=E|0,L=L|0,L=v-L-(E>>>0>_>>>0|0)>>>0,an(L|0),_-E>>>0|0|0}function MA(_){return _=_|0,(_?31-(ur(_^_-1)|0)|0:32)|0}function br(_,v,E,L,O){_=_|0,v=v|0,E=E|0,L=L|0,O=O|0;var F=0,z=0,Q=0,Y=0,le=0,pe=0,Qe=0,Te=0,ze=0,it=0;if(pe=_,Y=v,le=Y,z=E,Te=L,Q=Te,!le)return F=(O|0)!=0,Q?F?(s[O>>2]=_|0,s[O+4>>2]=v&0,Te=0,O=0,an(Te|0),O|0):(Te=0,O=0,an(Te|0),O|0):(F&&(s[O>>2]=(pe>>>0)%(z>>>0),s[O+4>>2]=0),Te=0,O=(pe>>>0)/(z>>>0)>>>0,an(Te|0),O|0);F=(Q|0)==0;do if(z){if(!F){if(F=(ur(Q|0)|0)-(ur(le|0)|0)|0,F>>>0<=31){Qe=F+1|0,Q=31-F|0,v=F-31>>31,z=Qe,_=pe>>>(Qe>>>0)&v|le<<Q,v=le>>>(Qe>>>0)&v,F=0,Q=pe<<Q;break}return O?(s[O>>2]=_|0,s[O+4>>2]=Y|v&0,Te=0,O=0,an(Te|0),O|0):(Te=0,O=0,an(Te|0),O|0)}if(F=z-1|0,F&z|0){Q=(ur(z|0)|0)+33-(ur(le|0)|0)|0,it=64-Q|0,Qe=32-Q|0,Y=Qe>>31,ze=Q-32|0,v=ze>>31,z=Q,_=Qe-1>>31&le>>>(ze>>>0)|(le<<Qe|pe>>>(Q>>>0))&v,v=v&le>>>(Q>>>0),F=pe<<it&Y,Q=(le<<it|pe>>>(ze>>>0))&Y|pe<<Qe&Q-33>>31;break}return O|0&&(s[O>>2]=F&pe,s[O+4>>2]=0),(z|0)==1?(ze=Y|v&0,it=_|0|0,an(ze|0),it|0):(it=MA(z|0)|0,ze=le>>>(it>>>0)|0,it=le<<32-it|pe>>>(it>>>0)|0,an(ze|0),it|0)}else{if(F)return O|0&&(s[O>>2]=(le>>>0)%(z>>>0),s[O+4>>2]=0),ze=0,it=(le>>>0)/(z>>>0)>>>0,an(ze|0),it|0;if(!pe)return O|0&&(s[O>>2]=0,s[O+4>>2]=(le>>>0)%(Q>>>0)),ze=0,it=(le>>>0)/(Q>>>0)>>>0,an(ze|0),it|0;if(F=Q-1|0,!(F&Q))return O|0&&(s[O>>2]=_|0,s[O+4>>2]=F&le|v&0),ze=0,it=le>>>((MA(Q|0)|0)>>>0),an(ze|0),it|0;if(F=(ur(Q|0)|0)-(ur(le|0)|0)|0,F>>>0<=30){v=F+1|0,Q=31-F|0,z=v,_=le<<Q|pe>>>(v>>>0),v=le>>>(v>>>0),F=0,Q=pe<<Q;break}return O?(s[O>>2]=_|0,s[O+4>>2]=Y|v&0,ze=0,it=0,an(ze|0),it|0):(ze=0,it=0,an(ze|0),it|0)}while(0);if(!z)le=Q,Y=0,Q=0;else{Qe=E|0|0,pe=Te|L&0,le=ol(Qe|0,pe|0,-1,-1)|0,E=Ve()|0,Y=Q,Q=0;do L=Y,Y=F>>>31|Y<<1,F=Q|F<<1,L=_<<1|L>>>31|0,Te=_>>>31|v<<1|0,pa(le|0,E|0,L|0,Te|0)|0,it=Ve()|0,ze=it>>31|((it|0)<0?-1:0)<<1,Q=ze&1,_=pa(L|0,Te|0,ze&Qe|0,(((it|0)<0?-1:0)>>31|((it|0)<0?-1:0)<<1)&pe|0)|0,v=Ve()|0,z=z-1|0;while(z|0);le=Y,Y=0}return z=0,O|0&&(s[O>>2]=_,s[O+4>>2]=v),ze=(F|0)>>>31|(le|z)<<1|(z<<1|F>>>31)&0|Y,it=(F<<1|0)&-2|Q,an(ze|0),it|0}function Er(_,v,E,L){_=_|0,v=v|0,E=E|0,L=L|0;var O=0,F=0;return F=De,De=De+16|0,O=F|0,br(_,v,E,L,O)|0,De=F,an(s[O+4>>2]|0),s[O>>2]|0|0}function xt(_,v,E){return _=_|0,v=v|0,E=E|0,(E|0)<32?(an(v>>>E|0),_>>>E|(v&(1<<E)-1)<<32-E):(an(0),v>>>E-32|0)}function qt(_,v,E){return _=_|0,v=v|0,E=E|0,(E|0)<32?(an(v<<E|(_&(1<<E)-1<<32-E)>>>32-E|0),_<<E):(an(_<<E-32|0),0)}function Wa(_,v){return _=+_,v=+v,_!=_?+v:v!=v?+_:+qn(+_,+v)}function ai(_){return _=+_,_>=0?+mt(_+.5):+_i(_-.5)}function pi(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0;if((E|0)>=8192)return Ki(_|0,v|0,E|0)|0,_|0;if(F=_|0,O=_+E|0,(_&3)==(v&3)){for(;_&3;){if(!E)return F|0;rt[_>>0]=rt[v>>0]|0,_=_+1|0,v=v+1|0,E=E-1|0}for(E=O&-4|0,L=E-64|0;(_|0)<=(L|0);)s[_>>2]=s[v>>2],s[_+4>>2]=s[v+4>>2],s[_+8>>2]=s[v+8>>2],s[_+12>>2]=s[v+12>>2],s[_+16>>2]=s[v+16>>2],s[_+20>>2]=s[v+20>>2],s[_+24>>2]=s[v+24>>2],s[_+28>>2]=s[v+28>>2],s[_+32>>2]=s[v+32>>2],s[_+36>>2]=s[v+36>>2],s[_+40>>2]=s[v+40>>2],s[_+44>>2]=s[v+44>>2],s[_+48>>2]=s[v+48>>2],s[_+52>>2]=s[v+52>>2],s[_+56>>2]=s[v+56>>2],s[_+60>>2]=s[v+60>>2],_=_+64|0,v=v+64|0;for(;(_|0)<(E|0);)s[_>>2]=s[v>>2],_=_+4|0,v=v+4|0}else for(E=O-4|0;(_|0)<(E|0);)rt[_>>0]=rt[v>>0]|0,rt[_+1>>0]=rt[v+1>>0]|0,rt[_+2>>0]=rt[v+2>>0]|0,rt[_+3>>0]=rt[v+3>>0]|0,_=_+4|0,v=v+4|0;for(;(_|0)<(O|0);)rt[_>>0]=rt[v>>0]|0,_=_+1|0,v=v+1|0;return F|0}function gs(_,v,E){_=_|0,v=v|0,E=E|0;var L=0,O=0,F=0,z=0;if(F=_+E|0,v=v&255,(E|0)>=67){for(;_&3;)rt[_>>0]=v,_=_+1|0;for(L=F&-4|0,z=v|v<<8|v<<16|v<<24,O=L-64|0;(_|0)<=(O|0);)s[_>>2]=z,s[_+4>>2]=z,s[_+8>>2]=z,s[_+12>>2]=z,s[_+16>>2]=z,s[_+20>>2]=z,s[_+24>>2]=z,s[_+28>>2]=z,s[_+32>>2]=z,s[_+36>>2]=z,s[_+40>>2]=z,s[_+44>>2]=z,s[_+48>>2]=z,s[_+52>>2]=z,s[_+56>>2]=z,s[_+60>>2]=z,_=_+64|0;for(;(_|0)<(L|0);)s[_>>2]=z,_=_+4|0}for(;(_|0)<(F|0);)rt[_>>0]=v,_=_+1|0;return F-E|0}function Bi(_){return _=+_,_>=0?+mt(_+.5):+_i(_-.5)}function Pi(_){_=_|0;var v=0,E=0,L=0;return L=Ht()|0,E=s[ft>>2]|0,v=E+_|0,(_|0)>0&(v|0)<(E|0)|(v|0)<0?(Eo(v|0)|0,Se(12),-1):(v|0)>(L|0)&&!(bi(v|0)|0)?(Se(12),-1):(s[ft>>2]=v,E|0)}return{___uremdi3:Er,_bitshift64Lshr:xt,_bitshift64Shl:qt,_calloc:Jt,_cellAreaKm2:Ua,_cellAreaM2:gA,_cellAreaRads2:la,_compact:il,_destroyLinkedPolygon:ha,_edgeLengthKm:bn,_edgeLengthM:pA,_emscripten_replace_memory:oo,_exactEdgeLengthKm:Va,_exactEdgeLengthM:ui,_exactEdgeLengthRads:Dl,_experimentalH3ToLocalIj:Wt,_experimentalLocalIjToH3:Ga,_free:gt,_geoToH3:yA,_getDestinationH3IndexFromUnidirectionalEdge:vA,_getH3IndexesFromUnidirectionalEdge:Di,_getH3UnidirectionalEdge:Pu,_getH3UnidirectionalEdgeBoundary:ds,_getH3UnidirectionalEdgesFromHexagon:xA,_getOriginH3IndexFromUnidirectionalEdge:lo,_getPentagonIndexes:Lo,_getRes0Indexes:ta,_h3Distance:bA,_h3GetBaseCell:ja,_h3GetFaces:ca,_h3GetResolution:Bl,_h3IndexesAreNeighbors:Do,_h3IsPentagon:Si,_h3IsResClassIII:Ur,_h3IsValid:mA,_h3Line:zl,_h3LineSize:da,_h3SetToLinkedGeo:Ei,_h3ToCenterChild:Nr,_h3ToChildren:Ji,_h3ToGeo:fs,_h3ToGeoBoundary:Vr,_h3ToParent:_A,_h3UnidirectionalEdgeIsValid:qr,_hexAreaKm2:fi,_hexAreaM2:dA,_hexRing:Ee,_i64Subtract:pa,_kRing:Vs,_kRingDistances:XA,_llvm_minnum_f64:Wa,_llvm_round_f64:ai,_malloc:Wi,_maxFaceCount:Cu,_maxH3ToChildrenSize:nl,_maxKringSize:Xo,_maxPolyfillSize:Ge,_maxUncompactSize:ua,_memcpy:pi,_memset:gs,_numHexagons:ii,_pentagonIndexCount:Rl,_pointDistKm:fA,_pointDistM:vc,_pointDistRads:Aa,_polyfill:ot,_res0IndexCount:ea,_round:Bi,_sbrk:Pi,_sizeOfCoordIJ:rl,_sizeOfGeoBoundary:bc,_sizeOfGeoCoord:Fl,_sizeOfGeoPolygon:Nl,_sizeOfGeofence:Mu,_sizeOfH3Index:SA,_sizeOfLinkedGeoPolygon:ps,_uncompact:oi,establishStackSpace:Us,stackAlloc:_e,stackRestore:cr,stackSave:ao}}(ki,Xn,Et);e.___uremdi3=Je.___uremdi3,e._bitshift64Lshr=Je._bitshift64Lshr,e._bitshift64Shl=Je._bitshift64Shl,e._calloc=Je._calloc,e._cellAreaKm2=Je._cellAreaKm2,e._cellAreaM2=Je._cellAreaM2,e._cellAreaRads2=Je._cellAreaRads2,e._compact=Je._compact,e._destroyLinkedPolygon=Je._destroyLinkedPolygon,e._edgeLengthKm=Je._edgeLengthKm,e._edgeLengthM=Je._edgeLengthM;var os=e._emscripten_replace_memory=Je._emscripten_replace_memory;e._exactEdgeLengthKm=Je._exactEdgeLengthKm,e._exactEdgeLengthM=Je._exactEdgeLengthM,e._exactEdgeLengthRads=Je._exactEdgeLengthRads,e._experimentalH3ToLocalIj=Je._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=Je._experimentalLocalIjToH3,e._free=Je._free,e._geoToH3=Je._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=Je._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=Je._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=Je._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=Je._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=Je._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=Je._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=Je._getPentagonIndexes,e._getRes0Indexes=Je._getRes0Indexes,e._h3Distance=Je._h3Distance,e._h3GetBaseCell=Je._h3GetBaseCell,e._h3GetFaces=Je._h3GetFaces,e._h3GetResolution=Je._h3GetResolution,e._h3IndexesAreNeighbors=Je._h3IndexesAreNeighbors,e._h3IsPentagon=Je._h3IsPentagon,e._h3IsResClassIII=Je._h3IsResClassIII,e._h3IsValid=Je._h3IsValid,e._h3Line=Je._h3Line,e._h3LineSize=Je._h3LineSize,e._h3SetToLinkedGeo=Je._h3SetToLinkedGeo,e._h3ToCenterChild=Je._h3ToCenterChild,e._h3ToChildren=Je._h3ToChildren,e._h3ToGeo=Je._h3ToGeo,e._h3ToGeoBoundary=Je._h3ToGeoBoundary,e._h3ToParent=Je._h3ToParent,e._h3UnidirectionalEdgeIsValid=Je._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=Je._hexAreaKm2,e._hexAreaM2=Je._hexAreaM2,e._hexRing=Je._hexRing,e._i64Subtract=Je._i64Subtract,e._kRing=Je._kRing,e._kRingDistances=Je._kRingDistances,e._llvm_minnum_f64=Je._llvm_minnum_f64,e._llvm_round_f64=Je._llvm_round_f64,e._malloc=Je._malloc,e._maxFaceCount=Je._maxFaceCount,e._maxH3ToChildrenSize=Je._maxH3ToChildrenSize,e._maxKringSize=Je._maxKringSize,e._maxPolyfillSize=Je._maxPolyfillSize,e._maxUncompactSize=Je._maxUncompactSize,e._memcpy=Je._memcpy,e._memset=Je._memset,e._numHexagons=Je._numHexagons,e._pentagonIndexCount=Je._pentagonIndexCount,e._pointDistKm=Je._pointDistKm,e._pointDistM=Je._pointDistM,e._pointDistRads=Je._pointDistRads,e._polyfill=Je._polyfill,e._res0IndexCount=Je._res0IndexCount,e._round=Je._round,e._sbrk=Je._sbrk,e._sizeOfCoordIJ=Je._sizeOfCoordIJ,e._sizeOfGeoBoundary=Je._sizeOfGeoBoundary,e._sizeOfGeoCoord=Je._sizeOfGeoCoord,e._sizeOfGeoPolygon=Je._sizeOfGeoPolygon,e._sizeOfGeofence=Je._sizeOfGeofence,e._sizeOfH3Index=Je._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=Je._sizeOfLinkedGeoPolygon,e._uncompact=Je._uncompact,e.establishStackSpace=Je.establishStackSpace;var ke=e.stackAlloc=Je.stackAlloc,re=e.stackRestore=Je.stackRestore,fe=e.stackSave=Je.stackSave;if(e.asm=Je,e.cwrap=ce,e.setValue=X,e.getValue=ee,e.getTempRet0=V,Qn){so(Qn)||(Qn=A(Qn));{Ns();var be=function(oe){oe.byteLength&&(oe=new Uint8Array(oe)),Mt.set(oe,$),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,ro()},Oe=function(){d(Qn,be,function(){throw"could not load memory initializer "+Qn})},je=Or(Qn);if(je)be(je.buffer);else if(e.memoryInitializerRequest){var Xe=function(){var oe=e.memoryInitializerRequest,ve=oe.response;if(oe.status!==200&&oe.status!==0){var Pe=Or(e.memoryInitializerRequestURL);if(Pe)ve=Pe.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+oe.status+", retrying "+Qn),Oe();return}}be(ve)};e.memoryInitializerRequest.response?setTimeout(Xe,0):e.memoryInitializerRequest.addEventListener("load",Xe)}else Oe()}}var $e;ji=function oe(){$e||We(),$e||(ji=oe)};function We(oe){if(gn>0||(ti(),gn>0))return;function ve(){$e||($e=!0,!ue&&(kr(),Yn(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),si()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),ve()},1)):ve()}e.run=We;function Ye(oe){throw e.onAbort&&e.onAbort(oe),oe+="",l(oe),S(oe),ue=!0,"abort("+oe+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Ye,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return We(),t}(typeof Ho=="object"?Ho:{}),xn="number",Sf=xn,Mn=xn,jn=xn,Oo=xn,ri=xn,gK=[["sizeOfH3Index",xn],["sizeOfGeoCoord",xn],["sizeOfGeoBoundary",xn],["sizeOfGeoPolygon",xn],["sizeOfGeofence",xn],["sizeOfLinkedGeoPolygon",xn],["sizeOfCoordIJ",xn],["h3IsValid",Sf,[Mn,jn]],["geoToH3",Mn,[xn,xn,Oo]],["h3ToGeo",null,[Mn,jn,ri]],["h3ToGeoBoundary",null,[Mn,jn,ri]],["maxKringSize",xn,[xn]],["kRing",null,[Mn,jn,xn,ri]],["kRingDistances",null,[Mn,jn,xn,ri,ri]],["hexRing",null,[Mn,jn,xn,ri]],["maxPolyfillSize",xn,[ri,Oo]],["polyfill",null,[ri,Oo,ri]],["h3SetToLinkedGeo",null,[ri,xn,ri]],["destroyLinkedPolygon",null,[ri]],["compact",xn,[ri,ri,xn]],["uncompact",xn,[ri,xn,ri,xn,Oo]],["maxUncompactSize",xn,[ri,xn,Oo]],["h3IsPentagon",Sf,[Mn,jn]],["h3IsResClassIII",Sf,[Mn,jn]],["h3GetBaseCell",xn,[Mn,jn]],["h3GetResolution",xn,[Mn,jn]],["maxFaceCount",xn,[Mn,jn]],["h3GetFaces",null,[Mn,jn,ri]],["h3ToParent",Mn,[Mn,jn,Oo]],["h3ToChildren",null,[Mn,jn,Oo,ri]],["h3ToCenterChild",Mn,[Mn,jn,Oo]],["maxH3ToChildrenSize",xn,[Mn,jn,Oo]],["h3IndexesAreNeighbors",Sf,[Mn,jn,Mn,jn]],["getH3UnidirectionalEdge",Mn,[Mn,jn,Mn,jn]],["getOriginH3IndexFromUnidirectionalEdge",Mn,[Mn,jn]],["getDestinationH3IndexFromUnidirectionalEdge",Mn,[Mn,jn]],["h3UnidirectionalEdgeIsValid",Sf,[Mn,jn]],["getH3IndexesFromUnidirectionalEdge",null,[Mn,jn,ri]],["getH3UnidirectionalEdgesFromHexagon",null,[Mn,jn,ri]],["getH3UnidirectionalEdgeBoundary",null,[Mn,jn,ri]],["h3Distance",xn,[Mn,jn,Mn,jn]],["h3Line",xn,[Mn,jn,Mn,jn,ri]],["h3LineSize",xn,[Mn,jn,Mn,jn]],["experimentalH3ToLocalIj",xn,[Mn,jn,Mn,jn,ri]],["experimentalLocalIjToH3",xn,[Mn,jn,ri,ri]],["hexAreaM2",xn,[Oo]],["hexAreaKm2",xn,[Oo]],["edgeLengthM",xn,[Oo]],["edgeLengthKm",xn,[Oo]],["pointDistM",xn,[ri,ri]],["pointDistKm",xn,[ri,ri]],["pointDistRads",xn,[ri,ri]],["cellAreaM2",xn,[Mn,jn]],["cellAreaKm2",xn,[Mn,jn]],["cellAreaRads2",xn,[Mn,jn]],["exactEdgeLengthM",xn,[Mn,jn]],["exactEdgeLengthKm",xn,[Mn,jn]],["exactEdgeLengthRads",xn,[Mn,jn]],["numHexagons",xn,[Oo]],["getRes0Indexes",null,[ri]],["res0IndexCount",xn],["getPentagonIndexes",null,[xn,ri]],["pentagonIndexCount",xn]],zs={};gK.forEach(function(e){zs[e[0]]=Ho.cwrap.apply(Ho,e)});var t0=16,Cd=8;zs.sizeOfH3Index();var U5=zs.sizeOfGeoCoord(),mK=zs.sizeOfGeoBoundary();zs.sizeOfGeoPolygon();zs.sizeOfGeofence();zs.sizeOfLinkedGeoPolygon();zs.sizeOfCoordIJ();var N4={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function _K(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var yK=/[^0-9a-fA-F]/;function k0(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||yK.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),t0),n=parseInt(t.substring(t.length-8),t0);return[n,e]}function U4(t){if(t>=0)return t.toString(t0);t=t&2147483647;var e=V5(8,t.toString(t0)),n=(parseInt(e[0],t0)+8).toString(t0);return e=n+e.substring(1),e}function vK(t,e){return U4(e)+V5(8,U4(t))}function V5(t,e){for(var n=t-e.length,i="",r=0;r<n;r++)i+="0";return i=i+e,i}function xK(t){var e=Ho.getTempRet0();return[t,e]}function wK(t){var e=xK(t),n=e[0],i=e[1];return i?vK(n,i):null}function Nm(t){return LK(Ho.getValue(t,"double"))}function j5(t){return[Nm(t),Nm(t+Cd)]}function bK(t){return[Nm(t+Cd),Nm(t)]}function EK(t,e,n){for(var i=Ho.getValue(t,"i32"),r=t+Cd,A=[],d=e?bK:j5,l=0;l<i*2;l+=2)A.push(d(r+Cd*l));return n&&A.push(A[0]),A}function TK(t){var e=k0(t),n=e[0],i=e[1];return!!zs.h3IsPentagon(n,i)}function SK(t){var e=k0(t),n=e[0],i=e[1];return zs.h3IsValid(n,i)?zs.h3GetResolution(n,i):-1}function CK(t,e,n){var i=Ho._malloc(U5);Ho.HEAPF64.set([t,e].map(kK),i/Cd);var r=wK(zs.geoToH3(i,n));return Ho._free(i),r}function Bw(t){var e=Ho._malloc(U5),n=k0(t),i=n[0],r=n[1];zs.h3ToGeo(i,r,e);var A=j5(e);return Ho._free(e),A}function PK(t,e){var n=Ho._malloc(mK),i=k0(t),r=i[0],A=i[1];zs.h3ToGeoBoundary(r,A,n);var d=EK(n,e,e);return Ho._free(n),d}function MK(t,e){var n=k0(t),i=n[0],r=n[1],A=k0(e),d=A[0],l=A[1];return zs.h3Distance(i,r,d,l)}function IK(t,e){switch(_K(t),e){case N4.m:return zs.edgeLengthM(t);case N4.km:return zs.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function kK(t){return t*Math.PI/180}function LK(t){return t*180/Math.PI}const DK=10;function G5(t,e){e=e===void 0?t[0][0]:e;for(const n of t){const i=n[0]-e;i>180?n[0]-=360:i<-180&&(n[0]+=360)}}function BK(t,e,n){const[i,r]=Bw(t),A=e.length;G5(e,r);const d=e[0]===e[A-1]?A-1:A;for(let l=0;l<d;l++)e[l][0]=T0(r,e[l][0],n),e[l][1]=T0(i,e[l][1],n)}function RK(t,e,n){const i=t(e,n),[r,A]=Bw(i);return[A,r]}function V4(t,e=1){const n=PK(t,!0);return e!==1?BK(t,n,e):G5(n),n}function OK(t){const e=new Float64Array(t.length*2);let n=0;for(const i of t)e[n++]=i[0],e[n++]=i[1];return e}function zK(t,e){let n;return t==null?n=e:typeof t=="object"?n={...t,coverage:e}:n={getHexagon:t,coverage:e},n}const FK={...S_.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class uh extends N0{constructor(...e){super(...e),ae(this,"state",void 0)}initializeState(){uh._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:n}){if(e.highPrecision!==!0&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){const i=this._calculateH3DataProps();this.setState(i)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,n=!1,i=!1;const{iterable:r,objectInfo:A}=_c(this.props.data);for(const d of r){A.index++;const l=this.props.getHexagon(d,A),S=SK(l);if(e<0){if(e=S,!this.props.highPrecision)break}else if(e!==S){i=!0;break}if(TK(l)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?IK(e,"km"):0,hasMultipleRes:i,hasPentagon:n}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){const{resolution:e,hasPentagon:n,hasMultipleRes:i}=this.state,{viewport:r}=this.context;return!!(r!=null&&r.resolution)||i||n||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;const{resolution:n,edgeLengthKM:i,centerHex:r}=this.state;if(n<0)return;const A=this.props.centerHexagon||CK(e.latitude,e.longitude,n);if(r===A)return;if(r){const $=MK(r,A);if($>=0&&$*i<DK)return}const{unitsPerMeter:d}=e.distanceScales;let l=V4(A);const[S,k]=Bw(A),[U,V]=e.projectFlat([k,S]);l=l.map($=>{const X=e.projectFlat($);return[(X[0]-U)/d[0],(X[1]-V)/d[1]]}),this.setState({centerHex:A,vertices:l})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:e,material:n,coverage:i,extruded:r,wireframe:A,stroked:d,filled:l,lineWidthUnits:S,lineWidthScale:k,lineWidthMinPixels:U,lineWidthMaxPixels:V,getFillColor:$,getElevation:X,getLineColor:ee,getLineWidth:ue,transitions:we,updateTriggers:ie}=this.props;return{elevationScale:e,extruded:r,coverage:i,wireframe:A,stroked:d,filled:l,lineWidthUnits:S,lineWidthScale:k,lineWidthMinPixels:U,lineWidthMaxPixels:V,material:n,getElevation:X,getFillColor:$,getLineColor:ee,getLineWidth:ue,transitions:we,updateTriggers:{getFillColor:ie.getFillColor,getElevation:ie.getElevation,getLineColor:ie.getLineColor,getLineWidth:ie.getLineWidth}}}_renderPolygonLayer(){const{data:e,getHexagon:n,updateTriggers:i,coverage:r}=this.props,A=this.getSubLayerClass("hexagon-cell-hifi",S_),d=this._getForwardProps();return d.updateTriggers.getPolygon=zK(i.getHexagon,r),new A(d,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:d.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(l,S)=>{const k=n(l,S);return OK(V4(k,r))}})}_renderColumnLayer(){const{data:e,getHexagon:n,updateTriggers:i}=this.props,r=this.getSubLayerClass("hexagon-cell",x_),A=this._getForwardProps();return A.updateTriggers.getPosition=i.getHexagon,new r(A,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:A.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:RK.bind(null,n)})}}ae(uh,"defaultProps",FK);ae(uh,"layerName","H3HexagonLayer");ae(uh,"_checkH3Lib",()=>{});const Vy=Math.PI/180,hg=new Float32Array(16),j4=new Float32Array(12);function G4(t,e,n){const i=e[0]*Vy,r=e[1]*Vy,A=e[2]*Vy,d=Math.sin(A),l=Math.sin(i),S=Math.sin(r),k=Math.cos(A),U=Math.cos(i),V=Math.cos(r),$=n[0],X=n[1],ee=n[2];t[0]=$*V*U,t[1]=$*S*U,t[2]=$*-l,t[3]=X*(-S*k+V*l*d),t[4]=X*(V*k+S*l*d),t[5]=X*U*d,t[6]=ee*(S*d+V*l*k),t[7]=ee*(-V*d+S*l*k),t[8]=ee*U*k}function Q4(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const NK={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:A,getTranslation:d,getTransformMatrix:l}=this.props,S=Array.isArray(l),k=S&&l.length===16,U=Array.isArray(A),V=Array.isArray(r),$=Array.isArray(d),X=k||!S&&!!l(i[0]);X?t.constant=k:t.constant=V&&U&&$;const ee=t.value;if(t.constant){let ue;X?(hg.set(l),ue=Q4(hg)):(ue=j4,G4(ue,r,A),ue.set(d,9)),t.value=new Float32Array(ue)}else{let ue=e*t.size;const{iterable:we,objectInfo:ie}=_c(i,e,n);for(const Ae of we){ie.index++;let ce;if(X)hg.set(k?l:l(Ae,ie)),ce=Q4(hg);else{ce=j4;const Ce=V?r:r(Ae,ie),Ne=U?A:A(Ae,ie);G4(ce,Ce,Ne),ce.set($?d:d(Ae,ie),9)}ee[ue++]=ce[0],ee[ue++]=ce[1],ee[ue++]=ce[2],ee[ue++]=ce[3],ee[ue++]=ce[4],ee[ue++]=ce[5],ee[ue++]=ce[6],ee[ue++]=ce[7],ee[ue++]=ce[8],ee[ue++]=ce[9],ee[ue++]=ce[10],ee[ue++]=ce[11]}}}};function UK(t,e){return e===$n.CARTESIAN||e===$n.METER_OFFSETS||e===$n.DEFAULT&&!t.isGeospatial}const VK=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,jK=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function GK(t){let e=1/0,n=1/0,i=1/0,r=-1/0,A=-1/0,d=-1/0;const l=t.POSITION?t.POSITION.value:[],S=l&&l.length;for(let k=0;k<S;k+=3){const U=l[k],V=l[k+1],$=l[k+2];e=U<e?U:e,n=V<n?V:n,i=$<i?$:i,r=U>r?U:r,A=V>A?V:A,d=$>d?$:d}return[[e,n,i],[r,A,d]]}function H4(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),Nn.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function W4(t,e){if(t.attributes)return H4(t.attributes,e),t instanceof El?t:new El(t);if(t.positions||t.POSITION)return H4(t,e),new El({attributes:t});throw Error("Invalid mesh")}const QK=[0,0,0,255],HK={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:QK},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class Rw extends YA{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(){const e=!Zn(this.context.gl),n={};return ow(this.context.gl,Ii.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:VK,fs:jK,modules:[Ah,Fk,lh],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:i}=this.props;if(!i)return null;if(n=(e=i.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:r}=W4(i,this.props._useMeshColors);r.POSITION=r.POSITION||r.positions,n=GK(r)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:NK}),this.setState({emptyTexture:new $o(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e;if(n.mesh!==i.mesh||r.extensionsChanged){var A;if(this.state.positionBounds=null,(A=this.state.model)===null||A===void 0||A.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const d=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(d.NORMAL||d.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==i.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:A}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!A||UK(n,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new _u(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:W4(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return n.setUniforms({sampler:i||r,hasTexture:!!i}),n}setTexture(e){const{emptyTexture:n,model:i}=this.state;i&&i.setUniforms({sampler:e||n,hasTexture:!!e})}}ae(Rw,"defaultProps",HK);ae(Rw,"layerName","SimpleMeshLayer");const WK=typeof window<"u"?Tt.useLayoutEffect:Tt.useEffect,$K=WK;function Um(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const ZK={position:"absolute",zIndex:-1};function Q5(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>Q5(n,e));if(C_(t)){if(qK(t))return e.style=ZK,Tt.cloneElement(t,e);if(YK(t))return Tt.cloneElement(t,e)}return t}function C_(t){return t&&typeof t=="object"&&"type"in t||!1}function qK(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function YK(t){const e=t.type;return e&&e.deckGLViewProps}function Mv(t){if(typeof t=="function")return Tt.createElement(Kc,{},t);if(Array.isArray(t))return t.map(Mv);if(C_(t)){if(t.type===Tt.Fragment)return Mv(t.props.children);if(Um(t.type,Kc))return t}return t}function XK({children:t,layers:e=[],views:n=null}){const i=[],r=[],A={};return Tt.Children.forEach(Mv(t),d=>{if(C_(d)){const l=d.type;if(Um(l,YA)){const S=KK(l,d.props);r.push(S)}else i.push(d);if(Um(l,Kc)&&l!==Kc&&d.props.id){const S=new l(d.props);A[S.id]=S}}else d&&i.push(d)}),Object.keys(A).length>0&&(Array.isArray(n)?n.forEach(d=>{A[d.id]=d}):n&&(A[n.id]=n),n=Object.values(A)),e=r.length>0?[...r,...e]:e,{layers:e,children:i,views:n}}function KK(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}function JK({children:t,deck:e,ContextProvider:n}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const r={},A=i.views[0].id;for(const d of t){let l=A,S=d;C_(d)&&Um(d.type,Kc)&&(l=d.props.id||A,S=d.props.children);const k=i.getViewport(l),U=i.getViewState(l);if(k){U.padding=k.padding;const{x:V,y:$,width:X,height:ee}=k;S=Q5(S,{x:V,y:$,width:X,height:ee,viewport:k,viewState:U}),r[l]||(r[l]={viewport:k,children:[]}),r[l].children.push(S)}}return Object.keys(r).map(d=>{const{viewport:l,children:S}=r[d],{x:k,y:U,width:V,height:$}=l,X={position:"absolute",left:k,top:U,width:V,height:$},ee="view-".concat(d),ue=Tt.createElement("div",{key:ee,id:ee,style:X},...S);if(n){const we={viewport:l,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:ie=>{ie.viewId=d,e._onViewStateChange(ie)}};return Tt.createElement(n,{key:ee,value:we},ue)}return ue})}const eJ={mixBlendMode:null};function tJ({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const A in n)A in eJ?r[A]=n[A]:i[A]=n[A];return{containerStyle:i,canvasStyle:r}}function nJ(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function H5(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function iJ(t,e,n){const i=new e({...n,_customRender:r=>{t.redrawReason=r;const A=i.getViewports();t.lastRenderedViewports!==A?t.forceUpdate():H5(t)}});return i}const W5=Tt.forwardRef((t,e)=>{const[n,i]=Tt.useState(0),A=Tt.useRef({control:null,version:n,forceUpdate:()=>i(Ne=>Ne+1)}).current,d=Tt.useRef(null),l=Tt.useRef(null),S=Tt.useMemo(()=>XK(t),[t.layers,t.views,t.children]);let k=!0;const U=Ne=>{var qe;return k&&t.viewState?(A.viewStateUpdateRequested=Ne,null):(A.viewStateUpdateRequested=null,(qe=t.onViewStateChange)===null||qe===void 0?void 0:qe.call(t,Ne))},V=Ne=>{if(k)A.interactionStateUpdateRequested=Ne;else{var qe;A.interactionStateUpdateRequested=null,(qe=t.onInteractionStateChange)===null||qe===void 0||qe.call(t,Ne)}},$=Tt.useMemo(()=>{const Ne={...t,style:null,width:"100%",height:"100%",parent:d.current,canvas:l.current,layers:S.layers,views:S.views,onViewStateChange:U,onInteractionStateChange:V};return delete Ne._customRender,A.deck&&A.deck.setProps(Ne),Ne},[t]);Tt.useEffect(()=>{const Ne=t.Deck||v_;return A.deck=iJ(A,Ne,{...$,parent:d.current,canvas:l.current}),()=>{var qe;return(qe=A.deck)===null||qe===void 0?void 0:qe.finalize()}},[]),$K(()=>{H5(A);const{viewStateUpdateRequested:Ne,interactionStateUpdateRequested:qe}=A;Ne&&U(Ne),qe&&V(qe)}),Tt.useImperativeHandle(e,()=>nJ(A),[]);const X=A.deck&&A.deck.isInitialized?A.deck.getViewports():void 0,{ContextProvider:ee,width:ue,height:we,id:ie,style:Ae}=t,{containerStyle:ce,canvasStyle:Ce}=Tt.useMemo(()=>tJ({width:ue,height:we,style:Ae}),[ue,we,Ae]);if(!A.viewStateUpdateRequested&&A.lastRenderedViewports===X||A.version!==n){A.lastRenderedViewports=X,A.version=n;const Ne=JK({children:S.children,deck:A.deck,ContextProvider:ee}),qe=Tt.createElement("canvas",{key:"canvas",id:ie||"deckgl-overlay",ref:l,style:Ce});A.control=Tt.createElement("div",{id:"".concat(ie||"deckgl","-wrapper"),ref:d,style:ce},[qe,Ne])}return k=!1,A.control});W5.defaultProps=v_.defaultProps;const $5=W5;var No=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function A(oe){return e.locateFile?e.locateFile(oe,r):r+oe}var d;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",d=function(ve,Pe,rt){var s=new XMLHttpRequest;s.open("GET",ve,!0),s.responseType="arraybuffer",s.onload=function(){if(s.status==200||s.status==0&&s.response){Pe(s.response);return}var ft=Or(ve);if(ft){Pe(ft.buffer);return}rt()},s.onerror=rt,s.send(null)};var l=e.print||console.log.bind(console),S=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var k=0,U=function(oe){k=oe},V=function(){return k},$=8;function X(oe,ve,Pe,rt){switch(Pe=Pe||"i8",Pe.charAt(Pe.length-1)==="*"&&(Pe="i32"),Pe){case"i1":St[oe>>0]=ve;break;case"i8":St[oe>>0]=ve;break;case"i16":Kt[oe>>1]=ve;break;case"i32":pn[oe>>2]=ve;break;case"i64":It=[ve>>>0,(Gi=ve,+ut(Gi)>=1?Gi>0?(Ln(+rs(Gi/4294967296),4294967295)|0)>>>0:~~+xr((Gi-+(~~Gi>>>0))/4294967296)>>>0:0)],pn[oe>>2]=It[0],pn[oe+4>>2]=It[1];break;case"float":ei[oe>>2]=ve;break;case"double":li[oe>>3]=ve;break;default:Ye("invalid type for setValue: "+Pe)}}function ee(oe,ve,Pe){switch(ve=ve||"i8",ve.charAt(ve.length-1)==="*"&&(ve="i32"),ve){case"i1":return St[oe>>0];case"i8":return St[oe>>0];case"i16":return Kt[oe>>1];case"i32":return pn[oe>>2];case"i64":return pn[oe>>2];case"float":return ei[oe>>2];case"double":return li[oe>>3];default:Ye("invalid type for getValue: "+ve)}return null}var ue=!1;function we(oe,ve){oe||Ye("Assertion failed: "+ve)}function ie(oe){var ve=e["_"+oe];return we(ve,"Cannot call unknown function "+oe+", make sure it is exported"),ve}function Ae(oe,ve,Pe,rt,s){var Z={string:function(pt){var Dn=0;if(pt!=null&&pt!==0){var hi=(pt.length<<2)+1;Dn=ke(hi),lt(pt,Dn,hi)}return Dn},array:function(pt){var Dn=ke(pt.length);return at(pt,Dn),Dn}};function ft(pt){return ve==="string"?qe(pt):ve==="boolean"?!!pt:pt}var mt=ie(oe),kt=[],yt=0;if(rt)for(var Pt=0;Pt<rt.length;Pt++){var Qt=Z[Pe[Pt]];Qt?(yt===0&&(yt=fe()),kt[Pt]=Qt(rt[Pt])):kt[Pt]=rt[Pt]}var Vt=mt.apply(null,kt);return Vt=ft(Vt),yt!==0&&re(yt),Vt}function ce(oe,ve,Pe,rt){Pe=Pe||[];var s=Pe.every(function(ft){return ft==="number"}),Z=ve!=="string";return Z&&s&&!rt?ie(oe):function(){return Ae(oe,ve,Pe,arguments)}}var Ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ne(oe,ve,Pe){for(var rt=ve+Pe,s=ve;oe[s]&&!(s>=rt);)++s;if(s-ve>16&&oe.subarray&&Ce)return Ce.decode(oe.subarray(ve,s));for(var Z="";ve<s;){var ft=oe[ve++];if(!(ft&128)){Z+=String.fromCharCode(ft);continue}var mt=oe[ve++]&63;if((ft&224)==192){Z+=String.fromCharCode((ft&31)<<6|mt);continue}var kt=oe[ve++]&63;if((ft&240)==224?ft=(ft&15)<<12|mt<<6|kt:ft=(ft&7)<<18|mt<<12|kt<<6|oe[ve++]&63,ft<65536)Z+=String.fromCharCode(ft);else{var yt=ft-65536;Z+=String.fromCharCode(55296|yt>>10,56320|yt&1023)}}return Z}function qe(oe,ve){return oe?Ne(Mt,oe,ve):""}function tt(oe,ve,Pe,rt){if(!(rt>0))return 0;for(var s=Pe,Z=Pe+rt-1,ft=0;ft<oe.length;++ft){var mt=oe.charCodeAt(ft);if(mt>=55296&&mt<=57343){var kt=oe.charCodeAt(++ft);mt=65536+((mt&1023)<<10)|kt&1023}if(mt<=127){if(Pe>=Z)break;ve[Pe++]=mt}else if(mt<=2047){if(Pe+1>=Z)break;ve[Pe++]=192|mt>>6,ve[Pe++]=128|mt&63}else if(mt<=65535){if(Pe+2>=Z)break;ve[Pe++]=224|mt>>12,ve[Pe++]=128|mt>>6&63,ve[Pe++]=128|mt&63}else{if(Pe+3>=Z)break;ve[Pe++]=240|mt>>18,ve[Pe++]=128|mt>>12&63,ve[Pe++]=128|mt>>6&63,ve[Pe++]=128|mt&63}}return ve[Pe]=0,Pe-s}function lt(oe,ve,Pe){return tt(oe,Mt,ve,Pe)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function at(oe,ve){St.set(oe,ve)}function ht(oe,ve){return oe%ve>0&&(oe+=ve-oe%ve),oe}var Et,St,Mt,Kt,pn,ei,li;function Nt(oe){Et=oe,e.HEAP8=St=new Int8Array(oe),e.HEAP16=Kt=new Int16Array(oe),e.HEAP32=pn=new Int32Array(oe),e.HEAPU8=Mt=new Uint8Array(oe),e.HEAPU16=new Uint16Array(oe),e.HEAPU32=new Uint32Array(oe),e.HEAPF32=ei=new Float32Array(oe),e.HEAPF64=li=new Float64Array(oe)}var dn=5267040,vn=24128,Bn=e.TOTAL_MEMORY||33554432;e.buffer?Et=e.buffer:Et=new ArrayBuffer(Bn),Bn=Et.byteLength,Nt(Et),pn[vn>>2]=dn;function Tn(oe){for(;oe.length>0;){var ve=oe.shift();if(typeof ve=="function"){ve();continue}var Pe=ve.func;typeof Pe=="number"?ve.arg===void 0?e.dynCall_v(Pe):e.dynCall_vi(Pe,ve.arg):Pe(ve.arg===void 0?null:ve.arg)}}var wi=[],Un=[],Hr=[],qi=[];function ti(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)vr(e.preRun.shift());Tn(wi)}function kr(){Tn(Un)}function Yn(){Tn(Hr)}function si(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Lr(e.postRun.shift());Tn(qi)}function vr(oe){wi.unshift(oe)}function Lr(oe){qi.unshift(oe)}var ut=Math.abs,xr=Math.ceil,rs=Math.floor,Ln=Math.min,gn=0,ji=null;function Ns(oe){gn++,e.monitorRunDependencies&&e.monitorRunDependencies(gn)}function ro(oe){if(gn--,e.monitorRunDependencies&&e.monitorRunDependencies(gn),gn==0&&ji){var ve=ji;ji=null,ve()}}e.preloadedImages={},e.preloadedAudios={};var Qn=null,Jn="data:application/octet-stream;base64,";function so(oe){return String.prototype.startsWith?oe.startsWith(Jn):oe.indexOf(Jn)===0}var Gi,It;Qn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Yi=24144;function Xi(oe){return oe}function Dr(oe){var ve=/\b__Z[\w\d_]+/g;return oe.replace(ve,function(Pe){var rt=Pe;return Pe===rt?Pe:rt+" ["+Pe+"]"})}function Wr(){var oe=new Error;if(!oe.stack){try{throw new Error(0)}catch(ve){oe=ve}if(!oe.stack)return"(no stack trace available)"}return oe.stack.toString()}function Lt(){var oe=Wr();return e.extraStackTrace&&(oe+=`
`+e.extraStackTrace()),Dr(oe)}function yn(oe,ve,Pe,rt){Ye("Assertion failed: "+qe(oe)+", at: "+[ve?qe(ve):"unknown filename",Pe,rt?qe(rt):"unknown function"])}function mn(){return St.length}function Qi(oe,ve,Pe){Mt.set(Mt.subarray(ve,ve+Pe),oe)}function Cs(oe){return e.___errno_location&&(pn[e.___errno_location()>>2]=oe),oe}function ln(oe){Ye("OOM")}function Br(oe){try{var ve=new ArrayBuffer(oe);return ve.byteLength!=oe?void 0:(new Int8Array(ve).set(St),os(ve),Nt(ve),1)}catch{}}function ss(oe){var ve=mn(),Pe=16777216,rt=2147483648-Pe;if(oe>rt)return!1;for(var s=16777216,Z=Math.max(ve,s);Z<oe;)Z<=536870912?Z=ht(2*Z,Pe):Z=Math.min(ht((3*Z+2147483648)/4,Pe),rt);var ft=Br(Z);return!!ft}var $r=typeof atob=="function"?atob:function(oe){var ve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pe="",rt,s,Z,ft,mt,kt,yt,Pt=0;oe=oe.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ft=ve.indexOf(oe.charAt(Pt++)),mt=ve.indexOf(oe.charAt(Pt++)),kt=ve.indexOf(oe.charAt(Pt++)),yt=ve.indexOf(oe.charAt(Pt++)),rt=ft<<2|mt>>4,s=(mt&15)<<4|kt>>2,Z=(kt&3)<<6|yt,Pe=Pe+String.fromCharCode(rt),kt!==64&&(Pe=Pe+String.fromCharCode(s)),yt!==64&&(Pe=Pe+String.fromCharCode(Z));while(Pt<oe.length);return Pe};function Rr(oe){try{for(var ve=$r(oe),Pe=new Uint8Array(ve.length),rt=0;rt<ve.length;++rt)Pe[rt]=ve.charCodeAt(rt);return Pe}catch{throw new Error("Converting base64 string to bytes failed.")}}function Or(oe){if(so(oe))return Rr(oe.slice(Jn.length))}var ki={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Xn={a:Ye,b:U,c:V,d:yn,e:Cs,f:mn,g:Qi,h:ss,i:ln,j:Xi,k:Dr,l:Br,m:Wr,n:Lt,o:Yi,p:vn},Je=function(oe,ve,Pe){"almost asm";var rt=new oe.Int8Array(Pe),s=new oe.Int32Array(Pe);new oe.Uint8Array(Pe),new oe.Float32Array(Pe);var Z=new oe.Float64Array(Pe),ft=ve.o|0,mt=ve.p|0,kt=oe.Math.floor,yt=oe.Math.abs,Pt=oe.Math.sqrt,Qt=oe.Math.pow,Vt=oe.Math.cos,pt=oe.Math.sin,Dn=oe.Math.tan,hi=oe.Math.acos,ni=oe.Math.asin,Rn=oe.Math.atan,_i=oe.Math.atan2,On=oe.Math.ceil,qn=oe.Math.imul,ur=oe.Math.min,an=oe.Math.max,Ve=oe.Math.clz32,Ut=ve.b,Se=ve.c,Ht=ve.d,Ki=ve.e,bi=ve.f,Eo=ve.g,De=ve.h,oo=ve.i,_e=24160;function ao(u){return rt=new Int8Array(u),s=new Int32Array(u),Z=new Float64Array(u),Pe=u,!0}function cr(u){u=u|0;var c=0;return c=_e,_e=_e+u|0,_e=_e+15&-16,c|0}function Us(){return _e|0}function Xo(u){u=u|0,_e=u}function Vs(u,c){u=u|0,_e=u}function XA(u,c){u=u|0,c=c|0;var f=0,g=0,y=0;return(u|0)<0?(c=2,c|0):(u|0)>13780509?(c=ha(15,c)|0,c|0):(f=((u|0)<0)<<31>>31,y=Y(u|0,f|0,3,0)|0,g=Se()|0,f=E(u|0,f|0,1,0)|0,f=Y(y|0,g|0,f|0,Se()|0)|0,f=E(f|0,Se()|0,1,0)|0,u=Se()|0,s[c>>2]=f,s[c+4>>2]=u,c=0,c|0)}function Ko(u,c,f,g){return u=u|0,c=c|0,f=f|0,g=g|0,hr(u,c,f,g,0)|0}function hr(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0;if(N=_e,_e=_e+16|0,P=N,!(ge(u,c,f,g,y)|0))return g=0,_e=N,g|0;do if((f|0)>=0){if((f|0)>13780509){if(b=ha(15,P)|0,b|0)break;D=P,P=s[D>>2]|0,D=s[D+4>>2]|0}else b=((f|0)<0)<<31>>31,G=Y(f|0,b|0,3,0)|0,D=Se()|0,b=E(f|0,b|0,1,0)|0,b=Y(G|0,D|0,b|0,Se()|0)|0,b=E(b|0,Se()|0,1,0)|0,D=Se()|0,s[P>>2]=b,s[P+4>>2]=D,P=b;if(w(g|0,0,P<<3|0)|0,y|0){w(y|0,0,P<<2|0)|0,b=Ee(u,c,f,g,y,P,D,0)|0;break}b=v(P,4)|0,b?(G=Ee(u,c,f,g,b,P,D,0)|0,_(b),b=G):b=13}else b=2;while(0);return G=b,_e=N,G|0}function ge(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0;if(xe=_e,_e=_e+16|0,te=xe,se=xe+8|0,de=te,s[de>>2]=u,s[de+4>>2]=c,(f|0)<0)return se=2,_e=xe,se|0;if(b=g,s[b>>2]=u,s[b+4>>2]=c,b=(y|0)!=0,b&&(s[y>>2]=0),ui(u,c)|0)return se=9,_e=xe,se|0;s[se>>2]=0;e:do if((f|0)>=1)if(b)for(W=1,G=0,K=0,de=1,b=u;;){if(!(G|K)){if(b=Ge(b,c,4,se,te)|0,b|0)break e;if(c=te,b=s[c>>2]|0,c=s[c+4>>2]|0,ui(b,c)|0){b=9;break e}}if(b=Ge(b,c,s[22384+(K<<2)>>2]|0,se,te)|0,b|0)break e;if(c=te,b=s[c>>2]|0,c=s[c+4>>2]|0,u=g+(W<<3)|0,s[u>>2]=b,s[u+4>>2]=c,s[y+(W<<2)>>2]=de,u=G+1|0,P=(u|0)==(de|0),D=K+1|0,N=(D|0)==6,ui(b,c)|0){b=9;break e}if(de=de+(N&P&1)|0,(de|0)>(f|0)){b=0;break}else W=W+1|0,G=P?0:u,K=P?N?0:D:K}else for(W=1,G=0,K=0,de=1,b=u;;){if(!(G|K)){if(b=Ge(b,c,4,se,te)|0,b|0)break e;if(c=te,b=s[c>>2]|0,c=s[c+4>>2]|0,ui(b,c)|0){b=9;break e}}if(b=Ge(b,c,s[22384+(K<<2)>>2]|0,se,te)|0,b|0)break e;if(c=te,b=s[c>>2]|0,c=s[c+4>>2]|0,u=g+(W<<3)|0,s[u>>2]=b,s[u+4>>2]=c,u=G+1|0,P=(u|0)==(de|0),D=K+1|0,N=(D|0)==6,ui(b,c)|0){b=9;break e}if(de=de+(N&P&1)|0,(de|0)>(f|0)){b=0;break}else W=W+1|0,G=P?0:u,K=P?N?0:D:K}else b=0;while(0);return se=b,_e=xe,se|0}function Ee(u,c,f,g,y,b,P,D){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0,b=b|0,P=P|0,D=D|0;var N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0;if(xe=_e,_e=_e+16|0,te=xe+8|0,se=xe,N=pe(u|0,c|0,b|0,P|0)|0,W=Se()|0,K=g+(N<<3)|0,Ie=K,Fe=s[Ie>>2]|0,Ie=s[Ie+4>>2]|0,G=(Fe|0)==(u|0)&(Ie|0)==(c|0),!((Fe|0)==0&(Ie|0)==0|G))do N=E(N|0,W|0,1,0)|0,N=le(N|0,Se()|0,b|0,P|0)|0,W=Se()|0,K=g+(N<<3)|0,Fe=K,Ie=s[Fe>>2]|0,Fe=s[Fe+4>>2]|0,G=(Ie|0)==(u|0)&(Fe|0)==(c|0);while(!((Ie|0)==0&(Fe|0)==0|G));if(N=y+(N<<2)|0,G&&(s[N>>2]|0)<=(D|0)||(Fe=K,s[Fe>>2]=u,s[Fe+4>>2]=c,s[N>>2]=D,(D|0)>=(f|0)))return Fe=0,_e=xe,Fe|0;switch(G=D+1|0,s[te>>2]=0,N=Ge(u,c,2,te,se)|0,N|0){case 9:{de=9;break}case 0:{N=se,N=Ee(s[N>>2]|0,s[N+4>>2]|0,f,g,y,b,P,G)|0,N||(de=9);break}}e:do if((de|0)==9){switch(s[te>>2]=0,N=Ge(u,c,3,te,se)|0,N|0){case 9:break;case 0:{if(N=se,N=Ee(s[N>>2]|0,s[N+4>>2]|0,f,g,y,b,P,G)|0,N|0)break e;break}default:break e}switch(s[te>>2]=0,N=Ge(u,c,1,te,se)|0,N|0){case 9:break;case 0:{if(N=se,N=Ee(s[N>>2]|0,s[N+4>>2]|0,f,g,y,b,P,G)|0,N|0)break e;break}default:break e}switch(s[te>>2]=0,N=Ge(u,c,5,te,se)|0,N|0){case 9:break;case 0:{if(N=se,N=Ee(s[N>>2]|0,s[N+4>>2]|0,f,g,y,b,P,G)|0,N|0)break e;break}default:break e}switch(s[te>>2]=0,N=Ge(u,c,4,te,se)|0,N|0){case 9:break;case 0:{if(N=se,N=Ee(s[N>>2]|0,s[N+4>>2]|0,f,g,y,b,P,G)|0,N|0)break e;break}default:break e}switch(s[te>>2]=0,N=Ge(u,c,6,te,se)|0,N|0){case 9:break;case 0:{if(N=se,N=Ee(s[N>>2]|0,s[N+4>>2]|0,f,g,y,b,P,G)|0,N|0)break e;break}default:break e}return Fe=0,_e=xe,Fe|0}while(0);return Fe=N,_e=xe,Fe|0}function Ge(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0;if(f>>>0>6)return y=1,y|0;if(K=(s[g>>2]|0)%6|0,s[g>>2]=K,(K|0)>0){b=0;do f=us(f)|0,b=b+1|0;while((b|0)<(s[g>>2]|0))}if(K=Te(u|0,c|0,45)|0,Se()|0,W=K&127,W>>>0>121)return y=5,y|0;N=Nr(u,c)|0,b=Te(u|0,c|0,52)|0,Se()|0,b=b&15;e:do if(!b)G=8;else{for(;;){if(P=(15-b|0)*3|0,D=Te(u|0,c|0,P|0)|0,Se()|0,D=D&7,(D|0)==7){c=5;break}if(se=(er(b)|0)==0,b=b+-1|0,de=ze(7,0,P|0)|0,c=c&~(Se()|0),te=ze(s[(se?432:16)+(D*28|0)+(f<<2)>>2]|0,0,P|0)|0,P=Se()|0,f=s[(se?640:224)+(D*28|0)+(f<<2)>>2]|0,u=te|u&~de,c=P|c,!f){f=0;break e}if(!b){G=8;break e}}return c|0}while(0);(G|0)==8&&(se=s[848+(W*28|0)+(f<<2)>>2]|0,te=ze(se|0,0,45)|0,u=te|u,c=Se()|0|c&-1040385,f=s[4272+(W*28|0)+(f<<2)>>2]|0,(se&127|0)==127&&(se=ze(s[848+(W*28|0)+20>>2]|0,0,45)|0,c=Se()|0|c&-1040385,f=s[4272+(W*28|0)+20>>2]|0,u=oi(se|u,c)|0,c=Se()|0,s[g>>2]=(s[g>>2]|0)+1)),D=Te(u|0,c|0,45)|0,Se()|0,D=D&127;e:do if(En(D)|0){t:do if((Nr(u,c)|0)==1){if((W|0)!=(D|0))if(To(D,s[7696+(W*28|0)>>2]|0)|0){u=Ur(u,c)|0,P=1,c=Se()|0;break}else Ht(23313,22416,436,22424);switch(N|0){case 3:{u=oi(u,c)|0,c=Se()|0,s[g>>2]=(s[g>>2]|0)+1,P=0;break t}case 5:{u=Ur(u,c)|0,c=Se()|0,s[g>>2]=(s[g>>2]|0)+5,P=0;break t}case 0:return se=9,se|0;default:return se=1,se|0}}else P=0;while(0);if((f|0)>0){b=0;do u=il(u,c)|0,c=Se()|0,b=b+1|0;while((b|0)!=(f|0))}if((W|0)!=(D|0)){if(!(za(D)|0)){if((P|0)!=0|(Nr(u,c)|0)!=5)break;s[g>>2]=(s[g>>2]|0)+1;break}switch(K&127){case 8:case 118:break e}(Nr(u,c)|0)!=3&&(s[g>>2]=(s[g>>2]|0)+1)}}else if((f|0)>0){b=0;do u=oi(u,c)|0,c=Se()|0,b=b+1|0;while((b|0)!=(f|0))}while(0);return s[g>>2]=((s[g>>2]|0)+f|0)%6|0,se=y,s[se>>2]=u,s[se+4>>2]=c,se=0,se|0}function ot(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0;for(D=_e,_e=_e+16|0,b=D,P=D+8|0,y=(ui(u,c)|0)==0,y=y?1:2;;){if(s[P>>2]=0,G=(Ge(u,c,y,P,b)|0)==0,N=b,G&((s[N>>2]|0)==(f|0)?(s[N+4>>2]|0)==(g|0):0)){u=4;break}if(y=y+1|0,y>>>0>=7){y=7,u=4;break}}return(u|0)==4?(_e=D,y|0):0}function vt(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0;if(se=_e,_e=_e+16|0,de=se,te=se+8|0,K=de,s[K>>2]=u,s[K+4>>2]=c,!f)return te=g,s[te>>2]=u,s[te+4>>2]=c,te=0,_e=se,te|0;s[te>>2]=0;e:do if(ui(u,c)|0)u=9;else{if(b=(f|0)>0,b){y=0,K=u;do{if(u=Ge(K,c,4,te,de)|0,u|0)break e;if(c=de,K=s[c>>2]|0,c=s[c+4>>2]|0,y=y+1|0,ui(K,c)|0){u=9;break e}}while((y|0)<(f|0));if(W=g,s[W>>2]=K,s[W+4>>2]=c,W=f+-1|0,b){G=0,u=1;do{if(y=22384+(G<<2)|0,(G|0)==5)for(P=s[y>>2]|0,b=0,y=u;;){if(u=de,u=Ge(s[u>>2]|0,s[u+4>>2]|0,P,te,de)|0,u|0)break e;if((b|0)!=(W|0))if(N=de,D=s[N>>2]|0,N=s[N+4>>2]|0,u=g+(y<<3)|0,s[u>>2]=D,s[u+4>>2]=N,!(ui(D,N)|0))u=y+1|0;else{u=9;break e}else u=y;if(b=b+1|0,(b|0)>=(f|0))break;y=u}else for(P=de,N=s[y>>2]|0,D=0,y=u,b=s[P>>2]|0,P=s[P+4>>2]|0;;){if(u=Ge(b,P,N,te,de)|0,u|0)break e;if(P=de,b=s[P>>2]|0,P=s[P+4>>2]|0,u=g+(y<<3)|0,s[u>>2]=b,s[u+4>>2]=P,u=y+1|0,ui(b,P)|0){u=9;break e}if(D=D+1|0,(D|0)>=(f|0))break;y=u}G=G+1|0}while(G>>>0<6);u=de,P=K,y=s[u>>2]|0,b=c,u=s[u+4>>2]|0}else P=K,y=K,b=c,u=c}else P=g,s[P>>2]=u,s[P+4>>2]=c,P=u,y=u,b=c,u=c;u=(P|0)==(y|0)&(b|0)==(u|0)?0:9}while(0);return te=u,_e=se,te|0}function Zt(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0;if(D=_e,_e=_e+48|0,y=D+16|0,b=D+8|0,P=D,f|0)return P=15,_e=D,P|0;if(G=u,N=s[G+4>>2]|0,f=b,s[f>>2]=s[G>>2],s[f+4>>2]=N,sl(b,y),c=KA(y,c,P)|0,!c){if(f=s[b>>2]|0,b=s[u+8>>2]|0,(b|0)>0){y=s[u+12>>2]|0,c=0;do f=(s[y+(c<<3)>>2]|0)+f|0,c=c+1|0;while((c|0)<(b|0))}c=P,y=s[c>>2]|0,c=s[c+4>>2]|0,b=((f|0)<0)<<31>>31,(c|0)<(b|0)|(c|0)==(b|0)&y>>>0<f>>>0?(c=P,s[c>>2]=f,s[c+4>>2]=b,c=b):f=y,N=E(f|0,c|0,12,0)|0,G=Se()|0,c=P,s[c>>2]=N,s[c+4>>2]=G,c=g,s[c>>2]=N,s[c+4>>2]=G,c=0}return G=c,_e=D,G|0}function Cn(u,c,f,g,y,b,P){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0,b=b|0,P=P|0;var D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0,ct=0,Ct=0,un=0,Yt=0,wt=0,zt=0,nn=0,fn=0,cn=0,Pn=0,Gn=0,Kr=0;if(fn=_e,_e=_e+64|0,Yt=fn+48|0,wt=fn+32|0,zt=fn+24|0,At=fn+8|0,_t=fn,N=s[u>>2]|0,(N|0)<=0)return nn=0,_e=fn,nn|0;for(nt=u+4|0,ct=Yt+8|0,Ct=wt+8|0,un=At+8|0,D=0,Be=0;;){G=s[nt>>2]|0,Re=G+(Be<<4)|0,s[Yt>>2]=s[Re>>2],s[Yt+4>>2]=s[Re+4>>2],s[Yt+8>>2]=s[Re+8>>2],s[Yt+12>>2]=s[Re+12>>2],(Be|0)==(N+-1|0)?(s[wt>>2]=s[G>>2],s[wt+4>>2]=s[G+4>>2],s[wt+8>>2]=s[G+8>>2],s[wt+12>>2]=s[G+12>>2]):(Re=G+(Be+1<<4)|0,s[wt>>2]=s[Re>>2],s[wt+4>>2]=s[Re+4>>2],s[wt+8>>2]=s[Re+8>>2],s[wt+12>>2]=s[Re+12>>2]),N=JA(Yt,wt,g,zt)|0;e:do if(N)G=0,D=N;else if(G=zt,N=s[G>>2]|0,G=s[G+4>>2]|0,(G|0)>0|(G|0)==0&N>>>0>0){Fe=0,Re=0;t:for(;;){if(Kr=+Z[Yt>>3],Ie=L(N|0,G|0,Fe|0,Re|0)|0,Gn=+(Ie>>>0)+4294967296*+(Se()|0),cn=+(N>>>0)+4294967296*+(G|0),Pn=+(Fe>>>0)+4294967296*+(Re|0),Z[At>>3]=Kr*Gn/cn+ +Z[wt>>3]*Pn/cn,Z[un>>3]=+Z[ct>>3]*Gn/cn+ +Z[Ct>>3]*Pn/cn,N=Ps(At,g,_t)|0,N|0){D=N;break}Ie=_t,xe=s[Ie>>2]|0,Ie=s[Ie+4>>2]|0,de=pe(xe|0,Ie|0,c|0,f|0)|0,W=Se()|0,N=P+(de<<3)|0,K=N,G=s[K>>2]|0,K=s[K+4>>2]|0;n:do if((G|0)==0&(K|0)==0)Le=N,nn=16;else for(te=0,se=0;;){if((te|0)>(f|0)|(te|0)==(f|0)&se>>>0>c>>>0){D=1;break t}if((G|0)==(xe|0)&(K|0)==(Ie|0))break n;if(N=E(de|0,W|0,1,0)|0,de=le(N|0,Se()|0,c|0,f|0)|0,W=Se()|0,se=E(se|0,te|0,1,0)|0,te=Se()|0,N=P+(de<<3)|0,K=N,G=s[K>>2]|0,K=s[K+4>>2]|0,(G|0)==0&(K|0)==0){Le=N,nn=16;break}}while(0);if((nn|0)==16&&(nn=0,!((xe|0)==0&(Ie|0)==0))&&(se=Le,s[se>>2]=xe,s[se+4>>2]=Ie,se=b+(s[y>>2]<<3)|0,s[se>>2]=xe,s[se+4>>2]=Ie,se=y,se=E(s[se>>2]|0,s[se+4>>2]|0,1,0)|0,xe=Se()|0,Ie=y,s[Ie>>2]=se,s[Ie+4>>2]=xe),Fe=E(Fe|0,Re|0,1,0)|0,Re=Se()|0,G=zt,N=s[G>>2]|0,G=s[G+4>>2]|0,!((G|0)>(Re|0)|(G|0)==(Re|0)&N>>>0>Fe>>>0)){G=1;break e}}G=0}else G=1;while(0);if(Be=Be+1|0,!G){nn=21;break}if(N=s[u>>2]|0,(Be|0)>=(N|0)){D=0,nn=21;break}}return(nn|0)==21?(_e=fn,D|0):0}function Ei(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0,ct=0,Ct=0,un=0,Yt=0,wt=0,zt=0,nn=0,fn=0,cn=0,Pn=0,Gn=0;if(Gn=_e,_e=_e+112|0,nn=Gn+80|0,N=Gn+72|0,fn=Gn,cn=Gn+56|0,f|0)return Pn=15,_e=Gn,Pn|0;if(G=u+8|0,Pn=Pi((s[G>>2]<<5)+32|0)|0,!Pn)return Pn=13,_e=Gn,Pn|0;if(wr(u,Pn),wt=u,zt=s[wt+4>>2]|0,f=N,s[f>>2]=s[wt>>2],s[f+4>>2]=zt,sl(N,nn),f=KA(nn,c,fn)|0,f)wt=0,zt=0;else{if(f=s[N>>2]|0,b=s[G>>2]|0,(b|0)>0){P=s[u+12>>2]|0,y=0;do f=(s[P+(y<<3)>>2]|0)+f|0,y=y+1|0;while((y|0)!=(b|0));y=f}else y=f;f=fn,b=s[f>>2]|0,f=s[f+4>>2]|0,P=((y|0)<0)<<31>>31,(f|0)<(P|0)|(f|0)==(P|0)&b>>>0<y>>>0?(f=fn,s[f>>2]=y,s[f+4>>2]=P,f=P):y=b,wt=E(y|0,f|0,12,0)|0,zt=Se()|0,f=fn,s[f>>2]=wt,s[f+4>>2]=zt,f=0}if(f|0)return _(Pn),Pn=f,_e=Gn,Pn|0;if(y=v(wt,8)|0,!y)return _(Pn),Pn=13,_e=Gn,Pn|0;if(D=v(wt,8)|0,!D)return _(Pn),_(y),Pn=13,_e=Gn,Pn|0;un=nn,s[un>>2]=0,s[un+4>>2]=0,un=u,Yt=s[un+4>>2]|0,f=N,s[f>>2]=s[un>>2],s[f+4>>2]=Yt,f=Cn(N,wt,zt,c,nn,y,D)|0;e:do if(f)_(y),_(D),_(Pn);else{t:do if((s[G>>2]|0)>0){for(P=u+12|0,b=0;f=Cn((s[P>>2]|0)+(b<<3)|0,wt,zt,c,nn,y,D)|0,b=b+1|0,!(f|0);)if((b|0)>=(s[G>>2]|0))break t;_(y),_(D),_(Pn);break e}while(0);(zt|0)>0|(zt|0)==0&wt>>>0>0&&w(D|0,0,wt<<3|0)|0,Yt=nn,un=s[Yt+4>>2]|0;t:do if((un|0)>0|(un|0)==0&(s[Yt>>2]|0)>>>0>0){nt=y,ct=D,Ct=y,un=D,Yt=y,f=y,Le=y,At=D,_t=D,y=D;n:for(;;){for(Ie=0,Fe=0,Re=0,Be=0,b=0,P=0;;){D=fn,N=D+56|0;do s[D>>2]=0,D=D+4|0;while((D|0)<(N|0));if(c=nt+(Ie<<3)|0,G=s[c>>2]|0,c=s[c+4>>2]|0,ge(G,c,1,fn,0)|0){D=fn,N=D+56|0;do s[D>>2]=0,D=D+4|0;while((D|0)<(N|0));D=v(7,4)|0,D|0&&(Ee(G,c,1,fn,D,7,0,0)|0,_(D))}for(xe=0;;){se=fn+(xe<<3)|0,te=s[se>>2]|0,se=s[se+4>>2]|0;i:do if((te|0)==0&(se|0)==0)D=b,N=P;else{if(W=pe(te|0,se|0,wt|0,zt|0)|0,G=Se()|0,D=g+(W<<3)|0,c=D,N=s[c>>2]|0,c=s[c+4>>2]|0,!((N|0)==0&(c|0)==0)){K=0,de=0;do{if((K|0)>(zt|0)|(K|0)==(zt|0)&de>>>0>wt>>>0)break n;if((N|0)==(te|0)&(c|0)==(se|0)){D=b,N=P;break i}D=E(W|0,G|0,1,0)|0,W=le(D|0,Se()|0,wt|0,zt|0)|0,G=Se()|0,de=E(de|0,K|0,1,0)|0,K=Se()|0,D=g+(W<<3)|0,c=D,N=s[c>>2]|0,c=s[c+4>>2]|0}while(!((N|0)==0&(c|0)==0))}(te|0)==0&(se|0)==0?(D=b,N=P):(Mo(te,se,cn)|0,co(u,Pn,cn)|0&&(de=E(b|0,P|0,1,0)|0,P=Se()|0,K=D,s[K>>2]=te,s[K+4>>2]=se,b=ct+(b<<3)|0,s[b>>2]=te,s[b+4>>2]=se,b=de),D=b,N=P)}while(0);if(xe=xe+1|0,xe>>>0>=7)break;b=D,P=N}if(Ie=E(Ie|0,Fe|0,1,0)|0,Fe=Se()|0,Re=E(Re|0,Be|0,1,0)|0,Be=Se()|0,P=nn,b=s[P>>2]|0,P=s[P+4>>2]|0,(Be|0)<(P|0)|(Be|0)==(P|0)&Re>>>0<b>>>0)b=D,P=N;else break}if((P|0)>0|(P|0)==0&b>>>0>0){b=0,P=0;do Be=nt+(b<<3)|0,s[Be>>2]=0,s[Be+4>>2]=0,b=E(b|0,P|0,1,0)|0,P=Se()|0,Be=nn,Re=s[Be+4>>2]|0;while((P|0)<(Re|0)|((P|0)==(Re|0)?b>>>0<(s[Be>>2]|0)>>>0:0))}if(Be=nn,s[Be>>2]=D,s[Be+4>>2]=N,(N|0)>0|(N|0)==0&D>>>0>0)xe=y,Ie=_t,Fe=Yt,Re=At,Be=ct,y=Le,_t=f,At=Ct,Le=xe,f=Ie,Yt=un,un=Fe,Ct=Re,ct=nt,nt=Be;else break t}_(Ct),_(un),_(Pn),f=1;break e}else f=D;while(0);_(Pn),_(y),_(f),f=0}while(0);return Pn=f,_e=Gn,Pn|0}function wn(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0;if(W=_e,_e=_e+176|0,N=W,(c|0)<1)return MA(f,0,0),G=0,_e=W,G|0;for(D=u,D=Te(s[D>>2]|0,s[D+4>>2]|0,52)|0,Se()|0,MA(f,(c|0)>6?c:6,D&15),D=0;g=u+(D<<3)|0,g=tr(s[g>>2]|0,s[g+4>>2]|0,N)|0,!(g|0);){if(g=s[N>>2]|0,(g|0)>0){P=0;do b=N+8+(P<<4)|0,P=P+1|0,g=N+8+(((P|0)%(g|0)|0)<<4)|0,y=Wa(f,g,b)|0,y?xt(f,y)|0:qt(f,b,g)|0,g=s[N>>2]|0;while((P|0)<(g|0))}if(D=D+1|0,(D|0)>=(c|0)){g=0,G=13;break}}return(G|0)==13?(_e=W,g|0):(br(f),G=g,_e=W,G|0)}function Li(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0;if(b=_e,_e=_e+32|0,g=b,y=b+16|0,u=wn(u,c,y)|0,u|0)return f=u,_e=b,f|0;if(s[f>>2]=0,s[f+4>>2]=0,s[f+8>>2]=0,u=Er(y)|0,u|0)do{c=da(f)|0;do zl(c,u)|0,P=u+16|0,s[g>>2]=s[P>>2],s[g+4>>2]=s[P+4>>2],s[g+8>>2]=s[P+8>>2],s[g+12>>2]=s[P+12>>2],xt(y,u)|0,u=ai(y,g)|0;while(u|0);u=Er(y)|0}while(u|0);return br(y),u=EA(f)|0,u?(Bt(f),P=u,_e=b,P|0):(P=0,_e=b,P|0)}function En(u){return u=u|0,u>>>0>121?(u=0,u|0):(u=s[7696+(u*28|0)+16>>2]|0,u|0)}function za(u){return u=u|0,(u|0)==4|(u|0)==117|0}function zr(u){return u=u|0,s[11120+((s[u>>2]|0)*216|0)+((s[u+4>>2]|0)*72|0)+((s[u+8>>2]|0)*24|0)+(s[u+12>>2]<<3)>>2]|0}function aA(u){return u=u|0,s[11120+((s[u>>2]|0)*216|0)+((s[u+4>>2]|0)*72|0)+((s[u+8>>2]|0)*24|0)+(s[u+12>>2]<<3)+4>>2]|0}function AA(u,c){u=u|0,c=c|0,u=7696+(u*28|0)|0,s[c>>2]=s[u>>2],s[c+4>>2]=s[u+4>>2],s[c+8>>2]=s[u+8>>2],s[c+12>>2]=s[u+12>>2]}function Jo(u,c){u=u|0,c=c|0;var f=0,g=0;if(c>>>0>20)return c=-1,c|0;do if((s[11120+(c*216|0)>>2]|0)!=(u|0))if((s[11120+(c*216|0)+8>>2]|0)!=(u|0))if((s[11120+(c*216|0)+16>>2]|0)!=(u|0))if((s[11120+(c*216|0)+24>>2]|0)!=(u|0))if((s[11120+(c*216|0)+32>>2]|0)!=(u|0))if((s[11120+(c*216|0)+40>>2]|0)!=(u|0))if((s[11120+(c*216|0)+48>>2]|0)!=(u|0))if((s[11120+(c*216|0)+56>>2]|0)!=(u|0))if((s[11120+(c*216|0)+64>>2]|0)!=(u|0))if((s[11120+(c*216|0)+72>>2]|0)!=(u|0))if((s[11120+(c*216|0)+80>>2]|0)!=(u|0))if((s[11120+(c*216|0)+88>>2]|0)!=(u|0))if((s[11120+(c*216|0)+96>>2]|0)!=(u|0))if((s[11120+(c*216|0)+104>>2]|0)!=(u|0))if((s[11120+(c*216|0)+112>>2]|0)!=(u|0))if((s[11120+(c*216|0)+120>>2]|0)!=(u|0))if((s[11120+(c*216|0)+128>>2]|0)!=(u|0))if((s[11120+(c*216|0)+136>>2]|0)==(u|0))u=2,f=1,g=2;else{if((s[11120+(c*216|0)+144>>2]|0)==(u|0)){u=0,f=2,g=0;break}if((s[11120+(c*216|0)+152>>2]|0)==(u|0)){u=0,f=2,g=1;break}if((s[11120+(c*216|0)+160>>2]|0)==(u|0)){u=0,f=2,g=2;break}if((s[11120+(c*216|0)+168>>2]|0)==(u|0)){u=1,f=2,g=0;break}if((s[11120+(c*216|0)+176>>2]|0)==(u|0)){u=1,f=2,g=1;break}if((s[11120+(c*216|0)+184>>2]|0)==(u|0)){u=1,f=2,g=2;break}if((s[11120+(c*216|0)+192>>2]|0)==(u|0)){u=2,f=2,g=0;break}if((s[11120+(c*216|0)+200>>2]|0)==(u|0)){u=2,f=2,g=1;break}if((s[11120+(c*216|0)+208>>2]|0)==(u|0)){u=2,f=2,g=2;break}else u=-1;return u|0}else u=2,f=1,g=1;else u=2,f=1,g=0;else u=1,f=1,g=2;else u=1,f=1,g=1;else u=1,f=1,g=0;else u=0,f=1,g=2;else u=0,f=1,g=1;else u=0,f=1,g=0;else u=2,f=0,g=2;else u=2,f=0,g=1;else u=2,f=0,g=0;else u=1,f=0,g=2;else u=1,f=0,g=1;else u=1,f=0,g=0;else u=0,f=0,g=2;else u=0,f=0,g=1;else u=0,f=0,g=0;while(0);return c=s[11120+(c*216|0)+(f*72|0)+(u*24|0)+(g<<3)+4>>2]|0,c|0}function To(u,c){return u=u|0,c=c|0,(s[7696+(u*28|0)+20>>2]|0)==(c|0)?(c=1,c|0):(c=(s[7696+(u*28|0)+24>>2]|0)==(c|0),c|0)}function ea(u,c){return u=u|0,c=c|0,s[848+(u*28|0)+(c<<2)>>2]|0}function ta(u,c){return u=u|0,c=c|0,(s[848+(u*28|0)>>2]|0)==(c|0)?(c=0,c|0):(s[848+(u*28|0)+4>>2]|0)==(c|0)?(c=1,c|0):(s[848+(u*28|0)+8>>2]|0)==(c|0)?(c=2,c|0):(s[848+(u*28|0)+12>>2]|0)==(c|0)?(c=3,c|0):(s[848+(u*28|0)+16>>2]|0)==(c|0)?(c=4,c|0):(s[848+(u*28|0)+20>>2]|0)==(c|0)?(c=5,c|0):((s[848+(u*28|0)+24>>2]|0)==(c|0)?6:7)|0}function So(){return 122}function lA(u){u=u|0;var c=0,f=0,g=0;c=0;do ze(c|0,0,45)|0,g=Se()|0|134225919,f=u+(c<<3)|0,s[f>>2]=-1,s[f+4>>2]=g,c=c+1|0;while((c|0)!=122);return 0}function fr(u){return u=u|0,+Z[u+16>>3]<+Z[u+24>>3]|0}function Fr(u,c){u=u|0,c=c|0;var f=0,g=0,y=0;return f=+Z[c>>3],!(f>=+Z[u+8>>3])||!(f<=+Z[u>>3])?(c=0,c|0):(g=+Z[u+16>>3],f=+Z[u+24>>3],y=+Z[c+8>>3],c=y>=f,u=y<=g&1,g<f?c&&(u=1):c||(u=0),c=(u|0)!=0,c|0)}function KA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0;se=_e,_e=_e+288|0,W=se+264|0,K=se+96|0,G=se,D=G,N=D+96|0;do s[D>>2]=0,D=D+4|0;while((D|0)<(N|0));return c=fs(c,G)|0,c|0?(te=c,_e=se,te|0):(N=G,G=s[N>>2]|0,N=s[N+4>>2]|0,Mo(G,N,W)|0,tr(G,N,K)|0,P=+lo(W,K+8|0),Z[W>>3]=+Z[u>>3],N=W+8|0,Z[N>>3]=+Z[u+16>>3],Z[K>>3]=+Z[u+8>>3],G=K+8|0,Z[G>>3]=+Z[u+24>>3],y=+lo(W,K),Ie=+Z[N>>3]-+Z[G>>3],b=+yt(+Ie),xe=+Z[W>>3]-+Z[K>>3],g=+yt(+xe),!(Ie==0|xe==0)&&(Ie=+it(+b,+g),Ie=+On(+(y*y/+M(+(Ie/+M(+b,+g)),3)/(P*(P*2.59807621135)*.8))),Z[ft>>3]=Ie,de=~~Ie>>>0,te=+yt(Ie)>=1?Ie>0?~~+ur(+kt(Ie/4294967296),4294967295)>>>0:~~+On((Ie-+(~~Ie>>>0))/4294967296)>>>0:0,(s[ft+4>>2]&2146435072|0)!=2146435072)?(K=(de|0)==0&(te|0)==0,c=f,s[c>>2]=K?1:de,s[c+4>>2]=K?0:te,c=0):c=1,te=c,_e=se,te|0)}function JA(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0;G=_e,_e=_e+288|0,P=G+264|0,D=G+96|0,N=G,y=N,b=y+96|0;do s[y>>2]=0,y=y+4|0;while((y|0)<(b|0));return f=fs(f,N)|0,f|0?(g=f,_e=G,g|0):(f=N,y=s[f>>2]|0,f=s[f+4>>2]|0,Mo(y,f,P)|0,tr(y,f,D)|0,W=+lo(P,D+8|0),W=+On(+(+lo(u,c)/(W*2))),Z[ft>>3]=W,f=~~W>>>0,y=+yt(W)>=1?W>0?~~+ur(+kt(W/4294967296),4294967295)>>>0:~~+On((W-+(~~W>>>0))/4294967296)>>>0:0,(s[ft+4>>2]&2146435072|0)==2146435072?(g=1,_e=G,g|0):(N=(f|0)==0&(y|0)==0,s[g>>2]=N?1:f,s[g+4>>2]=N?0:y,g=0,_e=G,g|0))}function Ti(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0,s[u>>2]=c,s[u+4>>2]=f,s[u+8>>2]=g}function as(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0;K=c+8|0,s[K>>2]=0,N=+Z[u>>3],P=+yt(+N),G=+Z[u+8>>3],D=+yt(+G)/.8660254037844386,P=P+D*.5,f=~~P,u=~~D,P=P-+(f|0),D=D-+(u|0);do if(P<.5)if(P<.3333333333333333)if(s[c>>2]=f,D<(P+1)*.5){s[c+4>>2]=u;break}else{u=u+1|0,s[c+4>>2]=u;break}else if(de=1-P,u=(!(D<de)&1)+u|0,s[c+4>>2]=u,de<=D&D<P*2){f=f+1|0,s[c>>2]=f;break}else{s[c>>2]=f;break}else{if(!(P<.6666666666666666))if(f=f+1|0,s[c>>2]=f,D<P*.5){s[c+4>>2]=u;break}else{u=u+1|0,s[c+4>>2]=u;break}if(D<1-P){if(s[c+4>>2]=u,P*2+-1<D){s[c>>2]=f;break}}else u=u+1|0,s[c+4>>2]=u;f=f+1|0,s[c>>2]=f}while(0);do if(N<0)if(u&1){W=(u+1|0)/2|0,W=L(f|0,((f|0)<0)<<31>>31|0,W|0,((W|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-((+(W>>>0)+4294967296*+(Se()|0))*2+1)),s[c>>2]=f;break}else{W=(u|0)/2|0,W=L(f|0,((f|0)<0)<<31>>31|0,W|0,((W|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-(+(W>>>0)+4294967296*+(Se()|0))*2),s[c>>2]=f;break}while(0);W=c+4|0,G<0&&(f=f-((u<<1|1|0)/2|0)|0,s[c>>2]=f,u=0-u|0,s[W>>2]=u),g=u-f|0,(f|0)<0?(y=0-f|0,s[W>>2]=g,s[K>>2]=y,s[c>>2]=0,u=g,f=0):y=0,(u|0)<0&&(f=f-u|0,s[c>>2]=f,y=y-u|0,s[K>>2]=y,s[W>>2]=0,u=0),b=f-y|0,g=u-y|0,(y|0)<0&&(s[c>>2]=b,s[W>>2]=g,s[K>>2]=0,u=g,f=b,y=0),g=(u|0)<(f|0)?u:f,g=(y|0)<(g|0)?y:g,!((g|0)<=0)&&(s[c>>2]=f-g,s[W>>2]=u-g,s[K>>2]=y-g)}function rn(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0;c=s[u>>2]|0,P=u+4|0,f=s[P>>2]|0,(c|0)<0&&(f=f-c|0,s[P>>2]=f,b=u+8|0,s[b>>2]=(s[b>>2]|0)-c,s[u>>2]=0,c=0),(f|0)<0?(c=c-f|0,s[u>>2]=c,b=u+8|0,y=(s[b>>2]|0)-f|0,s[b>>2]=y,s[P>>2]=0,f=0):(y=u+8|0,b=y,y=s[y>>2]|0),(y|0)<0&&(c=c-y|0,s[u>>2]=c,f=f-y|0,s[P>>2]=f,s[b>>2]=0,y=0),g=(f|0)<(c|0)?f:c,g=(y|0)<(g|0)?y:g,!((g|0)<=0)&&(s[u>>2]=c-g,s[P>>2]=f-g,s[b>>2]=y-g)}function As(u,c){u=u|0,c=c|0;var f=0,g=0;g=s[u+8>>2]|0,f=+((s[u+4>>2]|0)-g|0),Z[c>>3]=+((s[u>>2]|0)-g|0)-f*.5,Z[c+8>>3]=f*.8660254037844386}function Hi(u,c,f){u=u|0,c=c|0,f=f|0,s[f>>2]=(s[c>>2]|0)+(s[u>>2]|0),s[f+4>>2]=(s[c+4>>2]|0)+(s[u+4>>2]|0),s[f+8>>2]=(s[c+8>>2]|0)+(s[u+8>>2]|0)}function Co(u,c,f){u=u|0,c=c|0,f=f|0,s[f>>2]=(s[u>>2]|0)-(s[c>>2]|0),s[f+4>>2]=(s[u+4>>2]|0)-(s[c+4>>2]|0),s[f+8>>2]=(s[u+8>>2]|0)-(s[c+8>>2]|0)}function Fa(u,c){u=u|0,c=c|0;var f=0,g=0;f=qn(s[u>>2]|0,c)|0,s[u>>2]=f,f=u+4|0,g=qn(s[f>>2]|0,c)|0,s[f>>2]=g,u=u+8|0,c=qn(s[u>>2]|0,c)|0,s[u>>2]=c}function na(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;P=s[u>>2]|0,D=(P|0)<0,g=(s[u+4>>2]|0)-(D?P:0)|0,b=(g|0)<0,y=(b?0-g|0:0)+((s[u+8>>2]|0)-(D?P:0))|0,f=(y|0)<0,u=f?0:y,c=(b?0:g)-(f?y:0)|0,y=(D?0:P)-(b?g:0)-(f?y:0)|0,f=(c|0)<(y|0)?c:y,f=(u|0)<(f|0)?u:f,g=(f|0)>0,u=u-(g?f:0)|0,c=c-(g?f:0)|0;e:do switch(y-(g?f:0)|0){case 0:switch(c|0){case 0:return D=u|0?(u|0)==1?1:7:0,D|0;case 1:return D=u|0?(u|0)==1?3:7:2,D|0;default:break e}case 1:switch(c|0){case 0:return D=u|0?(u|0)==1?5:7:4,D|0;case 1:{if(!u)u=6;else break e;return u|0}default:break e}}while(0);return D=7,D|0}function uA(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;P=u+8|0,y=s[P>>2]|0,b=(s[u>>2]|0)-y|0,D=u+4|0,y=(s[D>>2]|0)-y|0;do if(b>>>0>715827881|y>>>0>715827881){if(f=(b|0)>0,f){if((2147483647-b|0)<(b|0)||(2147483647-(b<<1)|0)<(b|0))return D=1,D|0}else if((-2147483648-b|0)>(b|0)||(-2147483648-(b<<1)|0)>(b|0))return D=1,D|0;if(c=b*3|0,(y|0)>0){if((2147483647-y|0)<(y|0))return D=1,D|0}else if((-2147483648-y|0)>(y|0))return D=1,D|0;if(g=y<<1,(b|0)>-1){if((c|-2147483648|0)>=(y|0))return D=1,D|0}else if((c^-2147483648|0)<(y|0))return D=1,D|0;if(f){if((2147483647-b|0)<(g|0))c=1;else{f=g;break}return c|0}else{if((-2147483648-b|0)>(g|0))c=1;else{f=g;break}return c|0}}else f=y<<1,c=b*3|0;while(0);g=Bi(+(c-y|0)/7)|0,s[u>>2]=g,y=Bi(+(f+b|0)/7)|0,s[D>>2]=y,s[P>>2]=0,f=(y|0)<(g|0),c=f?g:y,f=f?y:g;do if((f|0)<0){if((c|0)>0){if((c|-2147483648|0)<(f|0)&((f|0)!=-2147483648&(2147483647-c|0)>=(f|0)))break;Ht(23313,22444,355,22455)}if((f|0)==-2147483648|(-2147483648-c|0)>(f|0)&&Ht(23313,22444,355,22455),(c|0)>-1){if((c|-2147483648|0)<(f|0))break;Ht(23313,22444,355,22455)}else{if((c^-2147483648|0)>=(f|0))break;Ht(23313,22444,355,22455)}}while(0);return c=y-g|0,(g|0)<0?(f=0-g|0,s[D>>2]=c,s[P>>2]=f,s[u>>2]=0,g=0):(c=y,f=0),(c|0)<0&&(g=g-c|0,s[u>>2]=g,f=f-c|0,s[P>>2]=f,s[D>>2]=0,c=0),b=g-f|0,y=c-f|0,(f|0)<0?(s[u>>2]=b,s[D>>2]=y,s[P>>2]=0,c=y,y=b,f=0):y=g,g=(c|0)<(y|0)?c:y,g=(f|0)<(g|0)?f:g,(g|0)<=0?(D=0,D|0):(s[u>>2]=y-g,s[D>>2]=c-g,s[P>>2]=f-g,D=0,D|0)}function ls(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;P=u+8|0,y=s[P>>2]|0,b=(s[u>>2]|0)-y|0,D=u+4|0,y=(s[D>>2]|0)-y|0;do if(b>>>0>715827881|y>>>0>715827881){if(f=(b|0)>0,f){if((2147483647-b|0)<(b|0))return D=1,D|0}else if((-2147483648-b|0)>(b|0))return D=1,D|0;if(c=b<<1,(y|0)>0){if((2147483647-y|0)<(y|0)||(2147483647-(y<<1)|0)<(y|0))return D=1,D|0}else if((-2147483648-y|0)>(y|0)||(-2147483648-(y<<1)|0)>(y|0))return D=1,D|0;if(g=y*3|0,f){if((2147483647-c|0)<(y|0))return D=1,D|0}else if((-2147483648-c|0)>(y|0))return D=1,D|0;if((y|0)>-1){if((g|-2147483648|0)<(b|0)){f=g;break}else c=1;return c|0}else{if((g^-2147483648|0)<(b|0))c=1;else{f=g;break}return c|0}}else f=y*3|0,c=b<<1;while(0);g=Bi(+(c+y|0)/7)|0,s[u>>2]=g,y=Bi(+(f-b|0)/7)|0,s[D>>2]=y,s[P>>2]=0,f=(y|0)<(g|0),c=f?g:y,f=f?y:g;do if((f|0)<0){if((c|0)>0){if((c|-2147483648|0)<(f|0)&((f|0)!=-2147483648&(2147483647-c|0)>=(f|0)))break;Ht(23313,22444,404,22469)}if((f|0)==-2147483648|(-2147483648-c|0)>(f|0)&&Ht(23313,22444,404,22469),(c|0)>-1){if((c|-2147483648|0)<(f|0))break;Ht(23313,22444,404,22469)}else{if((c^-2147483648|0)>=(f|0))break;Ht(23313,22444,404,22469)}}while(0);return c=y-g|0,(g|0)<0?(f=0-g|0,s[D>>2]=c,s[P>>2]=f,s[u>>2]=0,g=0):(c=y,f=0),(c|0)<0&&(g=g-c|0,s[u>>2]=g,f=f-c|0,s[P>>2]=f,s[D>>2]=0,c=0),b=g-f|0,y=c-f|0,(f|0)<0?(s[u>>2]=b,s[D>>2]=y,s[P>>2]=0,c=y,y=b,f=0):y=g,g=(c|0)<(y|0)?c:y,g=(f|0)<(g|0)?f:g,(g|0)<=0?(D=0,D|0):(s[u>>2]=y-g,s[D>>2]=c-g,s[P>>2]=f-g,D=0,D|0)}function Eu(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;P=u+8|0,f=s[P>>2]|0,c=(s[u>>2]|0)-f|0,D=u+4|0,f=(s[D>>2]|0)-f|0,g=Bi(+((c*3|0)-f|0)/7)|0,s[u>>2]=g,c=Bi(+((f<<1)+c|0)/7)|0,s[D>>2]=c,s[P>>2]=0,f=c-g|0,(g|0)<0?(b=0-g|0,s[D>>2]=f,s[P>>2]=b,s[u>>2]=0,c=f,g=0,f=b):f=0,(c|0)<0&&(g=g-c|0,s[u>>2]=g,f=f-c|0,s[P>>2]=f,s[D>>2]=0,c=0),b=g-f|0,y=c-f|0,(f|0)<0?(s[u>>2]=b,s[D>>2]=y,s[P>>2]=0,c=y,y=b,f=0):y=g,g=(c|0)<(y|0)?c:y,g=(f|0)<(g|0)?f:g,!((g|0)<=0)&&(s[u>>2]=y-g,s[D>>2]=c-g,s[P>>2]=f-g)}function Ml(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;P=u+8|0,f=s[P>>2]|0,c=(s[u>>2]|0)-f|0,D=u+4|0,f=(s[D>>2]|0)-f|0,g=Bi(+((c<<1)+f|0)/7)|0,s[u>>2]=g,c=Bi(+((f*3|0)-c|0)/7)|0,s[D>>2]=c,s[P>>2]=0,f=c-g|0,(g|0)<0?(b=0-g|0,s[D>>2]=f,s[P>>2]=b,s[u>>2]=0,c=f,g=0,f=b):f=0,(c|0)<0&&(g=g-c|0,s[u>>2]=g,f=f-c|0,s[P>>2]=f,s[D>>2]=0,c=0),b=g-f|0,y=c-f|0,(f|0)<0?(s[u>>2]=b,s[D>>2]=y,s[P>>2]=0,c=y,y=b,f=0):y=g,g=(c|0)<(y|0)?c:y,g=(f|0)<(g|0)?f:g,!((g|0)<=0)&&(s[u>>2]=y-g,s[D>>2]=c-g,s[P>>2]=f-g)}function ia(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;c=s[u>>2]|0,P=u+4|0,f=s[P>>2]|0,D=u+8|0,g=s[D>>2]|0,y=f+(c*3|0)|0,s[u>>2]=y,f=g+(f*3|0)|0,s[P>>2]=f,c=(g*3|0)+c|0,s[D>>2]=c,g=f-y|0,(y|0)<0?(c=c-y|0,s[P>>2]=g,s[D>>2]=c,s[u>>2]=0,f=g,g=0):g=y,(f|0)<0&&(g=g-f|0,s[u>>2]=g,c=c-f|0,s[D>>2]=c,s[P>>2]=0,f=0),b=g-c|0,y=f-c|0,(c|0)<0?(s[u>>2]=b,s[P>>2]=y,s[D>>2]=0,g=b,c=0):y=f,f=(y|0)<(g|0)?y:g,f=(c|0)<(f|0)?c:f,!((f|0)<=0)&&(s[u>>2]=g-f,s[P>>2]=y-f,s[D>>2]=c-f)}function Zr(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;y=s[u>>2]|0,P=u+4|0,c=s[P>>2]|0,D=u+8|0,f=s[D>>2]|0,g=(c*3|0)+y|0,y=f+(y*3|0)|0,s[u>>2]=y,s[P>>2]=g,c=(f*3|0)+c|0,s[D>>2]=c,f=g-y|0,(y|0)<0?(c=c-y|0,s[P>>2]=f,s[D>>2]=c,s[u>>2]=0,y=0):f=g,(f|0)<0&&(y=y-f|0,s[u>>2]=y,c=c-f|0,s[D>>2]=c,s[P>>2]=0,f=0),b=y-c|0,g=f-c|0,(c|0)<0?(s[u>>2]=b,s[P>>2]=g,s[D>>2]=0,y=b,c=0):g=f,f=(g|0)<(y|0)?g:y,f=(c|0)<(f|0)?c:f,!((f|0)<=0)&&(s[u>>2]=y-f,s[P>>2]=g-f,s[D>>2]=c-f)}function Ao(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0;(c+-1|0)>>>0>=6||(y=(s[15440+(c*12|0)>>2]|0)+(s[u>>2]|0)|0,s[u>>2]=y,D=u+4|0,g=(s[15440+(c*12|0)+4>>2]|0)+(s[D>>2]|0)|0,s[D>>2]=g,P=u+8|0,c=(s[15440+(c*12|0)+8>>2]|0)+(s[P>>2]|0)|0,s[P>>2]=c,f=g-y|0,(y|0)<0?(c=c-y|0,s[D>>2]=f,s[P>>2]=c,s[u>>2]=0,g=0):(f=g,g=y),(f|0)<0&&(g=g-f|0,s[u>>2]=g,c=c-f|0,s[P>>2]=c,s[D>>2]=0,f=0),b=g-c|0,y=f-c|0,(c|0)<0?(s[u>>2]=b,s[D>>2]=y,s[P>>2]=0,g=b,c=0):y=f,f=(y|0)<(g|0)?y:g,f=(c|0)<(f|0)?c:f,!((f|0)<=0)&&(s[u>>2]=g-f,s[D>>2]=y-f,s[P>>2]=c-f))}function Il(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;y=s[u>>2]|0,P=u+4|0,c=s[P>>2]|0,D=u+8|0,f=s[D>>2]|0,g=c+y|0,y=f+y|0,s[u>>2]=y,s[P>>2]=g,c=f+c|0,s[D>>2]=c,f=g-y|0,(y|0)<0?(c=c-y|0,s[P>>2]=f,s[D>>2]=c,s[u>>2]=0,g=0):(f=g,g=y),(f|0)<0&&(g=g-f|0,s[u>>2]=g,c=c-f|0,s[D>>2]=c,s[P>>2]=0,f=0),b=g-c|0,y=f-c|0,(c|0)<0?(s[u>>2]=b,s[P>>2]=y,s[D>>2]=0,g=b,c=0):y=f,f=(y|0)<(g|0)?y:g,f=(c|0)<(f|0)?c:f,!((f|0)<=0)&&(s[u>>2]=g-f,s[P>>2]=y-f,s[D>>2]=c-f)}function ra(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;c=s[u>>2]|0,P=u+4|0,g=s[P>>2]|0,D=u+8|0,f=s[D>>2]|0,y=g+c|0,s[u>>2]=y,g=f+g|0,s[P>>2]=g,c=f+c|0,s[D>>2]=c,f=g-y|0,(y|0)<0?(c=c-y|0,s[P>>2]=f,s[D>>2]=c,s[u>>2]=0,g=0):(f=g,g=y),(f|0)<0&&(g=g-f|0,s[u>>2]=g,c=c-f|0,s[D>>2]=c,s[P>>2]=0,f=0),b=g-c|0,y=f-c|0,(c|0)<0?(s[u>>2]=b,s[P>>2]=y,s[D>>2]=0,g=b,c=0):y=f,f=(y|0)<(g|0)?y:g,f=(c|0)<(f|0)?c:f,!((f|0)<=0)&&(s[u>>2]=g-f,s[P>>2]=y-f,s[D>>2]=c-f)}function us(u){switch(u=u|0,u|0){case 1:{u=5;break}case 5:{u=4;break}case 4:{u=6;break}case 6:{u=2;break}case 2:{u=3;break}case 3:{u=1;break}}return u|0}function js(u){switch(u=u|0,u|0){case 1:{u=3;break}case 3:{u=2;break}case 2:{u=6;break}case 6:{u=4;break}case 4:{u=5;break}case 5:{u=1;break}}return u|0}function el(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;c=s[u>>2]|0,P=u+4|0,f=s[P>>2]|0,D=u+8|0,g=s[D>>2]|0,y=f+(c<<1)|0,s[u>>2]=y,f=g+(f<<1)|0,s[P>>2]=f,c=(g<<1)+c|0,s[D>>2]=c,g=f-y|0,(y|0)<0?(c=c-y|0,s[P>>2]=g,s[D>>2]=c,s[u>>2]=0,f=g,g=0):g=y,(f|0)<0&&(g=g-f|0,s[u>>2]=g,c=c-f|0,s[D>>2]=c,s[P>>2]=0,f=0),b=g-c|0,y=f-c|0,(c|0)<0?(s[u>>2]=b,s[P>>2]=y,s[D>>2]=0,g=b,c=0):y=f,f=(y|0)<(g|0)?y:g,f=(c|0)<(f|0)?c:f,!((f|0)<=0)&&(s[u>>2]=g-f,s[P>>2]=y-f,s[D>>2]=c-f)}function Po(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;y=s[u>>2]|0,P=u+4|0,c=s[P>>2]|0,D=u+8|0,f=s[D>>2]|0,g=(c<<1)+y|0,y=f+(y<<1)|0,s[u>>2]=y,s[P>>2]=g,c=(f<<1)+c|0,s[D>>2]=c,f=g-y|0,(y|0)<0?(c=c-y|0,s[P>>2]=f,s[D>>2]=c,s[u>>2]=0,y=0):f=g,(f|0)<0&&(y=y-f|0,s[u>>2]=y,c=c-f|0,s[D>>2]=c,s[P>>2]=0,f=0),b=y-c|0,g=f-c|0,(c|0)<0?(s[u>>2]=b,s[P>>2]=g,s[D>>2]=0,y=b,c=0):g=f,f=(g|0)<(y|0)?g:y,f=(c|0)<(f|0)?c:f,!((f|0)<=0)&&(s[u>>2]=y-f,s[P>>2]=g-f,s[D>>2]=c-f)}function tl(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0;return P=(s[u>>2]|0)-(s[c>>2]|0)|0,D=(P|0)<0,g=(s[u+4>>2]|0)-(s[c+4>>2]|0)-(D?P:0)|0,b=(g|0)<0,y=(D?0-P|0:0)+(s[u+8>>2]|0)-(s[c+8>>2]|0)+(b?0-g|0:0)|0,u=(y|0)<0,c=u?0:y,f=(b?0:g)-(u?y:0)|0,y=(D?0:P)-(b?g:0)-(u?y:0)|0,u=(f|0)<(y|0)?f:y,u=(c|0)<(u|0)?c:u,g=(u|0)>0,c=c-(g?u:0)|0,f=f-(g?u:0)|0,u=y-(g?u:0)|0,u=(u|0)>-1?u:0-u|0,f=(f|0)>-1?f:0-f|0,c=(c|0)>-1?c:0-c|0,c=(f|0)>(c|0)?f:c,((u|0)>(c|0)?u:c)|0}function Tu(u,c){u=u|0,c=c|0;var f=0;f=s[u+8>>2]|0,s[c>>2]=(s[u>>2]|0)-f,s[c+4>>2]=(s[u+4>>2]|0)-f}function kl(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0;g=s[u>>2]|0,s[c>>2]=g,y=s[u+4>>2]|0,P=c+4|0,s[P>>2]=y,D=c+8|0,s[D>>2]=0,f=(y|0)<(g|0),u=f?g:y,f=f?y:g;do if((f|0)<0){if((u|0)>0){if((u|-2147483648|0)<(f|0)&((f|0)!=-2147483648&(2147483647-u|0)>=(f|0)))break;return u=1,u|0}if((f|0)==-2147483648|(-2147483648-u|0)>(f|0))return c=1,c|0;if((u|0)>-1){if((u|-2147483648|0)<(f|0))break;return u=1,u|0}else{if((u^-2147483648|0)<(f|0))u=1;else break;return u|0}}while(0);return u=y-g|0,(g|0)<0?(f=0-g|0,s[P>>2]=u,s[D>>2]=f,s[c>>2]=0,g=0):(u=y,f=0),(u|0)<0&&(g=g-u|0,s[c>>2]=g,f=f-u|0,s[D>>2]=f,s[P>>2]=0,u=0),b=g-f|0,y=u-f|0,(f|0)<0?(s[c>>2]=b,s[P>>2]=y,s[D>>2]=0,u=y,y=b,f=0):y=g,g=(u|0)<(y|0)?u:y,g=(f|0)<(g|0)?f:g,(g|0)<=0?(c=0,c|0):(s[c>>2]=y-g,s[P>>2]=u-g,s[D>>2]=f-g,c=0,c|0)}function cs(u){u=u|0;var c=0,f=0,g=0,y=0;c=u+8|0,y=s[c>>2]|0,f=y-(s[u>>2]|0)|0,s[u>>2]=f,g=u+4|0,u=(s[g>>2]|0)-y|0,s[g>>2]=u,s[c>>2]=0-(u+f)}function Su(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;f=s[u>>2]|0,c=0-f|0,s[u>>2]=c,P=u+8|0,s[P>>2]=0,D=u+4|0,g=s[D>>2]|0,y=g+f|0,(f|0)>0?(s[D>>2]=y,s[P>>2]=f,s[u>>2]=0,c=0,g=y):f=0,(g|0)<0?(b=c-g|0,s[u>>2]=b,f=f-g|0,s[P>>2]=f,s[D>>2]=0,y=b-f|0,c=0-f|0,(f|0)<0?(s[u>>2]=y,s[D>>2]=c,s[P>>2]=0,g=c,f=0):(g=0,y=b)):y=c,c=(g|0)<(y|0)?g:y,c=(f|0)<(c|0)?f:c,!((c|0)<=0)&&(s[u>>2]=y-c,s[D>>2]=g-c,s[P>>2]=f-c)}function sa(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0;if(K=_e,_e=_e+64|0,W=K,D=K+56|0,!(!0&(c&2013265920|0)==134217728&(!0&(g&2013265920|0)==134217728)))return y=5,_e=K,y|0;if((u|0)==(f|0)&(c|0)==(g|0))return s[y>>2]=0,y=0,_e=K,y|0;if(P=Te(u|0,c|0,52)|0,Se()|0,P=P&15,G=Te(f|0,g|0,52)|0,Se()|0,(P|0)!=(G&15|0))return y=12,_e=K,y|0;if(b=P+-1|0,P>>>0>1){Dl(u,c,b,W)|0,Dl(f,g,b,D)|0,G=W,N=s[G>>2]|0,G=s[G+4>>2]|0;e:do if((N|0)==(s[D>>2]|0)&&(G|0)==(s[D+4>>2]|0)){P=(P^15)*3|0,b=Te(u|0,c|0,P|0)|0,Se()|0,b=b&7,P=Te(f|0,g|0,P|0)|0,Se()|0,P=P&7;do if((b|0)==0|(P|0)==0)s[y>>2]=1,b=0;else if((b|0)==7)b=5;else{if((b|0)==1|(P|0)==1&&ui(N,G)|0){b=5;break}if((s[15536+(b<<2)>>2]|0)!=(P|0)&&(s[15568+(b<<2)>>2]|0)!=(P|0))break e;s[y>>2]=1,b=0}while(0);return y=b,_e=K,y|0}while(0)}b=W,P=b+56|0;do s[b>>2]=0,b=b+4|0;while((b|0)<(P|0));return Ko(u,c,1,W)|0,c=W,!((s[c>>2]|0)==(f|0)&&(s[c+4>>2]|0)==(g|0))&&(c=W+8|0,!((s[c>>2]|0)==(f|0)&&(s[c+4>>2]|0)==(g|0)))&&(c=W+16|0,!((s[c>>2]|0)==(f|0)&&(s[c+4>>2]|0)==(g|0)))&&(c=W+24|0,!((s[c>>2]|0)==(f|0)&&(s[c+4>>2]|0)==(g|0)))&&(c=W+32|0,!((s[c>>2]|0)==(f|0)&&(s[c+4>>2]|0)==(g|0)))&&(c=W+40|0,!((s[c>>2]|0)==(f|0)&&(s[c+4>>2]|0)==(g|0)))?(b=W+48|0,b=((s[b>>2]|0)==(f|0)?(s[b+4>>2]|0)==(g|0):0)&1):b=1,s[y>>2]=b,y=0,_e=K,y|0}function oa(u,c,f,g,y){return u=u|0,c=c|0,f=f|0,g=g|0,y=y|0,f=ot(u,c,f,g)|0,(f|0)==7?(y=11,y|0):(g=ze(f|0,0,56)|0,c=c&-2130706433|(Se()|0)|268435456,s[y>>2]=u|g,s[y+4>>2]=c,y=0,y|0)}function aa(u,c,f){return u=u|0,c=c|0,f=f|0,!0&(c&2013265920|0)==268435456?(s[f>>2]=u,s[f+4>>2]=c&-2130706433|134217728,f=0,f|0):(f=6,f|0)}function Ll(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;return y=_e,_e=_e+16|0,g=y,s[g>>2]=0,!0&(c&2013265920|0)==268435456?(b=Te(u|0,c|0,56)|0,Se()|0,g=Ge(u,c&-2130706433|134217728,b&7,g,f)|0,_e=y,g|0):(g=6,_e=y,g|0)}function Hn(u,c){u=u|0,c=c|0;var f=0;switch(f=Te(u|0,c|0,56)|0,Se()|0,f&7){case 0:case 7:return f=0,f|0}return f=c&-2130706433|134217728,!(!0&(c&2013265920|0)==268435456)||!0&(c&117440512|0)==16777216&(ui(u,f)|0)!=0?(f=0,f|0):(f=gA(u,f)|0,f|0)}function cA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0;return y=_e,_e=_e+16|0,g=y,!0&(c&2013265920|0)==268435456?(b=c&-2130706433|134217728,P=f,s[P>>2]=u,s[P+4>>2]=b,s[g>>2]=0,c=Te(u|0,c|0,56)|0,Se()|0,g=Ge(u,b,c&7,g,f+8|0)|0,_e=y,g|0):(g=6,_e=y,g|0)}function hA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0;return y=(ui(u,c)|0)==0,c=c&-2130706433,g=f,s[g>>2]=y?u:0,s[g+4>>2]=y?c|285212672:0,g=f+8|0,s[g>>2]=u,s[g+4>>2]=c|301989888,g=f+16|0,s[g>>2]=u,s[g+4>>2]=c|318767104,g=f+24|0,s[g>>2]=u,s[g+4>>2]=c|335544320,g=f+32|0,s[g>>2]=u,s[g+4>>2]=c|352321536,f=f+40|0,s[f>>2]=u,s[f+4>>2]=c|369098752,0}function Gs(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0;return P=_e,_e=_e+16|0,y=P,b=c&-2130706433|134217728,!0&(c&2013265920|0)==268435456?(g=Te(u|0,c|0,56)|0,Se()|0,g=jr(u,b,g&7)|0,(g|0)==-1?(s[f>>2]=0,b=6,_e=P,b|0):(hs(u,b,y)|0&&Ht(23313,22484,282,22499),c=Te(u|0,c|0,52)|0,Se()|0,c=c&15,ui(u,b)|0?fi(y,c,g,2,f):ii(y,c,g,2,f),b=0,_e=P,b|0)):(b=6,_e=P,b|0)}function Aa(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0;g=_e,_e=_e+16|0,y=g,fA(u,c,f,y),as(y,f+4|0),_e=g}function fA(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0;if(D=_e,_e=_e+16|0,N=D,vc(u,f,N),b=+hi(+(1-+Z[N>>3]*.5)),b<1e-16){s[g>>2]=0,s[g+4>>2]=0,s[g+8>>2]=0,s[g+12>>2]=0,_e=D;return}if(N=s[f>>2]|0,y=+Z[15920+(N*24|0)>>3],y=+Lo(y-+Lo(+qr(15600+(N<<4)|0,u))),er(c)|0?P=+Lo(y+-.3334731722518321):P=y,y=+Dn(+b)/.381966011250105,(c|0)>0){u=0;do y=y*2.6457513110645907,u=u+1|0;while((u|0)!=(c|0))}b=+Vt(+P)*y,Z[g>>3]=b,P=+pt(+P)*y,Z[g+8>>3]=P,_e=D}function vc(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;if(b=_e,_e=_e+32|0,y=b,Ec(u,y),s[c>>2]=0,Z[f>>3]=5,g=+Ci(16400,y),g<+Z[f>>3]&&(s[c>>2]=0,Z[f>>3]=g),g=+Ci(16424,y),g<+Z[f>>3]&&(s[c>>2]=1,Z[f>>3]=g),g=+Ci(16448,y),g<+Z[f>>3]&&(s[c>>2]=2,Z[f>>3]=g),g=+Ci(16472,y),g<+Z[f>>3]&&(s[c>>2]=3,Z[f>>3]=g),g=+Ci(16496,y),g<+Z[f>>3]&&(s[c>>2]=4,Z[f>>3]=g),g=+Ci(16520,y),g<+Z[f>>3]&&(s[c>>2]=5,Z[f>>3]=g),g=+Ci(16544,y),g<+Z[f>>3]&&(s[c>>2]=6,Z[f>>3]=g),g=+Ci(16568,y),g<+Z[f>>3]&&(s[c>>2]=7,Z[f>>3]=g),g=+Ci(16592,y),g<+Z[f>>3]&&(s[c>>2]=8,Z[f>>3]=g),g=+Ci(16616,y),g<+Z[f>>3]&&(s[c>>2]=9,Z[f>>3]=g),g=+Ci(16640,y),g<+Z[f>>3]&&(s[c>>2]=10,Z[f>>3]=g),g=+Ci(16664,y),g<+Z[f>>3]&&(s[c>>2]=11,Z[f>>3]=g),g=+Ci(16688,y),g<+Z[f>>3]&&(s[c>>2]=12,Z[f>>3]=g),g=+Ci(16712,y),g<+Z[f>>3]&&(s[c>>2]=13,Z[f>>3]=g),g=+Ci(16736,y),g<+Z[f>>3]&&(s[c>>2]=14,Z[f>>3]=g),g=+Ci(16760,y),g<+Z[f>>3]&&(s[c>>2]=15,Z[f>>3]=g),g=+Ci(16784,y),g<+Z[f>>3]&&(s[c>>2]=16,Z[f>>3]=g),g=+Ci(16808,y),g<+Z[f>>3]&&(s[c>>2]=17,Z[f>>3]=g),g=+Ci(16832,y),g<+Z[f>>3]&&(s[c>>2]=18,Z[f>>3]=g),g=+Ci(16856,y),!(g<+Z[f>>3])){_e=b;return}s[c>>2]=19,Z[f>>3]=g,_e=b}function Na(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0;if(b=+Ha(u),b<1e-16){c=15600+(c<<4)|0,s[y>>2]=s[c>>2],s[y+4>>2]=s[c+4>>2],s[y+8>>2]=s[c+8>>2],s[y+12>>2]=s[c+12>>2];return}if(P=+_i(+ +Z[u+8>>3],+ +Z[u>>3]),(f|0)>0){u=0;do b=b/2.6457513110645907,u=u+1|0;while((u|0)!=(f|0))}g?(b=b/3,f=(er(f)|0)==0,b=+Rn(+((f?b:b/2.6457513110645907)*.381966011250105))):(b=+Rn(+(b*.381966011250105)),er(f)|0&&(P=+Lo(P+.3334731722518321))),Di(15600+(c<<4)|0,+Lo(+Z[15920+(c*24|0)>>3]-P),b,y)}function xc(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0;g=_e,_e=_e+16|0,y=g,As(u+4|0,y),Na(y,s[u>>2]|0,c,0,f),_e=g}function fi(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0,ct=0,Ct=0,un=0,Yt=0,wt=0,zt=0,nn=0,fn=0,cn=0;if(nn=_e,_e=_e+272|0,b=nn+256|0,Re=nn+240|0,Yt=nn,wt=nn+224|0,zt=nn+208|0,Be=nn+176|0,Le=nn+160|0,At=nn+192|0,_t=nn+144|0,nt=nn+128|0,ct=nn+112|0,Ct=nn+96|0,un=nn+80|0,s[b>>2]=c,s[Re>>2]=s[u>>2],s[Re+4>>2]=s[u+4>>2],s[Re+8>>2]=s[u+8>>2],s[Re+12>>2]=s[u+12>>2],dA(Re,b,Yt),s[y>>2]=0,Re=g+f+((g|0)==5&1)|0,(Re|0)<=(f|0)){_e=nn;return}N=s[b>>2]|0,G=wt+4|0,W=Be+4|0,K=f+5|0,de=16880+(N<<2)|0,te=16960+(N<<2)|0,se=nt+8|0,xe=ct+8|0,Ie=Ct+8|0,Fe=zt+4|0,D=f;e:for(;;){P=Yt+(((D|0)%5|0)<<4)|0,s[zt>>2]=s[P>>2],s[zt+4>>2]=s[P+4>>2],s[zt+8>>2]=s[P+8>>2],s[zt+12>>2]=s[P+12>>2];do;while((bn(zt,N,0,1)|0)==2);if((D|0)>(f|0)&(er(c)|0)!=0){if(s[Be>>2]=s[zt>>2],s[Be+4>>2]=s[zt+4>>2],s[Be+8>>2]=s[zt+8>>2],s[Be+12>>2]=s[zt+12>>2],As(G,Le),g=s[Be>>2]|0,b=s[17040+(g*80|0)+(s[wt>>2]<<2)>>2]|0,s[Be>>2]=s[18640+(g*80|0)+(b*20|0)>>2],P=s[18640+(g*80|0)+(b*20|0)+16>>2]|0,(P|0)>0){u=0;do Il(W),u=u+1|0;while((u|0)<(P|0))}switch(P=18640+(g*80|0)+(b*20|0)+4|0,s[At>>2]=s[P>>2],s[At+4>>2]=s[P+4>>2],s[At+8>>2]=s[P+8>>2],Fa(At,(s[de>>2]|0)*3|0),Hi(W,At,W),rn(W),As(W,_t),fn=+(s[te>>2]|0),Z[nt>>3]=fn*3,Z[se>>3]=0,cn=fn*-1.5,Z[ct>>3]=cn,Z[xe>>3]=fn*2.598076211353316,Z[Ct>>3]=cn,Z[Ie>>3]=fn*-2.598076211353316,s[17040+((s[Be>>2]|0)*80|0)+(s[zt>>2]<<2)>>2]|0){case 1:{u=ct,g=nt;break}case 3:{u=Ct,g=ct;break}case 2:{u=nt,g=Ct;break}default:{u=12;break e}}Ql(Le,_t,g,u,un),Na(un,s[Be>>2]|0,N,1,y+8+(s[y>>2]<<4)|0),s[y>>2]=(s[y>>2]|0)+1}if((D|0)<(K|0)&&(As(Fe,Be),Na(Be,s[zt>>2]|0,N,1,y+8+(s[y>>2]<<4)|0),s[y>>2]=(s[y>>2]|0)+1),s[wt>>2]=s[zt>>2],s[wt+4>>2]=s[zt+4>>2],s[wt+8>>2]=s[zt+8>>2],s[wt+12>>2]=s[zt+12>>2],D=D+1|0,(D|0)>=(Re|0)){u=3;break}}if((u|0)==3){_e=nn;return}else(u|0)==12&&Ht(22522,22569,571,22579)}function dA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0;N=_e,_e=_e+128|0,g=N+64|0,y=N,b=g,P=20240,D=b+60|0;do s[b>>2]=s[P>>2],b=b+4|0,P=P+4|0;while((b|0)<(D|0));b=y,P=20304,D=b+60|0;do s[b>>2]=s[P>>2],b=b+4|0,P=P+4|0;while((b|0)<(D|0));D=(er(s[c>>2]|0)|0)==0,g=D?g:y,y=u+4|0,el(y),Po(y),er(s[c>>2]|0)|0&&(Zr(y),s[c>>2]=(s[c>>2]|0)+1),s[f>>2]=s[u>>2],c=f+4|0,Hi(y,g,c),rn(c),s[f+16>>2]=s[u>>2],c=f+20|0,Hi(y,g+12|0,c),rn(c),s[f+32>>2]=s[u>>2],c=f+36|0,Hi(y,g+24|0,c),rn(c),s[f+48>>2]=s[u>>2],c=f+52|0,Hi(y,g+36|0,c),rn(c),s[f+64>>2]=s[u>>2],f=f+68|0,Hi(y,g+48|0,f),rn(f),_e=N}function bn(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0;if(se=_e,_e=_e+32|0,de=se+12|0,D=se,te=u+4|0,K=s[16960+(c<<2)>>2]|0,W=(g|0)!=0,K=W?K*3|0:K,y=s[te>>2]|0,G=u+8|0,P=s[G>>2]|0,W){if(b=u+12|0,g=s[b>>2]|0,y=P+y+g|0,(y|0)==(K|0))return te=1,_e=se,te|0;N=b}else N=u+12|0,g=s[N>>2]|0,y=P+y+g|0;if((y|0)<=(K|0))return te=0,_e=se,te|0;do if((g|0)>0){if(g=s[u>>2]|0,(P|0)>0){b=18640+(g*80|0)+60|0,g=u;break}g=18640+(g*80|0)+40|0,f?(Ti(de,K,0,0),Co(te,de,D),ra(D),Hi(D,de,te),b=g,g=u):(b=g,g=u)}else b=18640+((s[u>>2]|0)*80|0)+20|0,g=u;while(0);if(s[g>>2]=s[b>>2],y=b+16|0,(s[y>>2]|0)>0){g=0;do Il(te),g=g+1|0;while((g|0)<(s[y>>2]|0))}return u=b+4|0,s[de>>2]=s[u>>2],s[de+4>>2]=s[u+4>>2],s[de+8>>2]=s[u+8>>2],c=s[16880+(c<<2)>>2]|0,Fa(de,W?c*3|0:c),Hi(te,de,te),rn(te),W?g=((s[G>>2]|0)+(s[te>>2]|0)+(s[N>>2]|0)|0)==(K|0)?1:2:g=2,te=g,_e=se,te|0}function pA(u,c){u=u|0,c=c|0;var f=0;do f=bn(u,c,0,1)|0;while((f|0)==2);return f|0}function ii(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0,ct=0,Ct=0,un=0,Yt=0;if(Ct=_e,_e=_e+240|0,b=Ct+224|0,At=Ct+208|0,_t=Ct,nt=Ct+192|0,ct=Ct+176|0,Ie=Ct+160|0,Fe=Ct+144|0,Re=Ct+128|0,Be=Ct+112|0,Le=Ct+96|0,s[b>>2]=c,s[At>>2]=s[u>>2],s[At+4>>2]=s[u+4>>2],s[At+8>>2]=s[u+8>>2],s[At+12>>2]=s[u+12>>2],Wn(At,b,_t),s[y>>2]=0,xe=g+f+((g|0)==6&1)|0,(xe|0)<=(f|0)){_e=Ct;return}N=s[b>>2]|0,G=f+6|0,W=16960+(N<<2)|0,K=Fe+8|0,de=Re+8|0,te=Be+8|0,se=nt+4|0,P=0,D=f,g=-1;e:for(;;){if(b=(D|0)%6|0,u=_t+(b<<4)|0,s[nt>>2]=s[u>>2],s[nt+4>>2]=s[u+4>>2],s[nt+8>>2]=s[u+8>>2],s[nt+12>>2]=s[u+12>>2],u=P,P=bn(nt,N,0,1)|0,(D|0)>(f|0)&(er(c)|0)!=0&&(u|0)!=1&&(s[nt>>2]|0)!=(g|0)){switch(As(_t+(((b+5|0)%6|0)<<4)+4|0,ct),As(_t+(b<<4)+4|0,Ie),un=+(s[W>>2]|0),Z[Fe>>3]=un*3,Z[K>>3]=0,Yt=un*-1.5,Z[Re>>3]=Yt,Z[de>>3]=un*2.598076211353316,Z[Be>>3]=Yt,Z[te>>3]=un*-2.598076211353316,b=s[At>>2]|0,s[17040+(b*80|0)+(((g|0)==(b|0)?s[nt>>2]|0:g)<<2)>>2]|0){case 1:{u=Re,g=Fe;break}case 3:{u=Be,g=Re;break}case 2:{u=Fe,g=Be;break}default:{u=8;break e}}Ql(ct,Ie,g,u,Le),!(PA(ct,Le)|0)&&!(PA(Ie,Le)|0)&&(Na(Le,s[At>>2]|0,N,1,y+8+(s[y>>2]<<4)|0),s[y>>2]=(s[y>>2]|0)+1)}if((D|0)<(G|0)&&(As(se,ct),Na(ct,s[nt>>2]|0,N,1,y+8+(s[y>>2]<<4)|0),s[y>>2]=(s[y>>2]|0)+1),D=D+1|0,(D|0)>=(xe|0)){u=3;break}else g=s[nt>>2]|0}if((u|0)==3){_e=Ct;return}else(u|0)==8&&Ht(22606,22569,736,22651)}function Wn(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0;N=_e,_e=_e+160|0,g=N+80|0,y=N,b=g,P=20368,D=b+72|0;do s[b>>2]=s[P>>2],b=b+4|0,P=P+4|0;while((b|0)<(D|0));b=y,P=20448,D=b+72|0;do s[b>>2]=s[P>>2],b=b+4|0,P=P+4|0;while((b|0)<(D|0));D=(er(s[c>>2]|0)|0)==0,g=D?g:y,y=u+4|0,el(y),Po(y),er(s[c>>2]|0)|0&&(Zr(y),s[c>>2]=(s[c>>2]|0)+1),s[f>>2]=s[u>>2],c=f+4|0,Hi(y,g,c),rn(c),s[f+16>>2]=s[u>>2],c=f+20|0,Hi(y,g+12|0,c),rn(c),s[f+32>>2]=s[u>>2],c=f+36|0,Hi(y,g+24|0,c),rn(c),s[f+48>>2]=s[u>>2],c=f+52|0,Hi(y,g+36|0,c),rn(c),s[f+64>>2]=s[u>>2],c=f+68|0,Hi(y,g+48|0,c),rn(c),s[f+80>>2]=s[u>>2],f=f+84|0,Hi(y,g+60|0,f),rn(f),_e=N}function la(u,c){return u=u|0,c=c|0,c=Te(u|0,c|0,52)|0,Se()|0,c&15|0}function Ua(u,c){return u=u|0,c=c|0,c=Te(u|0,c|0,45)|0,Se()|0,c&127|0}function gA(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0;if(!(!0&(c&-16777216|0)==134217728)||(P=Te(u|0,c|0,45)|0,Se()|0,P=P&127,P>>>0>121))return c=0,c|0;f=Te(u|0,c|0,52)|0,Se()|0,f=f&15;do if(f|0){for(y=1,g=0;;){if(b=Te(u|0,c|0,(15-y|0)*3|0)|0,Se()|0,b=b&7,(b|0)!=0&(g^1))if((b|0)==1&(En(P)|0)!=0){D=0,g=13;break}else g=1;if((b|0)==7){D=0,g=13;break}if(y>>>0<f>>>0)y=y+1|0;else{g=9;break}}if((g|0)==9){if((f|0)==15)D=1;else break;return D|0}else if((g|0)==13)return D|0}while(0);for(;;){if(D=Te(u|0,c|0,(14-f|0)*3|0)|0,Se()|0,!((D&7|0)==7&!0)){D=0,g=13;break}if(f>>>0<14)f=f+1|0;else{D=1,g=13;break}}return(g|0)==13?D|0:0}function Dl(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0;if(b=Te(u|0,c|0,52)|0,Se()|0,b=b&15,f>>>0>15)return g=4,g|0;if((b|0)<(f|0))return g=12,g|0;if((b|0)==(f|0))return s[g>>2]=u,s[g+4>>2]=c,g=0,g|0;if(y=ze(f|0,0,52)|0,y=y|u,u=Se()|0|c&-15728641,(b|0)>(f|0))do c=ze(7,0,(14-f|0)*3|0)|0,f=f+1|0,y=c|y,u=Se()|0|u;while((f|0)<(b|0));return s[g>>2]=y,s[g+4>>2]=u,g=0,g|0}function Va(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0;if(b=Te(u|0,c|0,52)|0,Se()|0,b=b&15,!((f|0)<16&(b|0)<=(f|0)))return g=4,g|0;y=f-b|0,f=Te(u|0,c|0,45)|0,Se()|0;e:do if(!(En(f&127)|0))f=ps(7,0,y,((y|0)<0)<<31>>31)|0,y=Se()|0;else{t:do if(b|0){for(f=1;P=ze(7,0,(15-f|0)*3|0)|0,!!((P&u|0)==0&((Se()|0)&c|0)==0);)if(f>>>0<b>>>0)f=f+1|0;else break t;f=ps(7,0,y,((y|0)<0)<<31>>31)|0,y=Se()|0;break e}while(0);f=ps(7,0,y,((y|0)<0)<<31>>31)|0,f=Y(f|0,Se()|0,5,0)|0,f=E(f|0,Se()|0,-5,-1)|0,f=z(f|0,Se()|0,6,0)|0,f=E(f|0,Se()|0,1,0)|0,y=Se()|0}while(0);return P=g,s[P>>2]=f,s[P+4>>2]=y,P=0,P|0}function ui(u,c){u=u|0,c=c|0;var f=0,g=0,y=0;if(y=Te(u|0,c|0,45)|0,Se()|0,!(En(y&127)|0))return y=0,y|0;y=Te(u|0,c|0,52)|0,Se()|0,y=y&15;e:do if(!y)f=0;else for(g=1;;){if(f=Te(u|0,c|0,(15-g|0)*3|0)|0,Se()|0,f=f&7,f|0)break e;if(g>>>0<y>>>0)g=g+1|0;else{f=0;break}}while(0);return y=(f|0)==0&1,y|0}function Bl(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0;if(P=_e,_e=_e+16|0,b=P,ca(b,u,c,f),c=b,u=s[c>>2]|0,c=s[c+4>>2]|0,(u|0)==0&(c|0)==0)return _e=P,0;y=0,f=0;do D=g+(y<<3)|0,s[D>>2]=u,s[D+4>>2]=c,y=E(y|0,f|0,1,0)|0,f=Se()|0,Rl(b),D=b,u=s[D>>2]|0,c=s[D+4>>2]|0;while(!((u|0)==0&(c|0)==0));return _e=P,0}function ja(u,c,f,g){return u=u|0,c=c|0,f=f|0,g=g|0,(g|0)<(f|0)?(f=c,g=u,Ut(f|0),g|0):(f=ze(-1,-1,((g-f|0)*3|0)+3|0)|0,g=ze(~f|0,~(Se()|0)|0,(15-g|0)*3|0)|0,f=~(Se()|0)&c,g=~g&u,Ut(f|0),g|0)}function mA(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0;return y=Te(u|0,c|0,52)|0,Se()|0,y=y&15,(f|0)<16&(y|0)<=(f|0)?((y|0)<(f|0)&&(y=ze(-1,-1,((f+-1-y|0)*3|0)+3|0)|0,y=ze(~y|0,~(Se()|0)|0,(15-f|0)*3|0)|0,c=~(Se()|0)&c,u=~y&u),y=ze(f|0,0,52)|0,f=c&-15728641|(Se()|0),s[g>>2]=u|y,s[g+4>>2]=f,g=0,g|0):(g=4,g|0)}function _A(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0,ct=0;if((f|0)==0&(g|0)==0)return nt=0,nt|0;if(y=u,b=s[y>>2]|0,y=s[y+4>>2]|0,!0&(y&15728640|0)==0){if(!((g|0)>0|(g|0)==0&f>>>0>0)||(nt=c,s[nt>>2]=b,s[nt+4>>2]=y,(f|0)==1&(g|0)==0))return nt=0,nt|0;y=1;do At=u+(y<<3)|0,_t=s[At+4>>2]|0,nt=c+(y<<3)|0,s[nt>>2]=s[At>>2],s[nt+4>>2]=_t,y=y+1|0;while(0<(g|0)|(g|0)==0&y>>>0<f>>>0);return y=0,y|0}if(Le=f<<3,_t=Pi(Le)|0,!_t)return nt=13,nt|0;if(m(_t|0,u|0,Le|0)|0,At=v(f,8)|0,!At)return _(_t),nt=13,nt|0;e:do if(f|0){t:for(;;){y=_t,Fe=s[y>>2]|0,y=s[y+4>>2]|0,Re=Te(Fe|0,y|0,52)|0,Se()|0,Re=Re&15,Be=Re+-1|0,Ie=(f|0)>0;n:do if((Re|0)!=0&Ie){if(te=((f|0)<0)<<31>>31,se=ze(Be|0,0,52)|0,xe=Se()|0,Be>>>0>15){if(!((Fe|0)==0&(y|0)==0)){nt=17;break t}for(b=0;;){if(b=b+1|0,(b|0)>=(f|0))break n;if(g=_t+(b<<3)|0,xe=s[g>>2]|0,g=s[g+4>>2]|0,!((xe|0)==0&(g|0)==0)){y=g,nt=17;break t}}}for(b=0,u=Fe,g=y;;){if(!((u|0)==0&(g|0)==0)){if(!(!0&(g&117440512|0)==0)){nt=22;break t}if(D=Te(u|0,g|0,52)|0,Se()|0,D=D&15,(D|0)<(Be|0)){y=12,nt=28;break t}if((D|0)!=(Be|0)&&(u=u|se,g=g&-15728641|xe,D>>>0>=Re>>>0)){P=Be;do de=ze(7,0,(14-P|0)*3|0)|0,P=P+1|0,u=de|u,g=Se()|0|g;while(P>>>0<D>>>0)}if(P=pe(u|0,g|0,f|0,te|0)|0,Se()|0,G=At+(P<<3)|0,D=G,N=s[D>>2]|0,D=s[D+4>>2]|0,(N|0)==0&(D|0)==0)P=G;else for(de=0;;){if((de|0)>(f|0)){nt=32;break t}if((N|0)==(u|0)&(D&-117440513|0)==(g|0)){W=Te(N|0,D|0,56)|0,Se()|0,W=W&7,K=W+1|0,ct=Te(N|0,D|0,45)|0,Se()|0;i:do if(!(En(ct&127)|0))D=7;else{if(N=Te(N|0,D|0,52)|0,Se()|0,N=N&15,!N){D=6;break}for(D=1;;){if(ct=ze(7,0,(15-D|0)*3|0)|0,!((ct&u|0)==0&((Se()|0)&g|0)==0)){D=7;break i}if(D>>>0<N>>>0)D=D+1|0;else{D=6;break}}}while(0);if((W+2|0)>>>0>D>>>0){nt=42;break t}ct=ze(K|0,0,56)|0,g=Se()|0|g&-117440513,K=G,s[K>>2]=0,s[K+4>>2]=0,u=ct|u}else P=(P+1|0)%(f|0)|0;if(G=At+(P<<3)|0,D=G,N=s[D>>2]|0,D=s[D+4>>2]|0,(N|0)==0&(D|0)==0){P=G;break}else de=de+1|0}ct=P,s[ct>>2]=u,s[ct+4>>2]=g}if(b=b+1|0,(b|0)>=(f|0))break n;g=_t+(b<<3)|0,u=s[g>>2]|0,g=s[g+4>>2]|0}}while(0);if((f+5|0)>>>0<11){nt=85;break}if(xe=v((f|0)/6|0,8)|0,!xe){nt=49;break}n:do if(Ie){de=0,K=0;do{if(D=At+(de<<3)|0,g=D,b=s[g>>2]|0,g=s[g+4>>2]|0,!((b|0)==0&(g|0)==0)){N=Te(b|0,g|0,56)|0,Se()|0,N=N&7,u=N+1|0,G=g&-117440513,ct=Te(b|0,g|0,45)|0,Se()|0;i:do if(En(ct&127)|0){if(W=Te(b|0,g|0,52)|0,Se()|0,W=W&15,W|0)for(P=1;;){if(ct=ze(7,0,(15-P|0)*3|0)|0,!((b&ct|0)==0&(G&(Se()|0)|0)==0))break i;if(P>>>0<W>>>0)P=P+1|0;else break}g=ze(u|0,0,56)|0,b=g|b,g=Se()|0|G,u=D,s[u>>2]=b,s[u+4>>2]=g,u=N+2|0}while(0);(u|0)==7&&(ct=xe+(K<<3)|0,s[ct>>2]=b,s[ct+4>>2]=g&-117440513,K=K+1|0)}de=de+1|0}while((de|0)!=(f|0));if(Ie){if(de=((f|0)<0)<<31>>31,te=ze(Be|0,0,52)|0,se=Se()|0,Be>>>0>15){if(!((Fe|0)==0&(y|0)==0)){y=4,nt=84;break t}for(y=0;;){if(y=y+1|0,(y|0)>=(f|0)){b=0,y=K;break n}if(ct=_t+(y<<3)|0,!((s[ct>>2]|0)==0&(s[ct+4>>2]|0)==0)){y=4,nt=84;break t}}}for(W=0,b=0,G=Fe;;){do if(!((G|0)==0&(y|0)==0)){if(D=Te(G|0,y|0,52)|0,Se()|0,D=D&15,(D|0)<(Be|0)){y=12,nt=84;break t}do if((D|0)==(Be|0))g=G,D=y;else{if(g=G|te,u=y&-15728641|se,D>>>0<Re>>>0){D=u;break}P=Be;do ct=ze(7,0,(14-P|0)*3|0)|0,P=P+1|0,g=ct|g,u=Se()|0|u;while(P>>>0<D>>>0);D=u}while(0);for(P=pe(g|0,D|0,f|0,de|0)|0,Se()|0,u=0;;){if((u|0)>(f|0)){nt=77;break t}if(ct=At+(P<<3)|0,N=s[ct+4>>2]|0,(N&-117440513|0)==(D|0)&&(s[ct>>2]|0)==(g|0)){nt=79;break}if(P=(P+1|0)%(f|0)|0,ct=At+(P<<3)|0,(s[ct>>2]|0)==(g|0)&&(s[ct+4>>2]|0)==(D|0))break;u=u+1|0}if((nt|0)==79&&(nt=0,!0&(N&117440512|0)==100663296))break;ct=c+(b<<3)|0,s[ct>>2]=G,s[ct+4>>2]=y,b=b+1|0}while(0);if(y=W+1|0,(y|0)>=(f|0)){y=K;break n}ct=_t+(y<<3)|0,W=y,G=s[ct>>2]|0,y=s[ct+4>>2]|0}}else b=0,y=K}else b=0,y=0;while(0);if(w(At|0,0,Le|0)|0,m(_t|0,xe|0,y<<3|0)|0,_(xe),y)c=c+(b<<3)|0,f=y;else break e}if((nt|0)==17)!0&(y&117440512|0)==0?(y=4,nt=28):nt=22;else if((nt|0)==32)Ht(23313,22674,362,22684);else{if((nt|0)==42)return _(_t),_(At),ct=10,ct|0;if((nt|0)==49)return _(_t),_(At),ct=13,ct|0;if((nt|0)==77)Ht(23313,22674,462,22684);else{if((nt|0)==84)return _(xe),_(_t),_(At),ct=y,ct|0;if((nt|0)==85){m(c|0,_t|0,f<<3|0)|0;break}}}if((nt|0)==22)return _(_t),_(At),ct=5,ct|0;if((nt|0)==28)return _(_t),_(At),ct=y,ct|0}while(0);return _(_t),_(At),ct=0,ct|0}function nl(u,c,f,g,y,b,P){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0,b=b|0,P=P|0;var D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0;if(xe=_e,_e=_e+16|0,se=xe,!((f|0)>0|(f|0)==0&c>>>0>0))return se=0,_e=xe,se|0;if((P|0)>=16)return se=12,_e=xe,se|0;de=0,te=0,K=0,D=0;e:for(;;){if(G=u+(de<<3)|0,N=s[G>>2]|0,G=s[G+4>>2]|0,W=Te(N|0,G|0,52)|0,Se()|0,(W&15|0)>(P|0)){D=12,N=11;break}if(ca(se,N,G,P),W=se,G=s[W>>2]|0,W=s[W+4>>2]|0,(G|0)==0&(W|0)==0)N=K;else{N=K;do{if(!((D|0)<(b|0)|(D|0)==(b|0)&N>>>0<y>>>0)){N=10;break e}K=g+(N<<3)|0,s[K>>2]=G,s[K+4>>2]=W,N=E(N|0,D|0,1,0)|0,D=Se()|0,Rl(se),K=se,G=s[K>>2]|0,W=s[K+4>>2]|0}while(!((G|0)==0&(W|0)==0))}if(de=E(de|0,te|0,1,0)|0,te=Se()|0,(te|0)<(f|0)|(te|0)==(f|0)&de>>>0<c>>>0)K=N;else{D=0,N=11;break}}return(N|0)==10?(se=14,_e=xe,se|0):(N|0)==11?(_e=xe,D|0):0}function Ji(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0;de=_e,_e=_e+16|0,K=de;e:do if((f|0)>0|(f|0)==0&c>>>0>0){for(G=0,P=0,b=0,W=0;;){if(N=u+(G<<3)|0,D=s[N>>2]|0,N=s[N+4>>2]|0,!((D|0)==0&(N|0)==0)&&(N=(Va(D,N,g,K)|0)==0,D=K,P=E(s[D>>2]|0,s[D+4>>2]|0,P|0,b|0)|0,b=Se()|0,!N)){b=12;break}if(G=E(G|0,W|0,1,0)|0,W=Se()|0,!((W|0)<(f|0)|(W|0)==(f|0)&G>>>0<c>>>0))break e}return _e=de,b|0}else P=0,b=0;while(0);return s[y>>2]=P,s[y+4>>2]=b,y=0,_e=de,y|0}function Si(u,c){return u=u|0,c=c|0,c=Te(u|0,c|0,52)|0,Se()|0,c&1|0}function Nr(u,c){u=u|0,c=c|0;var f=0,g=0,y=0;if(y=Te(u|0,c|0,52)|0,Se()|0,y=y&15,!y)return y=0,y|0;for(g=1;;){if(f=Te(u|0,c|0,(15-g|0)*3|0)|0,Se()|0,f=f&7,f|0){g=5;break}if(g>>>0<y>>>0)g=g+1|0;else{f=0,g=5;break}}return(g|0)==5?f|0:0}function il(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0,N=0;if(N=Te(u|0,c|0,52)|0,Se()|0,N=N&15,!N)return D=c,N=u,Ut(D|0),N|0;for(D=1,f=0;;){b=(15-D|0)*3|0,g=ze(7,0,b|0)|0,y=Se()|0,P=Te(u|0,c|0,b|0)|0,Se()|0,b=ze(us(P&7)|0,0,b|0)|0,P=Se()|0,u=b|u&~g,c=P|c&~y;e:do if(!f)if((b&g|0)==0&(P&y|0)==0)f=0;else if(g=Te(u|0,c|0,52)|0,Se()|0,g=g&15,!g)f=1;else{f=1;t:for(;;){switch(P=Te(u|0,c|0,(15-f|0)*3|0)|0,Se()|0,P&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<g>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(P=(15-f|0)*3|0,y=Te(u|0,c|0,P|0)|0,Se()|0,b=ze(7,0,P|0)|0,c=c&~(Se()|0),P=ze(us(y&7)|0,0,P|0)|0,u=u&~b|P,c=c|(Se()|0),f>>>0<g>>>0)f=f+1|0;else{f=1;break}}while(0);if(D>>>0<N>>>0)D=D+1|0;else break}return Ut(c|0),u|0}function oi(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0;if(g=Te(u|0,c|0,52)|0,Se()|0,g=g&15,!g)return f=c,g=u,Ut(f|0),g|0;for(f=1;b=(15-f|0)*3|0,P=Te(u|0,c|0,b|0)|0,Se()|0,y=ze(7,0,b|0)|0,c=c&~(Se()|0),b=ze(us(P&7)|0,0,b|0)|0,u=b|u&~y,c=Se()|0|c,f>>>0<g>>>0;)f=f+1|0;return Ut(c|0),u|0}function ua(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0,N=0;if(N=Te(u|0,c|0,52)|0,Se()|0,N=N&15,!N)return D=c,N=u,Ut(D|0),N|0;for(D=1,f=0;;){b=(15-D|0)*3|0,g=ze(7,0,b|0)|0,y=Se()|0,P=Te(u|0,c|0,b|0)|0,Se()|0,b=ze(js(P&7)|0,0,b|0)|0,P=Se()|0,u=b|u&~g,c=P|c&~y;e:do if(!f)if((b&g|0)==0&(P&y|0)==0)f=0;else if(g=Te(u|0,c|0,52)|0,Se()|0,g=g&15,!g)f=1;else{f=1;t:for(;;){switch(P=Te(u|0,c|0,(15-f|0)*3|0)|0,Se()|0,P&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<g>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(y=(15-f|0)*3|0,b=ze(7,0,y|0)|0,P=c&~(Se()|0),c=Te(u|0,c|0,y|0)|0,Se()|0,c=ze(js(c&7)|0,0,y|0)|0,u=u&~b|c,c=P|(Se()|0),f>>>0<g>>>0)f=f+1|0;else{f=1;break}}while(0);if(D>>>0<N>>>0)D=D+1|0;else break}return Ut(c|0),u|0}function Ur(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0;if(g=Te(u|0,c|0,52)|0,Se()|0,g=g&15,!g)return f=c,g=u,Ut(f|0),g|0;for(f=1;P=(15-f|0)*3|0,b=ze(7,0,P|0)|0,y=c&~(Se()|0),c=Te(u|0,c|0,P|0)|0,Se()|0,c=ze(js(c&7)|0,0,P|0)|0,u=c|u&~b,c=Se()|0|y,f>>>0<g>>>0;)f=f+1|0;return Ut(c|0),u|0}function dr(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0;if(N=_e,_e=_e+64|0,D=N+40|0,g=N+24|0,y=N+12|0,b=N,ze(c|0,0,52)|0,f=Se()|0|134225919,!c)return(s[u+4>>2]|0)>2||(s[u+8>>2]|0)>2||(s[u+12>>2]|0)>2?(P=0,D=0,Ut(P|0),_e=N,D|0):(ze(zr(u)|0,0,45)|0,P=Se()|0|f,D=-1,Ut(P|0),_e=N,D|0);if(s[D>>2]=s[u>>2],s[D+4>>2]=s[u+4>>2],s[D+8>>2]=s[u+8>>2],s[D+12>>2]=s[u+12>>2],P=D+4|0,(c|0)>0)for(u=-1;s[g>>2]=s[P>>2],s[g+4>>2]=s[P+4>>2],s[g+8>>2]=s[P+8>>2],c&1?(Eu(P),s[y>>2]=s[P>>2],s[y+4>>2]=s[P+4>>2],s[y+8>>2]=s[P+8>>2],ia(y)):(Ml(P),s[y>>2]=s[P>>2],s[y+4>>2]=s[P+4>>2],s[y+8>>2]=s[P+8>>2],Zr(y)),Co(g,y,b),rn(b),W=(15-c|0)*3|0,G=ze(7,0,W|0)|0,f=f&~(Se()|0),W=ze(na(b)|0,0,W|0)|0,u=W|u&~G,f=Se()|0|f,(c|0)>1;)c=c+-1|0;else u=-1;e:do if((s[P>>2]|0)<=2&&(s[D+8>>2]|0)<=2&&(s[D+12>>2]|0)<=2){if(g=zr(D)|0,c=ze(g|0,0,45)|0,c=c|u,u=Se()|0|f&-1040385,b=aA(D)|0,!(En(g)|0)){if((b|0)<=0)break;for(y=0;;){if(g=Te(c|0,u|0,52)|0,Se()|0,g=g&15,g)for(f=1;W=(15-f|0)*3|0,D=Te(c|0,u|0,W|0)|0,Se()|0,G=ze(7,0,W|0)|0,u=u&~(Se()|0),W=ze(us(D&7)|0,0,W|0)|0,c=c&~G|W,u=u|(Se()|0),f>>>0<g>>>0;)f=f+1|0;if(y=y+1|0,(y|0)==(b|0))break e}}y=Te(c|0,u|0,52)|0,Se()|0,y=y&15;t:do if(y){f=1;n:for(;;){switch(W=Te(c|0,u|0,(15-f|0)*3|0)|0,Se()|0,W&7){case 1:break n;case 0:break;default:break t}if(f>>>0<y>>>0)f=f+1|0;else break t}if(To(g,s[D>>2]|0)|0)for(f=1;D=(15-f|0)*3|0,G=ze(7,0,D|0)|0,W=u&~(Se()|0),u=Te(c|0,u|0,D|0)|0,Se()|0,u=ze(js(u&7)|0,0,D|0)|0,c=c&~G|u,u=W|(Se()|0),f>>>0<y>>>0;)f=f+1|0;else for(f=1;W=(15-f|0)*3|0,D=Te(c|0,u|0,W|0)|0,Se()|0,G=ze(7,0,W|0)|0,u=u&~(Se()|0),W=ze(us(D&7)|0,0,W|0)|0,c=c&~G|W,u=u|(Se()|0),f>>>0<y>>>0;)f=f+1|0}while(0);if((b|0)>0){f=0;do c=il(c,u)|0,u=Se()|0,f=f+1|0;while((f|0)!=(b|0))}}else c=0,u=0;while(0);return G=u,W=c,Ut(G|0),_e=N,W|0}function er(u){return u=u|0,(u|0)%2|0|0}function Ps(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0;return y=_e,_e=_e+16|0,g=y,c>>>0>15?(g=4,_e=y,g|0):(s[u+4>>2]&2146435072|0)==2146435072||(s[u+8+4>>2]&2146435072|0)==2146435072?(g=3,_e=y,g|0):(Aa(u,c,g),c=dr(g,c)|0,g=Se()|0,s[f>>2]=c,s[f+4>>2]=g,(c|0)==0&(g|0)==0&&Ht(23313,22674,786,22697),g=0,_e=y,g|0)}function Ms(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0;if(y=f+4|0,b=Te(u|0,c|0,52)|0,Se()|0,b=b&15,P=Te(u|0,c|0,45)|0,Se()|0,g=(b|0)==0,En(P&127)|0){if(g)return P=1,P|0;g=1}else{if(g)return P=0,P|0;!(s[y>>2]|0)&&!(s[f+8>>2]|0)?g=(s[f+12>>2]|0)!=0&1:g=1}for(f=1;f&1?ia(y):Zr(y),P=Te(u|0,c|0,(15-f|0)*3|0)|0,Se()|0,Ao(y,P&7),f>>>0<b>>>0;)f=f+1|0;return g|0}function hs(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0;if(W=_e,_e=_e+16|0,N=W,G=Te(u|0,c|0,45)|0,Se()|0,G=G&127,G>>>0>121)return s[f>>2]=0,s[f+4>>2]=0,s[f+8>>2]=0,s[f+12>>2]=0,G=5,_e=W,G|0;e:do if(En(G)|0&&(b=Te(u|0,c|0,52)|0,Se()|0,b=b&15,(b|0)!=0)){g=1;t:for(;;){switch(D=Te(u|0,c|0,(15-g|0)*3|0)|0,Se()|0,D&7){case 5:break t;case 0:break;default:{g=c;break e}}if(g>>>0<b>>>0)g=g+1|0;else{g=c;break e}}for(y=1,g=c;c=(15-y|0)*3|0,P=ze(7,0,c|0)|0,D=g&~(Se()|0),g=Te(u|0,g|0,c|0)|0,Se()|0,g=ze(js(g&7)|0,0,c|0)|0,u=u&~P|g,g=D|(Se()|0),y>>>0<b>>>0;)y=y+1|0}else g=c;while(0);if(D=7696+(G*28|0)|0,s[f>>2]=s[D>>2],s[f+4>>2]=s[D+4>>2],s[f+8>>2]=s[D+8>>2],s[f+12>>2]=s[D+12>>2],!(Ms(u,g,f)|0))return G=0,_e=W,G|0;if(P=f+4|0,s[N>>2]=s[P>>2],s[N+4>>2]=s[P+4>>2],s[N+8>>2]=s[P+8>>2],b=Te(u|0,g|0,52)|0,Se()|0,D=b&15,b&1?(Zr(P),b=D+1|0):b=D,!(En(G)|0))g=0;else{e:do if(!D)g=0;else for(c=1;;){if(y=Te(u|0,g|0,(15-c|0)*3|0)|0,Se()|0,y=y&7,y|0){g=y;break e}if(c>>>0<D>>>0)c=c+1|0;else{g=0;break}}while(0);g=(g|0)==4&1}if(!(bn(f,b,g,0)|0))(b|0)!=(D|0)&&(s[P>>2]=s[N>>2],s[P+4>>2]=s[N+4>>2],s[P+8>>2]=s[N+8>>2]);else{if(En(G)|0)do;while(bn(f,b,0,0)|0);(b|0)!=(D|0)&&Ml(P)}return G=0,_e=W,G|0}function Mo(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;return b=_e,_e=_e+16|0,g=b,y=hs(u,c,g)|0,y|0?(_e=b,y|0):(y=Te(u|0,c|0,52)|0,Se()|0,xc(g,y&15,f),y=0,_e=b,y|0)}function tr(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0;if(P=_e,_e=_e+16|0,b=P,g=hs(u,c,b)|0,g|0)return b=g,_e=P,b|0;g=Te(u|0,c|0,45)|0,Se()|0,g=(En(g&127)|0)==0,y=Te(u|0,c|0,52)|0,Se()|0,y=y&15;e:do if(!g){if(y|0)for(g=1;;){if(D=ze(7,0,(15-g|0)*3|0)|0,!((D&u|0)==0&((Se()|0)&c|0)==0))break e;if(g>>>0<y>>>0)g=g+1|0;else break}return fi(b,y,0,5,f),D=0,_e=P,D|0}while(0);return ii(b,y,0,6,f),D=0,_e=P,D|0}function yA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;if(y=Te(u|0,c|0,45)|0,Se()|0,!(En(y&127)|0))return y=2,s[f>>2]=y,0;if(y=Te(u|0,c|0,52)|0,Se()|0,y=y&15,!y)return y=5,s[f>>2]=y,0;for(g=1;;){if(b=ze(7,0,(15-g|0)*3|0)|0,!((b&u|0)==0&((Se()|0)&c|0)==0)){g=2,u=6;break}if(g>>>0<y>>>0)g=g+1|0;else{g=5,u=6;break}}return(u|0)==6&&(s[f>>2]=g),0}function Io(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0;K=_e,_e=_e+128|0,G=K+112|0,b=K+96|0,W=K,y=Te(u|0,c|0,52)|0,Se()|0,D=y&15,s[G>>2]=D,P=Te(u|0,c|0,45)|0,Se()|0,P=P&127;e:do if(En(P)|0){if(D|0)for(g=1;;){if(N=ze(7,0,(15-g|0)*3|0)|0,!((N&u|0)==0&((Se()|0)&c|0)==0)){y=0;break e}if(g>>>0<D>>>0)g=g+1|0;else break}if(y&1)y=1;else return N=ze(D+1|0,0,52)|0,W=Se()|0|c&-15728641,G=ze(7,0,(14-D|0)*3|0)|0,W=Io((N|u)&~G,W&~(Se()|0),f)|0,_e=K,W|0}else y=0;while(0);if(g=hs(u,c,b)|0,!g){y?(dA(b,G,W),N=5):(Wn(b,G,W),N=6);e:do if(En(P)|0)if(!D)u=5;else for(g=1;;){if(P=ze(7,0,(15-g|0)*3|0)|0,!((P&u|0)==0&((Se()|0)&c|0)==0)){u=2;break e}if(g>>>0<D>>>0)g=g+1|0;else{u=5;break}}else u=2;while(0);w(f|0,-1,u<<2|0)|0;e:do if(y)for(b=0;;){if(P=W+(b<<4)|0,pA(P,s[G>>2]|0)|0,P=s[P>>2]|0,D=s[f>>2]|0,(D|0)==-1|(D|0)==(P|0))g=f;else{y=0;do{if(y=y+1|0,y>>>0>=u>>>0){g=1;break e}g=f+(y<<2)|0,D=s[g>>2]|0}while(!((D|0)==-1|(D|0)==(P|0)))}if(s[g>>2]=P,b=b+1|0,b>>>0>=N>>>0){g=0;break}}else for(b=0;;){if(P=W+(b<<4)|0,bn(P,s[G>>2]|0,0,1)|0,P=s[P>>2]|0,D=s[f>>2]|0,(D|0)==-1|(D|0)==(P|0))g=f;else{y=0;do{if(y=y+1|0,y>>>0>=u>>>0){g=1;break e}g=f+(y<<2)|0,D=s[g>>2]|0}while(!((D|0)==-1|(D|0)==(P|0)))}if(s[g>>2]=P,b=b+1|0,b>>>0>=N>>>0){g=0;break}}while(0)}return W=g,_e=K,W|0}function ko(){return 12}function fs(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0,N=0;if(u>>>0>15)return D=4,D|0;if(ze(u|0,0,52)|0,D=Se()|0|134225919,!u){f=0,g=0;do En(g)|0&&(ze(g|0,0,45)|0,P=D|(Se()|0),u=c+(f<<3)|0,s[u>>2]=-1,s[u+4>>2]=P,f=f+1|0),g=g+1|0;while((g|0)!=122);return f=0,f|0}f=0,P=0;do{if(En(P)|0){for(ze(P|0,0,45)|0,g=1,y=-1,b=D|(Se()|0);N=ze(7,0,(15-g|0)*3|0)|0,y=y&~N,b=b&~(Se()|0),(g|0)!=(u|0);)g=g+1|0;N=c+(f<<3)|0,s[N>>2]=y,s[N+4>>2]=b,f=f+1|0}P=P+1|0}while((P|0)!=122);return f=0,f|0}function Vr(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0;if(Re=_e,_e=_e+16|0,Ie=Re,Fe=Te(u|0,c|0,52)|0,Se()|0,Fe=Fe&15,f>>>0>15)return Fe=4,_e=Re,Fe|0;if((Fe|0)<(f|0))return Fe=12,_e=Re,Fe|0;if((Fe|0)!=(f|0))if(b=ze(f|0,0,52)|0,b=b|u,D=Se()|0|c&-15728641,(Fe|0)>(f|0)){N=f;do xe=ze(7,0,(14-N|0)*3|0)|0,N=N+1|0,b=xe|b,D=Se()|0|D;while((N|0)<(Fe|0));xe=b}else xe=b;else xe=u,D=c;se=Te(xe|0,D|0,45)|0,Se()|0;e:do if(En(se&127)|0){if(N=Te(xe|0,D|0,52)|0,Se()|0,N=N&15,N|0)for(b=1;;){if(se=ze(7,0,(15-b|0)*3|0)|0,!((se&xe|0)==0&((Se()|0)&D|0)==0)){G=33;break e}if(b>>>0<N>>>0)b=b+1|0;else break}if(se=g,s[se>>2]=0,s[se+4>>2]=0,(Fe|0)>(f|0)){for(se=c&-15728641,te=Fe;;){if(de=te,te=te+-1|0,te>>>0>15|(Fe|0)<(te|0)){G=19;break}if((Fe|0)!=(te|0))if(b=ze(te|0,0,52)|0,b=b|u,N=Se()|0|se,(Fe|0)<(de|0))K=b;else{G=te;do K=ze(7,0,(14-G|0)*3|0)|0,G=G+1|0,b=K|b,N=Se()|0|N;while((G|0)<(Fe|0));K=b}else K=u,N=c;if(W=Te(K|0,N|0,45)|0,Se()|0,!(En(W&127)|0))b=0;else{W=Te(K|0,N|0,52)|0,Se()|0,W=W&15;t:do if(!W)b=0;else for(G=1;;){if(b=Te(K|0,N|0,(15-G|0)*3|0)|0,Se()|0,b=b&7,b|0)break t;if(G>>>0<W>>>0)G=G+1|0;else{b=0;break}}while(0);b=(b|0)==0&1}if(N=Te(u|0,c|0,(15-de|0)*3|0)|0,Se()|0,N=N&7,(N|0)==7){y=5,G=42;break}if(b=(b|0)!=0,(N|0)==1&b){y=5,G=42;break}if(K=N+(((N|0)!=0&b)<<31>>31)|0,K|0&&(G=Fe-de|0,G=ps(7,0,G,((G|0)<0)<<31>>31)|0,W=Se()|0,b?(b=Y(G|0,W|0,5,0)|0,b=E(b|0,Se()|0,-5,-1)|0,b=z(b|0,Se()|0,6,0)|0,b=E(b|0,Se()|0,1,0)|0,N=Se()|0):(b=G,N=W),de=K+-1|0,de=Y(G|0,W|0,de|0,((de|0)<0)<<31>>31|0)|0,de=E(b|0,N|0,de|0,Se()|0)|0,K=Se()|0,W=g,W=E(de|0,K|0,s[W>>2]|0,s[W+4>>2]|0)|0,K=Se()|0,de=g,s[de>>2]=W,s[de+4>>2]=K),(te|0)<=(f|0)){G=37;break}}if((G|0)==19)Ht(23313,22674,1099,22710);else if((G|0)==37){P=g,y=s[P+4>>2]|0,P=s[P>>2]|0;break}else if((G|0)==42)return _e=Re,y|0}else y=0,P=0}else G=33;while(0);e:do if((G|0)==33)if(se=g,s[se>>2]=0,s[se+4>>2]=0,(Fe|0)>(f|0)){for(b=Fe;;){if(y=Te(u|0,c|0,(15-b|0)*3|0)|0,Se()|0,y=y&7,(y|0)==7){y=5;break}if(P=Fe-b|0,P=ps(7,0,P,((P|0)<0)<<31>>31)|0,y=Y(P|0,Se()|0,y|0,0)|0,P=Se()|0,se=g,P=E(s[se>>2]|0,s[se+4>>2]|0,y|0,P|0)|0,y=Se()|0,se=g,s[se>>2]=P,s[se+4>>2]=y,b=b+-1|0,(b|0)<=(f|0))break e}return _e=Re,y|0}else y=0,P=0;while(0);return Va(xe,D,Fe,Ie)|0&&Ht(23313,22674,1063,22725),Fe=Ie,Ie=s[Fe+4>>2]|0,((y|0)>-1|(y|0)==-1&P>>>0>4294967295)&((Ie|0)>(y|0)|((Ie|0)==(y|0)?(s[Fe>>2]|0)>>>0>P>>>0:0))?(Fe=0,_e=Re,Fe|0):(Ht(23313,22674,1139,22710),0)}function Cu(u,c,f,g,y,b){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0,b=b|0;var P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0;if(K=_e,_e=_e+16|0,P=K,y>>>0>15)return b=4,_e=K,b|0;if(D=Te(f|0,g|0,52)|0,Se()|0,D=D&15,(D|0)>(y|0))return b=12,_e=K,b|0;if(Va(f,g,y,P)|0&&Ht(23313,22674,1063,22725),W=P,G=s[W+4>>2]|0,!(((c|0)>-1|(c|0)==-1&u>>>0>4294967295)&((G|0)>(c|0)|((G|0)==(c|0)?(s[W>>2]|0)>>>0>u>>>0:0))))return b=2,_e=K,b|0;W=y-D|0,y=ze(y|0,0,52)|0,N=Se()|0|g&-15728641,G=b,s[G>>2]=y|f,s[G+4>>2]=N,G=Te(f|0,g|0,45)|0,Se()|0;e:do if(En(G&127)|0){if(D|0)for(P=1;;){if(G=ze(7,0,(15-P|0)*3|0)|0,!((G&f|0)==0&((Se()|0)&g|0)==0))break e;if(P>>>0<D>>>0)P=P+1|0;else break}if((W|0)<1)return b=0,_e=K,b|0;for(G=D^15,g=-1,N=1,P=1;;){D=W-N|0,D=ps(7,0,D,((D|0)<0)<<31>>31)|0,f=Se()|0;do if(P)if(P=Y(D|0,f|0,5,0)|0,P=E(P|0,Se()|0,-5,-1)|0,P=z(P|0,Se()|0,6,0)|0,y=Se()|0,(c|0)>(y|0)|(c|0)==(y|0)&u>>>0>P>>>0){c=E(u|0,c|0,-1,-1)|0,c=L(c|0,Se()|0,P|0,y|0)|0,P=Se()|0,de=b,se=s[de>>2]|0,de=s[de+4>>2]|0,xe=(G+g|0)*3|0,te=ze(7,0,xe|0)|0,de=de&~(Se()|0),g=z(c|0,P|0,D|0,f|0)|0,u=Se()|0,y=E(g|0,u|0,2,0)|0,xe=ze(y|0,Se()|0,xe|0)|0,de=Se()|0|de,y=b,s[y>>2]=xe|se&~te,s[y+4>>2]=de,u=Y(g|0,u|0,D|0,f|0)|0,u=L(c|0,P|0,u|0,Se()|0)|0,P=0,c=Se()|0;break}else{xe=b,te=s[xe>>2]|0,xe=s[xe+4>>2]|0,se=ze(7,0,(G+g|0)*3|0)|0,xe=xe&~(Se()|0),P=b,s[P>>2]=te&~se,s[P+4>>2]=xe,P=1;break}else te=b,y=s[te>>2]|0,te=s[te+4>>2]|0,g=(G+g|0)*3|0,de=ze(7,0,g|0)|0,te=te&~(Se()|0),xe=z(u|0,c|0,D|0,f|0)|0,P=Se()|0,g=ze(xe|0,P|0,g|0)|0,te=Se()|0|te,se=b,s[se>>2]=g|y&~de,s[se+4>>2]=te,P=Y(xe|0,P|0,D|0,f|0)|0,u=L(u|0,c|0,P|0,Se()|0)|0,P=0,c=Se()|0;while(0);if((W|0)>(N|0))g=~N,N=N+1|0;else{c=0;break}}return _e=K,c|0}while(0);if((W|0)<1)return xe=0,_e=K,xe|0;for(y=D^15,P=1;;)if(se=W-P|0,se=ps(7,0,se,((se|0)<0)<<31>>31)|0,xe=Se()|0,N=b,f=s[N>>2]|0,N=s[N+4>>2]|0,D=(y-P|0)*3|0,g=ze(7,0,D|0)|0,N=N&~(Se()|0),de=z(u|0,c|0,se|0,xe|0)|0,te=Se()|0,D=ze(de|0,te|0,D|0)|0,N=Se()|0|N,G=b,s[G>>2]=D|f&~g,s[G+4>>2]=N,xe=Y(de|0,te|0,se|0,xe|0)|0,u=L(u|0,c|0,xe|0,Se()|0)|0,c=Se()|0,(W|0)<=(P|0)){c=0;break}else P=P+1|0;return _e=K,c|0}function ca(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0;y=Te(c|0,f|0,52)|0,Se()|0,y=y&15,(c|0)==0&(f|0)==0|((g|0)>15|(y|0)>(g|0))?(g=-1,y=-1,c=0,f=0):(b=ja(c,f,y+1|0,g)|0,f=(Se()|0)&-15728641,c=ze(g|0,0,52)|0,c=b|c,f=f|(Se()|0),b=(ui(c,f)|0)==0,g=b?-1:g),b=u,s[b>>2]=c,s[b+4>>2]=f,s[u+8>>2]=y,s[u+12>>2]=g}function Rl(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0;if(f=u,c=s[f>>2]|0,f=s[f+4>>2]|0,!((c|0)==0&(f|0)==0)&&(g=Te(c|0,f|0,52)|0,Se()|0,g=g&15,D=ze(1,0,(g^15)*3|0)|0,c=E(D|0,Se()|0,c|0,f|0)|0,f=Se()|0,D=u,s[D>>2]=c,s[D+4>>2]=f,D=u+8|0,P=s[D>>2]|0,!((g|0)<(P|0)))){for(N=u+12|0,b=g;;){if((b|0)==(P|0)){g=5;break}if(G=(b|0)==(s[N>>2]|0),y=(15-b|0)*3|0,g=Te(c|0,f|0,y|0)|0,Se()|0,g=g&7,G&((g|0)==1&!0)){g=7;break}if(!((g|0)==7&!0)){g=10;break}if(G=ze(1,0,y|0)|0,c=E(c|0,f|0,G|0,Se()|0)|0,f=Se()|0,G=u,s[G>>2]=c,s[G+4>>2]=f,(b|0)>(P|0))b=b+-1|0;else{g=10;break}}if((g|0)==5){G=u,s[G>>2]=0,s[G+4>>2]=0,s[D>>2]=-1,s[N>>2]=-1;return}else if((g|0)==7){P=ze(1,0,y|0)|0,P=E(c|0,f|0,P|0,Se()|0)|0,D=Se()|0,G=u,s[G>>2]=P,s[G+4>>2]=D,s[N>>2]=b+-1;return}else if((g|0)==10)return}}function Lo(u){u=+u;var c=0;return c=u<0?u+6.283185307179586:u,+(u>=6.283185307179586?c+-6.283185307179586:c)}function Do(u,c){return u=u|0,c=c|0,+yt(+(+Z[u>>3]-+Z[c>>3]))<17453292519943298e-27?(c=+yt(+(+Z[u+8>>3]-+Z[c+8>>3]))<17453292519943298e-27,c|0):(c=0,c|0)}function Pu(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0;return y=+Z[c>>3],g=+Z[u>>3],b=+pt(+((y-g)*.5)),f=+pt(+((+Z[c+8>>3]-+Z[u+8>>3])*.5)),f=b*b+f*(+Vt(+y)*+Vt(+g)*f),+(+_i(+ +Pt(+f),+ +Pt(+(1-f)))*2)}function lo(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0;return y=+Z[c>>3],g=+Z[u>>3],b=+pt(+((y-g)*.5)),f=+pt(+((+Z[c+8>>3]-+Z[u+8>>3])*.5)),f=b*b+f*(+Vt(+y)*+Vt(+g)*f),+(+_i(+ +Pt(+f),+ +Pt(+(1-f)))*2*6371.007180918475)}function vA(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0;return y=+Z[c>>3],g=+Z[u>>3],b=+pt(+((y-g)*.5)),f=+pt(+((+Z[c+8>>3]-+Z[u+8>>3])*.5)),f=b*b+f*(+Vt(+y)*+Vt(+g)*f),+(+_i(+ +Pt(+f),+ +Pt(+(1-f)))*2*6371.007180918475*1e3)}function qr(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0;return b=+Z[c>>3],g=+Vt(+b),y=+Z[c+8>>3]-+Z[u+8>>3],P=g*+pt(+y),f=+Z[u>>3],+ +_i(+P,+(+pt(+b)*+Vt(+f)-+Vt(+y)*(g*+pt(+f))))}function Di(u,c,f,g){u=u|0,c=+c,f=+f,g=g|0;var y=0,b=0,P=0,D=0;if(f<1e-16){s[g>>2]=s[u>>2],s[g+4>>2]=s[u+4>>2],s[g+8>>2]=s[u+8>>2],s[g+12>>2]=s[u+12>>2];return}b=c<0?c+6.283185307179586:c,b=c>=6.283185307179586?b+-6.283185307179586:b;do if(b<1e-16)c=+Z[u>>3]+f,Z[g>>3]=c,y=g;else{if(y=+yt(+(b+-3.141592653589793))<1e-16,c=+Z[u>>3],y){c=c-f,Z[g>>3]=c,y=g;break}if(P=+Vt(+f),f=+pt(+f),c=P*+pt(+c)+ +Vt(+b)*(f*+Vt(+c)),c=c>1?1:c,c=+ni(+(c<-1?-1:c)),Z[g>>3]=c,+yt(+(c+-1.5707963267948966))<1e-16){Z[g>>3]=1.5707963267948966,Z[g+8>>3]=0;return}if(+yt(+(c+1.5707963267948966))<1e-16){Z[g>>3]=-1.5707963267948966,Z[g+8>>3]=0;return}if(D=+Vt(+c),b=f*+pt(+b)/D,f=+Z[u>>3],c=(P-+pt(+c)*+pt(+f))/+Vt(+f)/D,P=b>1?1:b,c=c>1?1:c,c=+Z[u+8>>3]+ +_i(+(P<-1?-1:P),+(c<-1?-1:c)),c>3.141592653589793)do c=c+-6.283185307179586;while(c>3.141592653589793);if(c<-3.141592653589793)do c=c+6.283185307179586;while(c<-3.141592653589793);Z[g+8>>3]=c;return}while(0);if(+yt(+(c+-1.5707963267948966))<1e-16){Z[y>>3]=1.5707963267948966,Z[g+8>>3]=0;return}if(+yt(+(c+1.5707963267948966))<1e-16){Z[y>>3]=-1.5707963267948966,Z[g+8>>3]=0;return}if(c=+Z[u+8>>3],c>3.141592653589793)do c=c+-6.283185307179586;while(c>3.141592653589793);if(c<-3.141592653589793)do c=c+6.283185307179586;while(c<-3.141592653589793);Z[g+8>>3]=c}function xA(u,c){return u=u|0,c=c|0,u>>>0>15?(c=4,c|0):(Z[c>>3]=+Z[20528+(u<<3)>>3],c=0,c|0)}function ds(u,c){return u=u|0,c=c|0,u>>>0>15?(c=4,c|0):(Z[c>>3]=+Z[20656+(u<<3)>>3],c=0,c|0)}function wA(u,c){return u=u|0,c=c|0,u>>>0>15?(c=4,c|0):(Z[c>>3]=+Z[20784+(u<<3)>>3],c=0,c|0)}function wc(u,c){return u=u|0,c=c|0,u>>>0>15?(c=4,c|0):(Z[c>>3]=+Z[20912+(u<<3)>>3],c=0,c|0)}function ha(u,c){u=u|0,c=c|0;var f=0;return u>>>0>15?(c=4,c|0):(f=ps(7,0,u,((u|0)<0)<<31>>31)|0,f=Y(f|0,Se()|0,120,0)|0,u=Se()|0,s[c>>2]=f|2,s[c+4>>2]=u,c=0,c|0)}function Ol(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0;return de=+Z[c>>3],W=+Z[u>>3],N=+pt(+((de-W)*.5)),b=+Z[c+8>>3],G=+Z[u+8>>3],P=+pt(+((b-G)*.5)),D=+Vt(+W),K=+Vt(+de),P=N*N+P*(K*D*P),P=+_i(+ +Pt(+P),+ +Pt(+(1-P)))*2,N=+Z[f>>3],de=+pt(+((N-de)*.5)),g=+Z[f+8>>3],b=+pt(+((g-b)*.5)),y=+Vt(+N),b=de*de+b*(K*y*b),b=+_i(+ +Pt(+b),+ +Pt(+(1-b)))*2,N=+pt(+((W-N)*.5)),g=+pt(+((G-g)*.5)),g=N*N+g*(D*y*g),g=+_i(+ +Pt(+g),+ +Pt(+(1-g)))*2,y=(P+b+g)*.5,+(+Rn(+ +Pt(+(+Dn(+(y*.5))*+Dn(+((y-P)*.5))*+Dn(+((y-b)*.5))*+Dn(+((y-g)*.5)))))*4)}function fa(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0;if(D=_e,_e=_e+192|0,b=D+168|0,P=D,y=Mo(u,c,b)|0,y|0)return f=y,_e=D,f|0;if(tr(u,c,P)|0&&Ht(23313,22742,386,22751),c=s[P>>2]|0,(c|0)>0){if(g=+Ol(P+8|0,P+8+(((c|0)!=1&1)<<4)|0,b)+0,(c|0)!=1){u=1;do y=u,u=u+1|0,g=g+ +Ol(P+8+(y<<4)|0,P+8+(((u|0)%(c|0)|0)<<4)|0,b);while((u|0)<(c|0))}}else g=0;return Z[f>>3]=g,f=0,_e=D,f|0}function Yr(u,c,f){return u=u|0,c=c|0,f=f|0,u=fa(u,c,f)|0,u|0||(Z[f>>3]=+Z[f>>3]*6371.007180918475*6371.007180918475),u|0}function Is(u,c,f){return u=u|0,c=c|0,f=f|0,u=fa(u,c,f)|0,u|0||(Z[f>>3]=+Z[f>>3]*6371.007180918475*6371.007180918475*1e3*1e3),u|0}function Wt(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0;if(D=_e,_e=_e+176|0,P=D,u=Gs(u,c,P)|0,u|0)return P=u,_e=D,P|0;if(Z[f>>3]=0,u=s[P>>2]|0,(u|0)<=1)return P=0,_e=D,P|0;c=u+-1|0,u=0,g=+Z[P+8>>3],y=+Z[P+16>>3],b=0;do u=u+1|0,G=g,g=+Z[P+8+(u<<4)>>3],W=+pt(+((g-G)*.5)),N=y,y=+Z[P+8+(u<<4)+8>>3],N=+pt(+((y-N)*.5)),N=W*W+N*(+Vt(+g)*+Vt(+G)*N),b=b+ +_i(+ +Pt(+N),+ +Pt(+(1-N)))*2;while((u|0)<(c|0));return Z[f>>3]=b,P=0,_e=D,P|0}function Ga(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0;if(D=_e,_e=_e+176|0,P=D,u=Gs(u,c,P)|0,u|0)return P=u,b=+Z[f>>3],b=b*6371.007180918475,Z[f>>3]=b,_e=D,P|0;if(Z[f>>3]=0,u=s[P>>2]|0,(u|0)<=1)return P=0,b=0,b=b*6371.007180918475,Z[f>>3]=b,_e=D,P|0;c=u+-1|0,u=0,g=+Z[P+8>>3],y=+Z[P+16>>3],b=0;do u=u+1|0,G=g,g=+Z[P+8+(u<<4)>>3],W=+pt(+((g-G)*.5)),N=y,y=+Z[P+8+(u<<4)+8>>3],N=+pt(+((y-N)*.5)),N=W*W+N*(+Vt(+G)*+Vt(+g)*N),b=b+ +_i(+ +Pt(+N),+ +Pt(+(1-N)))*2;while((u|0)!=(c|0));return Z[f>>3]=b,P=0,W=b,W=W*6371.007180918475,Z[f>>3]=W,_e=D,P|0}function bA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0;if(D=_e,_e=_e+176|0,P=D,u=Gs(u,c,P)|0,u|0)return P=u,b=+Z[f>>3],b=b*6371.007180918475,b=b*1e3,Z[f>>3]=b,_e=D,P|0;if(Z[f>>3]=0,u=s[P>>2]|0,(u|0)<=1)return P=0,b=0,b=b*6371.007180918475,b=b*1e3,Z[f>>3]=b,_e=D,P|0;c=u+-1|0,u=0,g=+Z[P+8>>3],y=+Z[P+16>>3],b=0;do u=u+1|0,G=g,g=+Z[P+8+(u<<4)>>3],W=+pt(+((g-G)*.5)),N=y,y=+Z[P+8+(u<<4)+8>>3],N=+pt(+((y-N)*.5)),N=W*W+N*(+Vt(+G)*+Vt(+g)*N),b=b+ +_i(+ +Pt(+N),+ +Pt(+(1-N)))*2;while((u|0)!=(c|0));return Z[f>>3]=b,P=0,W=b,W=W*6371.007180918475,W=W*1e3,Z[f>>3]=W,_e=D,P|0}function da(u){u=u|0;var c=0,f=0,g=0;return c=v(1,12)|0,c||Ht(22832,22787,49,22845),f=u+4|0,g=s[f>>2]|0,g|0?(g=g+8|0,s[g>>2]=c,s[f>>2]=c,c|0):(s[u>>2]|0&&Ht(22862,22787,61,22885),g=u,s[g>>2]=c,s[f>>2]=c,c|0)}function zl(u,c){u=u|0,c=c|0;var f=0,g=0;return g=Pi(24)|0,g||Ht(22899,22787,78,22913),s[g>>2]=s[c>>2],s[g+4>>2]=s[c+4>>2],s[g+8>>2]=s[c+8>>2],s[g+12>>2]=s[c+12>>2],s[g+16>>2]=0,c=u+4|0,f=s[c>>2]|0,f|0?(s[f+16>>2]=g,s[c>>2]=g,g|0):(s[u>>2]|0&&Ht(22928,22787,82,22913),s[u>>2]=g,s[c>>2]=g,g|0)}function Bt(u){u=u|0;var c=0,f=0,g=0,y=0;if(u)for(g=1;;){if(c=s[u>>2]|0,c|0)do{if(f=s[c>>2]|0,f|0)do y=f,f=s[f+16>>2]|0,_(y);while(f|0);y=c,c=s[c+8>>2]|0,_(y)}while(c|0);if(c=u,u=s[u+8>>2]|0,g||_(c),u)g=0;else break}}function EA(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0,ct=0,Ct=0,un=0,Yt=0,wt=0,zt=0,nn=0,fn=0,cn=0;if(y=u+8|0,s[y>>2]|0)return cn=1,cn|0;if(g=s[u>>2]|0,!g)return cn=0,cn|0;c=g,f=0;do f=f+1|0,c=s[c+8>>2]|0;while(c|0);if(f>>>0<2)return cn=0,cn|0;nn=Pi(f<<2)|0,nn||Ht(22948,22787,317,22967),zt=Pi(f<<5)|0,zt||Ht(22989,22787,321,22967),s[u>>2]=0,_t=u+4|0,s[_t>>2]=0,s[y>>2]=0,f=0,wt=0,At=0,K=0;e:for(;;){if(W=s[g>>2]|0,W){b=0,P=W;do{if(N=+Z[P+8>>3],c=P,P=s[P+16>>2]|0,G=(P|0)==0,y=G?W:P,D=+Z[y+8>>3],+yt(+(N-D))>3.141592653589793){cn=14;break}b=b+(D-N)*(+Z[c>>3]+ +Z[y>>3])}while(!G);if((cn|0)==14){cn=0,b=0,c=W;do Le=+Z[c+8>>3],Yt=c+16|0,un=s[Yt>>2]|0,un=un|0?un:W,Be=+Z[un+8>>3],b=b+(+Z[c>>3]+ +Z[un>>3])*((Be<0?Be+6.283185307179586:Be)-(Le<0?Le+6.283185307179586:Le)),c=s[(c|0?Yt:g)>>2]|0;while(c|0)}b>0?(s[nn+(wt<<2)>>2]=g,wt=wt+1|0,y=At,c=K):cn=19}else cn=19;if((cn|0)==19){cn=0;do if(f){if(c=f+8|0,s[c>>2]|0){cn=21;break e}if(f=v(1,12)|0,!f){cn=23;break e}s[c>>2]=f,y=f+4|0,P=f,c=K}else if(K){y=_t,P=K+8|0,c=g,f=u;break}else if(s[u>>2]|0){cn=27;break e}else{y=_t,P=u,c=g,f=u;break}while(0);if(s[P>>2]=g,s[y>>2]=g,P=zt+(At<<5)|0,G=s[g>>2]|0,G){for(W=zt+(At<<5)+8|0,Z[W>>3]=17976931348623157e292,K=zt+(At<<5)+24|0,Z[K>>3]=17976931348623157e292,Z[P>>3]=-17976931348623157e292,de=zt+(At<<5)+16|0,Z[de>>3]=-17976931348623157e292,Fe=17976931348623157e292,Re=-17976931348623157e292,y=0,te=G,N=17976931348623157e292,xe=17976931348623157e292,Ie=-17976931348623157e292,D=-17976931348623157e292;b=+Z[te>>3],Le=+Z[te+8>>3],te=s[te+16>>2]|0,se=(te|0)==0,Be=+Z[(se?G:te)+8>>3],b<N&&(Z[W>>3]=b,N=b),Le<xe&&(Z[K>>3]=Le,xe=Le),b>Ie?Z[P>>3]=b:b=Ie,Le>D&&(Z[de>>3]=Le,D=Le),Fe=Le>0&Le<Fe?Le:Fe,Re=Le<0&Le>Re?Le:Re,y=y|+yt(+(Le-Be))>3.141592653589793,!se;)Ie=b;y&&(Z[de>>3]=Re,Z[K>>3]=Fe)}else s[P>>2]=0,s[P+4>>2]=0,s[P+8>>2]=0,s[P+12>>2]=0,s[P+16>>2]=0,s[P+20>>2]=0,s[P+24>>2]=0,s[P+28>>2]=0;y=At+1|0}if(Yt=g+8|0,g=s[Yt>>2]|0,s[Yt>>2]=0,g)At=y,K=c;else{cn=45;break}}if((cn|0)==21)Ht(22765,22787,35,22799);else if((cn|0)==23)Ht(22819,22787,37,22799);else if((cn|0)==27)Ht(22862,22787,61,22885);else if((cn|0)==45){e:do if((wt|0)>0){for(Yt=(y|0)==0,Ct=y<<2,un=(u|0)==0,ct=0,c=0;;){if(nt=s[nn+(ct<<2)>>2]|0,Yt)cn=73;else{if(At=Pi(Ct)|0,!At){cn=50;break}if(_t=Pi(Ct)|0,!_t){cn=52;break}t:do if(un)f=0;else{for(y=0,f=0,P=u;g=zt+(y<<5)|0,TA(s[P>>2]|0,g,s[nt>>2]|0)|0?(s[At+(f<<2)>>2]=P,s[_t+(f<<2)>>2]=g,se=f+1|0):se=f,P=s[P+8>>2]|0,P;)y=y+1|0,f=se;if((se|0)>0)if(g=s[At>>2]|0,(se|0)==1)f=g;else for(de=0,te=-1,f=g,K=g;;){for(G=s[K>>2]|0,g=0,P=0;y=s[s[At+(P<<2)>>2]>>2]|0,(y|0)==(G|0)?W=g:W=g+((TA(y,s[_t+(P<<2)>>2]|0,s[G>>2]|0)|0)&1)|0,P=P+1|0,(P|0)!=(se|0);)g=W;if(y=(W|0)>(te|0),f=y?K:f,g=de+1|0,(g|0)==(se|0))break t;de=g,te=y?W:te,K=s[At+(g<<2)>>2]|0}else f=0}while(0);if(_(At),_(_t),f){if(y=f+4|0,g=s[y>>2]|0,g)f=g+8|0;else if(s[f>>2]|0){cn=70;break}s[f>>2]=nt,s[y>>2]=nt}else cn=73}if((cn|0)==73){if(cn=0,c=s[nt>>2]|0,c|0)do _t=c,c=s[c+16>>2]|0,_(_t);while(c|0);_(nt),c=1}if(ct=ct+1|0,(ct|0)>=(wt|0)){fn=c;break e}}(cn|0)==50?Ht(23004,22787,249,23023):(cn|0)==52?Ht(23042,22787,252,23023):(cn|0)==70&&Ht(22862,22787,61,22885)}else fn=0;while(0);return _(nn),_(zt),cn=fn,cn|0}return 0}function TA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0;if(!(Fr(c,f)|0)||(c=fr(c)|0,g=+Z[f>>3],y=+Z[f+8>>3],y=c&y<0?y+6.283185307179586:y,u=s[u>>2]|0,!u))return u=0,u|0;if(c){c=0,G=y,f=u;e:for(;;){for(;P=+Z[f>>3],y=+Z[f+8>>3],f=f+16|0,W=s[f>>2]|0,W=W|0?W:u,b=+Z[W>>3],D=+Z[W+8>>3],P>b?(N=P,P=D):(N=b,b=P,P=y,y=D),g=g==b|g==N?g+2220446049250313e-31:g,!!(g<b|g>N);)if(f=s[f>>2]|0,!f){f=22;break e}if(D=P<0?P+6.283185307179586:P,P=y<0?y+6.283185307179586:y,G=D==G|P==G?G+-2220446049250313e-31:G,N=D+(P-D)*((g-b)/(N-b)),(N<0?N+6.283185307179586:N)>G&&(c=c^1),f=s[f>>2]|0,!f){f=22;break}}if((f|0)==22)return c|0}else{c=0,G=y,f=u;e:for(;;){for(;P=+Z[f>>3],y=+Z[f+8>>3],f=f+16|0,W=s[f>>2]|0,W=W|0?W:u,b=+Z[W>>3],D=+Z[W+8>>3],P>b?(N=P,P=D):(N=b,b=P,P=y,y=D),g=g==b|g==N?g+2220446049250313e-31:g,!!(g<b|g>N);)if(f=s[f>>2]|0,!f){f=22;break e}if(G=P==G|y==G?G+-2220446049250313e-31:G,P+(y-P)*((g-b)/(N-b))>G&&(c=c^1),f=s[f>>2]|0,!f){f=22;break}}if((f|0)==22)return c|0}return 0}function uo(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0;if(Re=_e,_e=_e+32|0,Fe=Re+16|0,Ie=Re,b=Te(u|0,c|0,52)|0,Se()|0,b=b&15,te=Te(f|0,g|0,52)|0,Se()|0,(b|0)!=(te&15|0))return Fe=12,_e=Re,Fe|0;if(G=Te(u|0,c|0,45)|0,Se()|0,G=G&127,W=Te(f|0,g|0,45)|0,Se()|0,W=W&127,G>>>0>121|W>>>0>121)return Fe=5,_e=Re,Fe|0;if(te=(G|0)!=(W|0),te){if(D=ta(G,W)|0,(D|0)==7)return Fe=1,_e=Re,Fe|0;N=ta(W,G)|0,(N|0)==7?Ht(23066,23090,161,23100):(se=D,P=N)}else se=0,P=0;K=En(G)|0,de=En(W)|0,s[Fe>>2]=0,s[Fe+4>>2]=0,s[Fe+8>>2]=0,s[Fe+12>>2]=0;do if(se){if(W=s[4272+(G*28|0)+(se<<2)>>2]|0,D=(W|0)>0,de)if(D){G=0,N=f,D=g;do N=ua(N,D)|0,D=Se()|0,P=js(P)|0,(P|0)==1&&(P=js(1)|0),G=G+1|0;while((G|0)!=(W|0));W=P,G=N,N=D}else W=P,G=f,N=g;else if(D){G=0,N=f,D=g;do N=Ur(N,D)|0,D=Se()|0,P=js(P)|0,G=G+1|0;while((G|0)!=(W|0));W=P,G=N,N=D}else W=P,G=f,N=g;if(Ms(G,N,Fe)|0,te||Ht(23115,23090,191,23100),D=(K|0)!=0,P=(de|0)!=0,D&P&&Ht(23142,23090,192,23100),D){if(P=Nr(u,c)|0,(P|0)==7){b=5;break}if(rt[21872+(P*7|0)+se>>0]|0){b=1;break}N=s[21040+(P*28|0)+(se<<2)>>2]|0,G=N}else if(P){if(P=Nr(G,N)|0,(P|0)==7){b=5;break}if(rt[21872+(P*7|0)+W>>0]|0){b=1;break}G=0,N=s[21040+(W*28|0)+(P<<2)>>2]|0}else G=0,N=0;if((G|N|0)<0)b=5;else{if((N|0)>0){D=Fe+4|0,P=0;do ra(D),P=P+1|0;while((P|0)!=(N|0))}if(s[Ie>>2]=0,s[Ie+4>>2]=0,s[Ie+8>>2]=0,Ao(Ie,se),b|0)for(;er(b)|0?ia(Ie):Zr(Ie),(b|0)>1;)b=b+-1|0;if((G|0)>0){b=0;do ra(Ie),b=b+1|0;while((b|0)!=(G|0))}xe=Fe+4|0,Hi(xe,Ie,xe),rn(xe),xe=51}}else if(Ms(f,g,Fe)|0,(K|0)!=0&(de|0)!=0)if((W|0)!=(G|0)&&Ht(23173,23090,261,23100),P=Nr(u,c)|0,b=Nr(f,g)|0,(P|0)==7|(b|0)==7)b=5;else if(rt[21872+(P*7|0)+b>>0]|0)b=1;else if(P=s[21040+(P*28|0)+(b<<2)>>2]|0,(P|0)>0){D=Fe+4|0,b=0;do ra(D),b=b+1|0;while((b|0)!=(P|0));xe=51}else xe=51;else xe=51;while(0);return(xe|0)==51&&(b=Fe+4|0,s[y>>2]=s[b>>2],s[y+4>>2]=s[b+4>>2],s[y+8>>2]=s[b+8>>2],b=0),Fe=b,_e=Re,Fe|0}function Qa(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0;if(xe=_e,_e=_e+48|0,G=xe+36|0,P=xe+24|0,D=xe+12|0,N=xe,y=Te(u|0,c|0,52)|0,Se()|0,y=y&15,de=Te(u|0,c|0,45)|0,Se()|0,de=de&127,de>>>0>121)return g=5,_e=xe,g|0;if(W=En(de)|0,ze(y|0,0,52)|0,Ie=Se()|0|134225919,b=g,s[b>>2]=-1,s[b+4>>2]=Ie,!y)return y=na(f)|0,(y|0)==7||(y=ea(de,y)|0,(y|0)==127)?(Ie=1,_e=xe,Ie|0):(te=ze(y|0,0,45)|0,se=Se()|0,de=g,se=s[de+4>>2]&-1040385|se,Ie=g,s[Ie>>2]=s[de>>2]|te,s[Ie+4>>2]=se,Ie=0,_e=xe,Ie|0);for(s[G>>2]=s[f>>2],s[G+4>>2]=s[f+4>>2],s[G+8>>2]=s[f+8>>2],f=y;;){if(b=f,f=f+-1|0,s[P>>2]=s[G>>2],s[P+4>>2]=s[G+4>>2],s[P+8>>2]=s[G+8>>2],er(b)|0){if(y=uA(G)|0,y|0){f=13;break}s[D>>2]=s[G>>2],s[D+4>>2]=s[G+4>>2],s[D+8>>2]=s[G+8>>2],ia(D)}else{if(y=ls(G)|0,y|0){f=13;break}s[D>>2]=s[G>>2],s[D+4>>2]=s[G+4>>2],s[D+8>>2]=s[G+8>>2],Zr(D)}if(Co(P,D,N),rn(N),y=g,Re=s[y>>2]|0,y=s[y+4>>2]|0,Be=(15-b|0)*3|0,Fe=ze(7,0,Be|0)|0,y=y&~(Se()|0),Be=ze(na(N)|0,0,Be|0)|0,y=Se()|0|y,Ie=g,s[Ie>>2]=Be|Re&~Fe,s[Ie+4>>2]=y,(b|0)<=1){f=14;break}}e:do if((f|0)!=13&&(f|0)==14)if((s[G>>2]|0)<=1&&(s[G+4>>2]|0)<=1&&(s[G+8>>2]|0)<=1){f=na(G)|0,y=ea(de,f)|0,(y|0)==127?N=0:N=En(y)|0;t:do if(f){if(W){if(y=Nr(u,c)|0,(y|0)==7){y=5;break e}if(b=s[21248+(y*28|0)+(f<<2)>>2]|0,(b|0)>0){y=f,f=0;do y=us(y)|0,f=f+1|0;while((f|0)!=(b|0))}else y=f;if((y|0)==1){y=9;break e}f=ea(de,y)|0,(f|0)==127&&Ht(23200,23090,411,23230),En(f)|0?Ht(23245,23090,412,23230):(se=f,te=b,K=y)}else se=y,te=0,K=f;if(D=s[4272+(de*28|0)+(K<<2)>>2]|0,(D|0)<=-1&&Ht(23276,23090,419,23230),!N){if((te|0)<0){y=5;break e}if(te|0){b=g,y=0,f=s[b>>2]|0,b=s[b+4>>2]|0;do f=oi(f,b)|0,b=Se()|0,Be=g,s[Be>>2]=f,s[Be+4>>2]=b,y=y+1|0;while((y|0)<(te|0))}if((D|0)<=0){y=se,f=58;break}for(b=g,y=0,f=s[b>>2]|0,b=s[b+4>>2]|0;;)if(f=oi(f,b)|0,b=Se()|0,Be=g,s[Be>>2]=f,s[Be+4>>2]=b,y=y+1|0,(y|0)==(D|0)){y=se,f=58;break t}}if(P=ta(se,de)|0,(P|0)==7&&Ht(23066,23090,428,23230),y=g,f=s[y>>2]|0,y=s[y+4>>2]|0,(D|0)>0){b=0;do f=oi(f,y)|0,y=Se()|0,Be=g,s[Be>>2]=f,s[Be+4>>2]=y,b=b+1|0;while((b|0)!=(D|0))}if(y=Nr(f,y)|0,(y|0)==7&&Ht(23313,23090,440,23230),f=za(se)|0,f=s[(f?21664:21456)+(P*28|0)+(y<<2)>>2]|0,(f|0)<0&&Ht(23313,23090,454,23230),!f)y=se,f=58;else{P=g,y=0,b=s[P>>2]|0,P=s[P+4>>2]|0;do b=il(b,P)|0,P=Se()|0,Be=g,s[Be>>2]=b,s[Be+4>>2]=P,y=y+1|0;while((y|0)<(f|0));y=se,f=58}}else if((W|0)!=0&(N|0)!=0){if(f=Nr(u,c)|0,b=g,b=Nr(s[b>>2]|0,s[b+4>>2]|0)|0,(f|0)==7|(b|0)==7){y=5;break e}if(b=s[21248+(f*28|0)+(b<<2)>>2]|0,(b|0)<0){y=5;break e}if(!b)f=59;else{D=g,f=0,P=s[D>>2]|0,D=s[D+4>>2]|0;do P=oi(P,D)|0,D=Se()|0,Be=g,s[Be>>2]=P,s[Be+4>>2]=D,f=f+1|0;while((f|0)<(b|0));f=58}}else f=58;while(0);if((f|0)==58&&N&&(f=59),(f|0)==59&&(Be=g,(Nr(s[Be>>2]|0,s[Be+4>>2]|0)|0)==1)){y=9;break}Be=g,Fe=s[Be>>2]|0,Be=s[Be+4>>2]&-1040385,Re=ze(y|0,0,45)|0,Be=Be|(Se()|0),y=g,s[y>>2]=Fe|Re,s[y+4>>2]=Be,y=0}else y=1;while(0);return Be=y,_e=xe,Be|0}function SA(u,c,f,g,y,b){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0,b=b|0;var P=0,D=0;return D=_e,_e=_e+16|0,P=D,y?u=15:(u=uo(u,c,f,g,P)|0,u||(Tu(P,b),u=0)),_e=D,u|0}function Fl(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0;return P=_e,_e=_e+16|0,b=P,g?f=15:(f=kl(f,b)|0,f||(f=Qa(u,c,b,y)|0)),_e=P,f|0}function bc(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0;return N=_e,_e=_e+32|0,P=N+12|0,D=N,b=uo(u,c,u,c,P)|0,b|0?(D=b,_e=N,D|0):(u=uo(u,c,f,g,D)|0,u|0?(D=u,_e=N,D|0):(P=tl(P,D)|0,D=y,s[D>>2]=P,s[D+4>>2]=((P|0)<0)<<31>>31,D=0,_e=N,D|0))}function Mu(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0;return N=_e,_e=_e+32|0,P=N+12|0,D=N,b=uo(u,c,u,c,P)|0,!b&&(b=uo(u,c,f,g,D)|0,!b)?(g=tl(P,D)|0,g=E(g|0,((g|0)<0)<<31>>31|0,1,0)|0,P=Se()|0,D=y,s[D>>2]=g,s[D+4>>2]=P,D=0,_e=N,D|0):(D=b,_e=N,D|0)}function Nl(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0,ct=0;if(nt=_e,_e=_e+48|0,P=nt+24|0,D=nt+12|0,_t=nt,b=uo(u,c,u,c,P)|0,!b&&(b=uo(u,c,f,g,D)|0,!b)){Le=tl(P,D)|0,At=((Le|0)<0)<<31>>31,s[P>>2]=0,s[P+4>>2]=0,s[P+8>>2]=0,s[D>>2]=0,s[D+4>>2]=0,s[D+8>>2]=0,uo(u,c,u,c,P)|0&&Ht(23313,23090,691,23299),uo(u,c,f,g,D)|0&&Ht(23313,23090,696,23299),cs(P),cs(D),Le?(K=s[P>>2]|0,se=+(Le|0),Fe=P+4|0,de=s[Fe>>2]|0,Re=P+8|0,te=s[Re>>2]|0,Be=P,g=K,b=de,f=te,xe=+((s[D>>2]|0)-K|0)/se,Ie=+((s[D+4>>2]|0)-de|0)/se,se=+((s[D+8>>2]|0)-te|0)/se):(b=P+4|0,f=P+8|0,Fe=b,Re=f,Be=P,g=s[P>>2]|0,b=s[b>>2]|0,f=s[f>>2]|0,xe=0,Ie=0,se=0),s[_t>>2]=g,te=_t+4|0,s[te>>2]=b,de=_t+8|0,s[de>>2]=f;e:do if((Le|0)<0)b=0;else for(W=0,K=0,b=g;;){G=+(K>>>0)+4294967296*+(W|0),ct=xe*G+ +(b|0),N=Ie*G+ +(s[Fe>>2]|0),G=se*G+ +(s[Re>>2]|0),f=~~+a(+ct),P=~~+a(+N),b=~~+a(+G),ct=+yt(+(+(f|0)-ct)),N=+yt(+(+(P|0)-N)),G=+yt(+(+(b|0)-G));do if(ct>N&ct>G)f=0-(P+b)|0,g=P;else if(D=0-f|0,N>G){g=D-b|0;break}else{g=P,b=D-P|0;break}while(0);if(s[_t>>2]=f,s[te>>2]=g,s[de>>2]=b,Su(_t),b=Qa(u,c,_t,y+(K<<3)|0)|0,b|0)break e;if(!((W|0)<(At|0)|(W|0)==(At|0)&K>>>0<Le>>>0)){b=0;break e}b=E(K|0,W|0,1,0)|0,D=Se()|0,W=D,K=b,b=s[Be>>2]|0}while(0);return _t=b,_e=nt,_t|0}return _t=b,_e=nt,_t|0}function ps(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0;if((f|0)==0&(g|0)==0)return y=0,b=1,Ut(y|0),b|0;b=u,y=c,u=1,c=0;do P=(f&1|0)==0&!0,u=Y((P?1:b)|0,(P?0:y)|0,u|0,c|0)|0,c=Se()|0,f=Qe(f|0,g|0,1)|0,g=Se()|0,b=Y(b|0,y|0,b|0,y|0)|0,y=Se()|0;while(!((f|0)==0&(g|0)==0));return Ut(c|0),u|0}function rl(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0;if(!(Fr(c,f)|0)||(c=fr(c)|0,g=+Z[f>>3],y=+Z[f+8>>3],y=c&y<0?y+6.283185307179586:y,de=s[u>>2]|0,(de|0)<=0))return de=0,de|0;if(K=s[u+4>>2]|0,c){c=0,W=y,f=-1,u=0;e:for(;;){for(G=u;P=+Z[K+(G<<4)>>3],y=+Z[K+(G<<4)+8>>3],u=(f+2|0)%(de|0)|0,b=+Z[K+(u<<4)>>3],D=+Z[K+(u<<4)+8>>3],P>b?(N=P,P=D):(N=b,b=P,P=y,y=D),g=g==b|g==N?g+2220446049250313e-31:g,!!(g<b|g>N);)if(f=G+1|0,(f|0)>=(de|0)){f=22;break e}else u=G,G=f,f=u;if(D=P<0?P+6.283185307179586:P,P=y<0?y+6.283185307179586:y,W=D==W|P==W?W+-2220446049250313e-31:W,N=D+(P-D)*((g-b)/(N-b)),(N<0?N+6.283185307179586:N)>W&&(c=c^1),u=G+1|0,(u|0)>=(de|0)){f=22;break}else f=G}if((f|0)==22)return c|0}else{c=0,W=y,f=-1,u=0;e:for(;;){for(G=u;P=+Z[K+(G<<4)>>3],y=+Z[K+(G<<4)+8>>3],u=(f+2|0)%(de|0)|0,b=+Z[K+(u<<4)>>3],D=+Z[K+(u<<4)+8>>3],P>b?(N=P,P=D):(N=b,b=P,P=y,y=D),g=g==b|g==N?g+2220446049250313e-31:g,!!(g<b|g>N);)if(f=G+1|0,(f|0)>=(de|0)){f=22;break e}else u=G,G=f,f=u;if(W=P==W|y==W?W+-2220446049250313e-31:W,P+(y-P)*((g-b)/(N-b))>W&&(c=c^1),u=G+1|0,(u|0)>=(de|0)){f=22;break}else f=G}if((f|0)==22)return c|0}return 0}function sl(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0;if(se=s[u>>2]|0,!se){s[c>>2]=0,s[c+4>>2]=0,s[c+8>>2]=0,s[c+12>>2]=0,s[c+16>>2]=0,s[c+20>>2]=0,s[c+24>>2]=0,s[c+28>>2]=0;return}if(xe=c+8|0,Z[xe>>3]=17976931348623157e292,Ie=c+24|0,Z[Ie>>3]=17976931348623157e292,Z[c>>3]=-17976931348623157e292,Fe=c+16|0,Z[Fe>>3]=-17976931348623157e292,!((se|0)<=0)){for(de=s[u+4>>2]|0,G=17976931348623157e292,W=-17976931348623157e292,K=0,u=-1,b=17976931348623157e292,P=17976931348623157e292,N=-17976931348623157e292,g=-17976931348623157e292,te=0;f=+Z[de+(te<<4)>>3],D=+Z[de+(te<<4)+8>>3],u=u+2|0,y=+Z[de+(((u|0)==(se|0)?0:u)<<4)+8>>3],f<b&&(Z[xe>>3]=f,b=f),D<P&&(Z[Ie>>3]=D,P=D),f>N?Z[c>>3]=f:f=N,D>g&&(Z[Fe>>3]=D,g=D),G=D>0&D<G?D:G,W=D<0&D>W?D:W,K=K|+yt(+(D-y))>3.141592653589793,u=te+1|0,(u|0)!=(se|0);)Re=te,N=f,te=u,u=Re;K&&(Z[Fe>>3]=W,Z[Ie>>3]=G)}}function wr(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0,_t=0,nt=0;if(se=s[u>>2]|0,se){if(xe=c+8|0,Z[xe>>3]=17976931348623157e292,Ie=c+24|0,Z[Ie>>3]=17976931348623157e292,Z[c>>3]=-17976931348623157e292,Fe=c+16|0,Z[Fe>>3]=-17976931348623157e292,(se|0)>0){for(y=s[u+4>>2]|0,de=17976931348623157e292,te=-17976931348623157e292,g=0,f=-1,N=17976931348623157e292,G=17976931348623157e292,K=-17976931348623157e292,P=-17976931348623157e292,Re=0;b=+Z[y+(Re<<4)>>3],W=+Z[y+(Re<<4)+8>>3],_t=f+2|0,D=+Z[y+(((_t|0)==(se|0)?0:_t)<<4)+8>>3],b<N&&(Z[xe>>3]=b,N=b),W<G&&(Z[Ie>>3]=W,G=W),b>K?Z[c>>3]=b:b=K,W>P&&(Z[Fe>>3]=W,P=W),de=W>0&W<de?W:de,te=W<0&W>te?W:te,g=g|+yt(+(W-D))>3.141592653589793,f=Re+1|0,(f|0)!=(se|0);)_t=Re,K=b,Re=f,f=_t;g&&(Z[Fe>>3]=te,Z[Ie>>3]=de)}}else s[c>>2]=0,s[c+4>>2]=0,s[c+8>>2]=0,s[c+12>>2]=0,s[c+16>>2]=0,s[c+20>>2]=0,s[c+24>>2]=0,s[c+28>>2]=0;if(_t=u+8|0,f=s[_t>>2]|0,!((f|0)<=0)){At=u+12|0,Le=0;do if(y=s[At>>2]|0,g=Le,Le=Le+1|0,Ie=c+(Le<<5)|0,Fe=s[y+(g<<3)>>2]|0,Fe){if(Re=c+(Le<<5)+8|0,Z[Re>>3]=17976931348623157e292,u=c+(Le<<5)+24|0,Z[u>>3]=17976931348623157e292,Z[Ie>>3]=-17976931348623157e292,Be=c+(Le<<5)+16|0,Z[Be>>3]=-17976931348623157e292,(Fe|0)>0){for(se=s[y+(g<<3)+4>>2]|0,de=17976931348623157e292,te=-17976931348623157e292,y=0,g=-1,xe=0,N=17976931348623157e292,G=17976931348623157e292,W=-17976931348623157e292,P=-17976931348623157e292;b=+Z[se+(xe<<4)>>3],K=+Z[se+(xe<<4)+8>>3],g=g+2|0,D=+Z[se+(((g|0)==(Fe|0)?0:g)<<4)+8>>3],b<N&&(Z[Re>>3]=b,N=b),K<G&&(Z[u>>3]=K,G=K),b>W?Z[Ie>>3]=b:b=W,K>P&&(Z[Be>>3]=K,P=K),de=K>0&K<de?K:de,te=K<0&K>te?K:te,y=y|+yt(+(K-D))>3.141592653589793,g=xe+1|0,(g|0)!=(Fe|0);)nt=xe,xe=g,W=b,g=nt;y&&(Z[Be>>3]=te,Z[u>>3]=de)}}else s[Ie>>2]=0,s[Ie+4>>2]=0,s[Ie+8>>2]=0,s[Ie+12>>2]=0,s[Ie+16>>2]=0,s[Ie+20>>2]=0,s[Ie+24>>2]=0,s[Ie+28>>2]=0,f=s[_t>>2]|0;while((Le|0)<(f|0))}}function co(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;if(!(rl(u,c,f)|0))return y=0,y|0;if(y=u+8|0,(s[y>>2]|0)<=0)return y=1,y|0;for(g=u+12|0,u=0;;){if(b=u,u=u+1|0,rl((s[g>>2]|0)+(b<<3)|0,c+(u<<5)|0,f)|0){u=0,g=6;break}if((u|0)>=(s[y>>2]|0)){u=1,g=6;break}}return(g|0)==6?u|0:0}function yi(){return 8}function Ul(){return 16}function Vl(){return 168}function jl(){return 8}function Gl(){return 16}function Xr(){return 12}function ci(){return 8}function CA(u){return u=u|0,+(+((s[u>>2]|0)>>>0)+4294967296*+(s[u+4>>2]|0))}function Ha(u){u=u|0;var c=0,f=0;return f=+Z[u>>3],c=+Z[u+8>>3],+ +Pt(+(f*f+c*c))}function Ql(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0;G=+Z[u>>3],N=+Z[c>>3]-G,D=+Z[u+8>>3],P=+Z[c+8>>3]-D,K=+Z[f>>3],b=+Z[g>>3]-K,de=+Z[f+8>>3],W=+Z[g+8>>3]-de,b=(b*(D-de)-(G-K)*W)/(N*W-P*b),Z[y>>3]=G+N*b,Z[y+8>>3]=D+P*b}function PA(u,c){return u=u|0,c=c|0,+yt(+(+Z[u>>3]-+Z[c>>3]))<11920928955078125e-23?(c=+yt(+(+Z[u+8>>3]-+Z[c+8>>3]))<11920928955078125e-23,c|0):(c=0,c|0)}function Ci(u,c){u=u|0,c=c|0;var f=0,g=0,y=0;return y=+Z[u>>3]-+Z[c>>3],g=+Z[u+8>>3]-+Z[c+8>>3],f=+Z[u+16>>3]-+Z[c+16>>3],+(y*y+g*g+f*f)}function Ec(u,c){u=u|0,c=c|0;var f=0,g=0,y=0;f=+Z[u>>3],g=+Vt(+f),f=+pt(+f),Z[c+16>>3]=f,f=+Z[u+8>>3],y=g*+Vt(+f),Z[c>>3]=y,f=g*+pt(+f),Z[c+8>>3]=f}function jr(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;if(b=_e,_e=_e+16|0,y=b,g=ui(u,c)|0,(f+-1|0)>>>0>5||(g=(g|0)!=0,(f|0)==1&g))return y=-1,_e=b,y|0;do if(Wi(u,c,y)|0)g=-1;else if(g){g=((s[21936+(f<<2)>>2]|0)+5-(s[y>>2]|0)|0)%5|0;break}else{g=((s[21968+(f<<2)>>2]|0)+6-(s[y>>2]|0)|0)%6|0;break}while(0);return y=g,_e=b,y|0}function Wi(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0,G=0;if(G=_e,_e=_e+32|0,P=G+16|0,D=G,g=hs(u,c,P)|0,g|0)return f=g,_e=G,f|0;b=Ua(u,c)|0,N=Nr(u,c)|0,AA(b,D),g=Jo(b,s[P>>2]|0)|0;e:do if(En(b)|0){do switch(b|0){case 4:{u=0;break}case 14:{u=1;break}case 24:{u=2;break}case 38:{u=3;break}case 49:{u=4;break}case 58:{u=5;break}case 63:{u=6;break}case 72:{u=7;break}case 83:{u=8;break}case 97:{u=9;break}case 107:{u=10;break}case 117:{u=11;break}default:{g=1;break e}}while(0);if(y=s[22e3+(u*24|0)+8>>2]|0,c=s[22e3+(u*24|0)+16>>2]|0,u=s[P>>2]|0,(u|0)!=(s[D>>2]|0)&&(D=za(b)|0,u=s[P>>2]|0,D|(u|0)==(c|0)&&(g=(g+1|0)%6|0)),(N|0)==3&(u|0)==(c|0)){g=(g+5|0)%6|0,y=22;break}(N|0)==5&(u|0)==(y|0)&&(g=(g+1|0)%6|0),y=22}else y=22;while(0);return(y|0)==22&&(s[f>>2]=g,g=0),f=g,_e=G,f|0}function gt(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0;if(Be=_e,_e=_e+32|0,Re=Be+24|0,Ie=Be+20|0,se=Be+8|0,te=Be+16|0,de=Be,N=(ui(u,c)|0)==0,N=N?6:5,W=Te(u|0,c|0,52)|0,Se()|0,W=W&15,N>>>0<=f>>>0)return g=2,_e=Be,g|0;K=(W|0)==0,!K&&(xe=ze(7,0,(W^15)*3|0)|0,(xe&u|0)==0&((Se()|0)&c|0)==0)?y=f:b=4;e:do if((b|0)==4){if(y=(ui(u,c)|0)!=0,((y?4:5)|0)<(f|0)||Wi(u,c,Re)|0||(b=(s[Re>>2]|0)+f|0,y?y=22288+(((b|0)%5|0)<<2)|0:y=22320+(((b|0)%6|0)<<2)|0,xe=s[y>>2]|0,(xe|0)==7))return g=1,_e=Be,g|0;s[Ie>>2]=0,y=Ge(u,c,xe,Ie,se)|0;do if(!y){if(D=se,G=s[D>>2]|0,D=s[D+4>>2]|0,P=D>>>0<c>>>0|(D|0)==(c|0)&G>>>0<u>>>0,b=P?G:u,P=P?D:c,!K&&(K=ze(7,0,(W^15)*3|0)|0,(G&K|0)==0&(D&(Se()|0)|0)==0))y=f;else{if(D=(f+-1+N|0)%(N|0)|0,y=ui(u,c)|0,(D|0)<0&&Ht(23313,23315,245,23324),N=(y|0)!=0,((N?4:5)|0)<(D|0)&&Ht(23313,23315,245,23324),Wi(u,c,Re)|0&&Ht(23313,23315,245,23324),y=(s[Re>>2]|0)+D|0,N?y=22288+(((y|0)%5|0)<<2)|0:y=22320+(((y|0)%6|0)<<2)|0,D=s[y>>2]|0,(D|0)==7&&Ht(23313,23315,245,23324),s[te>>2]=0,y=Ge(u,c,D,te,de)|0,y|0)break;G=de,N=s[G>>2]|0,G=s[G+4>>2]|0;do if(G>>>0<P>>>0|(G|0)==(P|0)&N>>>0<b>>>0){if(ui(N,G)|0?b=ot(N,G,u,c)|0:b=s[22384+((((s[te>>2]|0)+(s[22352+(D<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,y=ui(N,G)|0,(b+-1|0)>>>0>5){y=-1,b=N,P=G;break}if(y=(y|0)!=0,(b|0)==1&y){y=-1,b=N,P=G;break}do if(Wi(N,G,Re)|0)y=-1;else if(y){y=((s[21936+(b<<2)>>2]|0)+5-(s[Re>>2]|0)|0)%5|0;break}else{y=((s[21968+(b<<2)>>2]|0)+6-(s[Re>>2]|0)|0)%6|0;break}while(0);b=N,P=G}else y=f;while(0);D=se,G=s[D>>2]|0,D=s[D+4>>2]|0}if((b|0)==(G|0)&(P|0)==(D|0)){if(N=(ui(G,D)|0)!=0,N?u=ot(G,D,u,c)|0:u=s[22384+((((s[Ie>>2]|0)+(s[22352+(xe<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,y=ui(G,D)|0,(u+-1|0)>>>0<=5&&(Fe=(y|0)!=0,!((u|0)==1&Fe)))do if(Wi(G,D,Re)|0)y=-1;else if(Fe){y=((s[21936+(u<<2)>>2]|0)+5-(s[Re>>2]|0)|0)%5|0;break}else{y=((s[21968+(u<<2)>>2]|0)+6-(s[Re>>2]|0)|0)%6|0;break}while(0);else y=-1;y=y+1|0,y=(y|0)==6|N&(y|0)==5?0:y}c=P,u=b;break e}while(0);return g=y,_e=Be,g|0}while(0);return Fe=ze(y|0,0,56)|0,Re=Se()|0|c&-2130706433|536870912,s[g>>2]=Fe|u,s[g+4>>2]=Re,g=0,_e=Be,g|0}function Jt(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;return b=(ui(u,c)|0)==0,g=gt(u,c,0,f)|0,y=(g|0)==0,b?!y||(g=gt(u,c,1,f+8|0)|0,g|0)||(g=gt(u,c,2,f+16|0)|0,g|0)||(g=gt(u,c,3,f+24|0)|0,g|0)||(g=gt(u,c,4,f+32|0)|0,g)?(b=g,b|0):gt(u,c,5,f+40|0)|0:!y||(g=gt(u,c,1,f+8|0)|0,g|0)||(g=gt(u,c,2,f+16|0)|0,g|0)||(g=gt(u,c,3,f+24|0)|0,g|0)||(g=gt(u,c,4,f+32|0)|0,g|0)?(b=g,b|0):(b=f+40|0,s[b>>2]=0,s[b+4>>2]=0,b=0,b|0)}function ol(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0,D=0,N=0;return N=_e,_e=_e+192|0,y=N,b=N+168|0,P=Te(u|0,c|0,56)|0,Se()|0,P=P&7,D=c&-2130706433|134217728,g=hs(u,D,b)|0,g|0?(D=g,_e=N,D|0):(c=Te(u|0,c|0,52)|0,Se()|0,c=c&15,ui(u,D)|0?fi(b,c,P,1,y):ii(b,c,P,1,y),D=y+8|0,s[f>>2]=s[D>>2],s[f+4>>2]=s[D+4>>2],s[f+8>>2]=s[D+8>>2],s[f+12>>2]=s[D+12>>2],D=0,_e=N,D|0)}function pa(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0;return y=_e,_e=_e+16|0,f=y,!(!0&(c&2013265920|0)==536870912)||(g=c&-2130706433|134217728,!(gA(u,g)|0))?(g=0,_e=y,g|0):(b=Te(u|0,c|0,56)|0,Se()|0,b=(gt(u,g,b&7,f)|0)==0,g=f,g=b&((s[g>>2]|0)==(u|0)?(s[g+4>>2]|0)==(c|0):0)&1,_e=y,g|0)}function MA(u,c,f){u=u|0,c=c|0,f=f|0;var g=0;(c|0)>0?(g=v(c,4)|0,s[u>>2]=g,g||Ht(23337,23360,40,23374)):s[u>>2]=0,s[u+4>>2]=c,s[u+8>>2]=0,s[u+12>>2]=f}function br(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0;y=u+4|0,b=u+12|0,P=u+8|0;e:for(;;){for(f=s[y>>2]|0,c=0;;){if((c|0)>=(f|0))break e;if(g=s[u>>2]|0,D=s[g+(c<<2)>>2]|0,!D)c=c+1|0;else break}c=g+(~~(+yt(+(+Qt(10,+ +(15-(s[b>>2]|0)|0))*(+Z[D>>3]+ +Z[D+8>>3])))%+(f|0))>>>0<<2)|0,f=s[c>>2]|0;t:do if(f|0){if(g=D+32|0,(f|0)==(D|0))s[c>>2]=s[g>>2];else{if(f=f+32|0,c=s[f>>2]|0,!c)break;for(;(c|0)!=(D|0);)if(f=c+32|0,c=s[f>>2]|0,!c)break t;s[f>>2]=s[g>>2]}_(D),s[P>>2]=(s[P>>2]|0)+-1}while(0)}_(s[u>>2]|0)}function Er(u){u=u|0;var c=0,f=0,g=0;for(g=s[u+4>>2]|0,f=0;;){if((f|0)>=(g|0)){c=0,f=4;break}if(c=s[(s[u>>2]|0)+(f<<2)>>2]|0,!c)f=f+1|0;else{f=4;break}}return(f|0)==4?c|0:0}function xt(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0;if(f=~~(+yt(+(+Qt(10,+ +(15-(s[u+12>>2]|0)|0))*(+Z[c>>3]+ +Z[c+8>>3])))%+(s[u+4>>2]|0))>>>0,f=(s[u>>2]|0)+(f<<2)|0,g=s[f>>2]|0,!g)return b=1,b|0;b=c+32|0;do if((g|0)!=(c|0)){if(f=s[g+32>>2]|0,!f)return b=1,b|0;for(y=f;;){if((y|0)==(c|0)){y=8;break}if(f=s[y+32>>2]|0,f)g=y,y=f;else{f=1,y=10;break}}if((y|0)==8){s[g+32>>2]=s[b>>2];break}else if((y|0)==10)return f|0}else s[f>>2]=s[b>>2];while(0);return _(c),b=u+8|0,s[b>>2]=(s[b>>2]|0)+-1,b=0,b|0}function qt(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0;b=Pi(40)|0,b||Ht(23390,23360,98,23403),s[b>>2]=s[c>>2],s[b+4>>2]=s[c+4>>2],s[b+8>>2]=s[c+8>>2],s[b+12>>2]=s[c+12>>2],y=b+16|0,s[y>>2]=s[f>>2],s[y+4>>2]=s[f+4>>2],s[y+8>>2]=s[f+8>>2],s[y+12>>2]=s[f+12>>2],s[b+32>>2]=0,y=~~(+yt(+(+Qt(10,+ +(15-(s[u+12>>2]|0)|0))*(+Z[c>>3]+ +Z[c+8>>3])))%+(s[u+4>>2]|0))>>>0,y=(s[u>>2]|0)+(y<<2)|0,g=s[y>>2]|0;do if(!g)s[y>>2]=b;else{for(;!(Do(g,c)|0&&Do(g+16|0,f)|0);)if(y=s[g+32>>2]|0,g=y|0?y:g,!(s[g+32>>2]|0)){P=10;break}if((P|0)==10){s[g+32>>2]=b;break}return _(b),P=g,P|0}while(0);return P=u+8|0,s[P>>2]=(s[P>>2]|0)+1,P=b,P|0}function Wa(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0;if(y=~~(+yt(+(+Qt(10,+ +(15-(s[u+12>>2]|0)|0))*(+Z[c>>3]+ +Z[c+8>>3])))%+(s[u+4>>2]|0))>>>0,y=s[(s[u>>2]|0)+(y<<2)>>2]|0,!y)return f=0,f|0;if(!f){for(u=y;;){if(Do(u,c)|0){g=10;break}if(u=s[u+32>>2]|0,!u){u=0,g=10;break}}if((g|0)==10)return u|0}for(u=y;;){if(Do(u,c)|0&&Do(u+16|0,f)|0){g=10;break}if(u=s[u+32>>2]|0,!u){u=0,g=10;break}}return(g|0)==10?u|0:0}function ai(u,c){u=u|0,c=c|0;var f=0;if(f=~~(+yt(+(+Qt(10,+ +(15-(s[u+12>>2]|0)|0))*(+Z[c>>3]+ +Z[c+8>>3])))%+(s[u+4>>2]|0))>>>0,u=s[(s[u>>2]|0)+(f<<2)>>2]|0,!u)return f=0,f|0;for(;;){if(Do(u,c)|0){c=5;break}if(u=s[u+32>>2]|0,!u){u=0,c=5;break}}return(c|0)==5?u|0:0}function pi(){return 23424}function gs(u){return u=+u,+ +T(+u)}function Bi(u){return u=+u,~~+gs(u)|0}function Pi(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0,xe=0,Ie=0,Fe=0,Re=0,Be=0,Le=0,At=0;At=_e,_e=_e+16|0,de=At;do if(u>>>0<245){if(G=u>>>0<11?16:u+11&-8,u=G>>>3,K=s[5857]|0,f=K>>>u,f&3|0)return c=(f&1^1)+u|0,u=23468+(c<<1<<2)|0,f=u+8|0,g=s[f>>2]|0,y=g+8|0,b=s[y>>2]|0,(b|0)==(u|0)?s[5857]=K&~(1<<c):(s[b+12>>2]=u,s[f>>2]=b),Le=c<<3,s[g+4>>2]=Le|3,Le=g+Le+4|0,s[Le>>2]=s[Le>>2]|1,Le=y,_e=At,Le|0;if(W=s[5859]|0,G>>>0>W>>>0){if(f|0)return c=2<<u,c=f<<u&(c|0-c),c=(c&0-c)+-1|0,D=c>>>12&16,c=c>>>D,f=c>>>5&8,c=c>>>f,b=c>>>2&4,c=c>>>b,u=c>>>1&2,c=c>>>u,g=c>>>1&1,g=(f|D|b|u|g)+(c>>>g)|0,c=23468+(g<<1<<2)|0,u=c+8|0,b=s[u>>2]|0,D=b+8|0,f=s[D>>2]|0,(f|0)==(c|0)?(u=K&~(1<<g),s[5857]=u):(s[f+12>>2]=c,s[u>>2]=f,u=K),Le=g<<3,P=Le-G|0,s[b+4>>2]=G|3,y=b+G|0,s[y+4>>2]=P|1,s[b+Le>>2]=P,W|0&&(g=s[5862]|0,c=W>>>3,f=23468+(c<<1<<2)|0,c=1<<c,u&c?(u=f+8|0,c=s[u>>2]|0):(s[5857]=u|c,c=f,u=f+8|0),s[u>>2]=g,s[c+12>>2]=g,s[g+8>>2]=c,s[g+12>>2]=f),s[5859]=P,s[5862]=y,Le=D,_e=At,Le|0;if(b=s[5858]|0,b){for(f=(b&0-b)+-1|0,y=f>>>12&16,f=f>>>y,g=f>>>5&8,f=f>>>g,P=f>>>2&4,f=f>>>P,D=f>>>1&2,f=f>>>D,N=f>>>1&1,N=s[23732+((g|y|P|D|N)+(f>>>N)<<2)>>2]|0,f=N,D=N,N=(s[N+4>>2]&-8)-G|0;u=s[f+16>>2]|0,!(!u&&(u=s[f+20>>2]|0,!u));)P=(s[u+4>>2]&-8)-G|0,y=P>>>0<N>>>0,f=u,D=y?u:D,N=y?P:N;if(P=D+G|0,P>>>0>D>>>0){y=s[D+24>>2]|0,c=s[D+12>>2]|0;do if((c|0)==(D|0)){if(u=D+20|0,c=s[u>>2]|0,!c&&(u=D+16|0,c=s[u>>2]|0,!c)){f=0;break}for(;;)if(g=c+20|0,f=s[g>>2]|0,f)c=f,u=g;else if(g=c+16|0,f=s[g>>2]|0,f)c=f,u=g;else break;s[u>>2]=0,f=c}else f=s[D+8>>2]|0,s[f+12>>2]=c,s[c+8>>2]=f,f=c;while(0);do if(y|0){if(c=s[D+28>>2]|0,u=23732+(c<<2)|0,(D|0)==(s[u>>2]|0)){if(s[u>>2]=f,!f){s[5858]=b&~(1<<c);break}}else if(Le=y+16|0,s[((s[Le>>2]|0)==(D|0)?Le:y+20|0)>>2]=f,!f)break;s[f+24>>2]=y,c=s[D+16>>2]|0,c|0&&(s[f+16>>2]=c,s[c+24>>2]=f),c=s[D+20>>2]|0,c|0&&(s[f+20>>2]=c,s[c+24>>2]=f)}while(0);return N>>>0<16?(Le=N+G|0,s[D+4>>2]=Le|3,Le=D+Le+4|0,s[Le>>2]=s[Le>>2]|1):(s[D+4>>2]=G|3,s[P+4>>2]=N|1,s[P+N>>2]=N,W|0&&(g=s[5862]|0,c=W>>>3,f=23468+(c<<1<<2)|0,c=1<<c,c&K?(u=f+8|0,c=s[u>>2]|0):(s[5857]=c|K,c=f,u=f+8|0),s[u>>2]=g,s[c+12>>2]=g,s[g+8>>2]=c,s[g+12>>2]=f),s[5859]=N,s[5862]=P),Le=D+8|0,_e=At,Le|0}else K=G}else K=G}else K=G}else if(u>>>0<=4294967231)if(u=u+11|0,G=u&-8,g=s[5858]|0,g){y=0-G|0,u=u>>>8,u?G>>>0>16777215?N=31:(K=(u+1048320|0)>>>16&8,xe=u<<K,D=(xe+520192|0)>>>16&4,xe=xe<<D,N=(xe+245760|0)>>>16&2,N=14-(D|K|N)+(xe<<N>>>15)|0,N=G>>>(N+7|0)&1|N<<1):N=0,f=s[23732+(N<<2)>>2]|0;e:do if(!f)f=0,u=0,xe=61;else for(u=0,D=G<<((N|0)==31?0:25-(N>>>1)|0),b=0;;){if(P=(s[f+4>>2]&-8)-G|0,P>>>0<y>>>0)if(P)u=f,y=P;else{u=f,y=0,xe=65;break e}if(xe=s[f+20>>2]|0,f=s[f+16+(D>>>31<<2)>>2]|0,b=(xe|0)==0|(xe|0)==(f|0)?b:xe,f)D=D<<1;else{f=b,xe=61;break}}while(0);if((xe|0)==61){if((f|0)==0&(u|0)==0){if(u=2<<N,u=(u|0-u)&g,!u){K=G;break}K=(u&0-u)+-1|0,P=K>>>12&16,K=K>>>P,b=K>>>5&8,K=K>>>b,D=K>>>2&4,K=K>>>D,N=K>>>1&2,K=K>>>N,f=K>>>1&1,u=0,f=s[23732+((b|P|D|N|f)+(K>>>f)<<2)>>2]|0}f?xe=65:(D=u,P=y)}if((xe|0)==65)for(b=f;;)if(K=(s[b+4>>2]&-8)-G|0,f=K>>>0<y>>>0,y=f?K:y,u=f?b:u,f=s[b+16>>2]|0,f||(f=s[b+20>>2]|0),f)b=f;else{D=u,P=y;break}if(D|0&&P>>>0<((s[5859]|0)-G|0)>>>0&&(W=D+G|0,W>>>0>D>>>0)){b=s[D+24>>2]|0,c=s[D+12>>2]|0;do if((c|0)==(D|0)){if(u=D+20|0,c=s[u>>2]|0,!c&&(u=D+16|0,c=s[u>>2]|0,!c)){c=0;break}for(;;)if(y=c+20|0,f=s[y>>2]|0,f)c=f,u=y;else if(y=c+16|0,f=s[y>>2]|0,f)c=f,u=y;else break;s[u>>2]=0}else Le=s[D+8>>2]|0,s[Le+12>>2]=c,s[c+8>>2]=Le;while(0);do if(b){if(u=s[D+28>>2]|0,f=23732+(u<<2)|0,(D|0)==(s[f>>2]|0)){if(s[f>>2]=c,!c){g=g&~(1<<u),s[5858]=g;break}}else if(Le=b+16|0,s[((s[Le>>2]|0)==(D|0)?Le:b+20|0)>>2]=c,!c)break;s[c+24>>2]=b,u=s[D+16>>2]|0,u|0&&(s[c+16>>2]=u,s[u+24>>2]=c),u=s[D+20>>2]|0,u&&(s[c+20>>2]=u,s[u+24>>2]=c)}while(0);e:do if(P>>>0<16)Le=P+G|0,s[D+4>>2]=Le|3,Le=D+Le+4|0,s[Le>>2]=s[Le>>2]|1;else{if(s[D+4>>2]=G|3,s[W+4>>2]=P|1,s[W+P>>2]=P,c=P>>>3,P>>>0<256){f=23468+(c<<1<<2)|0,u=s[5857]|0,c=1<<c,u&c?(u=f+8|0,c=s[u>>2]|0):(s[5857]=u|c,c=f,u=f+8|0),s[u>>2]=W,s[c+12>>2]=W,s[W+8>>2]=c,s[W+12>>2]=f;break}if(c=P>>>8,c?P>>>0>16777215?f=31:(Be=(c+1048320|0)>>>16&8,Le=c<<Be,Re=(Le+520192|0)>>>16&4,Le=Le<<Re,f=(Le+245760|0)>>>16&2,f=14-(Re|Be|f)+(Le<<f>>>15)|0,f=P>>>(f+7|0)&1|f<<1):f=0,c=23732+(f<<2)|0,s[W+28>>2]=f,u=W+16|0,s[u+4>>2]=0,s[u>>2]=0,u=1<<f,!(g&u)){s[5858]=g|u,s[c>>2]=W,s[W+24>>2]=c,s[W+12>>2]=W,s[W+8>>2]=W;break}c=s[c>>2]|0;t:do if((s[c+4>>2]&-8|0)!=(P|0)){for(g=P<<((f|0)==31?0:25-(f>>>1)|0);f=c+16+(g>>>31<<2)|0,u=s[f>>2]|0,!!u;)if((s[u+4>>2]&-8|0)==(P|0)){c=u;break t}else g=g<<1,c=u;s[f>>2]=W,s[W+24>>2]=c,s[W+12>>2]=W,s[W+8>>2]=W;break e}while(0);Be=c+8|0,Le=s[Be>>2]|0,s[Le+12>>2]=W,s[Be>>2]=W,s[W+8>>2]=Le,s[W+12>>2]=c,s[W+24>>2]=0}while(0);return Le=D+8|0,_e=At,Le|0}else K=G}else K=G;else K=-1;while(0);if(f=s[5859]|0,f>>>0>=K>>>0)return c=f-K|0,u=s[5862]|0,c>>>0>15?(Le=u+K|0,s[5862]=Le,s[5859]=c,s[Le+4>>2]=c|1,s[u+f>>2]=c,s[u+4>>2]=K|3):(s[5859]=0,s[5862]=0,s[u+4>>2]=f|3,Le=u+f+4|0,s[Le>>2]=s[Le>>2]|1),Le=u+8|0,_e=At,Le|0;if(P=s[5860]|0,P>>>0>K>>>0)return Re=P-K|0,s[5860]=Re,Le=s[5863]|0,Be=Le+K|0,s[5863]=Be,s[Be+4>>2]=Re|1,s[Le+4>>2]=K|3,Le=Le+8|0,_e=At,Le|0;if(s[5975]|0?u=s[5977]|0:(s[5977]=4096,s[5976]=4096,s[5978]=-1,s[5979]=-1,s[5980]=0,s[5968]=0,s[5975]=de&-16^1431655768,u=4096),D=K+48|0,N=K+47|0,b=u+N|0,y=0-u|0,G=b&y,G>>>0<=K>>>0||(u=s[5967]|0,u|0&&(W=s[5965]|0,de=W+G|0,de>>>0<=W>>>0|de>>>0>u>>>0)))return Le=0,_e=At,Le|0;e:do if(s[5968]&4)c=0,xe=143;else{f=s[5863]|0;t:do if(f){for(g=23876;de=s[g>>2]|0,!(de>>>0<=f>>>0&&(de+(s[g+4>>2]|0)|0)>>>0>f>>>0);)if(u=s[g+8>>2]|0,u)g=u;else{xe=128;break t}if(c=b-P&y,c>>>0<2147483647)if(u=I(c|0)|0,(u|0)==((s[g>>2]|0)+(s[g+4>>2]|0)|0)){if((u|0)!=-1){P=c,b=u,xe=145;break e}}else g=u,xe=136;else c=0}else xe=128;while(0);do if((xe|0)==128)if(f=I(0)|0,(f|0)!=-1&&(c=f,te=s[5976]|0,se=te+-1|0,c=(se&c|0?(se+c&0-te)-c|0:0)+G|0,te=s[5965]|0,se=c+te|0,c>>>0>K>>>0&c>>>0<2147483647)){if(de=s[5967]|0,de|0&&se>>>0<=te>>>0|se>>>0>de>>>0){c=0;break}if(u=I(c|0)|0,(u|0)==(f|0)){P=c,b=f,xe=145;break e}else g=u,xe=136}else c=0;while(0);do if((xe|0)==136){if(f=0-c|0,!(D>>>0>c>>>0&(c>>>0<2147483647&(g|0)!=-1)))if((g|0)==-1){c=0;break}else{P=c,b=g,xe=145;break e}if(u=s[5977]|0,u=N-c+u&0-u,u>>>0>=2147483647){P=c,b=g,xe=145;break e}if((I(u|0)|0)==-1){I(f|0)|0,c=0;break}else{P=u+c|0,b=g,xe=145;break e}}while(0);s[5968]=s[5968]|4,xe=143}while(0);if((xe|0)==143&&G>>>0<2147483647&&(Re=I(G|0)|0,se=I(0)|0,Ie=se-Re|0,Fe=Ie>>>0>(K+40|0)>>>0,!((Re|0)==-1|Fe^1|Re>>>0<se>>>0&((Re|0)!=-1&(se|0)!=-1)^1))&&(P=Fe?Ie:c,b=Re,xe=145),(xe|0)==145){c=(s[5965]|0)+P|0,s[5965]=c,c>>>0>(s[5966]|0)>>>0&&(s[5966]=c),N=s[5863]|0;e:do if(N){for(c=23876;;){if(u=s[c>>2]|0,f=s[c+4>>2]|0,(b|0)==(u+f|0)){xe=154;break}if(g=s[c+8>>2]|0,g)c=g;else break}if((xe|0)==154&&(Be=c+4|0,(s[c+12>>2]&8|0)==0)&&b>>>0>N>>>0&u>>>0<=N>>>0){s[Be>>2]=f+P,Le=(s[5860]|0)+P|0,Re=N+8|0,Re=Re&7|0?0-Re&7:0,Be=N+Re|0,Re=Le-Re|0,s[5863]=Be,s[5860]=Re,s[Be+4>>2]=Re|1,s[N+Le+4>>2]=40,s[5864]=s[5979];break}for(b>>>0<(s[5861]|0)>>>0&&(s[5861]=b),f=b+P|0,c=23876;;){if((s[c>>2]|0)==(f|0)){xe=162;break}if(u=s[c+8>>2]|0,u)c=u;else break}if((xe|0)==162&&!(s[c+12>>2]&8|0)){s[c>>2]=b,W=c+4|0,s[W>>2]=(s[W>>2]|0)+P,W=b+8|0,W=b+(W&7|0?0-W&7:0)|0,c=f+8|0,c=f+(c&7|0?0-c&7:0)|0,G=W+K|0,D=c-W-K|0,s[W+4>>2]=K|3;t:do if((N|0)==(c|0))Le=(s[5860]|0)+D|0,s[5860]=Le,s[5863]=G,s[G+4>>2]=Le|1;else{if((s[5862]|0)==(c|0)){Le=(s[5859]|0)+D|0,s[5859]=Le,s[5862]=G,s[G+4>>2]=Le|1,s[G+Le>>2]=Le;break}if(u=s[c+4>>2]|0,(u&3|0)==1){P=u&-8,g=u>>>3;n:do if(u>>>0<256)if(u=s[c+8>>2]|0,f=s[c+12>>2]|0,(f|0)==(u|0)){s[5857]=s[5857]&~(1<<g);break}else{s[u+12>>2]=f,s[f+8>>2]=u;break}else{b=s[c+24>>2]|0,u=s[c+12>>2]|0;do if((u|0)==(c|0)){if(f=c+16|0,g=f+4|0,u=s[g>>2]|0,u)f=g;else if(u=s[f>>2]|0,!u){u=0;break}for(;;)if(y=u+20|0,g=s[y>>2]|0,g)u=g,f=y;else if(y=u+16|0,g=s[y>>2]|0,g)u=g,f=y;else break;s[f>>2]=0}else Le=s[c+8>>2]|0,s[Le+12>>2]=u,s[u+8>>2]=Le;while(0);if(!b)break;f=s[c+28>>2]|0,g=23732+(f<<2)|0;do if((s[g>>2]|0)!=(c|0)){if(Le=b+16|0,s[((s[Le>>2]|0)==(c|0)?Le:b+20|0)>>2]=u,!u)break n}else{if(s[g>>2]=u,u|0)break;s[5858]=s[5858]&~(1<<f);break n}while(0);if(s[u+24>>2]=b,f=c+16|0,g=s[f>>2]|0,g|0&&(s[u+16>>2]=g,s[g+24>>2]=u),f=s[f+4>>2]|0,!f)break;s[u+20>>2]=f,s[f+24>>2]=u}while(0);c=c+P|0,y=P+D|0}else y=D;if(c=c+4|0,s[c>>2]=s[c>>2]&-2,s[G+4>>2]=y|1,s[G+y>>2]=y,c=y>>>3,y>>>0<256){f=23468+(c<<1<<2)|0,u=s[5857]|0,c=1<<c,u&c?(u=f+8|0,c=s[u>>2]|0):(s[5857]=u|c,c=f,u=f+8|0),s[u>>2]=G,s[c+12>>2]=G,s[G+8>>2]=c,s[G+12>>2]=f;break}c=y>>>8;do if(!c)g=0;else{if(y>>>0>16777215){g=31;break}Be=(c+1048320|0)>>>16&8,Le=c<<Be,Re=(Le+520192|0)>>>16&4,Le=Le<<Re,g=(Le+245760|0)>>>16&2,g=14-(Re|Be|g)+(Le<<g>>>15)|0,g=y>>>(g+7|0)&1|g<<1}while(0);if(c=23732+(g<<2)|0,s[G+28>>2]=g,u=G+16|0,s[u+4>>2]=0,s[u>>2]=0,u=s[5858]|0,f=1<<g,!(u&f)){s[5858]=u|f,s[c>>2]=G,s[G+24>>2]=c,s[G+12>>2]=G,s[G+8>>2]=G;break}c=s[c>>2]|0;n:do if((s[c+4>>2]&-8|0)!=(y|0)){for(g=y<<((g|0)==31?0:25-(g>>>1)|0);f=c+16+(g>>>31<<2)|0,u=s[f>>2]|0,!!u;)if((s[u+4>>2]&-8|0)==(y|0)){c=u;break n}else g=g<<1,c=u;s[f>>2]=G,s[G+24>>2]=c,s[G+12>>2]=G,s[G+8>>2]=G;break t}while(0);Be=c+8|0,Le=s[Be>>2]|0,s[Le+12>>2]=G,s[Be>>2]=G,s[G+8>>2]=Le,s[G+12>>2]=c,s[G+24>>2]=0}while(0);return Le=W+8|0,_e=At,Le|0}for(c=23876;u=s[c>>2]|0,!(u>>>0<=N>>>0&&(Le=u+(s[c+4>>2]|0)|0,Le>>>0>N>>>0));)c=s[c+8>>2]|0;y=Le+-47|0,u=y+8|0,u=y+(u&7|0?0-u&7:0)|0,y=N+16|0,u=u>>>0<y>>>0?N:u,c=u+8|0,f=P+-40|0,Re=b+8|0,Re=Re&7|0?0-Re&7:0,Be=b+Re|0,Re=f-Re|0,s[5863]=Be,s[5860]=Re,s[Be+4>>2]=Re|1,s[b+f+4>>2]=40,s[5864]=s[5979],f=u+4|0,s[f>>2]=27,s[c>>2]=s[5969],s[c+4>>2]=s[5970],s[c+8>>2]=s[5971],s[c+12>>2]=s[5972],s[5969]=b,s[5970]=P,s[5972]=0,s[5971]=c,c=u+24|0;do Be=c,c=c+4|0,s[c>>2]=7;while((Be+8|0)>>>0<Le>>>0);if((u|0)!=(N|0)){if(b=u-N|0,s[f>>2]=s[f>>2]&-2,s[N+4>>2]=b|1,s[u>>2]=b,c=b>>>3,b>>>0<256){f=23468+(c<<1<<2)|0,u=s[5857]|0,c=1<<c,u&c?(u=f+8|0,c=s[u>>2]|0):(s[5857]=u|c,c=f,u=f+8|0),s[u>>2]=N,s[c+12>>2]=N,s[N+8>>2]=c,s[N+12>>2]=f;break}if(c=b>>>8,c?b>>>0>16777215?g=31:(Be=(c+1048320|0)>>>16&8,Le=c<<Be,Re=(Le+520192|0)>>>16&4,Le=Le<<Re,g=(Le+245760|0)>>>16&2,g=14-(Re|Be|g)+(Le<<g>>>15)|0,g=b>>>(g+7|0)&1|g<<1):g=0,f=23732+(g<<2)|0,s[N+28>>2]=g,s[N+20>>2]=0,s[y>>2]=0,c=s[5858]|0,u=1<<g,!(c&u)){s[5858]=c|u,s[f>>2]=N,s[N+24>>2]=f,s[N+12>>2]=N,s[N+8>>2]=N;break}c=s[f>>2]|0;t:do if((s[c+4>>2]&-8|0)!=(b|0)){for(g=b<<((g|0)==31?0:25-(g>>>1)|0);f=c+16+(g>>>31<<2)|0,u=s[f>>2]|0,!!u;)if((s[u+4>>2]&-8|0)==(b|0)){c=u;break t}else g=g<<1,c=u;s[f>>2]=N,s[N+24>>2]=c,s[N+12>>2]=N,s[N+8>>2]=N;break e}while(0);Be=c+8|0,Le=s[Be>>2]|0,s[Le+12>>2]=N,s[Be>>2]=N,s[N+8>>2]=Le,s[N+12>>2]=c,s[N+24>>2]=0}}else Le=s[5861]|0,(Le|0)==0|b>>>0<Le>>>0&&(s[5861]=b),s[5969]=b,s[5970]=P,s[5972]=0,s[5866]=s[5975],s[5865]=-1,s[5870]=23468,s[5869]=23468,s[5872]=23476,s[5871]=23476,s[5874]=23484,s[5873]=23484,s[5876]=23492,s[5875]=23492,s[5878]=23500,s[5877]=23500,s[5880]=23508,s[5879]=23508,s[5882]=23516,s[5881]=23516,s[5884]=23524,s[5883]=23524,s[5886]=23532,s[5885]=23532,s[5888]=23540,s[5887]=23540,s[5890]=23548,s[5889]=23548,s[5892]=23556,s[5891]=23556,s[5894]=23564,s[5893]=23564,s[5896]=23572,s[5895]=23572,s[5898]=23580,s[5897]=23580,s[5900]=23588,s[5899]=23588,s[5902]=23596,s[5901]=23596,s[5904]=23604,s[5903]=23604,s[5906]=23612,s[5905]=23612,s[5908]=23620,s[5907]=23620,s[5910]=23628,s[5909]=23628,s[5912]=23636,s[5911]=23636,s[5914]=23644,s[5913]=23644,s[5916]=23652,s[5915]=23652,s[5918]=23660,s[5917]=23660,s[5920]=23668,s[5919]=23668,s[5922]=23676,s[5921]=23676,s[5924]=23684,s[5923]=23684,s[5926]=23692,s[5925]=23692,s[5928]=23700,s[5927]=23700,s[5930]=23708,s[5929]=23708,s[5932]=23716,s[5931]=23716,Le=P+-40|0,Re=b+8|0,Re=Re&7|0?0-Re&7:0,Be=b+Re|0,Re=Le-Re|0,s[5863]=Be,s[5860]=Re,s[Be+4>>2]=Re|1,s[b+Le+4>>2]=40,s[5864]=s[5979];while(0);if(c=s[5860]|0,c>>>0>K>>>0)return Re=c-K|0,s[5860]=Re,Le=s[5863]|0,Be=Le+K|0,s[5863]=Be,s[Be+4>>2]=Re|1,s[Le+4>>2]=K|3,Le=Le+8|0,_e=At,Le|0}return Le=pi()|0,s[Le>>2]=12,Le=0,_e=At,Le|0}function _(u){u=u|0;var c=0,f=0,g=0,y=0,b=0,P=0,D=0,N=0;if(u){f=u+-8|0,y=s[5861]|0,u=s[u+-4>>2]|0,c=u&-8,N=f+c|0;do if(u&1)D=f,P=f;else{if(g=s[f>>2]|0,!(u&3)||(P=f+(0-g)|0,b=g+c|0,P>>>0<y>>>0))return;if((s[5862]|0)==(P|0)){if(u=N+4|0,c=s[u>>2]|0,(c&3|0)!=3){D=P,c=b;break}s[5859]=b,s[u>>2]=c&-2,s[P+4>>2]=b|1,s[P+b>>2]=b;return}if(f=g>>>3,g>>>0<256)if(u=s[P+8>>2]|0,c=s[P+12>>2]|0,(c|0)==(u|0)){s[5857]=s[5857]&~(1<<f),D=P,c=b;break}else{s[u+12>>2]=c,s[c+8>>2]=u,D=P,c=b;break}y=s[P+24>>2]|0,u=s[P+12>>2]|0;do if((u|0)==(P|0)){if(c=P+16|0,f=c+4|0,u=s[f>>2]|0,u)c=f;else if(u=s[c>>2]|0,!u){u=0;break}for(;;)if(g=u+20|0,f=s[g>>2]|0,f)u=f,c=g;else if(g=u+16|0,f=s[g>>2]|0,f)u=f,c=g;else break;s[c>>2]=0}else D=s[P+8>>2]|0,s[D+12>>2]=u,s[u+8>>2]=D;while(0);if(y){if(c=s[P+28>>2]|0,f=23732+(c<<2)|0,(s[f>>2]|0)==(P|0)){if(s[f>>2]=u,!u){s[5858]=s[5858]&~(1<<c),D=P,c=b;break}}else if(D=y+16|0,s[((s[D>>2]|0)==(P|0)?D:y+20|0)>>2]=u,!u){D=P,c=b;break}s[u+24>>2]=y,c=P+16|0,f=s[c>>2]|0,f|0&&(s[u+16>>2]=f,s[f+24>>2]=u),c=s[c+4>>2]|0,c?(s[u+20>>2]=c,s[c+24>>2]=u,D=P,c=b):(D=P,c=b)}else D=P,c=b}while(0);if(!(P>>>0>=N>>>0)&&(u=N+4|0,g=s[u>>2]|0,!!(g&1))){if(g&2)s[u>>2]=g&-2,s[D+4>>2]=c|1,s[P+c>>2]=c,y=c;else{if((s[5863]|0)==(N|0)){if(N=(s[5860]|0)+c|0,s[5860]=N,s[5863]=D,s[D+4>>2]=N|1,(D|0)!=(s[5862]|0))return;s[5862]=0,s[5859]=0;return}if((s[5862]|0)==(N|0)){N=(s[5859]|0)+c|0,s[5859]=N,s[5862]=P,s[D+4>>2]=N|1,s[P+N>>2]=N;return}y=(g&-8)+c|0,f=g>>>3;do if(g>>>0<256)if(c=s[N+8>>2]|0,u=s[N+12>>2]|0,(u|0)==(c|0)){s[5857]=s[5857]&~(1<<f);break}else{s[c+12>>2]=u,s[u+8>>2]=c;break}else{b=s[N+24>>2]|0,u=s[N+12>>2]|0;do if((u|0)==(N|0)){if(c=N+16|0,f=c+4|0,u=s[f>>2]|0,u)c=f;else if(u=s[c>>2]|0,!u){f=0;break}for(;;)if(g=u+20|0,f=s[g>>2]|0,f)u=f,c=g;else if(g=u+16|0,f=s[g>>2]|0,f)u=f,c=g;else break;s[c>>2]=0,f=u}else f=s[N+8>>2]|0,s[f+12>>2]=u,s[u+8>>2]=f,f=u;while(0);if(b|0){if(u=s[N+28>>2]|0,c=23732+(u<<2)|0,(s[c>>2]|0)==(N|0)){if(s[c>>2]=f,!f){s[5858]=s[5858]&~(1<<u);break}}else if(g=b+16|0,s[((s[g>>2]|0)==(N|0)?g:b+20|0)>>2]=f,!f)break;s[f+24>>2]=b,u=N+16|0,c=s[u>>2]|0,c|0&&(s[f+16>>2]=c,s[c+24>>2]=f),u=s[u+4>>2]|0,u|0&&(s[f+20>>2]=u,s[u+24>>2]=f)}}while(0);if(s[D+4>>2]=y|1,s[P+y>>2]=y,(D|0)==(s[5862]|0)){s[5859]=y;return}}if(u=y>>>3,y>>>0<256){f=23468+(u<<1<<2)|0,c=s[5857]|0,u=1<<u,c&u?(c=f+8|0,u=s[c>>2]|0):(s[5857]=c|u,u=f,c=f+8|0),s[c>>2]=D,s[u+12>>2]=D,s[D+8>>2]=u,s[D+12>>2]=f;return}u=y>>>8,u?y>>>0>16777215?g=31:(P=(u+1048320|0)>>>16&8,N=u<<P,b=(N+520192|0)>>>16&4,N=N<<b,g=(N+245760|0)>>>16&2,g=14-(b|P|g)+(N<<g>>>15)|0,g=y>>>(g+7|0)&1|g<<1):g=0,u=23732+(g<<2)|0,s[D+28>>2]=g,s[D+20>>2]=0,s[D+16>>2]=0,c=s[5858]|0,f=1<<g;e:do if(!(c&f))s[5858]=c|f,s[u>>2]=D,s[D+24>>2]=u,s[D+12>>2]=D,s[D+8>>2]=D;else{u=s[u>>2]|0;t:do if((s[u+4>>2]&-8|0)!=(y|0)){for(g=y<<((g|0)==31?0:25-(g>>>1)|0);f=u+16+(g>>>31<<2)|0,c=s[f>>2]|0,!!c;)if((s[c+4>>2]&-8|0)==(y|0)){u=c;break t}else g=g<<1,u=c;s[f>>2]=D,s[D+24>>2]=u,s[D+12>>2]=D,s[D+8>>2]=D;break e}while(0);P=u+8|0,N=s[P>>2]|0,s[N+12>>2]=D,s[P>>2]=D,s[D+8>>2]=N,s[D+12>>2]=u,s[D+24>>2]=0}while(0);if(N=(s[5865]|0)+-1|0,s[5865]=N,!(N|0)){for(u=23884;u=s[u>>2]|0,u;)u=u+8|0;s[5865]=-1}}}}function v(u,c){u=u|0,c=c|0;var f=0;return u?(f=qn(c,u)|0,(c|u)>>>0>65535&&(f=((f>>>0)/(u>>>0)|0|0)==(c|0)?f:-1)):f=0,u=Pi(f)|0,!u||!(s[u+-4>>2]&3)||w(u|0,0,f|0)|0,u|0}function E(u,c,f,g){return u=u|0,c=c|0,f=f|0,g=g|0,f=u+f>>>0,Ut(c+g+(f>>>0<u>>>0|0)>>>0|0),f|0|0}function L(u,c,f,g){return u=u|0,c=c|0,f=f|0,g=g|0,g=c-g-(f>>>0>u>>>0|0)>>>0,Ut(g|0),u-f>>>0|0|0}function O(u){return u=u|0,(u?31-(Ve(u^u-1)|0)|0:32)|0}function F(u,c,f,g,y){u=u|0,c=c|0,f=f|0,g=g|0,y=y|0;var b=0,P=0,D=0,N=0,G=0,W=0,K=0,de=0,te=0,se=0;if(W=u,N=c,G=N,P=f,de=g,D=de,!G)return b=(y|0)!=0,D?b?(s[y>>2]=u|0,s[y+4>>2]=c&0,de=0,y=0,Ut(de|0),y|0):(de=0,y=0,Ut(de|0),y|0):(b&&(s[y>>2]=(W>>>0)%(P>>>0),s[y+4>>2]=0),de=0,y=(W>>>0)/(P>>>0)>>>0,Ut(de|0),y|0);b=(D|0)==0;do if(P){if(!b){if(b=(Ve(D|0)|0)-(Ve(G|0)|0)|0,b>>>0<=31){K=b+1|0,D=31-b|0,c=b-31>>31,P=K,u=W>>>(K>>>0)&c|G<<D,c=G>>>(K>>>0)&c,b=0,D=W<<D;break}return y?(s[y>>2]=u|0,s[y+4>>2]=N|c&0,de=0,y=0,Ut(de|0),y|0):(de=0,y=0,Ut(de|0),y|0)}if(b=P-1|0,b&P|0){D=(Ve(P|0)|0)+33-(Ve(G|0)|0)|0,se=64-D|0,K=32-D|0,N=K>>31,te=D-32|0,c=te>>31,P=D,u=K-1>>31&G>>>(te>>>0)|(G<<K|W>>>(D>>>0))&c,c=c&G>>>(D>>>0),b=W<<se&N,D=(G<<se|W>>>(te>>>0))&N|W<<K&D-33>>31;break}return y|0&&(s[y>>2]=b&W,s[y+4>>2]=0),(P|0)==1?(te=N|c&0,se=u|0|0,Ut(te|0),se|0):(se=O(P|0)|0,te=G>>>(se>>>0)|0,se=G<<32-se|W>>>(se>>>0)|0,Ut(te|0),se|0)}else{if(b)return y|0&&(s[y>>2]=(G>>>0)%(P>>>0),s[y+4>>2]=0),te=0,se=(G>>>0)/(P>>>0)>>>0,Ut(te|0),se|0;if(!W)return y|0&&(s[y>>2]=0,s[y+4>>2]=(G>>>0)%(D>>>0)),te=0,se=(G>>>0)/(D>>>0)>>>0,Ut(te|0),se|0;if(b=D-1|0,!(b&D))return y|0&&(s[y>>2]=u|0,s[y+4>>2]=b&G|c&0),te=0,se=G>>>((O(D|0)|0)>>>0),Ut(te|0),se|0;if(b=(Ve(D|0)|0)-(Ve(G|0)|0)|0,b>>>0<=30){c=b+1|0,D=31-b|0,P=c,u=G<<D|W>>>(c>>>0),c=G>>>(c>>>0),b=0,D=W<<D;break}return y?(s[y>>2]=u|0,s[y+4>>2]=N|c&0,te=0,se=0,Ut(te|0),se|0):(te=0,se=0,Ut(te|0),se|0)}while(0);if(!P)G=D,N=0,D=0;else{K=f|0|0,W=de|g&0,G=E(K|0,W|0,-1,-1)|0,f=Se()|0,N=D,D=0;do g=N,N=b>>>31|N<<1,b=D|b<<1,g=u<<1|g>>>31|0,de=u>>>31|c<<1|0,L(G|0,f|0,g|0,de|0)|0,se=Se()|0,te=se>>31|((se|0)<0?-1:0)<<1,D=te&1,u=L(g|0,de|0,te&K|0,(((se|0)<0?-1:0)>>31|((se|0)<0?-1:0)<<1)&W|0)|0,c=Se()|0,P=P-1|0;while(P|0);G=N,N=0}return P=0,y|0&&(s[y>>2]=u,s[y+4>>2]=c),te=(b|0)>>>31|(G|P)<<1|(P<<1|b>>>31)&0|N,se=(b<<1|0)&-2|D,Ut(te|0),se|0}function z(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0;return G=c>>31|((c|0)<0?-1:0)<<1,N=((c|0)<0?-1:0)>>31|((c|0)<0?-1:0)<<1,b=g>>31|((g|0)<0?-1:0)<<1,y=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,D=L(G^u|0,N^c|0,G|0,N|0)|0,P=Se()|0,u=b^G,c=y^N,L((F(D,P,L(b^f|0,y^g|0,b|0,y|0)|0,Se()|0,0)|0)^u|0,(Se()|0)^c|0,u|0,c|0)|0}function Q(u,c){u=u|0,c=c|0;var f=0,g=0,y=0,b=0;return b=u&65535,y=c&65535,f=qn(y,b)|0,g=u>>>16,u=(f>>>16)+(qn(y,g)|0)|0,y=c>>>16,c=qn(y,b)|0,Ut((u>>>16)+(qn(y,g)|0)+(((u&65535)+c|0)>>>16)|0),u+c<<16|f&65535|0|0}function Y(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0;return y=u,b=f,f=Q(y,b)|0,u=Se()|0,Ut((qn(c,b)|0)+(qn(g,y)|0)+u|u&0|0),f|0|0|0}function le(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0,P=0,D=0,N=0,G=0;return y=_e,_e=_e+16|0,D=y|0,P=c>>31|((c|0)<0?-1:0)<<1,b=((c|0)<0?-1:0)>>31|((c|0)<0?-1:0)<<1,G=g>>31|((g|0)<0?-1:0)<<1,N=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,u=L(P^u|0,b^c|0,P|0,b|0)|0,c=Se()|0,F(u,c,L(G^f|0,N^g|0,G|0,N|0)|0,Se()|0,D)|0,g=L(s[D>>2]^P|0,s[D+4>>2]^b|0,P|0,b|0)|0,f=Se()|0,_e=y,Ut(f|0),g|0}function pe(u,c,f,g){u=u|0,c=c|0,f=f|0,g=g|0;var y=0,b=0;return b=_e,_e=_e+16|0,y=b|0,F(u,c,f,g,y)|0,_e=b,Ut(s[y+4>>2]|0),s[y>>2]|0|0}function Qe(u,c,f){return u=u|0,c=c|0,f=f|0,(f|0)<32?(Ut(c>>f|0),u>>>f|(c&(1<<f)-1)<<32-f):(Ut(((c|0)<0?-1:0)|0),c>>f-32|0)}function Te(u,c,f){return u=u|0,c=c|0,f=f|0,(f|0)<32?(Ut(c>>>f|0),u>>>f|(c&(1<<f)-1)<<32-f):(Ut(0),c>>>f-32|0)}function ze(u,c,f){return u=u|0,c=c|0,f=f|0,(f|0)<32?(Ut(c<<f|(u&(1<<f)-1<<32-f)>>>32-f|0),u<<f):(Ut(u<<f-32|0),0)}function it(u,c){return u=+u,c=+c,u!=u?+c:c!=c?+u:+an(+u,+c)}function M(u,c){return u=+u,c=+c,u!=u?+c:c!=c?+u:+ur(+u,+c)}function a(u){return u=+u,u>=0?+kt(u+.5):+On(u-.5)}function m(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0;if((f|0)>=8192)return Eo(u|0,c|0,f|0)|0,u|0;if(b=u|0,y=u+f|0,(u&3)==(c&3)){for(;u&3;){if(!f)return b|0;rt[u>>0]=rt[c>>0]|0,u=u+1|0,c=c+1|0,f=f-1|0}for(f=y&-4|0,g=f-64|0;(u|0)<=(g|0);)s[u>>2]=s[c>>2],s[u+4>>2]=s[c+4>>2],s[u+8>>2]=s[c+8>>2],s[u+12>>2]=s[c+12>>2],s[u+16>>2]=s[c+16>>2],s[u+20>>2]=s[c+20>>2],s[u+24>>2]=s[c+24>>2],s[u+28>>2]=s[c+28>>2],s[u+32>>2]=s[c+32>>2],s[u+36>>2]=s[c+36>>2],s[u+40>>2]=s[c+40>>2],s[u+44>>2]=s[c+44>>2],s[u+48>>2]=s[c+48>>2],s[u+52>>2]=s[c+52>>2],s[u+56>>2]=s[c+56>>2],s[u+60>>2]=s[c+60>>2],u=u+64|0,c=c+64|0;for(;(u|0)<(f|0);)s[u>>2]=s[c>>2],u=u+4|0,c=c+4|0}else for(f=y-4|0;(u|0)<(f|0);)rt[u>>0]=rt[c>>0]|0,rt[u+1>>0]=rt[c+1>>0]|0,rt[u+2>>0]=rt[c+2>>0]|0,rt[u+3>>0]=rt[c+3>>0]|0,u=u+4|0,c=c+4|0;for(;(u|0)<(y|0);)rt[u>>0]=rt[c>>0]|0,u=u+1|0,c=c+1|0;return b|0}function w(u,c,f){u=u|0,c=c|0,f=f|0;var g=0,y=0,b=0,P=0;if(b=u+f|0,c=c&255,(f|0)>=67){for(;u&3;)rt[u>>0]=c,u=u+1|0;for(g=b&-4|0,P=c|c<<8|c<<16|c<<24,y=g-64|0;(u|0)<=(y|0);)s[u>>2]=P,s[u+4>>2]=P,s[u+8>>2]=P,s[u+12>>2]=P,s[u+16>>2]=P,s[u+20>>2]=P,s[u+24>>2]=P,s[u+28>>2]=P,s[u+32>>2]=P,s[u+36>>2]=P,s[u+40>>2]=P,s[u+44>>2]=P,s[u+48>>2]=P,s[u+52>>2]=P,s[u+56>>2]=P,s[u+60>>2]=P,u=u+64|0;for(;(u|0)<(g|0);)s[u>>2]=P,u=u+4|0}for(;(u|0)<(b|0);)rt[u>>0]=c,u=u+1|0;return b-f|0}function T(u){return u=+u,u>=0?+kt(u+.5):+On(u-.5)}function I(u){u=u|0;var c=0,f=0,g=0;return g=bi()|0,f=s[mt>>2]|0,c=f+u|0,(u|0)>0&(c|0)<(f|0)|(c|0)<0?(oo(c|0)|0,Ki(12),-1):(c|0)>(g|0)&&!(De(c|0)|0)?(Ki(12),-1):(s[mt>>2]=c,f|0)}return{___divdi3:z,___muldi3:Y,___remdi3:le,___uremdi3:pe,_areNeighborCells:sa,_bitshift64Ashr:Qe,_bitshift64Lshr:Te,_bitshift64Shl:ze,_calloc:v,_cellAreaKm2:Yr,_cellAreaM2:Is,_cellAreaRads2:fa,_cellToBoundary:tr,_cellToCenterChild:mA,_cellToChildPos:Vr,_cellToChildren:Bl,_cellToChildrenSize:Va,_cellToLatLng:Mo,_cellToLocalIj:SA,_cellToParent:Dl,_cellToVertex:gt,_cellToVertexes:Jt,_cellsToDirectedEdge:oa,_cellsToLinkedMultiPolygon:Li,_childPosToCell:Cu,_compactCells:_A,_destroyLinkedMultiPolygon:Bt,_directedEdgeToBoundary:Gs,_directedEdgeToCells:cA,_edgeLengthKm:Ga,_edgeLengthM:bA,_edgeLengthRads:Wt,_emscripten_replace_memory:ao,_free:_,_getBaseCellNumber:Ua,_getDirectedEdgeDestination:Ll,_getDirectedEdgeOrigin:aa,_getHexagonAreaAvgKm2:xA,_getHexagonAreaAvgM2:ds,_getHexagonEdgeLengthAvgKm:wA,_getHexagonEdgeLengthAvgM:wc,_getIcosahedronFaces:Io,_getNumCells:ha,_getPentagons:fs,_getRes0Cells:lA,_getResolution:la,_greatCircleDistanceKm:lo,_greatCircleDistanceM:vA,_greatCircleDistanceRads:Pu,_gridDisk:Ko,_gridDiskDistances:hr,_gridDistance:bc,_gridPathCells:Nl,_gridPathCellsSize:Mu,_gridRingUnsafe:vt,_i64Add:E,_i64Subtract:L,_isPentagon:ui,_isResClassIII:Si,_isValidCell:gA,_isValidDirectedEdge:Hn,_isValidVertex:pa,_latLngToCell:Ps,_llvm_maxnum_f64:it,_llvm_minnum_f64:M,_llvm_round_f64:a,_localIjToCell:Fl,_malloc:Pi,_maxFaceCount:yA,_maxGridDiskSize:XA,_maxPolygonToCellsSize:Zt,_memcpy:m,_memset:w,_originToDirectedEdges:hA,_pentagonCount:ko,_polygonToCells:Ei,_readInt64AsDoubleFromPointer:CA,_res0CellCount:So,_round:T,_sbrk:I,_sizeOfCellBoundary:Vl,_sizeOfCoordIJ:ci,_sizeOfGeoLoop:jl,_sizeOfGeoPolygon:Gl,_sizeOfH3Index:yi,_sizeOfLatLng:Ul,_sizeOfLinkedGeoPolygon:Xr,_uncompactCells:nl,_uncompactCellsSize:Ji,_vertexToLatLng:ol,establishStackSpace:Vs,stackAlloc:cr,stackRestore:Xo,stackSave:Us}}(ki,Xn,Et);e.___divdi3=Je.___divdi3,e.___muldi3=Je.___muldi3,e.___remdi3=Je.___remdi3,e.___uremdi3=Je.___uremdi3,e._areNeighborCells=Je._areNeighborCells,e._bitshift64Ashr=Je._bitshift64Ashr,e._bitshift64Lshr=Je._bitshift64Lshr,e._bitshift64Shl=Je._bitshift64Shl,e._calloc=Je._calloc,e._cellAreaKm2=Je._cellAreaKm2,e._cellAreaM2=Je._cellAreaM2,e._cellAreaRads2=Je._cellAreaRads2,e._cellToBoundary=Je._cellToBoundary,e._cellToCenterChild=Je._cellToCenterChild,e._cellToChildPos=Je._cellToChildPos,e._cellToChildren=Je._cellToChildren,e._cellToChildrenSize=Je._cellToChildrenSize,e._cellToLatLng=Je._cellToLatLng,e._cellToLocalIj=Je._cellToLocalIj,e._cellToParent=Je._cellToParent,e._cellToVertex=Je._cellToVertex,e._cellToVertexes=Je._cellToVertexes,e._cellsToDirectedEdge=Je._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Je._cellsToLinkedMultiPolygon,e._childPosToCell=Je._childPosToCell,e._compactCells=Je._compactCells,e._destroyLinkedMultiPolygon=Je._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Je._directedEdgeToBoundary,e._directedEdgeToCells=Je._directedEdgeToCells,e._edgeLengthKm=Je._edgeLengthKm,e._edgeLengthM=Je._edgeLengthM,e._edgeLengthRads=Je._edgeLengthRads;var os=e._emscripten_replace_memory=Je._emscripten_replace_memory;e._free=Je._free,e._getBaseCellNumber=Je._getBaseCellNumber,e._getDirectedEdgeDestination=Je._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Je._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Je._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Je._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Je._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Je._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Je._getIcosahedronFaces,e._getNumCells=Je._getNumCells,e._getPentagons=Je._getPentagons,e._getRes0Cells=Je._getRes0Cells,e._getResolution=Je._getResolution,e._greatCircleDistanceKm=Je._greatCircleDistanceKm,e._greatCircleDistanceM=Je._greatCircleDistanceM,e._greatCircleDistanceRads=Je._greatCircleDistanceRads,e._gridDisk=Je._gridDisk,e._gridDiskDistances=Je._gridDiskDistances,e._gridDistance=Je._gridDistance,e._gridPathCells=Je._gridPathCells,e._gridPathCellsSize=Je._gridPathCellsSize,e._gridRingUnsafe=Je._gridRingUnsafe,e._i64Add=Je._i64Add,e._i64Subtract=Je._i64Subtract,e._isPentagon=Je._isPentagon,e._isResClassIII=Je._isResClassIII,e._isValidCell=Je._isValidCell,e._isValidDirectedEdge=Je._isValidDirectedEdge,e._isValidVertex=Je._isValidVertex,e._latLngToCell=Je._latLngToCell,e._llvm_maxnum_f64=Je._llvm_maxnum_f64,e._llvm_minnum_f64=Je._llvm_minnum_f64,e._llvm_round_f64=Je._llvm_round_f64,e._localIjToCell=Je._localIjToCell,e._malloc=Je._malloc,e._maxFaceCount=Je._maxFaceCount,e._maxGridDiskSize=Je._maxGridDiskSize,e._maxPolygonToCellsSize=Je._maxPolygonToCellsSize,e._memcpy=Je._memcpy,e._memset=Je._memset,e._originToDirectedEdges=Je._originToDirectedEdges,e._pentagonCount=Je._pentagonCount,e._polygonToCells=Je._polygonToCells,e._readInt64AsDoubleFromPointer=Je._readInt64AsDoubleFromPointer,e._res0CellCount=Je._res0CellCount,e._round=Je._round,e._sbrk=Je._sbrk,e._sizeOfCellBoundary=Je._sizeOfCellBoundary,e._sizeOfCoordIJ=Je._sizeOfCoordIJ,e._sizeOfGeoLoop=Je._sizeOfGeoLoop,e._sizeOfGeoPolygon=Je._sizeOfGeoPolygon,e._sizeOfH3Index=Je._sizeOfH3Index,e._sizeOfLatLng=Je._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Je._sizeOfLinkedGeoPolygon,e._uncompactCells=Je._uncompactCells,e._uncompactCellsSize=Je._uncompactCellsSize,e._vertexToLatLng=Je._vertexToLatLng,e.establishStackSpace=Je.establishStackSpace;var ke=e.stackAlloc=Je.stackAlloc,re=e.stackRestore=Je.stackRestore,fe=e.stackSave=Je.stackSave;if(e.asm=Je,e.cwrap=ce,e.setValue=X,e.getValue=ee,Qn){so(Qn)||(Qn=A(Qn));{Ns();var be=function(oe){oe.byteLength&&(oe=new Uint8Array(oe)),Mt.set(oe,$),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,ro()},Oe=function(){d(Qn,be,function(){throw"could not load memory initializer "+Qn})},je=Or(Qn);if(je)be(je.buffer);else if(e.memoryInitializerRequest){var Xe=function(){var oe=e.memoryInitializerRequest,ve=oe.response;if(oe.status!==200&&oe.status!==0){var Pe=Or(e.memoryInitializerRequestURL);if(Pe)ve=Pe.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+oe.status+", retrying "+Qn),Oe();return}}be(ve)};e.memoryInitializerRequest.response?setTimeout(Xe,0):e.memoryInitializerRequest.addEventListener("load",Xe)}else Oe()}}var $e;ji=function oe(){$e||We(),$e||(ji=oe)};function We(oe){if(gn>0||(ti(),gn>0))return;function ve(){$e||($e=!0,!ue&&(kr(),Yn(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),si()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),ve()},1)):ve()}e.run=We;function Ye(oe){throw e.onAbort&&e.onAbort(oe),oe+="",l(oe),S(oe),ue=!0,"abort("+oe+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Ye,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return We(),t}(typeof No=="object"?No:{}),Fn="number",Sn=Fn,Cf=Fn,In=Fn,kn=Fn,Ks=Fn,An=Fn,rJ=[["sizeOfH3Index",Fn],["sizeOfLatLng",Fn],["sizeOfCellBoundary",Fn],["sizeOfGeoLoop",Fn],["sizeOfGeoPolygon",Fn],["sizeOfLinkedGeoPolygon",Fn],["sizeOfCoordIJ",Fn],["readInt64AsDoubleFromPointer",Fn],["isValidCell",Cf,[In,kn]],["latLngToCell",Sn,[Fn,Fn,Ks,An]],["cellToLatLng",Sn,[In,kn,An]],["cellToBoundary",Sn,[In,kn,An]],["maxGridDiskSize",Sn,[Fn,An]],["gridDisk",Sn,[In,kn,Fn,An]],["gridDiskDistances",Sn,[In,kn,Fn,An,An]],["gridRingUnsafe",Sn,[In,kn,Fn,An]],["maxPolygonToCellsSize",Sn,[An,Ks,Fn,An]],["polygonToCells",Sn,[An,Ks,Fn,An]],["cellsToLinkedMultiPolygon",Sn,[An,Fn,An]],["destroyLinkedMultiPolygon",null,[An]],["compactCells",Sn,[An,An,Fn,Fn]],["uncompactCells",Sn,[An,Fn,Fn,An,Fn,Ks]],["uncompactCellsSize",Sn,[An,Fn,Fn,Ks,An]],["isPentagon",Cf,[In,kn]],["isResClassIII",Cf,[In,kn]],["getBaseCellNumber",Fn,[In,kn]],["getResolution",Fn,[In,kn]],["maxFaceCount",Sn,[In,kn,An]],["getIcosahedronFaces",Sn,[In,kn,An]],["cellToParent",Sn,[In,kn,Ks,An]],["cellToChildren",Sn,[In,kn,Ks,An]],["cellToCenterChild",Sn,[In,kn,Ks,An]],["cellToChildrenSize",Sn,[In,kn,Ks,An]],["cellToChildPos",Sn,[In,kn,Ks,An]],["childPosToCell",Sn,[Fn,Fn,In,kn,Ks,An]],["areNeighborCells",Sn,[In,kn,In,kn,An]],["cellsToDirectedEdge",Sn,[In,kn,In,kn,An]],["getDirectedEdgeOrigin",Sn,[In,kn,An]],["getDirectedEdgeDestination",Sn,[In,kn,An]],["isValidDirectedEdge",Cf,[In,kn]],["directedEdgeToCells",Sn,[In,kn,An]],["originToDirectedEdges",Sn,[In,kn,An]],["directedEdgeToBoundary",Sn,[In,kn,An]],["gridDistance",Sn,[In,kn,In,kn,An]],["gridPathCells",Sn,[In,kn,In,kn,An]],["gridPathCellsSize",Sn,[In,kn,In,kn,An]],["cellToLocalIj",Sn,[In,kn,In,kn,Fn,An]],["localIjToCell",Sn,[In,kn,An,Fn,An]],["getHexagonAreaAvgM2",Sn,[Ks,An]],["getHexagonAreaAvgKm2",Sn,[Ks,An]],["getHexagonEdgeLengthAvgM",Sn,[Ks,An]],["getHexagonEdgeLengthAvgKm",Sn,[Ks,An]],["greatCircleDistanceM",Fn,[An,An]],["greatCircleDistanceKm",Fn,[An,An]],["greatCircleDistanceRads",Fn,[An,An]],["cellAreaM2",Sn,[In,kn,An]],["cellAreaKm2",Sn,[In,kn,An]],["cellAreaRads2",Sn,[In,kn,An]],["edgeLengthM",Sn,[In,kn,An]],["edgeLengthKm",Sn,[In,kn,An]],["edgeLengthRads",Sn,[In,kn,An]],["getNumCells",Sn,[Ks,An]],["getRes0Cells",Sn,[An]],["res0CellCount",Fn],["getPentagons",Sn,[Fn,An]],["pentagonCount",Fn],["cellToVertex",Sn,[In,kn,Fn,An]],["cellToVertexes",Sn,[In,kn,An]],["vertexToLatLng",Sn,[In,kn,An]],["isValidVertex",Cf,[In,kn]]],sJ=0,oJ=1,aJ=2,AJ=3,lJ=4,uJ=5,cJ=6,hJ=7,fJ=8,dJ=9,pJ=10,gJ=11,mJ=12,_J=13,yJ=14,vJ=15,Fs={};Fs[sJ]="Success";Fs[oJ]="The operation failed but a more specific error is not available";Fs[aJ]="Argument was outside of acceptable range";Fs[AJ]="Latitude or longitude arguments were outside of acceptable range";Fs[lJ]="Resolution argument was outside of acceptable range";Fs[uJ]="Cell argument was not valid";Fs[cJ]="Directed edge argument was not valid";Fs[hJ]="Undirected edge argument was not valid";Fs[fJ]="Vertex argument was not valid";Fs[dJ]="Pentagon distortion was encountered";Fs[pJ]="Duplicate input";Fs[gJ]="Cell arguments were not neighbors";Fs[mJ]="Cell arguments had incompatible resolutions";Fs[_J]="Memory allocation failed";Fs[yJ]="Bounds of provided memory were insufficient";Fs[vJ]="Mode or flags argument was not valid";var xJ=1e3,wJ=1001,Z5=1002,P_={};P_[xJ]="Unknown unit";P_[wJ]="Array length out of bounds";P_[Z5]="Got unexpected null value for H3 index";var bJ="Unknown error";function q5(t,e,n){var i=n&&"value"in n,r=new Error((t[e]||bJ)+" (code: "+e+(i?", value: "+n.value:"")+")");return r.code=e,r}function EJ(t,e){var n=arguments.length===2?{value:e}:{};return q5(Fs,t,n)}function TJ(t,e){var n=arguments.length===2?{value:e}:{};return q5(P_,t,n)}function Y5(t){if(t!==0)throw EJ(t)}var Pl={};rJ.forEach(function(e){Pl[e[0]]=No.cwrap.apply(No,e)});var n0=16,SJ=4,X5=8,Iv=Pl.sizeOfH3Index(),K5=Pl.sizeOfLatLng();Pl.sizeOfCellBoundary();Pl.sizeOfGeoPolygon();Pl.sizeOfGeoLoop();Pl.sizeOfLinkedGeoPolygon();Pl.sizeOfCoordIJ();function CJ(t){if(!t)throw TJ(Z5);return t}var PJ=/[^0-9a-fA-F]/;function MJ(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||PJ.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),n0),n=parseInt(t.substring(t.length-8),n0);return[n,e]}function $4(t){if(t>=0)return t.toString(n0);t=t&2147483647;var e=J5(8,t.toString(n0)),n=(parseInt(e[0],n0)+8).toString(n0);return e=n+e.substring(1),e}function IJ(t,e){return $4(e)+J5(8,$4(t))}function J5(t,e){for(var n=t-e.length,i="",r=0;r<n;r++)i+="0";return i=i+e,i}function kJ(t,e){e===void 0&&(e=0);var n=No.getValue(t+Iv*e,"i32"),i=No.getValue(t+Iv*e+SJ,"i32");return i?IJ(n,i):null}function Z4(t){return OJ(No.getValue(t,"double"))}function LJ(t){return[Z4(t),Z4(t+X5)]}function DJ(t,e,n){var i=No._malloc(K5);No.HEAPF64.set([t,e].map(RJ),i/X5);var r=No._malloc(Iv);try{return Y5(Pl.latLngToCell(i,n,r)),CJ(kJ(r))}finally{No._free(r),No._free(i)}}function BJ(t){var e=No._malloc(K5),n=MJ(t),i=n[0],r=n[1];try{return Y5(Pl.cellToLatLng(i,r,e)),LJ(e)}finally{No._free(e)}}function RJ(t){return t*Math.PI/180}function OJ(t){return t*180/Math.PI}const Rh={SUM:1,MEAN:2,MIN:3,MAX:4};function eL(t,e){return t+e}function zJ(t,e){return e>t?e:t}function FJ(t,e){return e<t?e:t}function NJ(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(eL,0)/n.length:null}function UJ(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(eL,0):null}function VJ(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(zJ,-1/0):null}function jJ(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(FJ,1/0):null}function GJ(t,e,n){const i=Rh[t]||Rh.SUM;switch(e=QJ(e,n),i){case Rh.MIN:return r=>jJ(r,e);case Rh.SUM:return r=>UJ(r,e);case Rh.MEAN:return r=>NJ(r,e);case Rh.MAX:return r=>VJ(r,e);default:return null}}function QJ(t,e={}){return Number.isFinite(t)?t:n=>(e.index=n.index,t(n.source,e))}function HJ(t,e={}){return n=>(e.indices=n.map(i=>i.index),t(n.map(i=>i.source),e))}const WJ=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function $J(t,e){const n={};for(const i in t)e.includes(i)||(n[i]=t[i]);return n}class tL extends N0{constructor(...e){super(...e),ae(this,"state",void 0)}initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:$J(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){const i=this.getShaders({});i&&i.defines&&(i.defines.NON_INSTANCED_MODEL=1),this.updateShaders(i)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:e,mousePosition:n,gl:i}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,pickingActive:0,devicePixelRatio:Zc(i)})}updateShaders(e){}isAggregationDirty(e,n={}){const{props:i,oldProps:r,changeFlags:A}=e,{compareAll:d=!1,dimension:l}=n,{ignoreProps:S}=this.state,{props:k,accessors:U=[]}=l,{updateTriggersChanged:V}=A;if(A.dataChanged)return!0;if(V){if(V.all)return!0;for(const $ of U)if(V[$])return!0}if(d)return A.extensionsChanged?!0:bw({oldProps:r,newProps:i,ignoreProps:S,propTypes:this.constructor._propTypes});for(const $ of k)if(i[$]!==r[$])return!0;return!1}isAttributeChanged(e){const{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!ZJ(n)}_getAttributeManager(){return new m5(this.context.gl,{id:this.props.id,stats:this.context.stats})}}ae(tL,"layerName","AggregationLayer");function ZJ(t){let e=!0;for(const n in t){e=!1;break}return e}function M_(t,e,n){const i=n;return i.domain=()=>t,i.range=()=>e,i}function q4(t,e){return M_(t,e,i=>nee(t,e,i))}function qJ(t,e){return M_(t,e,i=>iee(t,e,i))}function YJ(t,e){const n=t.sort(nL);let i=0;const r=Math.max(1,e.length),A=new Array(r-1);for(;++i<r;)A[i-1]=XJ(n,i/r);const d=l=>JJ(A,e,l);return d.thresholds=()=>A,M_(t,e,d)}function nL(t,e){return t-e}function XJ(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const i=(n-1)*e,r=Math.floor(i),A=t[r],d=t[r+1];return A+(d-A)*(i-r)}function KJ(t,e){let n=0,i=t.length;for(;n<i;){const r=n+i>>>1;nL(t[r],e)>0?i=r:n=r+1}return n}function JJ(t,e,n){return e[KJ(t,n)]}function eee(t,e,n,i){const r="".concat(i);let A=e.get(r);return A===void 0&&(A=t.push(i),e.set(r,A)),n[(A-1)%n.length]}function tee(t,e){const n=new Map,i=[];for(const A of t){const d="".concat(A);n.has(d)||n.set(d,i.push(A))}return M_(t,e,A=>eee(i,n,e,A))}function nee(t,e,n){const i=t[1]-t[0];if(i<=0)return Nn.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const r=i/e.length,A=Math.floor((n-t[0])/r),d=Math.max(Math.min(A,e.length-1),0);return e[d]}function iee(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}function iL(t){return t!=null}function ree(t){const e=[];return t.forEach(n=>{!e.includes(n)&&iL(n)&&e.push(n)}),e}function rL(t,e){return(typeof e=="function"?t.map(e):t).filter(iL)}function see(t,e){return rL(t,e)}function oee(t,e){return ree(rL(t,e))}function aee(t,e,n){return Math.max(e,Math.min(n,t))}function Aee(t){switch(t){case"quantize":return q4;case"linear":return qJ;case"quantile":return YJ;case"ordinal":return tee;default:return q4}}const sL=t=>t.length,lee=3402823466e29,oL=t=>t.points,aL=t=>t.index,Y4=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,uee={getValue:sL,getPoints:oL,getIndex:aL,filterData:null};class cee{constructor(e=[],n=uee){ae(this,"maxCount",void 0),ae(this,"maxValue",void 0),ae(this,"minValue",void 0),ae(this,"totalCount",void 0),ae(this,"aggregatedBins",void 0),ae(this,"sortedBins",void 0),ae(this,"binMap",void 0),this.aggregatedBins=this.getAggregatedBins(e,n),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(e,n){const{getValue:i=sL,getPoints:r=oL,getIndex:A=aL,filterData:d}=n,l=typeof d=="function",S=e.length,k=[];let U=0;for(let V=0;V<S;V++){const $=e[V],X=r($),ee=A($),ue=l?X.filter(d):X;$.filteredPoints=l?ue:null;const we=ue.length?i(ue):null;we!=null&&(k[U]={i:Number.isFinite(ee)?ee:V,value:we,counts:ue.length},U++)}return k}_percentileToIndex(e){const n=this.sortedBins.length;if(n<2)return[0,0];const[i,r]=e.map(l=>aee(l,0,100)),A=Math.ceil(i/100*(n-1)),d=Math.floor(r/100*(n-1));return[A,d]}getBinMap(){const e={};for(const n of this.aggregatedBins)e[n.i]=n;return e}_updateMinMaxValues(){let e=0,n=0,i=lee,r=0;for(const A of this.aggregatedBins)e=e>A.counts?e:A.counts,n=n>A.value?n:A.value,i=i<A.value?i:A.value,r+=A.counts;this.maxCount=e,this.maxValue=n,this.minValue=i,this.totalCount=r}getValueRange(e){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((r,A)=>Y4(r.value,A.value))),!this.sortedBins.length)return[];let n=0,i=this.sortedBins.length-1;if(Array.isArray(e)){const r=this._percentileToIndex(e);n=r[0],i=r[1]}return[this.sortedBins[n].value,this.sortedBins[i].value]}getValueDomainByScale(e,[n=0,i=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((A,d)=>Y4(A.value,d.value))),!this.sortedBins.length)return[];const r=this._percentileToIndex([n,i]);return this._getScaleDomain(e,r)}_getScaleDomain(e,[n,i]){const r=this.sortedBins;switch(e){case"quantize":case"linear":return[r[n].value,r[i].value];case"quantile":return see(r.slice(n,i+1),A=>A.value);case"ordinal":return oee(r,A=>A.value);default:return[r[n].value,r[i].value]}}}function X4(){}const K4=["getBins","getDomain","getScaleFunc"],J4=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],hee=t=>t.cellSize;class fee{constructor(e){this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=e.getCellSize||hee,this._getAggregator=e.getAggregator,this._addDimension(e.dimensions||J4)}static defaultDimensions(){return J4}updateState(e,n){const{oldProps:i,props:r,changeFlags:A}=e;this.updateGetValueFuncs(i,r,A);const d=this.needsReProjectPoints(i,r,A);let l=!1;return A.dataChanged||d?(this.getAggregatedData(r,n),l=!0):((this.getDimensionChanges(i,r,A)||[]).forEach(k=>typeof k=="function"&&k()),l=!0),this.setState({aggregationDirty:l}),this.state}setState(e){this.state={...this.state,...e}}setDimensionState(e,n){this.setState({dimensions:{...this.state.dimensions,[e]:{...this.state.dimensions[e],...n}}})}normalizeResult(e={}){return e.hexagons?{data:e.hexagons,...e}:e.layerData?{data:e.layerData,...e}:e}getAggregatedData(e,n){const r=this._getAggregator(e)(e,n);this.setState({layerData:this.normalizeResult(r)}),this.changeFlags={layerData:!0},this.getSortedBins(e)}updateGetValueFuncs(e,n,i){for(const r in this.dimensionUpdaters){const{value:A,weight:d,aggregation:l}=this.dimensionUpdaters[r].getBins.triggers;let S=n[A.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[r].getBins,e,n,i)&&(S?S=HJ(S,{data:n.data}):S=GJ(n[l.prop],n[d.prop],{data:n.data})),S&&this.setDimensionState(r,{getValue:S})}}needsReProjectPoints(e,n,i){return this._getCellSize(e)!==this._getCellSize(n)||this._getAggregator(e)!==this._getAggregator(n)||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPosition)}addDimension(e){this._addDimension(e)}_addDimension(e=[]){e.forEach(n=>{const{key:i}=n;this.dimensionUpdaters[i]=this.getDimensionUpdaters(n),this.state.dimensions[i]={getValue:null,domain:null,sortedBins:null,scaleFunc:X4}})}getDimensionUpdaters({key:e,accessor:n,pickingInfo:i,getBins:r,getDomain:A,getScaleFunc:d,nullValue:l}){return{key:e,accessor:n,pickingInfo:i,getBins:{updater:this.getDimensionSortedBins,...r},getDomain:{updater:this.getDimensionValueDomain,...A},getScaleFunc:{updater:this.getDimensionScale,...d},attributeAccessor:this.getSubLayerDimensionAttribute(e,l)}}needUpdateDimensionStep(e,n,i,r){return Object.values(e.triggers).some(A=>A.updateTrigger?r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged[A.updateTrigger]):n[A.prop]!==i[A.prop])}getDimensionChanges(e,n,i){const r=[];for(const A in this.dimensionUpdaters){const d=K4.find(l=>this.needUpdateDimensionStep(this.dimensionUpdaters[A][l],e,n,i));d&&r.push(this.dimensionUpdaters[A][d].updater.bind(this,n,this.dimensionUpdaters[A]))}return r.length?r:null}getUpdateTriggers(e){const n=e.updateTriggers||{},i={};for(const r in this.dimensionUpdaters){const{accessor:A}=this.dimensionUpdaters[r];i[A]={},K4.forEach(d=>{Object.values(this.dimensionUpdaters[r][d].triggers).forEach(({prop:l,updateTrigger:S})=>{if(S){const k=n[S];typeof k=="object"&&!Array.isArray(k)?Object.assign(i[A],k):k!==void 0&&(i[A][l]=k)}else i[A][l]=e[l]})})}return i}getSortedBins(e){for(const n in this.dimensionUpdaters)this.getDimensionSortedBins(e,this.dimensionUpdaters[n])}getDimensionSortedBins(e,n){const{key:i}=n,{getValue:r}=this.state.dimensions[i],A=new cee(this.state.layerData.data||[],{getValue:r,filterData:e._filterData});this.setDimensionState(i,{sortedBins:A}),this.getDimensionValueDomain(e,n)}getDimensionValueDomain(e,n){const{getDomain:i,key:r}=n,{triggers:{lowerPercentile:A,upperPercentile:d,scaleType:l}}=i,S=this.state.dimensions[r].sortedBins.getValueDomainByScale(e[l.prop],[e[A.prop],e[d.prop]]);this.setDimensionState(r,{valueDomain:S}),this.getDimensionScale(e,n)}getDimensionScale(e,n){const{key:i,getScaleFunc:r,getDomain:A}=n,{domain:d,range:l}=r.triggers,{scaleType:S}=A.triggers,{onSet:k}=r,U=e[l.prop],V=e[d.prop]||this.state.dimensions[i].valueDomain,X=Aee(S&&e[S.prop])(V,U);typeof k=="object"&&typeof e[k.props]=="function"&&e[k.props](X.domain()),this.setDimensionState(i,{scaleFunc:X})}getSubLayerDimensionAttribute(e,n){return i=>{const{sortedBins:r,scaleFunc:A}=this.state.dimensions[e],d=r.binMap[i.index];if(d&&d.counts===0)return n;const l=d&&d.value,S=A.domain();return l>=S[0]&&l<=S[S.length-1]?A(l):n}}getSubLayerAccessors(e){const n={};for(const i in this.dimensionUpdaters){const{accessor:r}=this.dimensionUpdaters[i];n[r]=this.getSubLayerDimensionAttribute(e,i)}return n}getPickingInfo({info:e}){const n=e.picked&&e.index>-1;let i=null;if(n){const r=this.state.layerData.data[e.index],A={};for(const d in this.dimensionUpdaters){const{pickingInfo:l}=this.dimensionUpdaters[d],{sortedBins:S}=this.state.dimensions[d],k=S.binMap[r.index]&&S.binMap[r.index].value;A[l]=k}i=Object.assign(A,r,{points:r.filteredPoints||r.points})}return e.picked=!!i,e.object=i,e}getAccessor(e){return this.dimensionUpdaters.hasOwnProperty(e)?this.dimensionUpdaters[e].attributeAccessor:X4}}var zh=Math.PI/3,dee=[0,zh,2*zh,3*zh,4*zh,5*zh];function pee(t){return t[0]}function gee(t){return t[1]}function mee(){var t=0,e=0,n=1,i=1,r=pee,A=gee,d,l,S;function k(V){var $={},X=[],ee,ue=V.length;for(ee=0;ee<ue;++ee)if(!(isNaN(ie=+r.call(null,we=V[ee],ee,V))||isNaN(Ae=+A.call(null,we,ee,V)))){var we,ie,Ae,ce=Math.round(Ae=Ae/S),Ce=Math.round(ie=ie/l-(ce&1)/2),Ne=Ae-ce;if(Math.abs(Ne)*3>1){var qe=ie-Ce,tt=Ce+(ie<Ce?-1:1)/2,lt=ce+(Ae<ce?-1:1),at=ie-tt,ht=Ae-lt;qe*qe+Ne*Ne>at*at+ht*ht&&(Ce=tt+(ce&1?1:-1)/2,ce=lt)}var Et=Ce+"-"+ce,St=$[Et];St?St.push(we):(X.push(St=$[Et]=[we]),St.x=(Ce+(ce&1)/2)*l,St.y=ce*S)}return X}function U(V){var $=0,X=0;return dee.map(function(ee){var ue=Math.sin(ee)*V,we=-Math.cos(ee)*V,ie=ue-$,Ae=we-X;return $=ue,X=we,[ie,Ae]})}return k.hexagon=function(V){return"m"+U(V==null?d:+V).join("l")+"z"},k.centers=function(){for(var V=[],$=Math.round(e/S),X=Math.round(t/l),ee=$*S;ee<i+d;ee+=S,++$)for(var ue=X*l+($&1)*l/2;ue<n+l/2;ue+=l)V.push([ue,ee]);return V},k.mesh=function(){var V=U(d).slice(0,4).join("l");return k.centers().map(function($){return"M"+$+"m"+V}).join("")},k.x=function(V){return arguments.length?(r=V,k):r},k.y=function(V){return arguments.length?(A=V,k):A},k.radius=function(V){return arguments.length?(d=+V,l=d*2*Math.sin(zh),S=d*1.5,k):d},k.size=function(V){return arguments.length?(t=e=0,n=+V[0],i=+V[1],k):[n-t,i-e]},k.extent=function(V){return arguments.length?(t=+V[0][0],e=+V[0][1],n=+V[1][0],i=+V[1][1],k):[[t,e],[n,i]]},k.radius(1)}function _ee(t,e){const{data:n,radius:i}=t,{viewport:r,attributes:A}=e,d=n.length?yee(n,e):null,l=vee(i,r,d),S=[],{iterable:k,objectInfo:U}=_c(n),V=A.positions.value,{size:$}=A.positions.getAccessor();for(const ue of k){U.index++;const we=U.index*$,ie=[V[we],V[we+1]];Number.isFinite(ie[0])&&Number.isFinite(ie[1])?S.push({screenCoord:r.projectFlat(ie),source:ue,index:U.index}):Nn.warn("HexagonLayer: invalid position")()}return{hexagons:mee().radius(l).x(ue=>ue.screenCoord[0]).y(ue=>ue.screenCoord[1])(S).map((ue,we)=>({position:r.unprojectFlat([ue.x,ue.y]),points:ue,index:we})),radiusCommon:l}}function yee(t,e){const{attributes:n}=e,i=n.positions.value,{size:r}=n.positions.getAccessor();let A=1/0,d=1/0,l=-1/0,S=-1/0,k;for(k=0;k<r*t.length;k+=r){const U=i[k],V=i[k+1];Number.isFinite(U)&&Number.isFinite(V)&&(A=Math.min(U,A),l=Math.max(U,l),d=Math.min(V,d),S=Math.max(V,S))}return[A,d,l,S].every(Number.isFinite)?[(A+l)/2,(d+S)/2]:null}function vee(t,e,n){const{unitsPerMeter:i}=e.getDistanceScales(n);return t*i[0]}function eC(){}const xee={colorDomain:null,colorRange:WJ,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:eC,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:eC,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:_ee,getPosition:{type:"accessor",value:t=>t.position},material:!0,_filterData:{type:"function",value:null,optional:!0}};class Vm extends tL{constructor(...e){super(...e),ae(this,"state",void 0)}initializeState(){const e=new fee({getAggregator:i=>i.hexagonAggregator,getCellSize:i=>i.radius});this.state={cpuAggregator:e,aggregatorState:e.state,vertices:null},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}updateState(e){if(super.updateState(e),e.changeFlags.propsOrDataChanged){const n=this.state.cpuAggregator.updateState(e,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==n.layerData){const{hexagonVertices:i}=n.layerData||{};this.setState({vertices:i&&this.convertLatLngToMeterOffset(i)})}this.setState({aggregatorState:n})}}convertLatLngToMeterOffset(e){const{viewport:n}=this.context;if(Array.isArray(e)&&e.length===6){const i=e[0],r=e[3],A=[(i[0]+r[0])/2,(i[1]+r[1])/2],d=n.projectFlat(A),{metersPerUnit:l}=n.getDistanceScales(A);return e.map(k=>{const U=n.projectFlat(k);return[(U[0]-d[0])*l[0],(U[1]-d[1])*l[1]]})}return Nn.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:e}){return this.state.cpuAggregator.getPickingInfo({info:e})}_onGetSublayerColor(e){return this.state.cpuAggregator.getAccessor("fillColor")(e)}_onGetSublayerElevation(e){return this.state.cpuAggregator.getAccessor("elevation")(e)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:e,extruded:n,coverage:i,material:r,transitions:A}=this.props,{aggregatorState:d,vertices:l}=this.state,S=this.getSubLayerClass("hexagon-cell",x_),k=this._getSublayerUpdateTriggers(),U=l?{vertices:l,radius:1}:{radius:d.layerData.radiusCommon||1,radiusUnits:"common",angle:90};return new S({...U,diskResolution:6,elevationScale:e,extruded:n,coverage:i,material:r,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:A&&{getFillColor:A.getColorValue||A.getColorWeight,getElevation:A.getElevationValue||A.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:k}),{data:d.layerData.data})}}ae(Vm,"layerName","HexagonLayer");ae(Vm,"defaultProps",xee);function Ow(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function AL(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function np(){}var Pd=.7,jm=1/Pd,h0="\\s*([+-]?\\d+)\\s*",Md="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wee=/^#([0-9a-f]{3,8})$/,bee=new RegExp(`^rgb\\(${h0},${h0},${h0}\\)$`),Eee=new RegExp(`^rgb\\(${Tl},${Tl},${Tl}\\)$`),Tee=new RegExp(`^rgba\\(${h0},${h0},${h0},${Md}\\)$`),See=new RegExp(`^rgba\\(${Tl},${Tl},${Tl},${Md}\\)$`),Cee=new RegExp(`^hsl\\(${Md},${Tl},${Tl}\\)$`),Pee=new RegExp(`^hsla\\(${Md},${Tl},${Tl},${Md}\\)$`),tC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ow(np,zw,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:nC,formatHex:nC,formatHex8:Mee,formatHsl:Iee,formatRgb:iC,toString:iC});function nC(){return this.rgb().formatHex()}function Mee(){return this.rgb().formatHex8()}function Iee(){return lL(this).formatHsl()}function iC(){return this.rgb().formatRgb()}function zw(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=wee.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?rC(e):n===3?new Vo(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?fg(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?fg(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=bee.exec(t))?new Vo(e[1],e[2],e[3],1):(e=Eee.exec(t))?new Vo(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Tee.exec(t))?fg(e[1],e[2],e[3],e[4]):(e=See.exec(t))?fg(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Cee.exec(t))?aC(e[1],e[2]/100,e[3]/100,1):(e=Pee.exec(t))?aC(e[1],e[2]/100,e[3]/100,e[4]):tC.hasOwnProperty(t)?rC(tC[t]):t==="transparent"?new Vo(NaN,NaN,NaN,0):null}function rC(t){return new Vo(t>>16&255,t>>8&255,t&255,1)}function fg(t,e,n,i){return i<=0&&(t=e=n=NaN),new Vo(t,e,n,i)}function kee(t){return t instanceof np||(t=zw(t)),t?(t=t.rgb(),new Vo(t.r,t.g,t.b,t.opacity)):new Vo}function Id(t,e,n,i){return arguments.length===1?kee(t):new Vo(t,e,n,i??1)}function Vo(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}Ow(Vo,Id,AL(np,{brighter(t){return t=t==null?jm:Math.pow(jm,t),new Vo(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Pd:Math.pow(Pd,t),new Vo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Vo(jc(this.r),jc(this.g),jc(this.b),Gm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sC,formatHex:sC,formatHex8:Lee,formatRgb:oC,toString:oC}));function sC(){return`#${Fc(this.r)}${Fc(this.g)}${Fc(this.b)}`}function Lee(){return`#${Fc(this.r)}${Fc(this.g)}${Fc(this.b)}${Fc((isNaN(this.opacity)?1:this.opacity)*255)}`}function oC(){const t=Gm(this.opacity);return`${t===1?"rgb(":"rgba("}${jc(this.r)}, ${jc(this.g)}, ${jc(this.b)}${t===1?")":`, ${t})`}`}function Gm(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function jc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Fc(t){return t=jc(t),(t<16?"0":"")+t.toString(16)}function aC(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new VA(t,e,n,i)}function lL(t){if(t instanceof VA)return new VA(t.h,t.s,t.l,t.opacity);if(t instanceof np||(t=zw(t)),!t)return new VA;if(t instanceof VA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),A=Math.max(e,n,i),d=NaN,l=A-r,S=(A+r)/2;return l?(e===A?d=(n-i)/l+(n<i)*6:n===A?d=(i-e)/l+2:d=(e-n)/l+4,l/=S<.5?A+r:2-A-r,d*=60):l=S>0&&S<1?0:d,new VA(d,l,S,t.opacity)}function Dee(t,e,n,i){return arguments.length===1?lL(t):new VA(t,e,n,i??1)}function VA(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Ow(VA,Dee,AL(np,{brighter(t){return t=t==null?jm:Math.pow(jm,t),new VA(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Pd:Math.pow(Pd,t),new VA(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Vo(jy(t>=240?t-240:t+120,r,i),jy(t,r,i),jy(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new VA(AC(this.h),dg(this.s),dg(this.l),Gm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Gm(this.opacity);return`${t===1?"hsl(":"hsla("}${AC(this.h)}, ${dg(this.s)*100}%, ${dg(this.l)*100}%${t===1?")":`, ${t})`}`}}));function AC(t){return t=(t||0)%360,t<0?t+360:t}function dg(t){return Math.max(0,Math.min(1,t||0))}function jy(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Bee(t,e,n,i,r){var A=t*t,d=A*t;return((1-3*t+3*A-d)*e+(4-6*A+3*d)*n+(1+3*t+3*A-3*d)*i+d*r)/6}function Ree(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],A=t[i+1],d=i>0?t[i-1]:2*r-A,l=i<e-1?t[i+2]:2*A-r;return Bee((n-i/e)*e,d,r,A,l)}}const uL=t=>()=>t;function Oee(t,e){return function(n){return t+n*e}}function zee(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Fee(t){return(t=+t)==1?cL:function(e,n){return n-e?zee(e,n,t):uL(isNaN(e)?n:e)}}function cL(t,e){var n=e-t;return n?Oee(t,n):uL(isNaN(t)?e:t)}(function t(e){var n=Fee(e);function i(r,A){var d=n((r=Id(r)).r,(A=Id(A)).r),l=n(r.g,A.g),S=n(r.b,A.b),k=cL(r.opacity,A.opacity);return function(U){return r.r=d(U),r.g=l(U),r.b=S(U),r.opacity=k(U),r+""}}return i.gamma=t,i})(1);function Nee(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),A=new Array(n),d,l;for(d=0;d<n;++d)l=Id(e[d]),i[d]=l.r||0,r[d]=l.g||0,A[d]=l.b||0;return i=t(i),r=t(r),A=t(A),l.opacity=1,function(S){return l.r=i(S),l.g=r(S),l.b=A(S),l+""}}}var Uee=Nee(Ree);function Vee(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const jee=t=>Uee(t[t.length-1]);var Gee=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Vee);const Qee=jee(Gee);function Rf(t,e,n){this.k=t,this.x=e,this.y=n}Rf.prototype={constructor:Rf,scale:function(t){return t===1?this:new Rf(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Rf(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Rf.prototype;const Hee=1e3;for(let t=0;t<Hee;t++)DJ(Math.random()*90,Math.random()*180,7);const Wee={longitude:139,latitude:35,zoom:11},$ee=63e5,Zee=new fw({color:[255,255,255],intensity:.9}),hL=new j$({color:[255,255,255],intensity:1.1,timestamp:0});new __({ambientLight:Zee,sunLight:hL});function qee(t){let e=t.data;console.log(t);let n=Object.values(e),i={};n.forEach(k=>{Object.entries(k).forEach(U=>{let V=U[0];i[V]=(i[V]||0)+U[1]})}),e&&(hL.timestamp=Date.now());const r=Tt.useMemo(()=>[new Rw({id:"earth-sphere",data:[0],mesh:new aW({radius:$ee,nlat:18,nlong:36}),coordinateSystem:$n.CARTESIAN,getPosition:[0,0,0],getColor:[255,255,255]}),new Dw({id:"earth-land",data:"https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_50m_land.geojson",stroked:!1,filled:!0,opacity:.1,getFillColor:[30,80,120]})],[]);let A=Object.entries(i);console.log(A);let d=[...Array(1e6).keys()].map((k,U)=>[Math.random()*180,Math.random()*90]);d=[...Array(A.length).keys()].map((k,U)=>{let[V,$]=BJ(A[U][0]),X=A[U][1];return[V,$,X]}),console.log(d);const l=new Vm({id:"hexagon_layer",getFillColor:[255,0,255,0],data:d,elevationRange:[0,0],elevationScale:1,getHexagon:k=>k[0],pickable:!0,radius:1e5,getPosition:k=>k.slice(0,2),onClick:k=>console.log(k),opacity:1,extruded:!1});Object.entries(e).map(k=>new uh({id:k[0],getFillColor:[255,0,255,0],data:Object.entries(k[1]),elevationRange:[0,20],elevationScale:20,getHexagon:V=>V[0],pickable:!0,radius:1e4,onClick:V=>console.log(V),extruded:!1}));const S=new Vm({id:"hexagon-layer",data:[...Array(1e6).keys()].map(k=>({COORDINATES:[Math.random()*180,Math.random()*90]})),pickable:!0,extruded:!0,radius:1e4,elevationScale:4,opacity:0,getPosition:k=>k.COORDINATES});return Tt.useState({longitude:-122.4,latitude:37.8,zoom:10,pitch:0,bearing:0}),$t.jsx($t.Fragment,{children:$t.jsx("div",{class:"relative w-full h-full",style:{height:"750px"},children:$t.jsx($5,{views:new y5,initialViewState:Wee,controller:!0,layers:[r,l,S]})})})}var fL="1.13.6",lC=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},I_=Array.prototype,Fw=Object.prototype,uC=typeof Symbol<"u"?Symbol.prototype:null,Yee=I_.push,ip=I_.slice,kd=Fw.toString,Xee=Fw.hasOwnProperty,dL=typeof ArrayBuffer<"u",Kee=typeof DataView<"u",Jee=Array.isArray,cC=Object.keys,hC=Object.create,fC=dL&&ArrayBuffer.isView,ete=isNaN,tte=isFinite,pL=!{toString:null}.propertyIsEnumerable("toString"),dC=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],nte=Math.pow(2,53)-1;function Zo(t,e){return e=e==null?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),i=Array(n),r=0;r<n;r++)i[r]=arguments[r+e];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i);case 2:return t.call(this,arguments[0],arguments[1],i)}var A=Array(e+1);for(r=0;r<e;r++)A[r]=arguments[r];return A[e]=i,t.apply(this,A)}}function ch(t){var e=typeof t;return e==="function"||e==="object"&&!!t}function ite(t){return t===null}function gL(t){return t===void 0}function mL(t){return t===!0||t===!1||kd.call(t)==="[object Boolean]"}function rte(t){return!!(t&&t.nodeType===1)}function io(t){var e="[object "+t+"]";return function(n){return kd.call(n)===e}}const Nw=io("String"),_L=io("Number"),ste=io("Date"),ote=io("RegExp"),ate=io("Error"),yL=io("Symbol"),vL=io("ArrayBuffer");var xL=io("Function"),Ate=lC.document&&lC.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof Ate!="function"&&(xL=function(t){return typeof t=="function"||!1});const xo=xL,wL=io("Object");var bL=Kee&&wL(new DataView(new ArrayBuffer(8))),Uw=typeof Map<"u"&&wL(new Map),lte=io("DataView");function ute(t){return t!=null&&xo(t.getInt8)&&vL(t.buffer)}const Qm=bL?ute:lte,hh=Jee||io("Array");function yc(t,e){return t!=null&&Xee.call(t,e)}var kv=io("Arguments");(function(){kv(arguments)||(kv=function(t){return yc(t,"callee")})})();const Vw=kv;function cte(t){return!yL(t)&&tte(t)&&!isNaN(parseFloat(t))}function EL(t){return _L(t)&&ete(t)}function TL(t){return function(){return t}}function SL(t){return function(e){var n=t(e);return typeof n=="number"&&n>=0&&n<=nte}}function CL(t){return function(e){return e==null?void 0:e[t]}}const Hm=CL("byteLength"),hte=SL(Hm);var fte=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function dte(t){return fC?fC(t)&&!Qm(t):hte(t)&&fte.test(kd.call(t))}const PL=dL?dte:TL(!1),qo=CL("length");function pte(t){for(var e={},n=t.length,i=0;i<n;++i)e[t[i]]=!0;return{contains:function(r){return e[r]===!0},push:function(r){return e[r]=!0,t.push(r)}}}function ML(t,e){e=pte(e);var n=dC.length,i=t.constructor,r=xo(i)&&i.prototype||Fw,A="constructor";for(yc(t,A)&&!e.contains(A)&&e.push(A);n--;)A=dC[n],A in t&&t[A]!==r[A]&&!e.contains(A)&&e.push(A)}function Ss(t){if(!ch(t))return[];if(cC)return cC(t);var e=[];for(var n in t)yc(t,n)&&e.push(n);return pL&&ML(t,e),e}function gte(t){if(t==null)return!0;var e=qo(t);return typeof e=="number"&&(hh(t)||Nw(t)||Vw(t))?e===0:qo(Ss(t))===0}function IL(t,e){var n=Ss(e),i=n.length;if(t==null)return!i;for(var r=Object(t),A=0;A<i;A++){var d=n[A];if(e[d]!==r[d]||!(d in r))return!1}return!0}function gi(t){if(t instanceof gi)return t;if(!(this instanceof gi))return new gi(t);this._wrapped=t}gi.VERSION=fL;gi.prototype.value=function(){return this._wrapped};gi.prototype.valueOf=gi.prototype.toJSON=gi.prototype.value;gi.prototype.toString=function(){return String(this._wrapped)};function pC(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,Hm(t))}var gC="[object DataView]";function Lv(t,e,n,i){if(t===e)return t!==0||1/t===1/e;if(t==null||e==null)return!1;if(t!==t)return e!==e;var r=typeof t;return r!=="function"&&r!=="object"&&typeof e!="object"?!1:kL(t,e,n,i)}function kL(t,e,n,i){t instanceof gi&&(t=t._wrapped),e instanceof gi&&(e=e._wrapped);var r=kd.call(t);if(r!==kd.call(e))return!1;if(bL&&r=="[object Object]"&&Qm(t)){if(!Qm(e))return!1;r=gC}switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:+t==0?1/+t===1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return uC.valueOf.call(t)===uC.valueOf.call(e);case"[object ArrayBuffer]":case gC:return kL(pC(t),pC(e),n,i)}var A=r==="[object Array]";if(!A&&PL(t)){var d=Hm(t);if(d!==Hm(e))return!1;if(t.buffer===e.buffer&&t.byteOffset===e.byteOffset)return!0;A=!0}if(!A){if(typeof t!="object"||typeof e!="object")return!1;var l=t.constructor,S=e.constructor;if(l!==S&&!(xo(l)&&l instanceof l&&xo(S)&&S instanceof S)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var k=n.length;k--;)if(n[k]===t)return i[k]===e;if(n.push(t),i.push(e),A){if(k=t.length,k!==e.length)return!1;for(;k--;)if(!Lv(t[k],e[k],n,i))return!1}else{var U=Ss(t),V;if(k=U.length,Ss(e).length!==k)return!1;for(;k--;)if(V=U[k],!(yc(e,V)&&Lv(t[V],e[V],n,i)))return!1}return n.pop(),i.pop(),!0}function mte(t,e){return Lv(t,e)}function rp(t){if(!ch(t))return[];var e=[];for(var n in t)e.push(n);return pL&&ML(t,e),e}function jw(t){var e=qo(t);return function(n){if(n==null)return!1;var i=rp(n);if(qo(i))return!1;for(var r=0;r<e;r++)if(!xo(n[t[r]]))return!1;return t!==BL||!xo(n[Gw])}}var Gw="forEach",LL="has",Qw=["clear","delete"],DL=["get",LL,"set"],_te=Qw.concat(Gw,DL),BL=Qw.concat(DL),yte=["add"].concat(Qw,Gw,LL);const vte=Uw?jw(_te):io("Map"),xte=Uw?jw(BL):io("WeakMap"),wte=Uw?jw(yte):io("Set"),bte=io("WeakSet");function U0(t){for(var e=Ss(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i}function Ete(t){for(var e=Ss(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i}function RL(t){for(var e={},n=Ss(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e}function Dv(t){var e=[];for(var n in t)xo(t[n])&&e.push(n);return e.sort()}function Hw(t,e){return function(n){var i=arguments.length;if(e&&(n=Object(n)),i<2||n==null)return n;for(var r=1;r<i;r++)for(var A=arguments[r],d=t(A),l=d.length,S=0;S<l;S++){var k=d[S];(!e||n[k]===void 0)&&(n[k]=A[k])}return n}}const OL=Hw(rp),Wm=Hw(Ss),zL=Hw(rp,!0);function Tte(){return function(){}}function FL(t){if(!ch(t))return{};if(hC)return hC(t);var e=Tte();e.prototype=t;var n=new e;return e.prototype=null,n}function Ste(t,e){var n=FL(t);return e&&Wm(n,e),n}function Cte(t){return ch(t)?hh(t)?t.slice():OL({},t):t}function Pte(t,e){return e(t),t}function NL(t){return hh(t)?t:[t]}gi.toPath=NL;function sp(t){return gi.toPath(t)}function Ww(t,e){for(var n=e.length,i=0;i<n;i++){if(t==null)return;t=t[e[i]]}return n?t:void 0}function UL(t,e,n){var i=Ww(t,sp(e));return gL(i)?n:i}function Mte(t,e){e=sp(e);for(var n=e.length,i=0;i<n;i++){var r=e[i];if(!yc(t,r))return!1;t=t[r]}return!!n}function $w(t){return t}function Ld(t){return t=Wm({},t),function(e){return IL(e,t)}}function Zw(t){return t=sp(t),function(e){return Ww(e,t)}}function op(t,e,n){if(e===void 0)return t;switch(n??3){case 1:return function(i){return t.call(e,i)};case 3:return function(i,r,A){return t.call(e,i,r,A)};case 4:return function(i,r,A,d){return t.call(e,i,r,A,d)}}return function(){return t.apply(e,arguments)}}function VL(t,e,n){return t==null?$w:xo(t)?op(t,e,n):ch(t)&&!hh(t)?Ld(t):Zw(t)}function qw(t,e){return VL(t,e,1/0)}gi.iteratee=qw;function Yo(t,e,n){return gi.iteratee!==qw?gi.iteratee(t,e):VL(t,e,n)}function Ite(t,e,n){e=Yo(e,n);for(var i=Ss(t),r=i.length,A={},d=0;d<r;d++){var l=i[d];A[l]=e(t[l],l,t)}return A}function jL(){}function kte(t){return t==null?jL:function(e){return UL(t,e)}}function Lte(t,e,n){var i=Array(Math.max(0,t));e=op(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i}function Bv(t,e){return e==null&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}const Dd=Date.now||function(){return new Date().getTime()};function GL(t){var e=function(A){return t[A]},n="(?:"+Ss(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(A){return A=A==null?"":""+A,i.test(A)?A.replace(r,e):A}}const QL={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Dte=GL(QL),Bte=RL(QL),Rte=GL(Bte),Ote=gi.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Gy=/(.)^/,zte={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Fte=/\\|'|\r|\n|\u2028|\u2029/g;function Nte(t){return"\\"+zte[t]}var Ute=/^\s*(\w|\$)+\s*$/;function Vte(t,e,n){!e&&n&&(e=n),e=zL({},e,gi.templateSettings);var i=RegExp([(e.escape||Gy).source,(e.interpolate||Gy).source,(e.evaluate||Gy).source].join("|")+"|$","g"),r=0,A="__p+='";t.replace(i,function(k,U,V,$,X){return A+=t.slice(r,X).replace(Fte,Nte),r=X+k.length,U?A+=`'+
((__t=(`+U+`))==null?'':_.escape(__t))+
'`:V?A+=`'+
((__t=(`+V+`))==null?'':__t)+
'`:$&&(A+=`';
`+$+`
__p+='`),k}),A+=`';
`;var d=e.variable;if(d){if(!Ute.test(d))throw new Error("variable is not a bare identifier: "+d)}else A=`with(obj||{}){
`+A+`}
`,d="obj";A=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+A+`return __p;
`;var l;try{l=new Function(d,"_",A)}catch(k){throw k.source=A,k}var S=function(k){return l.call(this,k,gi)};return S.source="function("+d+`){
`+A+"}",S}function jte(t,e,n){e=sp(e);var i=e.length;if(!i)return xo(n)?n.call(t):n;for(var r=0;r<i;r++){var A=t==null?void 0:t[e[r]];A===void 0&&(A=n,r=i),t=xo(A)?A.call(t):A}return t}var Gte=0;function Qte(t){var e=++Gte+"";return t?t+e:e}function Hte(t){var e=gi(t);return e._chain=!0,e}function HL(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var A=FL(t.prototype),d=t.apply(A,r);return ch(d)?d:A}var V0=Zo(function(t,e){var n=V0.placeholder,i=function(){for(var r=0,A=e.length,d=Array(A),l=0;l<A;l++)d[l]=e[l]===n?arguments[r++]:e[l];for(;r<arguments.length;)d.push(arguments[r++]);return HL(t,i,this,this,d)};return i});V0.placeholder=gi;const WL=Zo(function(t,e,n){if(!xo(t))throw new TypeError("Bind must be called on a function");var i=Zo(function(r){return HL(t,i,e,this,n.concat(r))});return i}),Oa=SL(qo);function fh(t,e,n,i){if(i=i||[],!e&&e!==0)e=1/0;else if(e<=0)return i.concat(t);for(var r=i.length,A=0,d=qo(t);A<d;A++){var l=t[A];if(Oa(l)&&(hh(l)||Vw(l)))if(e>1)fh(l,e-1,n,i),r=i.length;else for(var S=0,k=l.length;S<k;)i[r++]=l[S++];else n||(i[r++]=l)}return i}const Wte=Zo(function(t,e){e=fh(e,!1,!1);var n=e.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=e[n];t[i]=WL(t[i],t)}return t});function $te(t,e){var n=function(i){var r=n.cache,A=""+(e?e.apply(this,arguments):i);return yc(r,A)||(r[A]=t.apply(this,arguments)),r[A]};return n.cache={},n}const $L=Zo(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),Zte=V0($L,gi,1);function qte(t,e,n){var i,r,A,d,l=0;n||(n={});var S=function(){l=n.leading===!1?0:Dd(),i=null,d=t.apply(r,A),i||(r=A=null)},k=function(){var U=Dd();!l&&n.leading===!1&&(l=U);var V=e-(U-l);return r=this,A=arguments,V<=0||V>e?(i&&(clearTimeout(i),i=null),l=U,d=t.apply(r,A),i||(r=A=null)):!i&&n.trailing!==!1&&(i=setTimeout(S,V)),d};return k.cancel=function(){clearTimeout(i),l=0,i=r=A=null},k}function Yte(t,e,n){var i,r,A,d,l,S=function(){var U=Dd()-r;e>U?i=setTimeout(S,e-U):(i=null,n||(d=t.apply(l,A)),i||(A=l=null))},k=Zo(function(U){return l=this,A=U,r=Dd(),i||(i=setTimeout(S,e),n&&(d=t.apply(l,A))),d});return k.cancel=function(){clearTimeout(i),i=A=l=null},k}function Xte(t,e){return V0(e,t)}function Yw(t){return function(){return!t.apply(this,arguments)}}function Kte(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}}function Jte(t,e){return function(){if(--t<1)return e.apply(this,arguments)}}function ZL(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}const ene=V0(ZL,2);function qL(t,e,n){e=Yo(e,n);for(var i=Ss(t),r,A=0,d=i.length;A<d;A++)if(r=i[A],e(t[r],r,t))return r}function YL(t){return function(e,n,i){n=Yo(n,i);for(var r=qo(e),A=t>0?0:r-1;A>=0&&A<r;A+=t)if(n(e[A],A,e))return A;return-1}}const Xw=YL(1),XL=YL(-1);function KL(t,e,n,i){n=Yo(n,i,1);for(var r=n(e),A=0,d=qo(t);A<d;){var l=Math.floor((A+d)/2);n(t[l])<r?A=l+1:d=l}return A}function JL(t,e,n){return function(i,r,A){var d=0,l=qo(i);if(typeof A=="number")t>0?d=A>=0?A:Math.max(A+l,d):l=A>=0?Math.min(A+1,l):A+l+1;else if(n&&A&&l)return A=n(i,r),i[A]===r?A:-1;if(r!==r)return A=e(ip.call(i,d,l),EL),A>=0?A+d:-1;for(A=t>0?d:l-1;A>=0&&A<l;A+=t)if(i[A]===r)return A;return-1}}const e6=JL(1,Xw,KL),tne=JL(-1,XL);function Rv(t,e,n){var i=Oa(t)?Xw:qL,r=i(t,e,n);if(r!==void 0&&r!==-1)return t[r]}function nne(t,e){return Rv(t,Ld(e))}function vu(t,e,n){e=op(e,n);var i,r;if(Oa(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var A=Ss(t);for(i=0,r=A.length;i<r;i++)e(t[A[i]],A[i],t)}return t}function eh(t,e,n){e=Yo(e,n);for(var i=!Oa(t)&&Ss(t),r=(i||t).length,A=Array(r),d=0;d<r;d++){var l=i?i[d]:d;A[d]=e(t[l],l,t)}return A}function t6(t){var e=function(n,i,r,A){var d=!Oa(n)&&Ss(n),l=(d||n).length,S=t>0?0:l-1;for(A||(r=n[d?d[S]:S],S+=t);S>=0&&S<l;S+=t){var k=d?d[S]:S;r=i(r,n[k],k,n)}return r};return function(n,i,r,A){var d=arguments.length>=3;return e(n,op(i,A,4),r,d)}}const Qy=t6(1),mC=t6(-1);function L0(t,e,n){var i=[];return e=Yo(e,n),vu(t,function(r,A,d){e(r,A,d)&&i.push(r)}),i}function ine(t,e,n){return L0(t,Yw(Yo(e)),n)}function _C(t,e,n){e=Yo(e,n);for(var i=!Oa(t)&&Ss(t),r=(i||t).length,A=0;A<r;A++){var d=i?i[A]:A;if(!e(t[d],d,t))return!1}return!0}function yC(t,e,n){e=Yo(e,n);for(var i=!Oa(t)&&Ss(t),r=(i||t).length,A=0;A<r;A++){var d=i?i[A]:A;if(e(t[d],d,t))return!0}return!1}function lu(t,e,n,i){return Oa(t)||(t=U0(t)),(typeof n!="number"||i)&&(n=0),e6(t,e,n)>=0}const rne=Zo(function(t,e,n){var i,r;return xo(e)?r=e:(e=sp(e),i=e.slice(0,-1),e=e[e.length-1]),eh(t,function(A){var d=r;if(!d){if(i&&i.length&&(A=Ww(A,i)),A==null)return;d=A[e]}return d==null?d:d.apply(A,n)})});function Kw(t,e){return eh(t,Zw(e))}function sne(t,e){return L0(t,Ld(e))}function n6(t,e,n){var i=-1/0,r=-1/0,A,d;if(e==null||typeof e=="number"&&typeof t[0]!="object"&&t!=null){t=Oa(t)?t:U0(t);for(var l=0,S=t.length;l<S;l++)A=t[l],A!=null&&A>i&&(i=A)}else e=Yo(e,n),vu(t,function(k,U,V){d=e(k,U,V),(d>r||d===-1/0&&i===-1/0)&&(i=k,r=d)});return i}function one(t,e,n){var i=1/0,r=1/0,A,d;if(e==null||typeof e=="number"&&typeof t[0]!="object"&&t!=null){t=Oa(t)?t:U0(t);for(var l=0,S=t.length;l<S;l++)A=t[l],A!=null&&A<i&&(i=A)}else e=Yo(e,n),vu(t,function(k,U,V){d=e(k,U,V),(d<r||d===1/0&&i===1/0)&&(i=k,r=d)});return i}var ane=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function i6(t){return t?hh(t)?ip.call(t):Nw(t)?t.match(ane):Oa(t)?eh(t,$w):U0(t):[]}function r6(t,e,n){if(e==null||n)return Oa(t)||(t=U0(t)),t[Bv(t.length-1)];var i=i6(t),r=qo(i);e=Math.max(Math.min(e,r),0);for(var A=r-1,d=0;d<e;d++){var l=Bv(d,A),S=i[d];i[d]=i[l],i[l]=S}return i.slice(0,e)}function Ane(t){return r6(t,1/0)}function lne(t,e,n){var i=0;return e=Yo(e,n),Kw(eh(t,function(r,A,d){return{value:r,index:i++,criteria:e(r,A,d)}}).sort(function(r,A){var d=r.criteria,l=A.criteria;if(d!==l){if(d>l||d===void 0)return 1;if(d<l||l===void 0)return-1}return r.index-A.index}),"value")}function k_(t,e){return function(n,i,r){var A=e?[[],[]]:{};return i=Yo(i,r),vu(n,function(d,l){var S=i(d,l,n);t(A,d,S)}),A}}const une=k_(function(t,e,n){yc(t,n)?t[n].push(e):t[n]=[e]}),cne=k_(function(t,e,n){t[n]=e}),hne=k_(function(t,e,n){yc(t,n)?t[n]++:t[n]=1}),fne=k_(function(t,e,n){t[n?0:1].push(e)},!0);function dne(t){return t==null?0:Oa(t)?t.length:Ss(t).length}function pne(t,e,n){return e in n}const s6=Zo(function(t,e){var n={},i=e[0];if(t==null)return n;xo(i)?(e.length>1&&(i=op(i,e[1])),e=rp(t)):(i=pne,e=fh(e,!1,!1),t=Object(t));for(var r=0,A=e.length;r<A;r++){var d=e[r],l=t[d];i(l,d,t)&&(n[d]=l)}return n}),gne=Zo(function(t,e){var n=e[0],i;return xo(n)?(n=Yw(n),e.length>1&&(i=e[1])):(e=eh(fh(e,!1,!1),String),n=function(r,A){return!lu(e,A)}),s6(t,n,i)});function o6(t,e,n){return ip.call(t,0,Math.max(0,t.length-(e==null||n?1:e)))}function Hy(t,e,n){return t==null||t.length<1?e==null||n?void 0:[]:e==null||n?t[0]:o6(t,t.length-e)}function Ug(t,e,n){return ip.call(t,e==null||n?1:e)}function mne(t,e,n){return t==null||t.length<1?e==null||n?void 0:[]:e==null||n?t[t.length-1]:Ug(t,Math.max(0,t.length-e))}function _ne(t){return L0(t,Boolean)}function yne(t,e){return fh(t,e,!1)}const a6=Zo(function(t,e){return e=fh(e,!0,!0),L0(t,function(n){return!lu(e,n)})}),vne=Zo(function(t,e){return a6(t,e)});function Ov(t,e,n,i){mL(e)||(i=n,n=e,e=!1),n!=null&&(n=Yo(n,i));for(var r=[],A=[],d=0,l=qo(t);d<l;d++){var S=t[d],k=n?n(S,d,t):S;e&&!n?((!d||A!==k)&&r.push(S),A=k):n?lu(A,k)||(A.push(k),r.push(S)):lu(r,S)||r.push(S)}return r}const xne=Zo(function(t){return Ov(fh(t,!0,!0))});function wne(t){for(var e=[],n=arguments.length,i=0,r=qo(t);i<r;i++){var A=t[i];if(!lu(e,A)){var d;for(d=1;d<n&&lu(arguments[d],A);d++);d===n&&e.push(A)}}return e}function zv(t){for(var e=t&&n6(t,qo).length||0,n=Array(e),i=0;i<e;i++)n[i]=Kw(t,i);return n}const bne=Zo(zv);function Ene(t,e){for(var n={},i=0,r=qo(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n}function Tne(t,e,n){e==null&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),A=0;A<i;A++,t+=n)r[A]=t;return r}function Sne(t,e){if(e==null||e<1)return[];for(var n=[],i=0,r=t.length;i<r;)n.push(ip.call(t,i,i+=e));return n}function Jw(t,e){return t._chain?gi(e).chain():e}function A6(t){return vu(Dv(t),function(e){var n=gi[e]=t[e];gi.prototype[e]=function(){var i=[this._wrapped];return Yee.apply(i,arguments),Jw(this,n.apply(gi,i))}}),gi}vu(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=I_[t];gi.prototype[t]=function(){var n=this._wrapped;return n!=null&&(e.apply(n,arguments),(t==="shift"||t==="splice")&&n.length===0&&delete n[0]),Jw(this,n)}});vu(["concat","join","slice"],function(t){var e=I_[t];gi.prototype[t]=function(){var n=this._wrapped;return n!=null&&(n=e.apply(n,arguments)),Jw(this,n)}});const Cne=Object.freeze(Object.defineProperty({__proto__:null,VERSION:fL,after:Jte,all:_C,allKeys:rp,any:yC,assign:Wm,before:ZL,bind:WL,bindAll:Wte,chain:Hte,chunk:Sne,clone:Cte,collect:eh,compact:_ne,compose:Kte,constant:TL,contains:lu,countBy:hne,create:Ste,debounce:Yte,default:gi,defaults:zL,defer:Zte,delay:$L,detect:Rv,difference:a6,drop:Ug,each:vu,escape:Dte,every:_C,extend:OL,extendOwn:Wm,filter:L0,find:Rv,findIndex:Xw,findKey:qL,findLastIndex:XL,findWhere:nne,first:Hy,flatten:yne,foldl:Qy,foldr:mC,forEach:vu,functions:Dv,get:UL,groupBy:une,has:Mte,head:Hy,identity:$w,include:lu,includes:lu,indexBy:cne,indexOf:e6,initial:o6,inject:Qy,intersection:wne,invert:RL,invoke:rne,isArguments:Vw,isArray:hh,isArrayBuffer:vL,isBoolean:mL,isDataView:Qm,isDate:ste,isElement:rte,isEmpty:gte,isEqual:mte,isError:ate,isFinite:cte,isFunction:xo,isMap:vte,isMatch:IL,isNaN:EL,isNull:ite,isNumber:_L,isObject:ch,isRegExp:ote,isSet:wte,isString:Nw,isSymbol:yL,isTypedArray:PL,isUndefined:gL,isWeakMap:xte,isWeakSet:bte,iteratee:qw,keys:Ss,last:mne,lastIndexOf:tne,map:eh,mapObject:Ite,matcher:Ld,matches:Ld,max:n6,memoize:$te,methods:Dv,min:one,mixin:A6,negate:Yw,noop:jL,now:Dd,object:Ene,omit:gne,once:ene,pairs:Ete,partial:V0,partition:fne,pick:s6,pluck:Kw,property:Zw,propertyOf:kte,random:Bv,range:Tne,reduce:Qy,reduceRight:mC,reject:ine,rest:Ug,restArguments:Zo,result:jte,sample:r6,select:L0,shuffle:Ane,size:dne,some:yC,sortBy:lne,sortedIndex:KL,tail:Ug,take:Hy,tap:Pte,template:Vte,templateSettings:Ote,throttle:qte,times:Lte,toArray:i6,toPath:NL,transpose:zv,unescape:Rte,union:xne,uniq:Ov,unique:Ov,uniqueId:Qte,unzip:zv,values:U0,where:sne,without:vne,wrap:Xte,zip:bne},Symbol.toStringTag,{value:"Module"}));var Fv=A6(Cne);Fv._=Fv;function Pne(t){console.log(t.data);const e=Tt.useRef();return console.log("BAR CHART"),Tt.useEffect(()=>{const n=new Wy;return n.module(EC,i=>{if(i==="chart")return new bC(e.current)}).redefine("alphabet",t.data),()=>n.dispose()},[]),$t.jsx($t.Fragment,{children:$t.jsx("div",{ref:e})})}function Mne(t){console.log(t.getCoefficents);const e=Tt.useRef();return Tt.useEffect(()=>{const n=new Wy;return new Wy().module(oD,i=>{if(i==="chart")return new bC(e.current)}).redefine("dataset",t.getCoefficents),()=>n.dispose()},[]),$t.jsx($t.Fragment,{children:$t.jsx("div",{ref:e})})}const Ine=[35,139],kne=[[0,"#3288bd"],[1,"#66c2a5"],[2,"#abdda4"],[3,"#e6f598"],[4,"#ffffbf"],[5,"#fee08b"],[6,"#fdae61"],[7,"#f46d43"],[8,"#d53e4f"]],Lne=()=>{let t=kne[Math.floor(Math.random()*8)][1];return console.log(t),{id:"data",type:"fill",paint:{"fill-color":t,"fill-opacity":.8}}};function Dne(t){console.log(t);const e=Tt.useRef(),[n,i]=Tt.useState("");if(t.data==="hello world"||t.data==="hello-world")return $t.jsx($t.Fragment,{});const r=t.data[0][2],A=t.data[0][3],d=()=>{console.log("hello")},l=(we,ie)=>$t.jsx(yU,{longitude:we.lon,latitude:we.lat,anchor:"bottom",onClick:Ae=>{Ae.originalEvent.stopPropagation()}},`marker-${ie}`);function S(we){return we.reduce((ie,Ae)=>(ie.features.push(Ae.features[0]),ie))}let k=t.data.map((we,ie)=>we[1]);k=S(k);let U=$t.jsx(xU,{type:"geojson",data:k,children:$t.jsx(vU,{...Lne()})}),V=t.data.map(we=>we[0].map(l)),$=["commuteDistance","library","bar","coffee"],X={};$.forEach(we=>{X[we]=.5});let[ee,ue]=Tt.useState(X);return Tt.useEffect(()=>{console.log("fetch to callFN here"),(async()=>await(await fetch("https://pypypy.ngrok.io/callFn/",{method:"POST",redirect:"follow",referrerPolicy:"no-referrer",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":!0},body:JSON.stringify({getCoefficents:ee})})).json())().then(ie=>{let Ae=`
    You selected Coffee Shops as most Important and there are 300 per square mile near this airbnb
    You Selected libraries as not Important and there none near this airbnb
    You selected Bars as somewhat important and there are a handful close to this airbnb by Train
    You selected Bars as important and there is a really good one called Disco Gay Bar thats a 5 min walk
    `;i(JSON.stringify(ie,null,2)+Ae)})},[ee]),$t.jsxs($t.Fragment,{children:[$t.jsxs(bI,{ref:e,mapboxAccessToken:"pk.eyJ1IjoiYXdhaGFiIiwiYSI6ImNrdjc3NW11aTJncmIzMXExcXRiNDNxZWYifQ.tqFU7uVd6mbhHtjYsjtvlg",initialViewState:{longitude:A,latitude:r,zoom:14},style:{width:1e3,height:500},onClick:d,mapStyle:"https://api.maptiler.com/maps/streets/style.json?key=D8xiby3LSvsdgkGzkOmN",children:[V,U]}),$t.jsx($t.Fragment,{children:n}),$t.jsx(Mne,{getCoefficents:ee}),$t.jsx(Pne,{data:t.data.map(we=>we[0]).flat().map(we=>{function ie(Ae,ce){let Ce=Ae[0]-ce[0],Ne=Ae[1]-ce[1];return Ce*Ce*Ne*Ne}return{frequency:ie([we.lat,we.lon],Ine),letter:we.tags.amenity+we.tags.name}})})]})}const Bne={marker:{x:0,y:0,width:128,height:128,mask:!0}},Rne=new fw({color:[255,255,255],intensity:1}),One=new Xk({color:[255,255,255],intensity:.8,position:[-.144528,49.739968,8e4]}),zne=new Xk({color:[255,255,255],intensity:.8,position:[-3.807751,54.104682,8e3]}),Fne=new __({ambientLight:Rne,pointLight1:One,pointLight2:zne}),Nne={ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]},Une="https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json";function Vne(t){if(t.picked)return JSON.stringify(t.object,null,2)}function jne({centroid:t,reports:e,hexes:n,_houses:i,mapStyle:r=Une,radius:A=1e3,upperPercentile:d=100,coverage:l=1}){console.log(t,"centroid");const S=[new tp({id:"icon-layer",data:e.map(U=>U.house),pickable:!0,iconAtlas:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/icon-atlas.png",iconMapping:Bne,getIcon:U=>"marker",onClick:U=>U.object.url,sizeScale:15,getPosition:U=>U.location.reverse().concat(100),getSize:U=>5,getColor:U=>[Math.random()*255,140,0]}),new uh({id:"h3",getFillColor:U=>Object.values(Id(Qee(U[1].vending_machine/100))).slice(0,3),data:Object.entries(n),elevationRange:[0,0],elevationScale:1,getHexagon:U=>U[0],pickable:!0,radius:A,onClick:U=>console.log(U),material:Nne,extruded:!1})],k={longitude:t[1],latitude:t[0],zoom:11,maxZoom:20,pitch:0,bearing:0};return $t.jsx("div",{className:"relative h-96",children:$t.jsx($5,{width:500,height:500,layers:S,effects:[Fne],initialViewState:k,controller:!0,getTooltip:Vne,children:$t.jsx(bI,{reuseMaps:!0,mapLib:bU,mapStyle:r,preventStyleDiffing:!0})})})}function Gne(t){const e=Tt.useRef();return Tt.useEffect(()=>{const n=new wI;return n.module(EC,i=>{if(i==="chart")return new V2(e.current)}).redefine("alphabet",t.data),()=>n.dispose()},[]),$t.jsx($t.Fragment,{children:$t.jsx("div",{ref:e})})}function Qne(t){let e={};return e[t.label]=.5,$t.jsxs("div",{className:"block",children:[$t.jsx("label",{children:t.label}),$t.jsx("input",{type:"range",onChange:n=>{e[t.label]=n.target.value/100,l6("sliders",Object.assign(eb("sliders"),e)),t.apply_()}})]})}let Bd={};function l6(t,e){Bd[t]=e}function eb(t){return t?Bd[t]:Bd}let vC=!1;function Hne(t){let e=t.cities,n="";if(!vC){if(e.indexOf("Tokyo, Japan")==-1)return;vC=!0,n="Tokyo, Japan"}let[i,r]=Tt.useState(n);Tt.useState(!1);let A=t.apply_;return Tt.useEffect(()=>{l6(t.formDataKey,i),A()},[i]),$t.jsxs("div",{children:[$t.jsx("fieldset",{className:"mt-4",children:$t.jsx("div",{className:"space-y-4",children:e.map((d,l)=>$t.jsxs("div",{className:"flex items-center",children:[$t.jsx("input",{id:d,name:"notification-method",type:"radio",checked:i===d,className:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-600",onChange:()=>{r(d)}}),$t.jsx("label",{htmlFor:d,className:"ml-3 block text-sm font-medium leading-6 text-gray-900",children:d})]},l))})}),"-----------------------------------------------------"]})}function Wne(t){return Dne(t)}function tb(t){return document.querySelector(t)}console.log("is this deployed");async function xC(){let t=tb("textarea").value.split(`
`),e="http://127.0.0.1:8000/makeFn";window.location.hostname==="https://hidden-river-3971.fly.dev"&&(console.log("gesundheit"),e="https://hidden-river-3971.fly.dev/makeFn/",console.log(e));let n=await fetch(e,{method:"POST",redirect:"follow",referrerPolicy:"no-referrer",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":!0,"Access-Control-Allow-Origin":"*"},body:JSON.stringify({fn:t,documentContext:eb(),hashUrl:window.location.hash.slice(1)})});return n=await n.json(),Bd=n.documentContext,n.isFromDisk&&(document.querySelector("textarea").value=n.fn),n.fn}function $ne(t){let e=Date.now();return function(){let n=Date.now();n-e>2e3&&t(),e=n}}function Zne({apply_:t}){return Tt.useEffect(()=>{tb("textarea").value=h6[0],t()},[]),$t.jsx($t.Fragment,{children:$t.jsx("textarea",{className:"bg-blue-200 w-full h-64 border border-gray-300 rounded-lg p-2",onKeyUp:$ne(t)})})}const u6=t=>$t.jsxs("ul",{className:"overflow-scroll h-64",children:[$t.jsx("li",{children:t.length},"item font-white"),t.map((e,n)=>$t.jsx("li",{children:e},n))]});function qne(t){if(!t.reports)return $t.jsx($t.Fragment,{children:"not found sorry 🐻"});console.log(t);let e=t.reports.map((n,i)=>{const r=n.reasoning_explanation;return $t.jsxs("div",{children:[$t.jsx("div",{children:n.name+"  "+n.house.url}),$t.jsxs($t.Fragment,{children:["Other Houses Within Neighborhood",u6(n.houses_within_suggested_neighborhood.map(A=>A.url))]}),$t.jsx("div",{children:r.split(`
`).map(A=>$t.jsx("div",{children:A}))}),$t.jsx("div",{children:$t.jsx(Gne,{data:Object.entries(n.commutes).map(A=>({letter:A[0],frequency:parseFloat(A[1].replace("mi",""))}))})})]},i)});return $t.jsxs($t.Fragment,{children:[$t.jsx("div",{class:"text-xl",children:t.city}),$t.jsx(jne,{...t}),[...Array(8).keys()].map(n=>$t.jsx("br",{},n)),e]})}function Yne(t){return t[0]&&t[0][0]&&t[0][0][1]&&t[0][0][1].type==="node"}function wC(t,e){return t.map(function(i,r){return i.component==="<Hexagonworld>"?$t.jsx(qee,{data:i.data}):i[0]&&i[0].isochrone?i.map((A,d)=>$t.jsx("div",{children:$t.jsx(qne,{...A})},d)):i[0]=="#"?$t.jsx("h1",{className:"text-xl",children:i}):Yne(i)?$t.jsx(Wne,{data:i}):i.component==="<slider>"?$t.jsx($t.Fragment,{children:$t.jsx(Qne,{apply_:e,label:i.label})}):i.component==="<Radio>"?$t.jsx(Hne,{apply_:e,formDataKey:i.key,cities:Array.isArray(i.data)?i.data:i.data[eb().continent||"Asia"]},Math.random()):Array.isArray(i)?u6(i):$t.jsx(Xne,{text:i})}).map((i,r)=>$t.jsx("div",{children:i},r))}function Xne(t){return $t.jsx("div",{className:" border border-purple-500",children:t.text})}let c6={optimalhousematchingforgroups:`
  for every city in ['Tokyo, Japan', 'Houston, Texas', 'Madrid, Spain']
  find 10 houses and each house is close to the residents favorite preferences. All like bar, half like research_institute, only 1 likes clinic (two people like restaurant, two people like library, two people like atm,  none of them like vending_machine and they all like bench but half like libraries and the other half prefer parking_space and some prefer bank while others prefer place_of_worship and some like disco and the others prefer country.) - they all want to be less than 90 min train distance to Sensō-ji`,hexagon_world:"map of the future - all airbnbs + pois in the world",airbnb:`for each continent
  choose a city in each
  find all airbnb in that city
  i like library
  i like bar
  i like coffee
  filter by 10 min train or drive to a library above 4 star
  `,arxiv:`find all papers on https://scholar.google.com/scholar?start=0&q=IPC&hl=en&as_sdt=0,44
  find papers which are good but not highly cited yet and find papers that may be highly cited in future 
  get all diagrams
  get all tables
  get sentences that are highly similar or support the same thesis 
  :poll astronomy, physics, infoTheory
      find all papers on arxiv relating to astronomy
      predict papers that will be highly cited
      or predict quality or relevance of paper that are too specific to have a lot of citations
      
      What are the most important problems in your field -> how would you work on them?.
      `,pokemon:`given a favorite pokemon - select
  make best team that counters elite 4
  element counters
  schedule - spend 30 min in viridian city`,tree_planting:`find all trees in nyc 
   plot on a map
  reccomend places to plant a tree based on h3
  visualize how many are of which species in a trees_histogram
  trees_map
  find a place to plant a new tree that is optimal
  `,yt_humor_database:`
  for all keenan and kel
  get all transcript
  then find the jokes
  then categorize the jokes and the other context 
  `},Kne=Object.keys(c6),h6=Object.values(c6);function Jne(){const[t,e]=Tt.useState(0),[n,i]=Tt.useState([]),[r,A]=Tt.useState(0),d=Fv.throttle(function(){async function S(){let k=await xC();k=wC(k,S),i(k)}S()},5*1e3);Tt.useEffect(()=>{(async()=>{let k=await xC();k=wC(k,d),i(k)})()},[t]);const l=$t.jsxs("div",{children:[$t.jsx("label",{children:"pick a template"}),$t.jsx("select",{value:r,onChange:S=>{A(S.target.value),tb("textarea").value=h6[S.target.selectedIndex],e(t+1),Bd={city:"Tokyo, Japan"}},className:"w-64 m-5 border border-bluegray-800 border-dashed",children:Kne.map((S,k)=>$t.jsx("option",{value:k,children:S},S))}),$t.jsx(NR,{url:eie}),$t.jsx(Zne,{apply_:d})]});return $t.jsx($t.Fragment,{children:$t.jsxs("div",{className:"grid grid-cols-3",children:[l,$t.jsx("div",{className:"col-span-2 ",children:n})]})})}let eie=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQ8YIQwbLgQeNxMXMBMeMh0XOR4fMQ0gPhUiNRUnOyMcOyEpLCEvMCQ+PTgzMAIpSgYqTgcnUAAuWgUuXAorVAsuVAgvVg4rUw0qVwwtUAwvWQ4yTAYzVAEwXgAwXwEyXQAyXgA1WwM0XAE0XwE3XQI3XwcwXgY1XwA4XgoxWgswXAk2Xw4xWQ04WxMpQRUpRBMoVxEtVRUrVBUtWREyXRc5VQAvYAAvYQAsZwAuZwAxYAAwYQExYgAwYwIyYAAyYQAyYwAwZQAxZgEzZAAyZQAyZwE0YQE0YgA0YwE2YwA1ZAI0ZQA0ZgE0ZwA3ZAA3ZQA2ZwQwYQYyYwQyZAUzZQY1YQQ0YgY0Zgc2ZAQ3ZgIxaQAxagEzaAAyaQAyawAzbAAybgA0aAA0aQA1awE2aAI3aQA3agM0bgE2bAE3bQA2bwQwbwc3aAQ3bAU2bgA5YwQ4YAU4ZwU6ZgA4aAM4bAQ4aAQ5awgyZgwyYQ40ZQg4aAA1cAA1cRMpYhQrYRUrZRcsYyMuTi84SSg/XwpWeBlXcCpDWTFDUShTZDVAYFNIG2pOAGFdE05RWE5VXVRKbFRdZExnVltoeXxLT2xDZWNHcHpYc25haG5gbXJveHpueHV2eAtehnFWg3lUh3tWinxXjXpag25jg2Z1iHJihmWXlGmbkn+OpYJZAIRfV4NGf4tOd4FTb5BbiZh9jqZ2nqxxoauocd/OduXKb4aLkYiDmpOEl5KQk5iTl5GVoIi1oa6HnKOTnrWbpMCovtaQzt+W29+f09Soy9qt1N+41+WYxuKd1uWZ1+yc2+yV4/GR6PqY7fmd6v6b6+mszeal2+Wr1OC23uO53euq4PCm4/Sm4Pqh8dLVhODE0wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJNhIKMAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjVJivzgAAABG0lEQVQoUwEQAe/+AHxhJSFMaUVIR05zTVNURGEAe2MjcDtBYm1KSkBNNmw9UABdXDxTUlduOVt0TUtDQEpIAE09XHcYM35/fYAwGCpVSkoAZGJoE4GinZ+gnqGkiRkdZQA7QEQ0j9LP1MbB0MS1LylGAHkmKzKV08nWwKqwwraCNRwACwwNAJTVy8q/ra+WmLmGGwCoi4yKk8XNzKu7rry4tKMuALOy17GpzsjHrL2Xt5uQpwcApaa6kQ7Yw9G+mpmNjpKDMQCchIWIhwYKBQMECAEJAhR4AChvP1EaFxEsKRYVEA8tJz4ASU9eOHc8WTphYTZ6HxJyPwBnQnVJElg8aV5qYzd2O3FHAGtaICQiI0RfYHtfXWZEHlYX2mbiHrA6rAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQ0dPhQXKBYYPw0kNgghPxInOhAmPRIoPx0mNTcfNTgyGjAlNg4aQhkbSwQoSAcqSAYqTgQvTwksSAUrUgcuVwAuWgEtXgAuXQAvXgAuXwYqXgQtWQsuWAguWw0uWQwuXgMzVwAwWAAxXQIzXAAzXgE1XAM0XQA0XgM0XwE2XgM3XwczWgQzXwY0WAU1XQsyUw0wUAoxWAsyWwsxXgkyXgwzXBEqSRIvTRAvThYoThcrThQsThgjQRwlTBspThIsURAtWRAsWxAvXhstURQwVxAwWRY4VAAvYgAtZgEuZgAvbggrbwIneAAxYQEyYAAyYQAyYwAwZQAwZgAxZwEzZAAyZQIyZgAyZwA0YAI1YgA0YwI3YQA2YwA1ZAE1ZQA0ZgE0ZwA2ZQA2ZgczYgYyYwYxZAUzZAYyZQQyZgQzZwU1ZgY2ZwAxawIyaAAzaQAyawAzbQA0aAA0agE2aAQ2awU0bAI5YgE4Zwc4YQY5ZAA4awM7bgU4aQQ6aQQ8bQk2YAg0ZQk1ZgM0dgM6cgk3cgwxfy82QCw4RjE8WipEXS1JVzRHTiVBZihPbC9SaCZRc0VINVVOMVNePlp2OWtaPkNQWEtUWV5OdVxbYVpib3NPWWtHY2hIbWRdZXhbb3tjS3dmcHl3eGVdhmpeiW1ciGRiimpkimpmiWR0jW91gXtthGqlVWipWYdPfoxSeo1BgpFjipJ6iqB5mLhpqoO0Y52xabPge7ThfIuJlJKCjZqPlZGVmJyTmISKopaMpZKUoKeJobibr7jigM+QyduYwd6c48Sgxt2i0t2h4eWT3e6U1POY0++T6PGT5/SZ6fqc6vqf7v2f9+es2uqm1+O/y/Cyx+Gg5Omj6eit4+un8OW24uSx6fOt4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJj3aiYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjVJivzgAAABG0lEQVQoUwEQAe/+AHF3IVtvcHJaJyNjZGVpUF4AYE92JGdnTi4rMhwzZhl8TwBifk8sRT84Nzs6Q0QVfRdZAF9HczQ9p6aio6OkpYwteCQAg29TQpfayNnF1tfbvgURKQBBHjU5nNPO0cmvs8exhkYgAAkLhwGb3M3Mw7CynqC/iS8AlJGSkJrEz9CtwLm8urioNgC2t8K1n9XLyq7BnbuhmL08AKyrtJMK1NLYxqqplZaZiD4Aj42OiosIAg0MAAYDBwRAHwBMhUsaMBITHRsxDg8QFIBWAIJKSHRnFoFrfBh5KGpfTlwAbnt6VmyESVdxTV9fcVVhXABYIlBVbVJ1bV13UVUXWWFiACUqVGBoSXVSUGFXVn8mTXr3Hmu6vgXxNAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQkbLAEdOQAfPRwcMRIgLh4kKiAhIyQmKTcxIQ0fTwEhQQAqUwArVAAsVgAtWQAuWwAvXA8wUAwxVhwzSQAxYAAyYgAyYwAzZAAzZQA0Zik4Riw5RjM7Ti9AUjhCSzhDW3ZqOElGQkhISFxRRlxUTFFRUVJSUl9ZWWFWSWhWRGZdXWlWaXZYdnhlVHlgX3lkWGVkZHNlaH1uaXN0dXVzc3R0dHh4eDY6vzgzuTk3wCWMPBnGixfBlkHTlpgyCI5Ke7J8fc8wE4BVgKh4gq5vrKiDbcG0Ad/jAefeAfnVEoeFh4qKipKSkpSUlJmZmcuZmdubsPi9ot6F3u+P7/6G6v6G6/+G7P6J7v+L8P+L8f+O9P+P9f+R9/+T+f+U+f+X/P6d8f+Y/P+Y/v+Z//+a/vmkx/mrzv6uzP+m5QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE3XPx0AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjVJivzgAAAAmklEQVQoU2OQRAMMWAWEdPVAQF9WQlISrEIlPTopLDw5w5UfJpAYGx+s7RLhLC0MVCEoxaicEhUZZOqlY+grJ8ngaKehqBkSl2Tv6+3n623My+Dh7ummkBAT6uSv5WOm7sDNYG1ja8URmJoWYGSipmogI85gaWGuJM/KzMnEwsbAzgW2RYJbVIBPUlKER4xbHGotsmuxO500FQCjIiU3D5OSIgAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURQ0dPhQXKBYYPw0kNgghPxInOhAmPRIoPx0mNTcfNTgyGjAlNg4aQhkbSwQoSAcqSAYqTgQvTwksSAUrUgcuVwAuWgEtXgAuXQAvXgAuXwYqXgQtWQsuWAguWw0uWQwuXgMzVwAwWAAxXQIzXAAzXgE1XAM0XQA0XgM0XwE2XgM3XwczWgQzXwY0WAU1XQsyUw0wUAoxWAsyWwsxXgkyXgwzXBEqSRIvTRAvThYoThcrThQsThgjQRwlTBspThIsURAtWRAsWxAvXhstURQwVxAwWRY4VAAvYgAtZgEuZgAvbggrbwIneAAxYQEyYAAyYQAyYwAwZQAwZgAxZwEzZAAyZQIyZgAyZwA0YAI1YgA0YwI3YQA2YwA1ZAE1ZQA0ZgE0ZwA2ZQA2ZgczYgYyYwYxZAUzZAYyZQQyZgQzZwU1ZgY2ZwAxawIyaAAzaQAyawAzbQA0aAA0agE2aAQ2awU0bAI5YgE4Zwc4YQY5ZAA4awM7bgU4aQQ6aQQ8bQk2YAg0ZQk1ZgM0dgM6cgk3cgwxfy82QCw4RjE8WipEXS1JVzRHTiVBZihPbC9SaCZRc0VINVVOMVNePlp2OWtaPkNQWEtUWV5OdVxbYVpib3NPWWtHY2hIbWRdZXhbb3tjS3dmcHl3eGVdhmpeiW1ciGRiimpkimpmiWR0jW91gXtthGqlVWipWYdPfoxSeo1BgpFjipJ6iqB5mLhpqoO0Y52xabPge7ThfIuJlJKCjZqPlZGVmJyTmISKopaMpZKUoKeJobibr7jigM+QyduYwd6c48Sgxt2i0t2h4eWT3e6U1POY0++T6PGT5/SZ6fqc6vqf7v2f9+es2uqm1+O/y/Cyx+Gg5Omj6eit4+un8OW24uSx6fOt4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJj3aiYAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjVJivzgAAABG0lEQVQoUwEQAe/+AHF3IVtvcHJaJyNjZGVpUF4AYE92JGdnTi4rMhwzZhl8TwBifk8sRT84Nzs6Q0QVfRdZAF9HczQ9p6aio6OkpYwteCQAg29TQpfayNnF1tfbvgURKQBBHjU5nNPO0cmvs8exhkYgAAkLhwGb3M3Mw7CynqC/iS8AlJGSkJrEz9CtwLm8urioNgC2t8K1n9XLyq7BnbuhmL08AKyrtJMK1NLYxqqplZaZiD4Aj42OiosIAg0MAAYDBwRAHwBMhUsaMBITHRsxDg8QFIBWAIJKSHRnFoFrfBh5KGpfTlwAbnt6VmyESVdxTV9fcVVhXABYIlBVbVJ1bV13UVUXWWFiACUqVGBoSXVSUGFXVn8mTXr3Hmu6vgXxNAAAAABJRU5ErkJggg=="];$y.createRoot(document.getElementById("root")).render($t.jsx(Jne,{}));export{AD as c,$m as g};
